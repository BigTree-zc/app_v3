/**
 * @file lv_demo_widgets.c
 *
 */

/*********************
 *      INCLUDES
 *********************/
#include "lv_demo_widgets.h"
#include "stdio.h"
#include "unistd.h"
#include "sys/types.h"
#include "sys/stat.h"
#include "fcntl.h"
#include "stdlib.h"
#include <sys/mman.h>
#include <time.h>
#include <string.h>
#include <sys/time.h>   
#include <sys/resource.h>
#include "../../examples/libs/Zint/zint.h"
#define STB_IMAGE_IMPLEMENTATION
#include "../../examples/libs/Zint/stb_image.h"
#define STB_IMAGE_WRITE_IMPLEMENTATION
#include "../../examples/libs/Zint/stb_image_write.h"
#include <dirent.h>
#include "sw_aes.h"
#include <regex.h> // 用于正则表达式匹配


#define  SOFTWARE_VERSION  "V1.0_20250928"



#if LV_USE_DEMO_WIDGETS

#if LV_MEM_CUSTOM == 0 && LV_MEM_SIZE < (38ul * 1024ul)
    #error Insufficient memory for lv_demo_widgets. Please set LV_MEM_SIZE to at least 38KB (38ul * 1024ul).  48KB is recommended.
#endif

/*********************
 *      DEFINES
 *********************/

/**********************
 *      TYPEDEFS
 **********************/
typedef enum {
    DISP_SMALL,
    DISP_MEDIUM,
    DISP_LARGE,
} disp_size_t;

/**********************
 *  STATIC PROTOTYPES
 **********************/
static void profile_create(lv_obj_t * parent);
static void analytics_create(lv_obj_t * parent);
static void shop_create(lv_obj_t * parent);
static void color_changer_create(lv_obj_t * parent);

static lv_obj_t * create_meter_box(lv_obj_t * parent, const char * title, const char * text1, const char * text2,
                                   const char * text3);
static lv_obj_t * create_shop_item(lv_obj_t * parent, const void * img_src, const char * name, const char * category,
                                   const char * price);

static void color_changer_event_cb(lv_event_t * e);
static void color_event_cb(lv_event_t * e);
static void ta_event_cb(lv_event_t * e);
static void birthday_event_cb(lv_event_t * e);
static void calendar_event_cb(lv_event_t * e);
static void slider_event_cb(lv_event_t * e);
static void chart_event_cb(lv_event_t * e);
static void shop_chart_event_cb(lv_event_t * e);
static void meter1_indic1_anim_cb(void * var, int32_t v);
static void meter1_indic2_anim_cb(void * var, int32_t v);
static void meter1_indic3_anim_cb(void * var, int32_t v);
static void meter2_timer_cb(lv_timer_t * timer);
static void meter3_anim_cb(void * var, int32_t v);

/**********************
 *  STATIC VARIABLES
 **********************/
static disp_size_t disp_size;

static lv_obj_t * tv;
static lv_obj_t * calendar;
static lv_style_t style_text_muted;
static lv_style_t style_title;
static lv_style_t style_icon;
static lv_style_t style_bullet;

static lv_obj_t * meter1;
static lv_obj_t * meter2;
static lv_obj_t * meter3;

static lv_obj_t * chart1;
static lv_obj_t * chart2;
static lv_obj_t * chart3;

static lv_chart_series_t * ser1;
static lv_chart_series_t * ser2;
static lv_chart_series_t * ser3;
static lv_chart_series_t * ser4;

static const lv_font_t * font_large;
static const lv_font_t * font_normal;

static uint32_t session_desktop = 1000;
static uint32_t session_tablet = 1000;
static uint32_t session_mobile = 1000;

static lv_timer_t * meter2_timer;

static lv_obj_t * Head_background_image;
static lv_obj_t * Total_output_label;
static lv_obj_t * Date_label;
static lv_obj_t * Time_label;
static lv_obj_t * Battery_label;
static lv_obj_t * Battery_image;
static lv_obj_t * win_content;
static lv_obj_t* win_obj;
static lv_obj_t* screen_off_obj;


//#define CANVAS_WIDTH      9169   //39
#define CANVAS_WIDTH      16077   //156
//#define CANVAS_WIDTH      5000  //39
#define CANVAS_HEIGHT     158

#define PRINT_KEY_NUM     130   // PE2
#define ENCODER_KEY_NUM   132   // PE4
#define PH45_164_CLK_NUM  136   // PE8
#define PH45_164_AB_NUM   135   // PE7
#define PH45_595_SER1_NUM 138   // PE10
#define PH45_595_SER2_NUM 137   // PE9
#define PH45_595_CLK_NUM  134   // PE6
#define PH45_595_RCK_NUM  133   // PE5

#define PH45_GPIO_STATUS_HIGH  1
#define PH45_GPIO_STATUS_LOW   0

#define GPIO_REG_BASE   0x01C20800      //GPIO物理基地址 (小页4kb)
#define MAP_SIZE        0x400 //MMU页大小
#define GPIO_BASE_OFFSET (GPIO_REG_BASE & 0X00000FFF) //GPIO基地址偏移计算
#define GPIO_PAGE_OFFSET (GPIO_REG_BASE & 0XFFFFF000) //获得页偏移

#define rPE_CFG0 0X90  //PE_CFG0寄存器地址偏移  PE0~PE7
#define rPE_CFG1 0X94  //PE_CFG0寄存器地址偏移  PE8~PE15
#define rPE_DAT 0XA0    //PE_DAT寄存器地址偏移
#define rPE_PULL0 0XAC  //PE_PULL0寄存器地址偏移


#define CANVAS_WIDTH_1  2077
#define CANVAS_HEIGHT_1 158
#define WORD_MAX_SIZE 200


typedef struct _PRINT_DATA_
{
    unsigned char trigger_mode;
    unsigned char nozzle; // 0:left;1:right
    unsigned char concentration;
    unsigned char word_width;
    unsigned char print_number;//连喷次数：1~9：连喷次数就是按一下之后滚动，如果连喷次数是1就喷一次，是3就喷三次，以此类推
    unsigned char print_interval;//连喷间隔：就是按下喷印按键 机器不是要滚动然后喷出吗 间隔数值越大 需要滚动越远,单位是1mm
    unsigned char trigger_delay;//触发延迟：100毫秒
    unsigned char print_speed;//喷印速度：1微妙  
    unsigned int data_width;
    unsigned int data_hight;
    unsigned char data[CANVAS_WIDTH_1 * CANVAS_HEIGHT_1];
}PRINT_DATA;
static PRINT_DATA print_data;        

/* 第一步：为画布申请缓冲区内存 */
//static lv_color_t cbuf[LV_CANVAS_BUF_SIZE_TRUE_COLOR(CANVAS_WIDTH,CANVAS_HEIGHT)];
static unsigned int buzzer_enable = 0;
static unsigned int buzzer_count = 0;
static int fd_buzzer;
//static int fd_mp1484_en;
static int fd_bm8563;
static int fd_rc522;
static int fd_adc;
static int fd_optoelectronic;
//static int print_width[CANVAS_HEIGHT] = {0};
static int print_button_enable = 0;
static int fd_gpio_in;
static unsigned int key_value = 1;
static unsigned int key_value_1 = 1;
static unsigned int key_value_2 = 1;
//static unsigned int encoder_enalbe = 0;
//static unsigned int encoder_low_flag = 0;
//static unsigned int encoder_count = 0;
//static unsigned int encoder_count_last = 0;
static int fd_ph45;
//static unsigned char g_odd_even = 1; //jishu
//static unsigned char *map_base;
static PRINT_DATA print_data;
static char g_time_data_string[16]={0};
static char g_time_time_string[16]={0};
static lv_obj_t * label_print;
static lv_obj_t * imgbtn_print;
unsigned int g_total_output = 0;
const char* config_file = "/root/config.conf";


//文件管理
lv_obj_t* file_management_win;
lv_obj_t* file_management_head_bg;
lv_obj_t* label_file_management_total_output;
lv_obj_t* label_file_management;
lv_obj_t* label_file_management_date;
lv_obj_t* label_file_management_time;
lv_obj_t* img_file_management_battery_level;
lv_obj_t* label_file_management_label;
lv_obj_t* file_management_middle_bg;
lv_obj_t* img_file_management_text;
lv_obj_t* label_file_management_text;
lv_obj_t* label_file_management_text_label;
lv_obj_t* label_file_management_text_label_1;
lv_obj_t* img_file_management_text_time;
lv_obj_t* label_file_management_text_time;
lv_obj_t* label_file_management_text_time_label;
lv_obj_t* img_file_management_typeface;
lv_obj_t* label_file_management_typeface;
lv_obj_t* btn_file_management_typeface;
lv_obj_t* label_file_management_typeface_label;
lv_obj_t* img_file_management_word_space;
lv_obj_t* label_file_management_word_space;
lv_obj_t* label_file_management_word_space_label;
lv_obj_t* btn_file_management_word_space_label;
lv_obj_t* img_file_management_word_size;
lv_obj_t* label_file_management_word_size;
lv_obj_t* label_file_management_word_size_label;
lv_obj_t* btn_file_management_word_size_label;
lv_obj_t* img_file_management_spin;
lv_obj_t* label_file_management_spin;
lv_obj_t* label_file_management_spin_label;
lv_obj_t* label_btn_modification_text_spin;
lv_obj_t* btn_modification_text_spin;
lv_obj_t* img_file_management_width;
lv_obj_t* label_file_management_width;
lv_obj_t* label_file_management_width_label;
lv_obj_t* img_file_management_bold;
lv_obj_t* label_file_management_bold;
lv_obj_t* sw_file_management_bold;
lv_obj_t* img_file_management_line_increment;
lv_obj_t* label_file_management_line_increment;
lv_obj_t* label_file_management_line_increment_label;
lv_obj_t* img_management_line_italic;
lv_obj_t* label_management_line_italic;
lv_obj_t* sw_management_line_italic;
lv_obj_t* file_management_bottom_bg;
lv_obj_t* label_file_management_return;
lv_obj_t* imgbtn_file_management_get_back;
lv_obj_t* imgbtn_file_management_confirm;
lv_obj_t* label_file_management_confirm;
lv_obj_t* btn_file_management_text;
lv_obj_t* label_keyboard_return;
lv_obj_t* btn_keyboard_return;
lv_obj_t* label_keyboard_confirm;
lv_obj_t* btn_keyboard_confirm;
lv_obj_t* keyboard_cand_panel;
lv_obj_t* text_edit_keyboard;
lv_obj_t* textarea_text_keyboard;
lv_obj_t* pinyin_ime;
lv_obj_t* textarea_bg_keyboard;
lv_obj_t* keyboard_bg;
static unsigned char print_status = 0;
lv_obj_t* main_canvas;
lv_draw_label_dsc_t main_label_dsc;
lv_timer_t * timer_100ms;

lv_obj_t* temp_focused_obj;

lv_obj_t* canvas;

lv_color_t *canvasBuf  = NULL;

lv_style_t style_info;
lv_ft_info_t info;

static lv_img_dsc_t* snapshot = NULL;

int fd_pwm;
int fd_period_0;
int fd_duty_0;
int fd_enable_0;
int fd_period_1;
int fd_duty_1;
int fd_enable_1;


#define DUTY              "duty"
#define PERIOD            "1000000"
#define DUTYCYCLE         "500000"
#define LENGTH            100


#define NEW_TEXT_MAX_NUMBER 10
#define TEXT_MAX_LENGTH     200
#define BREAK_MAX_NUMBER    5


enum
{
    TYPE_WORD = 1,
    TYPE_QR = 2,
    TYPE_BAR = 3,
    TYPE_PITCTURE,
    TYPE_ICON,
    TYPE_COUNT,
    TYPE_DATE,
    TYPE_BREAK,
    TYPE_SYMBOL,
};



typedef struct  _WORD_STRUCTURE_
{
    unsigned char typeface;//字体
    unsigned char italic_bold;//斜体
    unsigned char space;//间距
    unsigned char size;//大小
    int spin;//旋转
    lv_ft_info_t info;
    lv_style_t style;
    char text[TEXT_MAX_LENGTH];
}WORD_STRUCTURE;


typedef struct  _DATE_TIME_STRUCTURE_
{
    unsigned char typeface;//字体
    unsigned char italic_bold;//斜体
    unsigned char space;//间距
    unsigned char size;//大小
    unsigned char date_or_time;//0:date;1:time;2:validity
    unsigned char date_or_time_type;
    unsigned char year;
    unsigned char month;
    unsigned char day;
    int spin;//旋转
    lv_ft_info_t info;
    lv_style_t style;
    char text[TEXT_MAX_LENGTH/2];
}DATE_TIME_STRUCTURE;



typedef struct  _QR_BAR_STRUCTURE_
{
    unsigned char type;//字体
    unsigned char symbology;
    unsigned char figure;//数字
    unsigned char borders;//边框
    unsigned char height;
    unsigned char width;
    int size;
    char text[TEXT_MAX_LENGTH];
}QR_BAR_STRUCTURE;


typedef struct  _PICTURE_STRUCTURE_
{
    char text_1[100];//存储图片名称
    char text_2[100];//存储图片名称
    unsigned int size;
}PICTURE_STRUCTURE;


typedef struct  _ICON_STRUCTURE_
{
    unsigned char type;//存储图片名称
    unsigned int size;
}ICON_STRUCTURE;



typedef struct  _COUNT_STRUCTURE_
{
    unsigned char law;
    unsigned char repetition;
    unsigned char typeface;//字体
    unsigned char space;//间距
    unsigned char size;//大小
    unsigned char lead_zero;
    int current_value;
    int minimum;
    int maximum;
    int step;
    lv_ft_info_t info;
    lv_style_t style;
    char text[32];
}COUNT_STRUCTURE;


typedef struct  _DATA_STRUCTURE_
{
    unsigned char type;  //1:文字；2:二维码；3：条形码；4：图片；5：图标；6：计数；7：日期；8:分段;9,fuhao
    unsigned int x;//位置
    unsigned int y;//位置
    union _UNION_DATA_
    {
        WORD_STRUCTURE word;
        DATE_TIME_STRUCTURE date_time;
        QR_BAR_STRUCTURE qr_bar;
        PICTURE_STRUCTURE picture;
        ICON_STRUCTURE icon;
        COUNT_STRUCTURE count;
    }data;
}DATA_STRUCTURE;

DATA_STRUCTURE  data_structure[NEW_TEXT_MAX_NUMBER];
DATA_STRUCTURE  data_structure_last[NEW_TEXT_MAX_NUMBER];

unsigned int g_data_structure_count = 0;


static char typeface_buf[37][32] = {
    "ChangYongSongTi.ttc",
    "ChangYongHeiTi.ttf",
    "ChangYongKaiTi.ttf",
    "ChangYongLiShu-GBK.ttf",
    "FangZhengHeiTi-GBK.TTF",
    "SourceHanSansSC-Regular.otf",
    "CuTiSongTi.ttf",
    "JiangChengYuanTi400W.ttf",
    "JiYingBanYuan1.01.ttf",
    "TaiWanMingTi-TW-2.ttf",
    "TaiBeiHeiTi-Regular.ttf",
    "YouSheBiaoTiHei-2.ttf",
    "YouSheHaoShenTi-2.ttf",
    "PangMenBiaoTi.ttf",
    "PangMenCuShu6.0.ttf",
    "ZhanKuWenYi.ttf",
    "ZhanKuKuaiLe.ttf",
    "ZhanKuXiaoWei.otf",
    "QingKeHuangYou.ttf",
    "XiaoBoSaoBao.otf",
    "XiaoBoNanShen.otf",
    "JiangXiZhuoKai.ttf",
    "MuYaoShouXie.ttf",
    "RenDongZhuShi-Regular.TTF",
    "ZhuoJianGanLan-Regula.ttf",
    "WenCangShuFang-2.ttf",
    "HongLeiXingShu.otf",
    "KongXinZiTi.ttf",
    "LibreBaskerville-Regular.ttf",
    "EBGaramond08-Regular.ttf",
    "Arvo-Regular.ttf",
    "OpenSans-Regular.ttf",
    "Roboto-Regular.ttf",
    "Montserrat-Regular.ttf",
    "D-DIN-PRO-400-Regular.otf",
    "Marcellus-Regular.ttf",
    "JinzisheTongyuan-Regular.ttf",
};

static char typeface_name[37][16] = {
    "常用宋体",
    "常用黑体",
    "常用楷体",
    "常用隶书",
    "方正黑体",
    "思源黑体",
    "粗体宋体",
    "江城圆体",
    "极影半圆",
    "臺湾明体",
    "台北黑体",
    "优设标题",
    "优设身体",
    "庞门标题",
    "庞门粗书",
    "站酷文艺",
    "站酷快乐",
    "站酷小微",
    "庆科黄油",
    "晓波骚包",
    "晓波男神",
    "江西拙楷",
    "沐瑶手写",
    "任东竹石",
    "卓健橄榄",
    "问藏书房",
    "鸿雷行书",
    "空心字体",
    "Baskerville",
    "Garamond",
    "Arvo",
    "Open Sans",
    "Roboto",
    "Montserrat",
    "D-DIN PRO",
    "Marcellus",
    "点阵圆点1",
};

typedef enum
{
    CHANG_YONG_SONG_TI = 0,
    CHANG_YONG_HEI_TI = 1,
    CHANG_YONG_KAI_TI = 2,
    CHANG_YONG_LI_SHU_GBK = 3,
    FANG_ZHENG_HEI_TI_GBK = 4,
    SOURCE_HAN_SANS_SC_REGULAR = 5,
    SOURCE_HAN_SERIF_CN_SEMIBOLD_7 = 6,
    CU_TI_SONG_TI = 7,
    JIANG_CHENG_YUAN_TI = 8,
    JI_YING_BAN_YUAN = 9,
    TAI_WAN_MING_TI = 10,
    TAI_BEI_HEI_TI = 11,
    YOU_SHE_BIAO_TI_HEI = 12,
    YOU_SHE_HAO_SHEN_TI = 13,
    PANG_MEN_BIAO_TI = 14,
    PANG_MEN_CU_SHU = 15,
    ZHAN_KU_WEN_YI = 16,
    ZHAN_KU_KUAI_LE = 17,
    ZHAN_KU_XIAO_WEI = 18,
    QING_KE_HUANG_YOU = 19,
    XIAO_BO_SAO_BAO = 20,
    XIAO_BO_NAN_SHEN = 21,
    JIANG_XI_ZHUO_KAI = 22,
    MU_YAO_SHOU_XIE = 23,
    REN_DONG_ZHU_SHI = 24,
    ZHUO_JIAN_GAN_LAN = 25,
    WEN_CANG_SHU_FANG = 26,
    HONG_LEI_XING_SHU = 27,
    KONG_XIN_ZI_TI = 28,
    LIBRE_BASKERVILLE = 29,
    EB_GARAMOND = 30,
    ARVO_REGULAR = 31,
    OPEN_SANS_REGULAR = 32,
    ROBOTO_REGULAR = 33,
    MONTSERRAT_REGULAR = 34,
    D_DIN_PRO_400_REGULAR = 35,
    MARCELLUS_REGULAR = 36,
    JIN_ZI_SHE_TONG_YUAN_REGULAR = 37,
    FONT_TYPE_MAX,
}FontType;


lv_obj_t* typeface_head_bg;
lv_obj_t* label_typeface_return;
lv_obj_t* btn_typeface_return;
lv_obj_t* btn_typeface_confirm;
lv_obj_t* label_typeface_confirm;
lv_obj_t* typeface_content_bg;
lv_obj_t* label_typeface_head;
lv_obj_t* win_obj_typeface;
lv_obj_t* win_content_typeface;
lv_obj_t* left_stop_img_typeface;
lv_obj_t* right_stop_img_typeface;
lv_obj_t* typeface_slider_bg;
lv_obj_t* slider_typeface;
lv_obj_t* slider_main;

#define TYPEFACE_NUMBER   37
#define QR_CODE_NUMBER    4
#define BAR_CODE_NUMBER   10
#define SYMBOL_NUMBER     119

typedef struct  _TYPEFACE_OBJ_
{
    lv_obj_t* obj_typeface_btn;
    lv_obj_t* obj_typeface_label;
}TYPEFACE_OBJ;

TYPEFACE_OBJ typeface_obj[120];


static int g_typeface = CHANG_YONG_SONG_TI;




static lv_obj_t* set_tv;
static lv_obj_t* set_tv_print;
static lv_obj_t* set_tv_system;
static lv_obj_t* set_tv_about;

lv_obj_t* set_tv_bottom_bg;
lv_obj_t* set_tv_bottom_return;
lv_obj_t* imgbtn_set_tv_bottom_return;
lv_obj_t* imgbtn_set_tv_bottom_confirm;
lv_obj_t* label_set_tv_bottom_confirm;

lv_obj_t* trigger_mode;
lv_obj_t* print_mode;
lv_obj_t* voltage_mode;
lv_obj_t* width_mode;
lv_obj_t* nozzle_mode;
lv_obj_t* concentration_mode;
lv_obj_t* number_continuous_print_mode;
lv_obj_t* label_voltage_mode;
lv_obj_t* label_width_mode;
lv_obj_t* label_print_mode;
lv_obj_t* label_trigger_mode;
lv_obj_t* label_nozzle_mode;
lv_obj_t* label_encoder_mode;
lv_obj_t* encoder_mode;
lv_obj_t* label_concentration_mode;
lv_obj_t* label_number_continuous_print_mode;
lv_obj_t* label_interval_continuous_print_mode;
lv_obj_t* label_trigger_delay_mode;
lv_obj_t* label_speed_print_mode;
lv_obj_t* label_set_print_mode;
lv_obj_t* btn_interval_continuous_print_mode;
lv_obj_t* label_btn_interval_continuous_print_mode;
lv_obj_t* btn_trigger_delay_mode;
lv_obj_t* label_btn_trigger_delay_mode;
lv_obj_t* btn_label_speed_print_mode;
lv_obj_t* label_btn_label_speed_print_mode;
lv_obj_t* btn_label_set_print_mode;
lv_obj_t* label_btn_label_set_print_mode;
lv_obj_t* label_system_date;
lv_obj_t* btn_system_date;
lv_obj_t* label_btn_system_date;
lv_obj_t* label_system_time;
lv_obj_t* btn_system_time;
lv_obj_t* label_btn_system_time;
lv_obj_t* label_key_sound;
lv_obj_t* key_sound_mode;
lv_obj_t* label_screen_luminance;
 lv_obj_t* slider_screen_luminance;
lv_obj_t* label_USB_transfer;
lv_obj_t* sw_USB_transfer;
lv_obj_t* label_language;
lv_obj_t* dropdown_language;
lv_obj_t* btn_calibration;
lv_obj_t* label_btn_calibration;
lv_obj_t* btn_factory_reset;
lv_obj_t* label_btn_factory_reset;
lv_obj_t* label_breath_plate;
lv_obj_t* btn_breath_plate;
lv_obj_t* label_btn_breath_plate;
lv_obj_t* label_bluetooth_transfer;
lv_obj_t* sw_label_bluetooth_transfer;
lv_obj_t* label_device_type;
lv_obj_t* label_hardware_version;
lv_obj_t* label_manufacturer_information;
lv_obj_t* label_software_version;
lv_obj_t* btn_developer_model;
lv_obj_t* label_btn_check_updates;
lv_obj_t* btn_check_updates;
lv_obj_t* label_btn_developer_model;
lv_obj_t* dropdown_breath_plate;

static lv_obj_t* hint_label = NULL; // 密码提示框
static lv_obj_t* pwd_text_area = NULL; // 密码输入框

static const char* keyboard_map[] =
{
    "1","2", "3","\n",
    "4", "5", "6", "\n",
    "7", "8", "9" ,"\n",
    ".","0","x",""
};


static lv_obj_t* pwd_main_cont = NULL; // 密码输入界面的容器


static const lv_btnmatrix_ctrl_t keyboard_ctrl[] =
{
    LV_BTNMATRIX_CTRL_NO_REPEAT, LV_BTNMATRIX_CTRL_NO_REPEAT, LV_BTNMATRIX_CTRL_NO_REPEAT,
    LV_BTNMATRIX_CTRL_NO_REPEAT, LV_BTNMATRIX_CTRL_NO_REPEAT, LV_BTNMATRIX_CTRL_NO_REPEAT,
    LV_BTNMATRIX_CTRL_NO_REPEAT, LV_BTNMATRIX_CTRL_NO_REPEAT, LV_BTNMATRIX_CTRL_NO_REPEAT,
    LV_BTNMATRIX_CTRL_NO_REPEAT, LV_BTNMATRIX_CTRL_NO_REPEAT, LV_BTNMATRIX_CTRL_NO_REPEAT,
};

lv_obj_t* pwd_keyboard;
lv_obj_t* yield_text_area;


lv_obj_t* system_date_head_bg;
lv_obj_t* label_system_date_head;
lv_obj_t* system_date_middle_bg;
lv_obj_t* system_date_roller_year;
lv_obj_t* label_system_date_return;
lv_obj_t* btn_system_date_confirm;
lv_obj_t* btn_system_date_return;
lv_obj_t* label_system_date_confirm;
lv_obj_t* system_date_bottom_bg;
lv_obj_t* label_system_date_year_middle;
lv_obj_t* label_system_date_month_middle;
lv_obj_t* label_system_date_day_middle;
lv_obj_t* label_system_date_hour_middle;
lv_obj_t* label_system_date_minute_middle;
lv_obj_t* label_system_date_second_middle;
lv_obj_t* system_date_roller_month;
lv_obj_t* system_date_roller_day;
lv_obj_t* system_date_roller_hour;
lv_obj_t* system_date_roller_minute;
lv_obj_t* system_date_roller_second;


lv_obj_t* addition_head_bg;
lv_obj_t* img_addition_bg;
lv_obj_t* label_addition_head;
lv_obj_t* label_addition_middle_bg;
lv_obj_t* addition_bottom_bg;
lv_obj_t* label_addition_return;
lv_obj_t* imgbtn_addition_return;
lv_obj_t* imgbtn_addition_confirm;
lv_obj_t* label_addition_confirm;
lv_obj_t* btn_addition_text;
lv_obj_t* label_btn_addition_text;
lv_obj_t* btn_addition_date;
lv_obj_t* label_btn_addition_date;
lv_obj_t* btn_addition_picture;
lv_obj_t* label_btn_addition_picture;
lv_obj_t* btn_addition_QR_code;
lv_obj_t* label_btn_addition_QR_code;
lv_obj_t* btn_addition_bar_code;
lv_obj_t* label_btn_addition_bar_code;
lv_obj_t* btn_addition_count;
lv_obj_t* label_btn_addition_count;
lv_obj_t* btn_addition_subsection;
lv_obj_t* label_btn_addition_subsection;
lv_obj_t* btn_addition_symbol;
lv_obj_t* label_btn_addition_symbol;
lv_obj_t* btn_addition_icon;
lv_obj_t* label_btn_addition_icon;
lv_obj_t* btn_addition_more_functions;
lv_obj_t* label_btn_addition_more_functions;
lv_obj_t* btn_addition_return;



lv_obj_t* addition_count_head_bg;
lv_obj_t* label_addition_count_head;
lv_obj_t* obj_addition_count_middle_bg;
lv_obj_t* obj_addition_count_middle_bg_1;
lv_obj_t* label_addition_count_times_repetition;
lv_obj_t* btn_addition_count_times_repetition;
lv_obj_t* img_addition_count_typeface;
lv_obj_t* label_btn_addition_count_times_repetition;
lv_obj_t* label_addition_count_step;
lv_obj_t* btn_addition_count_step;
lv_obj_t* label_btn_addition_count_step;
lv_obj_t* label_addition_count_maximum;
lv_obj_t* btn_addition_count_maximum;
lv_obj_t* img_addition_count_step;
lv_obj_t* label_btn_addition_count_maximum;
lv_obj_t* label_addition_count_current_value;
lv_obj_t* btn_addition_count_current_value;
lv_obj_t* label_btn_addition_count_current_value;
lv_obj_t* img_addition_count_minimum;
lv_obj_t* obj_addition_count_bottom_bg;
lv_obj_t* label_addition_count_return;
lv_obj_t* imgbtn_addition_count_return;
lv_obj_t* imgbtn_addition_count_confirm;
lv_obj_t* label_addition_count_confirm;
lv_obj_t* label_addition_count_bit;
lv_obj_t* btn_label_addition_count_bit;
lv_obj_t* label_btn_label_addition_count_bit;
lv_obj_t* label_addition_count_law;
lv_obj_t* btn_addition_count_law;
lv_obj_t* label_btn_addition_count_law;
lv_obj_t* label_addition_count_minimum;
lv_obj_t* btn_addition_count_minimum;
lv_obj_t* img_addition_count_maximum;
lv_obj_t* label_btn_addition_count_minimum;
lv_obj_t* label_addition_count_lead_zero;
lv_obj_t* btn_addition_count_lead_zero;
lv_obj_t* label_btn_addition_count_lead_zero;
lv_obj_t* label_addition_count_scale;
lv_obj_t* btn_addition_count_scale;
lv_obj_t* label_btn_addition_count_scale;
lv_obj_t* label_addition_count_typeface;
lv_obj_t* btn_addition_count_typeface;
lv_obj_t* img_addition_count_size;
lv_obj_t* label_btn_addition_count_typeface;
lv_obj_t* label_addition_count_size;
lv_obj_t* btn_addition_count_size;
lv_obj_t* img_addition_count_space;
lv_obj_t* label_btn_addition_count_size;
lv_obj_t* label_addition_count_space;
lv_obj_t* btn_addition_count_space;
lv_obj_t* label_btn_addition_count_space;
lv_obj_t* img_addition_count_lead_zero;

lv_obj_t* obj_addition_date_text_head_bg;
lv_obj_t* label_addition_date_text_head;
lv_obj_t* obj_addition_date_text_middle_bg;
lv_obj_t* label_addition_date_text_return;
lv_obj_t* btn_addition_date_text_return;
lv_obj_t* btn_addition_date_confirm;
lv_obj_t* label_addition_date_confirm;
lv_obj_t* label_addition_count_preview;
lv_obj_t* img_addition_count_law;


#define DATA_TYPE_NUMBER   15

typedef struct  _DATE_TYPE_OBJ_
{
    lv_obj_t* obj_date_btn;
    lv_obj_t* obj_date_label;
}DATE_TYPE_OBJ;

DATE_TYPE_OBJ date_type_obj[DATA_TYPE_NUMBER];

#define TIME_TYPE_NUMBER   5


lv_obj_t* trigger_mode;
lv_obj_t* print_mode;
lv_obj_t* voltage_mode;
lv_obj_t* width_mode;
lv_obj_t* nozzle_mode;
lv_obj_t* concentration_mode;
lv_obj_t* number_continuous_print_mode;
lv_obj_t* label_voltage_mode;
lv_obj_t* label_width_mode;
lv_obj_t* label_print_mode;
lv_obj_t* label_trigger_mode;
lv_obj_t* label_nozzle_mode;
lv_obj_t* label_encoder_mode;
lv_obj_t* encoder_mode;
lv_obj_t* label_concentration_mode;
lv_obj_t* label_number_continuous_print_mode;
lv_obj_t* label_interval_continuous_print_mode;
lv_obj_t* label_trigger_delay_mode;
lv_obj_t* label_speed_print_mode;
lv_obj_t* label_set_print_mode;
lv_obj_t* btn_interval_continuous_print_mode;
lv_obj_t* label_btn_interval_continuous_print_mode;
lv_obj_t* btn_trigger_delay_mode;
lv_obj_t* label_btn_trigger_delay_mode;
lv_obj_t* btn_label_speed_print_mode;
lv_obj_t* label_btn_label_speed_print_mode;
lv_obj_t* btn_label_set_print_mode;
lv_obj_t* label_btn_label_set_print_mode;
lv_obj_t* label_system_date;
lv_obj_t* btn_system_date;
lv_obj_t* label_btn_system_date;
lv_obj_t* label_system_time;
lv_obj_t* btn_system_time;
lv_obj_t* label_btn_system_time;
lv_obj_t* label_key_sound;
lv_obj_t* key_sound_mode;
lv_obj_t* label_screen_luminance;
lv_obj_t* label_USB_transfer;
lv_obj_t* sw_USB_transfer;
lv_obj_t* label_language;
lv_obj_t* dropdown_language;
lv_obj_t* btn_calibration;
lv_obj_t* label_btn_calibration;
lv_obj_t* btn_factory_reset;
lv_obj_t* label_btn_factory_reset;
lv_obj_t* label_breath_plate;
lv_obj_t* btn_breath_plate;
lv_obj_t* label_btn_breath_plate;
lv_obj_t* label_bluetooth_transfer;
lv_obj_t* sw_label_bluetooth_transfer;
lv_obj_t* label_device_type;
lv_obj_t* label_hardware_version;
lv_obj_t* label_manufacturer_information;
lv_obj_t* label_software_version;
lv_obj_t* btn_developer_model;
lv_obj_t* label_btn_check_updates;
lv_obj_t* btn_check_updates;
lv_obj_t* label_btn_developer_model;
lv_obj_t* dropdown_breath_plate;
lv_obj_t* btn_modification_text_spin;
lv_obj_t* label_btn_modification_text_spin;
lv_obj_t* btn_addition_text_spin;
lv_obj_t* label_btn_addition_text_spin;
lv_obj_t* addition_date_head_bg;
lv_obj_t* label_addition_date_head;
lv_obj_t* label_addition_date_middle;
lv_obj_t* label_addition_date_middle_bg;
lv_obj_t* addition_date_middle_bg;
lv_obj_t* img_addition_date_text;
lv_obj_t* label_addition_date_text;
lv_obj_t* btn_addition_date_text;
lv_obj_t* label_btn_addition_date_text;
lv_obj_t* img_addition_time;
lv_obj_t* label_addition_time;
lv_obj_t* btn_label_addition_time;
lv_obj_t* label_btn_label_addition_time;
lv_obj_t* img_addition_date_typeface;
lv_obj_t* label_addition_date_typeface;
lv_obj_t* btn_addition_date_typeface;
lv_obj_t* label_btn_addition_date_typeface;
lv_obj_t* img_addition_date_word_size;
lv_obj_t* label_addition_date_word_size;
lv_obj_t* btn_addition_date_word_size;
lv_obj_t* label_btn_addition_date_word_size;
lv_obj_t* img_addition_date_word_space;
lv_obj_t* label_addition_date_word_space;
lv_obj_t* btn_addition_date_word_space;
lv_obj_t* label_btn_addition_date_word_space;
lv_obj_t* img_btn_addition_text_bold;
lv_obj_t* label_addition_text_bold;
lv_obj_t* sw_addition_text_bold;
lv_obj_t* img_addition_text_italic;
lv_obj_t* label_addition_text_italic;
lv_obj_t* sw_addition_text_italic;
lv_obj_t* img_addition_date_spin;
lv_obj_t* label_addition_date_spin;
lv_obj_t* btn_addition_date_spin;
lv_obj_t* label_btn_addition_date_spin;
lv_obj_t* img_btn_addition_date_bold;
lv_obj_t* label_addition_date_bold;
lv_obj_t* sw_addition_date_bold;
lv_obj_t* img_addition_date_italic;
lv_obj_t* label_addition_date_italic;
lv_obj_t* sw_addition_date_italic;
lv_obj_t* addition_date_bottom_bg;
lv_obj_t* label_addition_date_time_return;
lv_obj_t* imgbtn_addition_date_time_return;
lv_obj_t* imgbtn_addition_date_time_confirm;
lv_obj_t* label_addition_date_time_confirm;
lv_obj_t* addition_QR_code_head_bg;
lv_obj_t* label_addition_QR_code_head;
lv_obj_t* label_addition_QR_code_text;
lv_obj_t* label_addition_QR_code_width;
lv_obj_t* btn_addition_QR_code_width;
lv_obj_t* label_btn_addition_QR_code_width;
lv_obj_t* addition_QR_code_middle_bg;
lv_obj_t* qrcode_addition_QR_code;
lv_obj_t* label_addition_QR_code_return;
lv_obj_t* btn_addition_QR_code_return;
lv_obj_t* btn_addition_QR_code_confirm;
lv_obj_t* label_addition_QR_code_confirm;
lv_obj_t* addition_QR_code_middle_bg_1;
lv_obj_t* obj_addition_QR_code_bottom_bg;
lv_obj_t* img_addition_QR_code_text;
lv_obj_t* btn_addition_QR_code_text;
lv_obj_t* label_btn_addition_QR_code_text;
lv_obj_t* label_btn_addition_QR_code_text_1;
lv_obj_t* img_addition_QR_code;
lv_obj_t* label_addition_QR_code_QR;
lv_obj_t* dropdown_addition_QR_code_QR;
lv_obj_t* obj_addition_picture_head_bg;
lv_obj_t* label_addition_picture_head;
lv_obj_t* obj_addition_picture_preview_bg;
lv_obj_t* obj_addition_picture_bottom_bg;
lv_obj_t* label_addition_picture_return;
lv_obj_t* imgbtn_addition_picture_return;
lv_obj_t* imgbtn_addition_picture_confirm;
lv_obj_t* label_addition_picture_confirm;
lv_obj_t* btn_addition_QR_code_QR;
lv_obj_t* label_btn_addition_QR_code_QR;
lv_obj_t* img_addition_QR_code_height;
lv_obj_t* label_addition_QR_code_height;
lv_obj_t* btn_addition_QR_code_height;
lv_obj_t* label_btn_addition_QR_code_height;
lv_obj_t* img_addition_QR_code_figure;
lv_obj_t* label_addition_QR_code_figure;
lv_obj_t* btn_addition_QR_code_figure;
lv_obj_t* label_btn_addition_QR_code_figure;
lv_obj_t* img_addition_QR_code_bar_code;
lv_obj_t* label_addition_QR_code_bar_code;
lv_obj_t* btn_addition_QR_code_bar_code;
lv_obj_t* label_btn_addition_QR_code_bar_code;
lv_obj_t* img_addition_QR_code_width;
lv_obj_t* img_addition_QR_code_border;
lv_obj_t* label_addition_QR_code_border;
lv_obj_t* btn_addition_QR_code_border;
lv_obj_t* label_btn_addition_QR_code_border;
lv_obj_t* sw_addition_QR_code_figure;
lv_obj_t* sw_addition_QR_code_border;
lv_obj_t* obj_addition_picture_btn_bg;
lv_obj_t* obj_addition_table_bg;
lv_obj_t* btn_addition_picture_delete;
lv_obj_t* label_btn_addition_picture_delete;
lv_obj_t* btn_addition_picture_open;
lv_obj_t* label_btn_addition_picture_open;
lv_obj_t* img_addition_picture_search;
lv_obj_t* label_addition_picture_search;
lv_obj_t* btn_addition_picture_search;
lv_obj_t* label_btn_addition_picture_search;
lv_obj_t* table_addition_picture;
lv_obj_t* table_addition_picture_1;

lv_obj_t* btn_file_save;
lv_obj_t* label_btn_file_save;
lv_obj_t* btn_file_save_as;
lv_obj_t* label_btn_file_save_as;


#define TYPEFACE_NUMBER   37
#define QR_CODE_NUMBER    4
#define BAR_CODE_NUMBER   10
#define SYMBOL_NUMBER     119


static const char* const g_addition_symbol[] = {
            "€","￡","₣","₧","p","₴","¥","₩","₹","฿","₨","₪","₫","₭","₱","₤","₺",
            "₵","©","®","°","℃","℉","№","Ω","μ","π","φ","ø","Ψ","※","㎡","℡","²",
            "Σ","θ","λ","ω","∮","←","↑","→","↓","~","√","∞","∴","∵","∷","∽","≠",
            "≤","≥","≦","≧","⊙","⊕","〈","〉","《","》","「","」","『","』","【","】","〔",
            "〕","〖","〗","︗","︘","︵","︶","︷","︸","︹","︺","︻","︼","︽","︾","︿","﹀",
            "﹁","﹂","﹃","﹄","{","|","}","«","»","^","˄","˅","ˆ","ˇ","►","◄","㏗",
            "㏋","｟","｠","■","□","▲","△","▼","▽","◆","◇","○","◎","★","☆","ˆ","ˇ",
};

//static char g_addition_symbol[] = "€￡₣₧p₴¥₩₹฿₨₪₫₭₱₤₺₵©®°℃℉№ΩμπφøΨ※㎡℡²Σθλω∮←↑→↓~√∞∴∵∷∽≠≤≥≦≧⊙⊕〈〉《》「」『』【】〔〕〖〗︗︘︵︶︷︸︹︺︻︼︽︾︿﹀﹁﹂﹃﹄{|}«»^˄˅ˆˇ►◄㏗㏋｟｠■□▲△▼▽◆◇○◎★☆ˆˇ";


static int g_symbol_flag = 0;


lv_obj_t* addition_head_bg;
lv_obj_t* label_addition_head;
lv_obj_t* label_addition_middle_bg;
lv_obj_t* addition_bottom_bg;
lv_obj_t* label_addition_return;
lv_obj_t* imgbtn_addition_return;
lv_obj_t* imgbtn_addition_confirm;
lv_obj_t* label_addition_confirm;
lv_obj_t* btn_addition_text;
lv_obj_t* label_btn_addition_text;
lv_obj_t* btn_addition_date;
lv_obj_t* label_btn_addition_date;
lv_obj_t* btn_addition_picture;
lv_obj_t* label_btn_addition_picture;
lv_obj_t* btn_addition_QR_code;
lv_obj_t* label_btn_addition_QR_code;
lv_obj_t* btn_addition_bar_code;
lv_obj_t* label_btn_addition_bar_code;
lv_obj_t* btn_addition_count;
lv_obj_t* label_btn_addition_count;
lv_obj_t* btn_addition_subsection;
lv_obj_t* label_btn_addition_subsection;
lv_obj_t* btn_addition_symbol;
lv_obj_t* label_btn_addition_symbol;
lv_obj_t* btn_addition_icon;
lv_obj_t* label_btn_addition_icon;
lv_obj_t* btn_addition_more_functions;
lv_obj_t* label_btn_addition_more_functions;



lv_obj_t* system_date_head_bg;
lv_obj_t* label_system_date_head;
lv_obj_t* system_date_middle_bg;
lv_obj_t* system_date_roller_year;
lv_obj_t* label_system_date_return;
lv_obj_t* btn_system_date_confirm;
lv_obj_t* btn_system_date_return;
lv_obj_t* label_system_date_confirm;
lv_obj_t* system_date_bottom_bg;
lv_obj_t* label_system_date_year_middle;
lv_obj_t* label_system_date_month_middle;
lv_obj_t* label_system_date_day_middle;
lv_obj_t* label_system_date_hour_middle;
lv_obj_t* label_system_date_minute_middle;
lv_obj_t* label_system_date_second_middle;
lv_obj_t* system_date_roller_month;
lv_obj_t* system_date_roller_day;
lv_obj_t* system_date_roller_hour;
lv_obj_t* system_date_roller_minute;
lv_obj_t* system_date_roller_second;
lv_obj_t* addition_count_head_bg;
lv_obj_t* label_addition_count_head;
lv_obj_t* obj_addition_count_middle_bg;
lv_obj_t* label_addition_count_times_repetition;
lv_obj_t* btn_addition_count_times_repetition;
lv_obj_t* label_btn_addition_count_times_repetition;
lv_obj_t* label_addition_count_step;
lv_obj_t* btn_addition_count_step;
lv_obj_t* label_btn_addition_count_step;
lv_obj_t* label_addition_count_maximum;
lv_obj_t* btn_addition_count_maximum;
lv_obj_t* label_btn_addition_count_maximum;
lv_obj_t* label_addition_count_current_value;
lv_obj_t* btn_addition_count_current_value;
lv_obj_t* label_btn_addition_count_current_value;
lv_obj_t* obj_addition_count_bottom_bg;
lv_obj_t* label_addition_count_return;
lv_obj_t* imgbtn_addition_count_return;
lv_obj_t* imgbtn_addition_count_confirm;
lv_obj_t* label_addition_count_confirm;
lv_obj_t* label_addition_count_bit;
lv_obj_t* btn_label_addition_count_bit;
lv_obj_t* label_btn_label_addition_count_bit;
lv_obj_t* label_addition_count_law;
lv_obj_t* dropdown_addition_count_law;
lv_obj_t* img_addition_count_repetition;
lv_obj_t* btn_addition_count_law;
lv_obj_t* label_btn_addition_count_law;
lv_obj_t* label_addition_count_minimum;
lv_obj_t* btn_addition_count_minimum;
lv_obj_t* label_btn_addition_count_minimum;
lv_obj_t* label_addition_count_lead_zero;
lv_obj_t* dropdown_addition_count_lead_zero;
lv_obj_t* img_addition_count_current_value;
lv_obj_t* btn_addition_count_lead_zero;
lv_obj_t* label_btn_addition_count_lead_zero;
lv_obj_t* label_addition_count_scale;
lv_obj_t* btn_addition_count_scale;
lv_obj_t* label_btn_addition_count_scale;
lv_obj_t* label_addition_count_typeface;
lv_obj_t* btn_addition_count_typeface;
lv_obj_t* label_btn_addition_count_typeface;
lv_obj_t* label_addition_count_size;
lv_obj_t* btn_addition_count_size;
lv_obj_t* label_btn_addition_count_size;
lv_obj_t* label_addition_count_space;
lv_obj_t* btn_addition_count_space;
lv_obj_t* label_btn_addition_count_space;

lv_obj_t* obj_addition_date_text_head_bg;
lv_obj_t* label_addition_date_text_head;
lv_obj_t* obj_addition_date_text_middle_bg;
lv_obj_t* label_addition_date_text_return;
lv_obj_t* btn_addition_date_text_return;
lv_obj_t* btn_addition_date_confirm;
lv_obj_t* label_addition_date_confirm;
lv_obj_t* label_addition_count_preview;


static unsigned char QR_or_bar_code_flag = 0;
static unsigned char QR_code_type = 0;
static unsigned char bar_code_type = 0;
//static unsigned char figure_borders = 0;

static unsigned char g_system_time[6]={0};

static int set_system_time_flag = 0;
static volatile int read_writer_rtc_enable = 1;

static char QR_code_name[4][16] = {
    "QR CODE",
    "PDF417",
    "DATA MATRIX",
    "HANXIN",
};

static char bar_code_name[10][16] = {
    "CODE39",
    "CODE128",
    "EAN8",
    "EAN13",
    "EAN128",
    "UPCA",
    "UPCE",
    "ITF14",
    "INT25",
    "EAN14",
};


static unsigned char date_or_time_flag = 0;
static unsigned char g_date_type = 0;
static unsigned char g_time_type = 0;


typedef struct _SET_PRINT_DATA_
{
    unsigned char trigger_mode;//触发方式： 0：编码器；1：光电
    unsigned char nozzle;//喷头选择： 0：左喷；1：右喷
    unsigned char concentration;//浓度：1,2,3,4：走1步，打印3次
    unsigned char width;//宽度：1,2,3,4：走3步，打印1次
    unsigned char encoder;//编码器：0：开启；1：关闭
    unsigned char print_direction;//喷印方向：0：正向；1：逆向；2：正倒；3：逆倒
    unsigned char print_voltage;//打印电压：0:8V——20:12V
    unsigned char print_number;//连喷次数：1~9：连喷次数就是按一下之后滚动，如果连喷次数是1就喷一次，是3就喷三次，以此类推
    unsigned char print_interval;//连喷间隔：就是按下喷印按键 机器不是要滚动然后喷出吗 间隔数值越大 需要滚动越远,单位是1mm
    unsigned char trigger_delay;//触发延迟：100毫秒
    unsigned char print_speed;//喷印速度：1微妙
    unsigned char flash_set;//闪喷设置：1分钟
}SET_PRINT_DATA;


enum
{
    LANGUAGE_SIMPLIFIED_CHINESE = 0,//Language: Simplified Chinese
    LANGUAGE_ENGLISH = 1,//Language: Simplified Chinese

};

typedef struct _SET_SYSTEM_DATA_
{
    unsigned char buzzer;//蜂鸣器：0：开；1：关
    unsigned char brightness;//屏幕亮度：0~100；
    unsigned char USB_transfer;//USB传输:开关
    unsigned char language;//语言：0：中文；1：英文；2：繁体
    unsigned char screen_off;//息屏时间：0：1分钟；1:5分钟；2:30分钟；3：常亮
}SET_SYSTEM_DATA;


typedef struct _SET_DEVELOPER_DATA_
{
    unsigned char password[16];//密码
    unsigned char bandwidth;//打印脉宽：0:1.5us——10:2.5us
}SET_DEVELOPER_DATA;

typedef struct _SYSTEM_DATA_
{
    unsigned char init;
    unsigned int total_output;//总产量
    SET_PRINT_DATA print;
    SET_SYSTEM_DATA system;
    SET_DEVELOPER_DATA develop;
}SYSTEM_DATA;

static SYSTEM_DATA system_data;

#define MOUNT_POINT "/mnt/"

char usb_command[256];
char usb_device[32];
#define USB_PICTURE_NUMBER   100
char usb_picture[USB_PICTURE_NUMBER][128]={0};
static uint16_t g_row;
lv_obj_t* picture_img;

static int g_modification_id = 0;


lv_obj_t* set_developer_bg;
lv_obj_t* label_set_developer_head;
lv_obj_t* set_developer_middle_bg;
lv_obj_t* img_Rf_frequency;
lv_obj_t* label_Rf_frequency_text;
lv_obj_t* label_Rf_frequency_label;
lv_obj_t* img_surrogate_information;
lv_obj_t* label_surrogate_information_name;
lv_obj_t* label_surrogate_information_label;
lv_obj_t* img_print_pulse_width;
lv_obj_t* label_print_pulse_width;
lv_obj_t* dropdown_print_pulse_width;
lv_obj_t* img_yield_reset;
lv_obj_t* label_yield_reset;
lv_obj_t* btn_yield_reset;
lv_obj_t* label_btn_yield_reset;
lv_obj_t* label_prompt_message;


static lv_obj_t* Ink_cartridge_error_win;
static lv_obj_t* label_warning;
static lv_obj_t* Ink_cartridge_error_content;
static lv_obj_t* label_warning_content;
static lv_obj_t* button_ack;
static lv_obj_t* button_ack_label;
static lv_obj_t* button_return;
static lv_obj_t* button_return_label;

unsigned char g_file_num = 0;

static int set_linux_time_flag = 0;


typedef struct  _SUBSECTION_STRUCTURE_
{
    unsigned char total;
    unsigned char current;
    int x[BREAK_MAX_NUMBER];
}SUBSECTION_STRUCTURE;

SUBSECTION_STRUCTURE subsection_structure;


typedef struct {
    unsigned long total;     // 总内存 (KB)
    unsigned long free;      // 空闲内存 (KB)
    unsigned long available; // 可用内存 (KB)
    unsigned long buffers;   // 缓冲区内存 (KB)
    unsigned long cached;    // 缓存内存 (KB)
} MemoryInfo;

static unsigned char  g_icon_type = 0;

#define ICON_NUMBER 98
#define QR_BAR_MAX_HIGHT 200
#define QR_BAR_MIN_HIGHT 100

lv_img_dsc_t icon_buf[ICON_NUMBER] = { 0 };

int g_screen_off_count = 0;
unsigned char g_screen_off_status = 0;
uint32_t g_sd_serial;


#ifdef __GNUC__
#define STRUCT_PACKED __attribute__ ((packed))
#else
#define STRUCT_PACKED
#endif

#define uint8_t unsigned char

#define AES_MAXROUNDS 14
#define AES_BLOCKSIZE 16
#define AES_IV_SIZE   16
#define KEYSIZE       16
#define MSG_SIZE      KEYSIZE

typedef struct STRUCT_PACKED
{
    unsigned char year;
    unsigned char month;
    unsigned char day;
    unsigned char hour;
    unsigned char minute;
    unsigned char second;
}RTC_TIME;  


typedef struct STRUCT_PACKED
{
    unsigned char machine_model;
    unsigned int count;
    RTC_TIME rtc_time;
    unsigned char res[4];
    unsigned char crc;
}CARD_INFORMATION; 

typedef struct STRUCT_PACKED
{
    unsigned int device_id;
    RTC_TIME rtc_time;
    unsigned char res[5];
    unsigned char crc;
}DEVICE_INFORMATION; 

typedef struct STRUCT_PACKED
{
    unsigned char machine_model;
    unsigned char locked_state;
    unsigned int device_id;
    RTC_TIME rtc_time;
    unsigned char res[3];
    unsigned char crc;
}AUTHORIZATION_INFORMATION; 


/* CRC Table for 0x2F polynomial */
const unsigned char CRC_TABLE[256] = {
		0x00, 0x2F, 0x5E, 0x71, 0xBC, 0x93, 0xE2, 0xCD, 0x57, 0x78, 0x09, 0x26, 0xEB, 0xC4, 0xB5, 0x9A,
		0xAE, 0x81, 0xF0, 0xDF, 0x12, 0x3D, 0x4C, 0x63, 0xF9, 0xD6, 0xA7, 0x88, 0x45, 0x6A, 0x1B, 0x34,
		0x73, 0x5C, 0x2D, 0x02, 0xCF, 0xE0, 0x91, 0xBE, 0x24, 0x0B, 0x7A, 0x55, 0x98, 0xB7, 0xC6, 0xE9,
		0xDD, 0xF2, 0x83, 0xAC, 0x61, 0x4E, 0x3F, 0x10, 0x8A, 0xA5, 0xD4, 0xFB, 0x36, 0x19, 0x68, 0x47,
		0xE6, 0xC9, 0xB8, 0x97, 0x5A, 0x75, 0x04, 0x2B, 0xB1, 0x9E, 0xEF, 0xC0, 0x0D, 0x22, 0x53, 0x7C,
		0x48, 0x67, 0x16, 0x39, 0xF4, 0xDB, 0xAA, 0x85, 0x1F, 0x30, 0x41, 0x6E, 0xA3, 0x8C, 0xFD, 0xD2,
		0x95, 0xBA, 0xCB, 0xE4, 0x29, 0x06, 0x77, 0x58, 0xC2, 0xED, 0x9C, 0xB3, 0x7E, 0x51, 0x20, 0x0F,
		0x3B, 0x14, 0x65, 0x4A, 0x87, 0xA8, 0xD9, 0xF6, 0x6C, 0x43, 0x32, 0x1D, 0xD0, 0xFF, 0x8E, 0xA1,
		0xE3, 0xCC, 0xBD, 0x92, 0x5F, 0x70, 0x01, 0x2E, 0xB4, 0x9B, 0xEA, 0xC5, 0x08, 0x27, 0x56, 0x79,
		0x4D, 0x62, 0x13, 0x3C, 0xF1, 0xDE, 0xAF, 0x80, 0x1A, 0x35, 0x44, 0x6B, 0xA6, 0x89, 0xF8, 0xD7,
		0x90, 0xBF, 0xCE, 0xE1, 0x2C, 0x03, 0x72, 0x5D, 0xC7, 0xE8, 0x99, 0xB6, 0x7B, 0x54, 0x25, 0x0A,
		0x3E, 0x11, 0x60, 0x4F, 0x82, 0xAD, 0xDC, 0xF3, 0x69, 0x46, 0x37, 0x18, 0xD5, 0xFA, 0x8B, 0xA4,
		0x05, 0x2A, 0x5B, 0x74, 0xB9, 0x96, 0xE7, 0xC8, 0x52, 0x7D, 0x0C, 0x23, 0xEE, 0xC1, 0xB0, 0x9F,
		0xAB, 0x84, 0xF5, 0xDA, 0x17, 0x38, 0x49, 0x66, 0xFC, 0xD3, 0xA2, 0x8D, 0x40, 0x6F, 0x1E, 0x31,
		0x76, 0x59, 0x28, 0x07, 0xCA, 0xE5, 0x94, 0xBB, 0x21, 0x0E, 0x7F, 0x50, 0x9D, 0xB2, 0xC3, 0xEC,
		0xD8, 0xF7, 0x86, 0xA9, 0x64, 0x4B, 0x3A, 0x15, 0x8F, 0xA0, 0xD1, 0xFE, 0x33, 0x1C, 0x6D, 0x42
};

static const uint8_t key[KEYSIZE] =
{
    0xff, 0xde, 0x01, 0xad,
    0xff, 0xb0, 0x02, 0x0b,
    0xff, 0xde, 0x03, 0xad,
    0xff, 0xb0, 0x04, 0x0b
};

static const uint8_t iv[KEYSIZE] =
{
    0xff, 0xc0, 0x04, 0xfe,
    0xff, 0xc0, 0x03, 0x7d,
    0xff, 0xc0, 0x02, 0xfe,
    0xff, 0xc0, 0x01, 0x7d
};

// 字体样式标志位（可组合使用，如粗体+斜体）
typedef enum {
    FONT_STYLE_NORMAL = 0x00, // 默认
    FONT_STYLE_BOLD = 0x01, // 粗体
    FONT_STYLE_ITALIC = 0x02, // 斜体
    FONT_STYLE_BOLD_ITALIC = FONT_STYLE_BOLD | FONT_STYLE_ITALIC
} FontStyle;



typedef struct FontNode {
    FontType type;          // 字体类型（如Arial）
    uint16_t size;          // 字号（10-200）
    FontStyle style;        // 字形样式（粗体/斜体等）
    lv_font_t* font;        // LVGL字体对象
    uint32_t ref_count;     // 引用计数
    struct FontNode* next;  // 下一个节点
} FontNode;



static uint8_t out[MSG_SIZE] ;
static uint8_t msg[MSG_SIZE] ;
static AES_CTX context ;

unsigned char g_authorization_buf[16]={0};
unsigned char g_screen_touch_flag = 0;
unsigned int g_screen_touch_count = 0;

CARD_INFORMATION card_info_newest;

int read_card_info_result = 0;

unsigned int total_output_last;
unsigned char total_output_changeFlag = 0;

AUTHORIZATION_INFORMATION  g_authorization;

typedef struct _VALIDITY_DATE_ {
    unsigned char flag;          
    unsigned char year;         
    unsigned char month;        
    unsigned char day;        
} VALIDITY_DATE;

VALIDITY_DATE validity_date;
unsigned char flag_modification_or_addition = 0;

static void textarea_text_event_cb(lv_event_t* e);
static void drag_event_handler(lv_event_t* e);

void set_mp1484_en(unsigned char gpio_status);
void delay_100ns(unsigned int ns);
void initialize(void);
void set_mp1484_en(unsigned char gpio_status);
int get_max(int buf[],int len);
void print_event_cb(lv_event_t *e);
void slider_show_2(void);
int pwm_voltage(void);
void slider_show_typeface(void);
void get_system_data(void);
void set_system_data(void);
//void delete_bmp_files(const char *dir_path);
void delete_bmp_files(void);
int is_bmp_png_file(const char *filename);
void save_as_bmp_half_size_noalloc(const char* filename, const lv_img_dsc_t* img);
void formatNumberWithLeadingZeros(unsigned int a, unsigned int b, char *strA);
void remove_dat_suffix(const char *filename, char *output);
void bubbleSort(int arr[], int n);
void print_memory_info(const MemoryInfo *mem);
int get_memory_info(MemoryInfo *mem);
int get_sd_id(void);
void recovery_data(void);
void get_config_data(void);
void slider_show_icon(void);
void screen_touched_event_handler(lv_event_t * e);
void pwm_init(void);
int pwm_brightness(int vaule);
unsigned char stringToHex(char a);
unsigned char CRC8(unsigned char buf[],unsigned char len);
time_t datetime_to_seconds(int year, int month, int day, int hour, int minute, int second);
int compare_files(const void *a, const void *b);
void font_list_release(FontType type, uint16_t size, FontStyle style);
FontNode* font_list_find(FontType type, uint16_t size, FontStyle style);
lv_font_t* font_list_get(FontType type, uint16_t size, FontStyle style);
void font_list_gc(void);
static void btn_addition_count_updata(void);
void addition_text_updata(void);
void addition_QR_bar_updata(void);
int check_string_format(const char *str);
void check_hp45(void);
// 判断是否为闰年
bool isLeapYear(int year);
// 获取指定年月的天数
int daysInMonth(int year, int month) ;
// 计算有效期后的日期
void calculateExpiryDate(int startYear, int startMonth, int startDay,
                         int validYears, int validMonths, int validDays,
                         int *endYear, int *endMonth, int *endDay);



static FontNode* font_list_head = NULL;


// 方向定义
typedef enum {
    CROP_DIRECTION_NORMAL = 0,    // 正向：从左到右，从上到下
    CROP_DIRECTION_REVERSE_X = 1, // 逆向：从右到左，从上到下
    CROP_DIRECTION_REVERSE_Y = 2, // 正倒：从左到右，从下到上
    CROP_DIRECTION_REVERSE_XY = 3 // 逆倒：从右到左，从下到上
} CropDirection;

bool find_effective_x_range(const uint8_t* input_data, uint32_t input_width, uint32_t input_height,
    uint32_t x1, uint32_t x2,
    uint32_t* effective_start_x, uint32_t* effective_end_x);

    // 完全重写的正确截图函数
bool crop_x_range_correct(const uint8_t* input_data, uint32_t input_width, uint32_t input_height,
    uint32_t x1, uint32_t x2,
    uint8_t* output_buf, uint32_t output_buf_size,
    uint32_t* output_width, uint32_t* output_height,
    uint32_t* actual_start_x, uint32_t* actual_end_x,
    CropDirection direction);

static void button_left_stop_event_cb(lv_event_t* e);
static void button_right_stop_event_cb(lv_event_t* e);
static void file_change_event_cb(lv_event_t* e);
static void file_draw_event_cb(lv_event_t* e);
void tabview_event_cb(lv_event_t * e);


FontNode* font_list_find(FontType type, uint16_t size, FontStyle style)
{
    FontNode* current = font_list_head;
    while (current != NULL)
    {
        if (current->type == type && current->size == size && current->style == style)
        {
            return current;
        }
        current = current->next;
    }
    return NULL;
}


lv_font_t* font_list_get(FontType type, uint16_t size, FontStyle style)
{
    char tempBuf[128] = { 0 };

    // 参数检查
    if (size < 10 || size > 200 || type > FONT_TYPE_MAX)
    {
        LV_LOG_ERROR("Invalid font params: type=%d, size=%d", type, size);
        return NULL;
    }

    // 查询缓存
    FontNode* node = font_list_find(type, size, style);
    if (node != NULL)
    {
        node->ref_count++;
        return node->font;
    }

    // 新建节点
    FontNode* new_node = lv_mem_alloc(sizeof(FontNode));
    new_node->type = type;
    new_node->size = size;
    new_node->style = style;
    new_node->ref_count = 1;
    new_node->next = NULL;

    //sprintf(tempBuf, "./lvgl/src/extra/libs/freetype/%s", typeface_buf[type]);
    sprintf(tempBuf, "/media/%s", typeface_buf[type]);

    printf("%s\n\r", tempBuf);

    lv_ft_info_t ft_info = {
        .name = tempBuf,
        .weight = size,
        .style = style,
        .font = NULL
    };

    if (!lv_ft_font_init(&ft_info))
    {
        lv_mem_free(new_node);
        LV_LOG_ERROR("Failed to init font: %s (size:%d, style:%d)", tempBuf, size, style);
        return NULL;
    }

    new_node->font = ft_info.font;

    // 添加到链表尾部
    if (font_list_head == NULL)
    {
        font_list_head = new_node;
    }
    else
    {
        FontNode* tail = font_list_head;
        while (tail->next != NULL) tail = tail->next;
        tail->next = new_node;
    }

    return new_node->font;
}


void font_list_gc(void)
{
    FontNode** ptr = &font_list_head;
    while (*ptr != NULL)
    {
        if ((*ptr)->ref_count == 0) {
            FontNode* to_free = *ptr;
            lv_ft_font_destroy(to_free->font); // LVGL 8.3 官方释放方法
            *ptr = to_free->next;
            lv_mem_free(to_free);
        }
        else {
            ptr = &(*ptr)->next;
        }
    }
}

void font_list_release(FontType type, uint16_t size, FontStyle style)
{
    FontNode* node = font_list_find(type, size, style);
    if (node && node->ref_count > 0)
    {
        node->ref_count--;
    }

    font_list_gc();
}


time_t datetime_to_seconds(int year, int month, int day, int hour, int minute, int second) 
{
    struct tm time_struct = {0};
    
    // 填充tm结构体
    time_struct.tm_year = year - 1900;  // 年份从1900开始计算
    time_struct.tm_mon = month - 1;     // 月份是0-11
    time_struct.tm_mday = day;
    time_struct.tm_hour = hour;
    time_struct.tm_min = minute;
    time_struct.tm_sec = second;
    time_struct.tm_isdst = -1;          // 让系统决定是否使用夏令时
    
    // 转换为time_t类型（自1970年以来的秒数）
    time_t seconds = mktime(&time_struct);
    
    return seconds;
}


unsigned char CRC8(unsigned char buf[],unsigned char len)
{
	 unsigned char wCRCin = 0xFF;
	 unsigned char i;

	 for (i = 0; i < len-1; i++)
	 {
    	 wCRCin = CRC_TABLE[wCRCin ^ buf[i]];
     }
     return (wCRCin) ;
}

unsigned char stringToHex(char a)
{
	if((a >= '0')&&(a <= '9'))
	{
		return a - '0';
	}
	else if((a >= 'A')&&(a <= 'F'))
	{
		return a - 'A' + 10;
	}
	else if((a >= 'a')&&(a <= 'f'))
	{
		return a - 'a' + 10;
	}
    return 0;
}




int pwm_voltage(void)
{
    int ret ;
    int period;
    char strDutycycle[10];
    int pwm = 0;
    int dutycycle;

    ret = write(fd_period_0, PERIOD,strlen(PERIOD));
    if(ret < 0)
    {
        printf("change period error\n");
        return -1;
    }
    else
    {
        printf("change period ok\n");
    }

    switch(system_data.print.print_voltage)
    {
        case 0:
        default:
            dutycycle = 39;//8.0
            break;
        case 1:
            dutycycle = 42;//8.2
            break;
        case 2:
            dutycycle = 46;//8.4
            break;
        case 3:
            dutycycle = 49;//8.6
            break;
        case 4:
            dutycycle = 52;//8.8
            break;
        case 5:
            dutycycle = 55;//9.0
            break;
        case 6:
            dutycycle = 59;//9.2
            break;
        case 7:
            dutycycle = 62;//9.4
            break;
        case 8:
            dutycycle = 65;//9.6
            break;
        case 9:
            dutycycle = 69;//9.8
            break;
        case 10:
            dutycycle = 72;//10
            break;
        case 11:
            dutycycle = 75;//10.2
            break;
        case 12:
            dutycycle = 78;//10.4
            break;
        case 13:
            dutycycle = 82;//10.6
            break;
        case 14:
            dutycycle = 85;//10.8
            break;
        case 15:
            dutycycle = 88;//11
            break;
        case 16:
            dutycycle = 92;//11.2
            break;
        case 17:
            dutycycle = 95;//11.4
            break;
        case 18:
            dutycycle = 98;//11.6
            break;
        case 19:
            dutycycle = 99;//11.7
            break;
        case 20:
            dutycycle = 100;//11.8
            break;
    }
    
    period = atoi(PERIOD);
    dutycycle = period * dutycycle / 100;
    sprintf(strDutycycle,"%d",dutycycle);

    ret = write(fd_duty_0, strDutycycle, strlen(strDutycycle));
    if(ret < 0)
    {
        printf("change duty_cycle error\n");
        return -1;
    }
    else
    {
    printf("change duty_cycle ok\n");
    }

    ret = write(fd_enable_0, "1", strlen("1"));
    if(ret < 0)
    {
        printf("enable pwm%d error\n",pwm);
        return -1;
    }
    else
    {
        printf("enable pwm%d ok\n",pwm);
    }

    return 0;
}


int pwm_brightness(int vaule)
{
    int ret ;
    int period;
    char strDutycycle[10];
    int pwm = 1;
    int dutycycle;

    ret = write(fd_period_1, PERIOD,strlen(PERIOD));
    if(ret < 0)
    {
        printf("change period error\n");
        return -1;
    }
    else
    {
        printf("change period ok\n");
    }
    dutycycle = vaule;
    
    period = atoi(PERIOD);
    dutycycle = period * dutycycle / 100;
    sprintf(strDutycycle,"%d",dutycycle);

    ret = write(fd_duty_1, strDutycycle, strlen(strDutycycle));
    if(ret < 0)
    {
        printf("change duty_cycle error\n");
        return -1;
    }
    else
    {
    printf("change duty_cycle ok\n");
    }

    ret = write(fd_enable_1, "1", strlen("1"));
    if(ret < 0)
    {
        printf("enable pwm%d error\n",pwm);
        return -1;
    }
    else
    {
        printf("enable pwm%d ok\n",pwm);
    }

    return 0;
}

void pwm_init(void)
{
    int ret ;

    fd_pwm = open("/sys/class/pwm/pwmchip0/export", O_WRONLY);
    if(fd_pwm < 0)
    {
        printf("open export error\n");
    }
	  
    ret = write(fd_pwm, "0", strlen("0"));
    if(ret < 0)
    {
        printf("creat pwm0 error\n");
    }
    else
    {
        printf("export pwm0 ok\n");
    }

    fd_period_0 = open("/sys/class/pwm/pwmchip0/pwm0/period", O_RDWR);
    fd_duty_0 = open("/sys/class/pwm/pwmchip0/pwm0/duty_cycle", O_RDWR);
    fd_enable_0 = open("/sys/class/pwm/pwmchip0/pwm0/enable", O_RDWR);

    if((fd_period_0 < 0)||(fd_duty_0 < 0)||(fd_enable_0 < 0))
    {
        printf("open error\n");
    }

    ret = write(fd_pwm, "1", strlen("1"));
    if(ret < 0)
    {
        printf("creat pwm1 error\n");
    }
    else
    {
        printf("export pwm1 ok\n");
    }
    
    fd_period_1 = open("/sys/class/pwm/pwmchip0/pwm1/period", O_RDWR);
    fd_duty_1 = open("/sys/class/pwm/pwmchip0/pwm1/duty_cycle", O_RDWR);
    fd_enable_1 = open("/sys/class/pwm/pwmchip0/pwm1/enable", O_RDWR);

    if((fd_period_1 < 0)||(fd_duty_1 < 0)||(fd_enable_1 < 0))
    {
        printf("open error\n");
    }
}
#if 0
void set_mp1484_en(unsigned char gpio_status)
{
    unsigned char databuf[2];
    int retvalue;

    databuf[0] = gpio_status;
    retvalue = write(fd_mp1484_en, databuf, 1);      
    if(retvalue < 0)
    {
        printf("set_mp1484_en Control Failed!\r\n");
        close(fd_mp1484_en);
    }    
}
#endif

void delay_100ns(unsigned int ns)
{
    unsigned int i;
    for(i=0;i<ns;i++);
}

#if 1
void initialize(void)
{

    fd_ph45 = open("/dev/hp45",O_RDWR | O_SYNC);
	if (fd_ph45 < 0)
	{
		printf("can not open file hp45\n");
	}
    else
    {
        printf("initialize hp45 ok\n");
    }

    fd_gpio_in = open("/dev/key_print", O_RDWR);
	if (fd_gpio_in < 0)
	{
		printf("can not open file gpio_in\n");
	}
    else
    {
        printf("open file gpio_in ok\n");
    }
 
    // 这里可以执行你的代码，进程将不会被抢占
    strcpy(usb_device, "/dev/mmcblk0p3");
    snprintf(usb_command, sizeof(usb_command), "mount -o iocharset=utf8 %s %s", usb_device, MOUNT_POINT);

    if (system(usb_command) == 0) 
    {
        printf("U盘第三个分区已成功挂载到 %s\n", MOUNT_POINT);
    } 
    else 
    {
        printf("挂载失败，请检查设备名称或挂载点\n");
    }
}
#endif

// 从 /proc/meminfo 中提取内存信息
int get_memory_info(MemoryInfo *mem) {
    FILE *fp;
    char line[256];
    char temp_key[32];
    unsigned long value;
    int found = 0;

    fp = fopen("/proc/meminfo", "r");
    if (fp == NULL) {
        perror("Failed to open /proc/meminfo");
        return -1;
    }

    // 初始化结构体
    memset(mem, 0, sizeof(MemoryInfo));

    while (fgets(line, sizeof(line), fp)) {
        if (sscanf(line, "%s %lu kB", temp_key, &value) != 2) {
            continue; // 跳过格式不匹配的行
        }

        // 匹配关键字段
        if (strcmp(temp_key, "MemTotal:") == 0) {
            mem->total = value;
            found++;
        } else if (strcmp(temp_key, "MemFree:") == 0) {
            mem->free = value;
            found++;
        } else if (strcmp(temp_key, "MemAvailable:") == 0) {
            mem->available = value;
            found++;
        } else if (strcmp(temp_key, "Buffers:") == 0) {
            mem->buffers = value;
            found++;
        } else if (strcmp(temp_key, "Cached:") == 0) {
            mem->cached = value;
            found++;
        }

        // 如果所有字段都已找到，提前退出
        if (found >= 5) break;
    }

    fclose(fp);
    return 0;
}

// 示例：打印内存信息
void print_memory_info(const MemoryInfo *mem) {

    printf("Memory Info (KB):\n");
    printf("  Total:     %lu\n", mem->total);
    printf("  Free:      %lu\n", mem->free);
    printf("  Available: %lu\n", mem->available);
    printf("  Buffers:   %lu\n", mem->buffers);
    printf("  Cached:    %lu\n", mem->cached);

    // 转换为 MB/GB 更友好显示（可选）
    printf("\nHuman-readable:\n");
    printf("  Total:     %.2f GB\n", mem->total / 1024.0 / 1024.0);
    printf("  Available: %.2f GB\n", mem->available / 1024.0 / 1024.0);
}



void bubbleSort(int arr[], int n) {
    int i, j, temp;
    for (i = 0; i < n-1; i++) {
        // 每次遍历将最大的元素移动到最后
        for (j = 0; j < n-i-1; j++) {
            if (arr[j] > arr[j+1]) {
                // 交换相邻元素
                temp = arr[j];
                arr[j] = arr[j+1];
                arr[j+1] = temp;
            }
        }
    }
}


void screen_touched_event_handler(lv_event_t * e)
{
    lv_event_code_t code = lv_event_get_code(e);
    //lv_obj_t * obj = lv_event_get_target(e);
    
    if(code == LV_EVENT_CLICKED) 
    {
        printf("lv_scr_act LV_EVENT_CLICKED\n");
        if(g_screen_off_status == 1)
        {
            g_screen_off_status = 0;

            lv_obj_del(screen_off_obj);

            g_screen_off_count = 0;

            pwm_brightness((int)(100-system_data.system.brightness)*4/5);
        }
        else
        {
            g_screen_off_count = 0;
        }
    }
}


// 获取指定位置的像素值（0表示有效数据）
static bool get_pixel(const uint8_t* data, uint32_t width, uint32_t x, uint32_t y) {
    uint32_t bytes_per_line = (width + 7) / 8;
    uint32_t byte_index = y * bytes_per_line + (x / 8);
    uint32_t bit_index = 7 - (x % 8);
    return (data[byte_index] >> bit_index) & 0x01;
}


// 设置指定位置的像素值
static void set_pixel(uint8_t* data, uint32_t width, uint32_t x, uint32_t y, bool value) {
    uint32_t bytes_per_line = (width + 7) / 8;
    uint32_t byte_index = y * bytes_per_line + (x / 8);
    uint32_t bit_index = 7 - (x % 8);

    if (value) {
        data[byte_index] |= (1 << bit_index);
    }
    else {
        data[byte_index] &= ~(1 << bit_index);
    }
}

// 在指定X范围内检测有效数据的实际边界（修正版）
bool find_effective_x_range(const uint8_t* input_data, uint32_t input_width, uint32_t input_height,
    uint32_t x1, uint32_t x2,
    uint32_t* effective_start_x, uint32_t* effective_end_x) {
    if (input_data == NULL || x1 > x2 || x2 >= input_width ||
        effective_start_x == NULL || effective_end_x == NULL) {
        return false;
    }

    // 初始化边界值为无效值
    uint32_t min_x = UINT32_MAX;
    uint32_t max_x = 0;
    bool found_effective_pixel = false;

    printf("Scanning for effective data in X range %d-%d...\n", x1, x2);

    // 逐行扫描指定X范围
    for (uint32_t y = 0; y < input_height; y++) {
        bool found_in_this_row = false;
        uint32_t row_min_x = UINT32_MAX;
        uint32_t row_max_x = 0;

        // 从左到右扫描该行
        for (uint32_t x = x1; x <= x2; x++) {
            if (!get_pixel(input_data, input_width, x, y)) {
                found_effective_pixel = true;
                found_in_this_row = true;
                if (x < row_min_x) row_min_x = x;
                if (x > row_max_x) row_max_x = x;
            }
        }

        // 更新全局边界
        if (found_in_this_row) {
            if (row_min_x < min_x) min_x = row_min_x;
            if (row_max_x > max_x) max_x = row_max_x;

            // 调试信息
            printf("Row %d: found data at X=%d-%d\n", y, row_min_x, row_max_x);
        }
    }

    if (!found_effective_pixel) {
        printf("No effective data found in range %d-%d\n", x1, x2);
        return false;
    }

    // 确保边界值有效
    if (min_x == UINT32_MAX || max_x == 0 || min_x > max_x) {
        printf("Invalid boundary values: min_x=%u, max_x=%u\n", min_x, max_x);
        return false;
    }

    *effective_start_x = min_x;
    *effective_end_x = max_x;

    printf("Final effective range: X=%d-%d, width=%d\n",
        min_x, max_x, max_x - min_x + 1);

    return true;
}

// 完全重写的正确截图函数
bool crop_x_range_correct(const uint8_t* input_data, uint32_t input_width, uint32_t input_height,
    uint32_t x1, uint32_t x2,
    uint8_t* output_buf, uint32_t output_buf_size,
    uint32_t* output_width, uint32_t* output_height,
    uint32_t* actual_start_x, uint32_t* actual_end_x,
    CropDirection direction) {
    if (input_data == NULL || output_buf == NULL ||
        output_width == NULL || output_height == NULL ||
        actual_start_x == NULL || actual_end_x == NULL ||
        input_width == 0 || input_height == 0 ||
        x1 >= input_width || x2 > input_width || x1 >= x2) {
        return false;
    }

    // 1. 在x1-x2范围内检测有效数据的实际边界
    uint32_t effective_start_x, effective_end_x;
    if (!find_effective_x_range(input_data, input_width, input_height, x1, x2,
        &effective_start_x, &effective_end_x)) {
        printf("No effective data found in range %d-%d\n", x1, x2);
        return false;
    }

    printf("Effective data: X=%d-%d, Requested range: X=%d-%d\n",
        effective_start_x, effective_end_x, x1, x2);

    // 2. 输出buffer的宽度应该是请求的范围宽度，不是有效数据的宽度！
    //uint32_t cropped_width = x2 - x1 + 1;  // 这是关键修正！
    uint32_t cropped_width = effective_end_x - effective_start_x + 1;  // 这是关键修正！
    uint32_t cropped_height = input_height;

    // 3. 检查输出buffer是否足够大
    uint32_t dst_bytes_per_line = (cropped_width + 7) / 8;
    uint32_t required_size = dst_bytes_per_line * cropped_height;

    if (output_buf_size < required_size) {
        printf("Output buffer too small: need %d, have %d\n", required_size, output_buf_size);
        return false;
    }

    // 4. 清空输出buffer（全部设为1，表示无效数据）
    memset(output_buf, 0xFF, output_buf_size);  // 全部设为1

    //uint32_t src_bytes_per_line = (input_width + 7) / 8;
    //uint32_t dst_bytes_per_line_out = (cropped_width + 7) / 8;

    // 5. 根据方向进行数据复制
    switch (direction) {
    case CROP_DIRECTION_NORMAL: {
        uint32_t error_x = effective_start_x - effective_start_x/8*8;
        // 正向：从左到右，从上到下
        // 使用逐像素复制确保正确对齐
        for (uint32_t y = 0; y < cropped_height; y++) {
            for (uint32_t x = 0; x < cropped_width + error_x; x++) {
                //uint32_t orig_x = x1 + x;
                uint32_t orig_x = effective_start_x + x;
                bool pixel_value;

                if (orig_x >= effective_start_x && orig_x <= effective_end_x) {
                    // 有效数据区域
                    pixel_value = get_pixel(input_data, input_width, orig_x, y);
                }
                else {
                    // 无效数据区域：设为1
                    pixel_value = true;
                }

                set_pixel(output_buf, cropped_width, x, y, pixel_value);
            }
        }
        break;
    }

    case CROP_DIRECTION_REVERSE_X: {
        // 逆向：从右到左，从上到下
        uint32_t error_x = effective_start_x - effective_start_x/8*8;
        for (uint32_t y = 0; y < cropped_height; y++) {
            for (uint32_t x = 0; x < cropped_width+error_x; x++) {
                // 计算在原始图像中的位置
                //uint32_t orig_x = x1 + x;
                uint32_t orig_x = effective_start_x + x;
                bool pixel_value;

                if (orig_x >= effective_start_x && orig_x <= effective_end_x) {
                    // 有效数据区域：逆向取图
                    uint32_t reverse_x = effective_start_x + (effective_end_x - orig_x);
                    pixel_value = get_pixel(input_data, input_width, reverse_x, y);
                }
                else {
                    // 无效数据区域：设为1
                    pixel_value = true;
                }

                set_pixel(output_buf, cropped_width, x, y, pixel_value);
            }
        }
        break;
    }

    case CROP_DIRECTION_REVERSE_Y: {
        // 正倒：从左到右，从下到上
        uint32_t error_x = effective_start_x - effective_start_x/8*8;
        for (uint32_t y = 0; y < cropped_height; y++) {
            uint32_t src_y = cropped_height - 1 - y;
            for (uint32_t x = 0; x < cropped_width+error_x; x++) {
                //uint32_t orig_x = x1 + x;
                uint32_t orig_x = effective_start_x + x;
                bool pixel_value;

                if (orig_x >= effective_start_x && orig_x <= effective_end_x) {
                    pixel_value = get_pixel(input_data, input_width, orig_x, src_y);
                }
                else {
                    pixel_value = true;
                }

                set_pixel(output_buf, cropped_width, x, y, pixel_value);
            }
        }
        break;
    }

    case CROP_DIRECTION_REVERSE_XY: {
        // 逆倒：从右到左，从下到上
        uint32_t error_x = effective_start_x - effective_start_x/8*8;
        for (uint32_t y = 0; y < cropped_height; y++) {
            uint32_t src_y = cropped_height - 1 - y;
            for (uint32_t x = 0; x < cropped_width+error_x; x++) {
                //uint32_t orig_x = x1 + x;
                uint32_t orig_x = effective_start_x + x;
                bool pixel_value;

                if (orig_x >= effective_start_x && orig_x <= effective_end_x) {
                    // 有效数据区域：逆向取图
                    uint32_t reverse_x = effective_start_x + (effective_end_x - orig_x);
                    pixel_value = get_pixel(input_data, input_width, reverse_x, src_y);
                }
                else {
                    // 无效数据区域：设为1
                    pixel_value = true;
                }

                set_pixel(output_buf, cropped_width, x, y, pixel_value);
            }
        }
        break;
    }
    }

    // 6. 返回结果
    *output_width = cropped_width;
    *output_height = cropped_height;
    *actual_start_x = effective_start_x;
    *actual_end_x = effective_end_x;

    return true;
}


static void timer_100ms_cb(lv_timer_t * t)
{
    int retvalue;
    char buf[2]={0};
    unsigned char databuf[20] = {0};
    char datastr[20] = {0};
    static int time_count_1s = 0;
    static int adc_count_5s = 0;
    static int flash_set_count = 0;
    static int rept_count = 0;
    static int rc522_count = 0;
    //static unsigned power_on = 0;
    int voltage = 0;
    char cmd[64]={0};
    unsigned char* pdata = NULL;
   // unsigned char* pdata2 = NULL;
   // unsigned char data = 0;
    int i;
    //int j;
    //unsigned int x1, y1, x2, y2,flag;
    unsigned char break_num = 0;
    unsigned char win_content_child_num;
    char date_time_str[64]={0};
    pid_t status;
    //unsigned char *temp_p = NULL;
    int now_year;
    int now_month;
    int now_day;
    int end_year;
    int end_month;
    int end_day;
  //  uint32_t bytes_per_line = 0;
  // uint32_t byte_index = 0;
  //  uint32_t bit_index = 0;
 //  uint8_t pixel = 0;
    uint32_t start_x, end_x;
    bool success;

    time_count_1s++;
    if(time_count_1s >= 10)
    {
        time_count_1s = 0;

        if(read_writer_rtc_enable == 1)
        {
            memset(databuf,0,sizeof(databuf));
            databuf[0] = 0x02;
            
            retvalue = read(fd_bm8563, databuf, 6);
            if(retvalue < 0)
            {
                printf("fd_bm8563 Failed!\r\n");
                //close(fd_bm8563);
            }
            else 
            {       
                //printf("%u %u %u %u %u %u\n\r",databuf[0],databuf[1],databuf[2],databuf[3],databuf[4],databuf[5]);
                sprintf(g_time_data_string,"%04u/%02u/%02u",2000+databuf[0],databuf[1],databuf[2]);
                sprintf(g_time_time_string,"%02u:%02u:%02u",databuf[3],databuf[4],databuf[5]);
                memcpy(g_system_time,databuf,6);
                //printf("%u %u %u %u %u %u\n\r",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]); 
                lv_label_set_text(Date_label, g_time_data_string);
                lv_label_set_text(Time_label, g_time_time_string);

                if(set_system_time_flag == 1)
                {
                    sprintf(g_time_data_string,"%04u-%02u-%02u",2000+databuf[0],databuf[1],databuf[2]);
                    lv_label_set_text(label_btn_system_date, g_time_data_string);
                    sprintf(g_time_time_string,"%02u:%02u:%02u",databuf[3],databuf[4],databuf[5]);
                    lv_label_set_text(label_btn_system_time, g_time_time_string);            
                }

                if(set_linux_time_flag == 0)
                {
                    set_linux_time_flag = 1;
                    printf("%u %u %u %u %u %u\n\r",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                    //设置系统时间
                    snprintf(cmd, sizeof(cmd), "date -s '%04d-%02d-%02d %02d:%02d:%02d'", 2000+g_system_time[0],g_system_time[1],g_system_time[2], g_system_time[3],g_system_time[4],g_system_time[5]);
                    system(cmd);               
                }
#if 0
                if(power_on == 0)
                {
                    power_on = 1;
                    recovery_data();
                }
#endif
            }
        }
    }

    if(g_screen_touch_flag == 1)
    {
        g_screen_touch_count++;
        if(g_screen_touch_count > 30)
        {
            printf("screen_off_obj\n");

            status = system("ts_calibrate");
            if (-1 == status)
            {
                printf("ts_calibrate error\n");
            }

            lv_obj_del(screen_off_obj);    
            g_screen_touch_flag = 0;
            g_screen_touch_count = 0;

            if(system_data.system.buzzer == 0)
            {
                buf[0] = 1;
                retvalue = write(fd_buzzer, buf, 1);
                if(retvalue < 0)
                {
                    printf("BEEP Control Failed!\r\n");
                    close(fd_buzzer);
                }
                usleep(300000);

                buf[0] = 0;
                retvalue = write(fd_buzzer, buf, 1);
                if(retvalue < 0)
                {
                    printf("BEEP Control Failed!\r\n");
                    close(fd_buzzer);
                }
            }
        }
    }
#if 0
    g_data_structure_count++;
    if(g_data_structure_count > 800)
    {
        g_data_structure_count = 0;

        font_list_gc();
        for(i=0;i<NEW_TEXT_MAX_NUMBER;i++)
        {
            if(data_structure[i].type != 0)
            {
                if((data_structure[i].type == data_structure_last[i].type)&&(data_structure[i].x == data_structure_last[i].x)&&(data_structure[i].y == data_structure_last[i].y))
                {
                    
                }
                else
                {
                    data_structure_last[i].type = data_structure[i].type;
                    data_structure_last[i].x = data_structure[i].x;
                    data_structure_last[i].y = data_structure[i].y;

                    if(data_structure[i].type == TYPE_DATE)
                    {
                        if(data_structure[i].data.date_time.date_or_time == 0)
                        {
                            switch(data_structure[i].data.date_time.date_or_time_type)
                            {
                                case 0:
                                    sprintf(date_time_str, "%04d/%02d/%02d", 2000 + g_system_time[0], g_system_time[1], g_system_time[2]);
                                    break;
                                case 1:
                                    sprintf(date_time_str, "%02d/%02d/%02d", g_system_time[0], g_system_time[1], g_system_time[2]);
                                    break;
                                case 2:
                                    sprintf(date_time_str, "%04d-%02d-%02d", 2000 + g_system_time[0], g_system_time[1], g_system_time[2]);
                                    break;
                                case 3:
                                    sprintf(date_time_str, "%02d-%02d-%02d", g_system_time[0], g_system_time[1], g_system_time[2]);
                                    break;
                                case 4:
                                    sprintf(date_time_str, "%04d.%02d.%02d", 2000 + g_system_time[0], g_system_time[1], g_system_time[2]);
                                    break;
                                case 5:
                                    sprintf(date_time_str, "%02d.%02d.%02d", g_system_time[0], g_system_time[1], g_system_time[2]);
                                    break;
                                case 6:
                                    sprintf(date_time_str, "%02d/%02d/%04d", g_system_time[2],  g_system_time[1], 2000 + g_system_time[0]);
                                    break;
                                case 7:
                                    sprintf(date_time_str, "%02d/%02d/%02d", g_system_time[2],  g_system_time[1], g_system_time[0]);
                                    break;
                                case 8:
                                    sprintf(date_time_str, "%02d-%02d-%04d", g_system_time[2],  g_system_time[1], 2000 + g_system_time[0]);
                                    break;
                                case 9:
                                    sprintf(date_time_str, "%02d-%02d-%02d", g_system_time[2],  g_system_time[1], g_system_time[0]);
                                    break;
                                case 10:
                                    sprintf(date_time_str, "%02d.%02d.%04d", g_system_time[2],  g_system_time[1], 2000 + g_system_time[0]);
                                    break;
                                case 11:
                                    sprintf(date_time_str, "%02d.%02d.%02d", g_system_time[2],  g_system_time[1], g_system_time[0]);
                                    break;
                                case 12:
                                    sprintf(date_time_str, "%04d年%02d月%02d日", 2000 + g_system_time[0], g_system_time[1], g_system_time[2]);
                                    break;
                                case 13:
                                    sprintf(date_time_str, "%02d年%02d月%02d日", g_system_time[0], g_system_time[1], g_system_time[2]);
                                    break;
                                case 14:
                                    sprintf(date_time_str, "%s",data_structure[i].data.date_time.text);
                                    break;
                                case 15:
                                    sprintf(date_time_str, "延期");
                                    break;
                            }
                        }
                        else if(data_structure[i].data.date_time.date_or_time == 2)
                        {
                            now_year =  2000 + g_system_time[0];
                            now_month =  g_system_time[1];
                            now_day =  g_system_time[2];
                            calculateExpiryDate(now_year,now_month,now_day,data_structure[i].data.date_time.year,data_structure[i].data.date_time.month,data_structure[i].data.date_time.day,&end_year,&end_month,&end_day);
  
                            switch(data_structure[i].data.date_time.date_or_time_type)
                            {
                                case 0:
                                    sprintf(date_time_str, "%04d/%02d/%02d", end_year, end_month, end_day);
                                    break;
                                case 1:
                                    sprintf(date_time_str, "%02d/%02d/%02d", end_year%100, end_month, end_day);
                                    break;
                                case 2:
                                    sprintf(date_time_str, "%04d-%02d-%02d", end_year, end_month, end_day);
                                    break;
                                case 3:
                                    sprintf(date_time_str, "%02d-%02d-%02d", end_year%100, end_month, end_day);
                                    break;
                                case 4:
                                    sprintf(date_time_str, "%04d.%02d.%02d", end_year, end_month, end_day);
                                    break;
                                case 5:
                                    sprintf(date_time_str, "%02d.%02d.%02d", end_year%100, end_month, end_day);
                                    break;
                                case 6:
                                    sprintf(date_time_str, "%02d/%02d/%04d", end_day,  end_month, end_year);
                                    break;
                                case 7:
                                    sprintf(date_time_str, "%02d/%02d/%02d", end_day,  end_month, end_year%100);
                                    break;
                                case 8:
                                    sprintf(date_time_str, "%02d-%02d-%04d", end_day,  end_month, end_year);
                                    break;
                                case 9:
                                    sprintf(date_time_str, "%02d-%02d-%02d", end_day,  end_month, end_year%100);
                                    break;
                                case 10:
                                    sprintf(date_time_str, "%02d.%02d.%04d", end_day,  end_month, end_year);
                                    break;
                                case 11:
                                    sprintf(date_time_str, "%02d.%02d.%02d", end_day,  end_month, end_year%100);
                                    break;
                                case 12:
                                    sprintf(date_time_str, "%04d年%02d月%02d日", end_year, end_month, end_day);
                                    break;
                                case 13:
                                    sprintf(date_time_str, "%02d年%02d月%02d日", end_year%100, end_month, end_day);
                                    break;
                                case 14:
                                    sprintf(date_time_str, "%s",data_structure[i].data.date_time.text);
                                    break;
                                case 15:
                                    sprintf(date_time_str, "延期");
                                    break;
                            }
                        }
                        else
                        {
                            switch(data_structure[i].data.date_time.date_or_time_type)
                            {
                                case 0:
                                    sprintf(date_time_str, "%02d:%02d:%02d", g_system_time[3], g_system_time[4], g_system_time[5]);
                                    break;
                                case 1:
                                    sprintf(date_time_str, "%02d:%02d", g_system_time[3], g_system_time[4]);
                                    break;
                                case 2:
                                    if (g_system_time[3] > 12)
                                    {
                                        sprintf(date_time_str, "%02d:%02d:%02d PM", g_system_time[3] - 12, g_system_time[4], g_system_time[5]);
                                    }
                                    else
                                    {
                                        sprintf(date_time_str, "%02d:%02d:%02d AM", g_system_time[3], g_system_time[4], g_system_time[5]);
                                    }
                                    break;
                                case 3:
                                    if (g_system_time[3] > 12)
                                    {
                                        sprintf(date_time_str, "%02d:%02d PM", g_system_time[3] - 12, g_system_time[4]);
                                    }
                                    else
                                    {
                                        sprintf(date_time_str, "%02d:%02d AM", g_system_time[3], g_system_time[4]);
                                    }
                                    break;
                                case 4:
                                    sprintf(date_time_str, "%02d时%02d分%02d秒", g_system_time[3], g_system_time[4], g_system_time[5]);
                                    break;
                                case 5:
                                    sprintf(date_time_str, "%s",data_structure[i].data.date_time.text);
                                    break;
                                case 6:
                                    sprintf(date_time_str, "延期");
                                    break;
                            }              
                        }

                        sprintf(data_structure[i].data.date_time.text,"%s",date_time_str);
                    }

                    printf("save data data_structure_last[%d].type=%d\n",i,data_structure_last[i].type);

                    if (remove("/media/system_file/data_structure.dat") == 0) 
                    {
                        printf("文件 /media/system_file/data_structure.dat 删除成功\n\r");
                    } 
                    else
                    {
                        perror("删除文件 /media/system_file/data_structure.dat 失败");
                    }
  
                    FILE* file = fopen("/media/system_file/data_structure.dat", "wb");
                    if (file == NULL) 
                    {
                        perror("Failed to open file");
                        //return EXIT_FAILURE;
                    }

                    // 将结构体写入文件
                    size_t written = fwrite(&data_structure, sizeof(data_structure), 1, file);
                    if (written != 1) {
                        perror("Failed to write data to file");
                        fclose(file);
                        //return EXIT_FAILURE;
                    }
                    // 关闭文件
                    fclose(file);

                    break;
                }
            }
            else
            {
                break;
            }
        }
    }
#endif

    adc_count_5s++;
    if(adc_count_5s >= 5000)
    {
        adc_count_5s = 0;
    }
#if 1
    if((adc_count_5s %300) == 0)
    {
        MemoryInfo mem;
        if (get_memory_info(&mem) == 0) 
        {
            print_memory_info(&mem);
        } 
        else 
        {
            printf("Failed to get memory info.\n");
        }
    }
#endif

    if(adc_count_5s == 5)
    {
        memset(databuf,0,sizeof(databuf));
        retvalue = read(fd_adc, databuf, sizeof(databuf));
		if(retvalue < 0)
		{
			printf("BEEP Control Failed!\r\n");
			close(fd_adc);
		}
		else
		{
			memcpy((unsigned char *)&voltage,databuf,4);
			//printf("voltage=%u\n",voltage);

            if(voltage == 63)
            {
                lv_label_set_text(Battery_label, "100%");
                lv_label_set_text(Battery_image, LV_SYMBOL_BATTERY_FULL);
                lv_obj_align(Battery_label, LV_ALIGN_TOP_LEFT, 395, 5);
            }
            else if(voltage == 62)
            {
                lv_label_set_text(Battery_label, "90%");
                lv_label_set_text(Battery_image, LV_SYMBOL_BATTERY_FULL);      
                lv_obj_align(Battery_label, LV_ALIGN_TOP_LEFT, 405, 5);         
            }
            else if(voltage == 61)
            {
                lv_label_set_text(Battery_label, "80%");
                lv_label_set_text(Battery_image, LV_SYMBOL_BATTERY_3);
                lv_obj_align(Battery_label, LV_ALIGN_TOP_LEFT, 405, 5);
            }
            else if(voltage == 60)
            {
                lv_label_set_text(Battery_label, "70%");
                lv_label_set_text(Battery_image, LV_SYMBOL_BATTERY_3);   
                lv_obj_align(Battery_label, LV_ALIGN_TOP_LEFT, 405, 5);            
            }
            else if(voltage == 59)
            {
                lv_label_set_text(Battery_label, "60%");
                lv_label_set_text(Battery_image, LV_SYMBOL_BATTERY_2);      
                lv_obj_align(Battery_label, LV_ALIGN_TOP_LEFT, 405, 5);         
            }
            else if(voltage == 58)
            {
                lv_label_set_text(Battery_label, "50%");
                lv_label_set_text(Battery_image, LV_SYMBOL_BATTERY_2);
                lv_obj_align(Battery_label, LV_ALIGN_TOP_LEFT, 405, 5);
            }
            else if(voltage == 57)
            {
                lv_label_set_text(Battery_label, "40%");
                lv_label_set_text(Battery_image, LV_SYMBOL_BATTERY_1);     
                lv_obj_align(Battery_label, LV_ALIGN_TOP_LEFT, 405, 5);          
            }
            else if(voltage == 56)
            {
                lv_label_set_text(Battery_label, "30%");
                lv_label_set_text(Battery_image, LV_SYMBOL_BATTERY_1);     
                lv_obj_align(Battery_label, LV_ALIGN_TOP_LEFT, 405, 5);          
            }
            else if(voltage == 55)
            {
                lv_label_set_text(Battery_label, "20%");
                lv_label_set_text(Battery_image, LV_SYMBOL_BATTERY_EMPTY);
                lv_obj_align(Battery_label, LV_ALIGN_TOP_LEFT, 405, 5);
            }
            else if(voltage == 54)
            {
                lv_label_set_text(Battery_label, "10%");
                lv_label_set_text(Battery_image, LV_SYMBOL_BATTERY_EMPTY);     
                lv_obj_align(Battery_label, LV_ALIGN_TOP_LEFT, 405, 5);          
            }
            else if(voltage < 54)
            {
                lv_label_set_text(Battery_label, "0%");
                lv_label_set_text(Battery_image, LV_SYMBOL_BATTERY_EMPTY);
                lv_obj_align(Battery_label, LV_ALIGN_TOP_LEFT, 405, 5);
            }
		}
    }


    if(buzzer_enable == 1)
    {
        if(system_data.system.buzzer == 0)
        {
            buzzer_count++;
            if(buzzer_count == 1)
            {
                buf[0] = 1;
                retvalue = write(fd_buzzer, buf, 1);
                if(retvalue < 0)
                {
                    printf("BEEP Control Failed!\r\n");
                    close(fd_buzzer);
                }
            }
            else if(buzzer_count > 2)
            {
                buzzer_enable = 0;
                g_screen_off_count = 0;
                g_data_structure_count = 0;
                buf[0] = 0;
                retvalue = write(fd_buzzer, buf, 1);
                if(retvalue < 0)
                {
                    printf("BEEP Control Failed!\r\n");
                    close(fd_buzzer);
                }
            }
        }
        else
        {
            buzzer_enable = 0;
            g_screen_off_count = 0;
            g_data_structure_count = 0;
        }

    }
    else
    {
        buzzer_count = 0;
    }

    if(g_screen_off_status == 0)
    {
        g_screen_off_count++;
        switch(system_data.system.screen_off)
        {
            case 0:
            {
                if(g_screen_off_count > 600)
                {
                    pwm_brightness(100);
                    g_screen_off_status = 1;
                }
                break;
            }
            case 1:
            {
                if(g_screen_off_count > 3000)
                {
                    pwm_brightness(100);
                    g_screen_off_status = 1;
                } 
                break;
            }
            case 2:
            {
                if(g_screen_off_count > 18000)
                {
                    pwm_brightness(100);
                    g_screen_off_status = 1;
                } 
                break;
            }
        }

        if(g_screen_off_status == 1)
        {
            screen_off_obj = lv_obj_create(lv_scr_act());
            lv_obj_align(screen_off_obj, LV_ALIGN_TOP_LEFT, 0, 0);
            lv_obj_set_size(screen_off_obj, 480, 272);
            lv_obj_set_style_bg_color(screen_off_obj, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
            lv_obj_set_style_border_width(screen_off_obj, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
            lv_obj_set_style_border_color(screen_off_obj, lv_color_hex(0xcccccc), LV_STATE_DEFAULT); /* 设置边框颜色 */
            lv_obj_clear_flag(screen_off_obj, LV_OBJ_FLAG_SCROLLABLE);
            lv_obj_set_style_radius(screen_off_obj, 0, LV_STATE_DEFAULT); /* 设置圆角 */    
            lv_obj_add_event_cb(screen_off_obj, screen_touched_event_handler, LV_EVENT_CLICKED, NULL);       
        }
    }


    if(print_button_enable == 1)
    {
        win_content_child_num = lv_obj_get_child_cnt(win_content);

        for (i = 0; i < win_content_child_num; i++)
        {
            if (data_structure[i].type == TYPE_BREAK)
            {
                lv_obj_t *child = lv_obj_get_child(win_content, i);

                if (child != NULL) 
                {
                    // 隐藏子对象
                    lv_obj_add_flag(child, LV_OBJ_FLAG_HIDDEN);
                }
            }
            else if(data_structure[i].type == TYPE_COUNT)
            {
                
            }
            else if(data_structure[i].type == TYPE_DATE)
            {
                printf("date_or_time=%d\n\r",data_structure[i].data.date_time.date_or_time);
                printf("date_or_time_type=%d\n\r",data_structure[i].data.date_time.date_or_time_type);
                if(data_structure[i].data.date_time.date_or_time == 0)
                {
                    switch(data_structure[i].data.date_time.date_or_time_type)
                    {
                        case 0:
                            sprintf(date_time_str, "%04d/%02d/%02d", 2000 + g_system_time[0], g_system_time[1], g_system_time[2]);
                            break;
                        case 1:
                            sprintf(date_time_str, "%02d/%02d/%02d", g_system_time[0], g_system_time[1], g_system_time[2]);
                            break;
                        case 2:
                            sprintf(date_time_str, "%04d-%02d-%02d", 2000 + g_system_time[0], g_system_time[1], g_system_time[2]);
                            break;
                        case 3:
                            sprintf(date_time_str, "%02d-%02d-%02d", g_system_time[0], g_system_time[1], g_system_time[2]);
                            break;
                        case 4:
                            sprintf(date_time_str, "%04d.%02d.%02d", 2000 + g_system_time[0], g_system_time[1], g_system_time[2]);
                            break;
                        case 5:
                            sprintf(date_time_str, "%02d.%02d.%02d", g_system_time[0], g_system_time[1], g_system_time[2]);
                            break;
                        case 6:
                            sprintf(date_time_str, "%02d/%02d/%04d", g_system_time[2],  g_system_time[1], 2000 + g_system_time[0]);
                            break;
                        case 7:
                            sprintf(date_time_str, "%02d/%02d/%02d", g_system_time[2],  g_system_time[1], g_system_time[0]);
                            break;
                        case 8:
                            sprintf(date_time_str, "%02d-%02d-%04d", g_system_time[2],  g_system_time[1], 2000 + g_system_time[0]);
                            break;
                        case 9:
                            sprintf(date_time_str, "%02d-%02d-%02d", g_system_time[2],  g_system_time[1], g_system_time[0]);
                            break;
                        case 10:
                            sprintf(date_time_str, "%02d.%02d.%04d", g_system_time[2],  g_system_time[1], 2000 + g_system_time[0]);
                            break;
                        case 11:
                            sprintf(date_time_str, "%02d.%02d.%02d", g_system_time[2],  g_system_time[1], g_system_time[0]);
                            break;
                        case 12:
                            sprintf(date_time_str, "%04d年%02d月%02d日", 2000 + g_system_time[0], g_system_time[1], g_system_time[2]);
                            break;
                        case 13:
                            sprintf(date_time_str, "%02d年%02d月%02d日", g_system_time[0], g_system_time[1], g_system_time[2]);
                            break;
                        case 14:
                            sprintf(date_time_str, "%s",data_structure[i].data.date_time.text);
                            break;
                        case 15:
                            sprintf(date_time_str, "延期");
                            break;
                    }
                }
                else if(data_structure[i].data.date_time.date_or_time == 2)
                {
                    now_year =  2000 + g_system_time[0];
                    now_month =  g_system_time[1];
                    now_day =  g_system_time[2];
                    calculateExpiryDate(now_year,now_month,now_day,data_structure[i].data.date_time.year,data_structure[i].data.date_time.month,data_structure[i].data.date_time.day,&end_year,&end_month,&end_day);

                    switch(data_structure[i].data.date_time.date_or_time_type)
                    {
                        case 0:
                            sprintf(date_time_str, "%04d/%02d/%02d", end_year, end_month, end_day);
                            break;
                        case 1:
                            sprintf(date_time_str, "%02d/%02d/%02d", end_year%100, end_month, end_day);
                            break;
                        case 2:
                            sprintf(date_time_str, "%04d-%02d-%02d", end_year, end_month, end_day);
                            break;
                        case 3:
                            sprintf(date_time_str, "%02d-%02d-%02d", end_year%100, end_month, end_day);
                            break;
                        case 4:
                            sprintf(date_time_str, "%04d.%02d.%02d", end_year, end_month, end_day);
                            break;
                        case 5:
                            sprintf(date_time_str, "%02d.%02d.%02d", end_year%100, end_month, end_day);
                            break;
                        case 6:
                            sprintf(date_time_str, "%02d/%02d/%04d", end_day,  end_month, end_year);
                            break;
                        case 7:
                            sprintf(date_time_str, "%02d/%02d/%02d", end_day,  end_month, end_year%100);
                            break;
                        case 8:
                            sprintf(date_time_str, "%02d-%02d-%04d", end_day,  end_month, end_year);
                            break;
                        case 9:
                            sprintf(date_time_str, "%02d-%02d-%02d", end_day,  end_month, end_year%100);
                            break;
                        case 10:
                            sprintf(date_time_str, "%02d.%02d.%04d", end_day,  end_month, end_year);
                            break;
                        case 11:
                            sprintf(date_time_str, "%02d.%02d.%02d", end_day,  end_month, end_year%100);
                            break;
                        case 12:
                            sprintf(date_time_str, "%04d年%02d月%02d日", end_year, end_month, end_day);
                            break;
                        case 13:
                            sprintf(date_time_str, "%02d年%02d月%02d日", end_year%100, end_month, end_day);
                            break;
                        case 14:
                            sprintf(date_time_str, "%s",data_structure[i].data.date_time.text);
                            break;
                        case 15:
                            sprintf(date_time_str, "延期");
                            break;
                    }
                }
                else
                {
                    switch(data_structure[i].data.date_time.date_or_time_type)
                    {
                        case 0:
                            sprintf(date_time_str, "%02d:%02d:%02d", g_system_time[3], g_system_time[4], g_system_time[5]);
                            break;
                        case 1:
                            sprintf(date_time_str, "%02d:%02d", g_system_time[3], g_system_time[4]);
                            break;
                        case 2:
                            if (g_system_time[3] > 12)
                            {
                                sprintf(date_time_str, "%02d:%02d:%02d PM", g_system_time[3] - 12, g_system_time[4], g_system_time[5]);
                            }
                            else
                            {
                                sprintf(date_time_str, "%02d:%02d:%02d AM", g_system_time[3], g_system_time[4], g_system_time[5]);
                            }
                            break;
                        case 3:
                            if (g_system_time[3] > 12)
                            {
                                sprintf(date_time_str, "%02d:%02d PM", g_system_time[3] - 12, g_system_time[4]);
                            }
                            else
                            {
                                sprintf(date_time_str, "%02d:%02d AM", g_system_time[3], g_system_time[4]);
                            }
                            break;
                        case 4:
                            sprintf(date_time_str, "%02d时%02d分%02d秒", g_system_time[3], g_system_time[4], g_system_time[5]);
                            break;
                        case 5:
                            sprintf(date_time_str, "%s",data_structure[i].data.date_time.text);
                            break;
                        case 6:
                            sprintf(date_time_str, "延期");
                            break;
                    }  
                }  

                sprintf(data_structure[i].data.date_time.text, "%s",date_time_str);
                  
                lv_obj_t *child = lv_obj_get_child(win_content, i);
                lv_label_set_text(lv_obj_get_child(child, 0), date_time_str); // 设置文本         
            }
        }

        lv_obj_update_layout(win_content);

        snapshot = lv_snapshot_take(win_content, LV_IMG_CF_ALPHA_1BIT);

        if(snapshot == NULL)
        {
            printf("lv_snapshot_take error\n");
        }
        else
        {
            printf("lv_snapshot_take ok\n");
            printf("napshot->data_size=%u\n\r",snapshot->data_size);
            printf("snapshot->header.w=%u\n\r",snapshot->header.w);
            printf("snapshot->header.h=%u\n\r",snapshot->header.h);
            printf("snapshot->header.cf=%u\n\r",snapshot->header.cf);

#if 0
            for (i = 0; i < CANVAS_HEIGHT; i++)
            {
                for (j = 0; j < 50; j++)
                {
                    data = *(snapshot->data + (i * CANVAS_WIDTH + j) * 4);
                    printf("%02x ", data);
                }

                printf("\n\r");
            }
#endif
        }

#if 0
        lv_draw_img_dsc_t img_dsc;
        lv_draw_img_dsc_init(&img_dsc);

        canvas = lv_canvas_create(win_content);
        lv_obj_align(canvas, LV_ALIGN_TOP_LEFT, 0, 0);
        //lv_obj_center(canvas);
        /* 第三步：为画布设置缓冲区 */

        size_t buf_size = CANVAS_WIDTH * CANVAS_HEIGHT * sizeof(lv_color_t);

        canvasBuf = (lv_color_t *)malloc(buf_size);
    
        if (canvasBuf == NULL) 
        {
            printf("Memory allocation failed for canvas\n");
            return;
        }

        lv_canvas_set_buffer(canvas, canvasBuf, CANVAS_WIDTH, CANVAS_HEIGHT, LV_IMG_CF_TRUE_COLOR);
        lv_canvas_fill_bg(canvas, lv_color_hex(0xffffff), LV_OPA_COVER);

        lv_canvas_draw_img(canvas, 0, 0, snapshot, &img_dsc);

        lv_obj_add_flag(canvas, LV_OBJ_FLAG_HIDDEN);
#endif

        memset((char *)&subsection_structure,0,sizeof(subsection_structure));

        for (i = 0; i < win_content_child_num; i++)
        {
            if (data_structure[i].type == TYPE_BREAK)
            {
                subsection_structure.x[break_num] = data_structure[i].x;
                break_num++;
            }
        }

        subsection_structure.total = break_num;

        bubbleSort(subsection_structure.x,break_num);

        for(i=0;i<break_num;i++)
        {
            printf("x[%d]=%d\n\r",i,subsection_structure.x[i]);
        }

        for (i = 0; i < win_content_child_num; i++)
        {
            if (data_structure[i].type == TYPE_BREAK)
            {
                lv_obj_t *child = lv_obj_get_child(win_content, i);

                if (child != NULL) 
                {
                    // 隐藏子对象
                    lv_obj_clear_flag(child, LV_OBJ_FLAG_HIDDEN);
                }
            }
        }

        lv_obj_update_layout(win_content);

        print_button_enable = 2;
    }
    else if(print_button_enable == 2)
    {
        if(system_data.print.trigger_mode == 0)
        {
            read(fd_gpio_in, &key_value, 4); 
        }
        else
        {
            read(fd_optoelectronic, &key_value_1, 4); 
            if((key_value_1 == 1)&&(key_value_2 == 0))
            {
                key_value = 0;
            }

            key_value_2 = key_value_1;
        }

        if(key_value == 0)
        {
            printf("PRINT_KEY\n");
            key_value = 1;

            if(system_data.system.buzzer == 0)
            {
                buf[0] = 1;
                retvalue = write(fd_buzzer, buf, 1);
                if(retvalue < 0)
                {
                    printf("BEEP Control Failed!\r\n");
                    close(fd_buzzer);
                }
                usleep(300000);

                buf[0] = 0;
                retvalue = write(fd_buzzer, buf, 1);
                if(retvalue < 0)
                {
                    printf("BEEP Control Failed!\r\n");
                    close(fd_buzzer);
                }
            }

            g_screen_off_count = 0;
            g_data_structure_count = 0;

            printf("subsection_structure.total=%d\r\n",subsection_structure.total);
            printf("subsection_structure.current=%d\r\n",subsection_structure.current);

            if(subsection_structure.total > 0)
            {
                if(subsection_structure.current == 0)
                {
                    pdata = snapshot->data; 

                    printf("h=%d\n\r",snapshot->header.h);
                    printf("w=%d\n\r", snapshot->header.w);
                    printf("size=%d\n\r", snapshot->data_size);
#if 0                    
                    bytes_per_line = (snapshot->header.w + 7) / 8;
                    for (i = 0; i < snapshot->header.h; i++) 
                    {
                        //printf("Row %3d: ", y);
                        for (j= 0; j < 100; j++) 
                        {
                            byte_index = i * bytes_per_line + (j / 8);
                            bit_index = 7 - (j % 8);
                            pixel = (pdata[byte_index] >> bit_index) & 0x01;
                            printf("%d", pixel);

                            // 每8位加一个空格便于阅读
                            // if ((x + 1) % 8 == 0) printf(" ");
                        }
                        printf("\n");
                    }
#endif

                    success = crop_x_range_correct(pdata, snapshot->header.w, snapshot->header.h,0,subsection_structure.x[0],   \
                                                    print_data.data, sizeof(print_data.data), &print_data.data_width, &print_data.data_hight, \
                                                    &start_x, &end_x,system_data.print.print_direction);


                    if (success) 
                    {
                        printf("Cropped successfully:\n");
                        printf("  Original: %dx%d\n", snapshot->header.w, snapshot->header.h);
                        printf("  Cropped: %dx%d\n", print_data.data_width, print_data.data_hight);
                        printf("  Start position: (%d, %d)\n", start_x, end_x);

                        // output_buf 现在包含裁剪后的二值化数据
                        // 其中像素值为0的区域是您需要的有效数据
#if 0
                        for (i = 0; i < print_data.data_hight; i++) 
                        {
                            //printf("Row %3d: ", y);
                            for (j= 0; j < 100; j++) 
                            {
                                byte_index = i * bytes_per_line + (j / 8);
                                bit_index = 7 - (j % 8);
                                pixel = (print_data.data[byte_index] >> bit_index) & 0x01;
                                printf("%d", pixel);

                                // 每8位加一个空格便于阅读
                            // if ((x + 1) % 8 == 0) printf(" ");
                            }
                            printf("\n");
                        }
#endif
                        print_data.trigger_mode = system_data.print.trigger_mode;
                        print_data.nozzle = system_data.print.nozzle;
                        print_data.concentration = system_data.print.concentration;
                        print_data.word_width = system_data.print.width;
                        print_data.print_number = system_data.print.print_number;
                        print_data.print_interval = system_data.print.print_interval;
                        print_data.trigger_delay = system_data.print.trigger_delay;
                        print_data.print_speed = system_data.print.print_speed;

                        printf("printWidth=%d printHeight=%d\n", print_data.data_width, print_data.data_hight);
                        printf("concentration=%d word_width=%d\n", print_data.concentration, print_data.word_width);
                        printf("nozzle=%d\n", print_data.nozzle);
                    }
                

                    if((print_data.data_width  > 2)&&(print_data.data_hight > 2))
                    {
                        retvalue = write(fd_ph45,(unsigned char *)&print_data, sizeof(print_data));      
                        if(retvalue < 0)
                        {
                            printf("fd_ph45 Control Failed!\r\n");
                            close(fd_ph45);
                        }
                        else
                        {
                            //printf("fd_ph45 Control ok!\r\n");
                        }
                        
                        if(system_data.system.buzzer == 0)
                        {
                            buf[0] = 1;
                            retvalue = write(fd_buzzer, buf, 1);
                            if(retvalue < 0)
                            {
                                printf("BEEP Control Failed!\r\n");
                                close(fd_buzzer);
                            }
                            usleep(300000);

                            buf[0] = 0;
                            retvalue = write(fd_buzzer, buf, 1);
                            if(retvalue < 0)
                            {
                                printf("BEEP Control Failed!\r\n");
                                close(fd_buzzer);
                            }
                        }
                    }

                    system_data.total_output++;

                    total_output_changeFlag = 1;

                    flash_set_count = 0;       

                    subsection_structure.current++;        
                }
                else if(subsection_structure.current < subsection_structure.total)
                {
                    pdata = snapshot->data; 


                    printf("h=%d\n\r",snapshot->header.h);
                    printf("w=%d\n\r", snapshot->header.w);
                    printf("size=%d\n\r", snapshot->data_size);

 #if 0                   
                    bytes_per_line = (snapshot->header.w + 7) / 8;
                    for (i = 0; i < snapshot->header.h; i++) 
                    {
                        //printf("Row %3d: ", y);
                        for (j= 0; j < 100; j++) 
                        {
                            byte_index = i * bytes_per_line + (j / 8);
                            bit_index = 7 - (j % 8);
                            pixel = (pdata[byte_index] >> bit_index) & 0x01;
                            printf("%d", pixel);

                            // 每8位加一个空格便于阅读
                            // if ((x + 1) % 8 == 0) printf(" ");
                        }
                        printf("\n");
                    }
#endif

                    success = crop_x_range_correct(pdata, snapshot->header.w, snapshot->header.h,subsection_structure.x[subsection_structure.current-1],subsection_structure.x[subsection_structure.current],   \
                                                    print_data.data, sizeof(print_data.data), &print_data.data_width, &print_data.data_hight, \
                                                    &start_x, &end_x,system_data.print.print_direction);


                    if (success) 
                    {
                        printf("Cropped successfully:\n");
                        printf("  Original: %dx%d\n", snapshot->header.w, snapshot->header.h);
                        printf("  Cropped: %dx%d\n", print_data.data_width, print_data.data_hight);
                        printf("  Start position: (%d, %d)\n", start_x, end_x);                  



                        print_data.trigger_mode = system_data.print.trigger_mode;
                        print_data.nozzle = system_data.print.nozzle;
                        print_data.concentration = system_data.print.concentration;
                        print_data.word_width = system_data.print.width;
                        print_data.print_number = system_data.print.print_number;
                        print_data.print_interval = system_data.print.print_interval;
                        print_data.trigger_delay = system_data.print.trigger_delay;
                        print_data.print_speed = system_data.print.print_speed;

                        printf("printWidth=%d printHeight=%d\n", print_data.data_width, print_data.data_hight);
                        printf("concentration=%d word_width=%d\n", print_data.concentration, print_data.word_width);
                        printf("nozzle=%d\n", print_data.nozzle);
                    }

                    if((print_data.data_width  > 2)&&(print_data.data_hight > 2))
                    {
                        retvalue = write(fd_ph45,(unsigned char *)&print_data, sizeof(print_data));      
                        if(retvalue < 0)
                        {
                            printf("fd_ph45 Control Failed!\r\n");
                            close(fd_ph45);
                        }
                        else
                        {
                            printf("fd_ph45 Control ok!\r\n");
                        }

                        if(system_data.system.buzzer == 0)
                        {
                            buf[0] = 1;
                            retvalue = write(fd_buzzer, buf, 1);
                            if(retvalue < 0)
                            {
                                printf("BEEP Control Failed!\r\n");
                                close(fd_buzzer);
                            }
                            usleep(300000);

                            buf[0] = 0;
                            retvalue = write(fd_buzzer, buf, 1);
                            if(retvalue < 0)
                            {
                                printf("BEEP Control Failed!\r\n");
                                close(fd_buzzer);
                            }
                        }
                    }

                    system_data.total_output++;

                    total_output_changeFlag = 1;

                    flash_set_count = 0;

                    subsection_structure.current++;
                }
                else
                {
                    pdata = snapshot->data; 

                    printf("h=%d\n\r",snapshot->header.h);
                    printf("w=%d\n\r", snapshot->header.w);
                    printf("size=%d\n\r", snapshot->data_size);

#if 0                    
                    bytes_per_line = (snapshot->header.w + 7) / 8;

                    for (i = 0; i < snapshot->header.h; i++) 
                    {
                        //printf("Row %3d: ", y);
                        for (j= 0; j < 100; j++) 
                        {
                            byte_index = i * bytes_per_line + (j / 8);
                            bit_index = 7 - (j % 8);
                            pixel = (pdata[byte_index] >> bit_index) & 0x01;
                            printf("%d", pixel);

                            // 每8位加一个空格便于阅读
                            // if ((x + 1) % 8 == 0) printf(" ");
                        }
                        printf("\n");
                    }
#endif

                    success = crop_x_range_correct(pdata, snapshot->header.w, snapshot->header.h,subsection_structure.x[subsection_structure.current-1],CANVAS_WIDTH - 1,   \
                                                    print_data.data, sizeof(print_data.data), &print_data.data_width, &print_data.data_hight, \
                                                    &start_x, &end_x,system_data.print.print_direction);


                    if (success) 
                    {
                        printf("Cropped successfully:\n");
                        printf("  Original: %dx%d\n", snapshot->header.w, snapshot->header.h);
                        printf("  Cropped: %dx%d\n", print_data.data_width, print_data.data_hight);
                        printf("  Start position: (%d, %d)\n", start_x, end_x);                  

                        print_data.trigger_mode = system_data.print.trigger_mode;
                        print_data.nozzle = system_data.print.nozzle;
                        print_data.concentration = system_data.print.concentration;
                        print_data.word_width = system_data.print.width;
                        print_data.print_number = system_data.print.print_number;
                        print_data.print_interval = system_data.print.print_interval;
                        print_data.trigger_delay = system_data.print.trigger_delay;
                        print_data.print_speed = system_data.print.print_speed;

                        printf("printWidth=%d printHeight=%d\n", print_data.data_width, print_data.data_hight);
                        printf("concentration=%d word_width=%d\n", print_data.concentration, print_data.word_width);
                        printf("nozzle=%d\n", print_data.nozzle);
                    }

                    if((print_data.data_width  > 2)&&(print_data.data_hight > 2))
                    {
                        retvalue = write(fd_ph45,(unsigned char *)&print_data, sizeof(print_data));      
                        if(retvalue < 0)
                        {
                            printf("fd_ph45 Control Failed!\r\n");
                            close(fd_ph45);
                        }
                        else
                        {
                            printf("fd_ph45 Control ok!\r\n");
                        }

                        lv_snapshot_free(snapshot);
          
                        if(system_data.system.buzzer == 0)
                        {
                            buf[0] = 1;
                            retvalue = write(fd_buzzer, buf, 1);
                            if(retvalue < 0)
                            {
                                printf("BEEP Control Failed!\r\n");
                                close(fd_buzzer);
                            }
                            usleep(300000);

                            buf[0] = 0;
                            retvalue = write(fd_buzzer, buf, 1);
                            if(retvalue < 0)
                            {
                                printf("BEEP Control Failed!\r\n");
                                close(fd_buzzer);
                            }
                        }
                    }

                    system_data.total_output++;

                    total_output_changeFlag = 1;

                    flash_set_count = 0;   

                    subsection_structure.current = 0;   

                    print_button_enable = 3;    
                }
            }
            //没有分段的情况
            else
            {
                //新建画布，获取图片，发送给底层
                //pdata = (unsigned char*)canvasBuf;
                pdata = snapshot->data; 

                printf("h=%d\n\r",snapshot->header.h);
                printf("w=%d\n\r", snapshot->header.w);
                printf("size=%d\n\r", snapshot->data_size);

#if 0
                bytes_per_line = (snapshot->header.w + 7) / 8;

                for (i = 0; i < snapshot->header.h; i++) 
                {
                    //printf("Row %3d: ", y);
                    for (j= 0; j < 100; j++) 
                    {
                        byte_index = i * bytes_per_line + (j / 8);
                        bit_index = 7 - (j % 8);
                        pixel = (pdata[byte_index] >> bit_index) & 0x01;
                        printf("%d", pixel);

                        // 每8位加一个空格便于阅读
                        // if ((x + 1) % 8 == 0) printf(" ");
                    }
                    printf("\n");
                }
#endif

                success = crop_x_range_correct(pdata, snapshot->header.w, snapshot->header.h,0,CANVAS_WIDTH - 1,   \
                                                print_data.data, sizeof(print_data.data), &print_data.data_width, &print_data.data_hight, \
                                                &start_x, &end_x,system_data.print.print_direction);


                if (success) 
                {
                    printf("Cropped successfully:\n");
                    printf("  Original: %dx%d\n", snapshot->header.w, snapshot->header.h);
                    printf("  Cropped: %dx%d\n", print_data.data_width, print_data.data_hight);
                    printf("  Start position: (%d, %d)\n", start_x, end_x);      


                    // output_buf 现在包含裁剪后的二值化数据
                    // 其中像素值为0的区域是您需要的有效数据
#if 0

                    bytes_per_line = (print_data.data_width + 7) / 8;

                    for (i = 0; i < print_data.data_hight; i++) 
                    {
                        //printf("Row %3d: ", y);
                        for (j= 0; j < 100; j++) 
                        {
                            byte_index = i * bytes_per_line + (j / 8);
                            bit_index = 7 - (j % 8);
                            pixel = (print_data.data[byte_index] >> bit_index) & 0x01;
                            printf("%d", pixel);

                            // 每8位加一个空格便于阅读
                        // if ((x + 1) % 8 == 0) printf(" ");
                        }
                        printf("\n");
                    }
#endif


                    print_data.trigger_mode = system_data.print.trigger_mode;
                    print_data.nozzle = system_data.print.nozzle;
                    print_data.concentration = system_data.print.concentration;
                    print_data.word_width = system_data.print.width;
                    print_data.print_number = system_data.print.print_number;
                    print_data.print_interval = system_data.print.print_interval;
                    print_data.trigger_delay = system_data.print.trigger_delay;
                    print_data.print_speed = system_data.print.print_speed;

                    printf("printWidth=%d printHeight=%d\n", print_data.data_width, print_data.data_hight);
                    printf("concentration=%d word_width=%d\n", print_data.concentration, print_data.word_width);
                    printf("nozzle=%d\n", print_data.nozzle);
                    printf("print_direction=%d\n", system_data.print.print_direction);
                }
            
                if((print_data.data_width  > 2)&&(print_data.data_hight > 2))
                {
                    retvalue = write(fd_ph45,(unsigned char *)&print_data, sizeof(print_data));      
                    if(retvalue < 0)
                    {
                        printf("fd_ph45 Control Failed!\r\n");
                        close(fd_ph45);
                    }
                    else
                    {
                        printf("fd_ph45 Control ok!\r\n");
                    }

                    lv_snapshot_free(snapshot);
                    
                    if(system_data.system.buzzer == 0)
                    {
                        buf[0] = 1;
                        retvalue = write(fd_buzzer, buf, 1);
                        if(retvalue < 0)
                        {
                            printf("BEEP Control Failed!\r\n");
                            close(fd_buzzer);
                        }
                        usleep(300000);

                        buf[0] = 0;
                        retvalue = write(fd_buzzer, buf, 1);
                        if(retvalue < 0)
                        {
                            printf("BEEP Control Failed!\r\n");
                            close(fd_buzzer);
                        }
                    }
                }
                else
                {
                    lv_snapshot_free(snapshot);   
                }

                system_data.total_output++;

                total_output_changeFlag = 1;

                flash_set_count = 0;

                print_button_enable = 3;

            }
        } 
    }
    else if(print_button_enable == 3)
    {
        win_content_child_num = lv_obj_get_child_cnt(win_content);

        for (i = 0; i < win_content_child_num; i++)
        {
            if (data_structure[i].type == TYPE_BREAK)
            {
                lv_obj_t *child = lv_obj_get_child(win_content, i);

                if (child != NULL) 
                {
                    // 隐藏子对象
                    lv_obj_add_flag(child, LV_OBJ_FLAG_HIDDEN);
                }
            }
            else if(data_structure[i].type == TYPE_COUNT)
            {
                //确定显示值的位数
                //递增
                if (data_structure[i].data.count.law == 0)
                {
                    if(data_structure[i].data.count.repetition > 1)
                    {
                        rept_count++;
                        if(rept_count >= data_structure[i].data.count.repetition)
                        {
                            data_structure[i].data.count.current_value += data_structure[i].data.count.step;
                            rept_count = 0;
                        }
                    }
                    else
                    {
                        data_structure[i].data.count.current_value += data_structure[i].data.count.step;
                    }
                    if (data_structure[i].data.count.current_value < data_structure[i].data.count.minimum)
                    {
                        data_structure[i].data.count.current_value = data_structure[i].data.count.minimum;
                    }
                    else if(data_structure[i].data.count.current_value > data_structure[i].data.count.maximum)
                    {
                        data_structure[i].data.count.current_value = data_structure[i].data.count.maximum;
                    }

                    if (data_structure[i].data.count.lead_zero == 0)
                    {
                        formatNumberWithLeadingZeros(data_structure[i].data.count.current_value, data_structure[i].data.count.maximum, date_time_str);
                    }
                    else
                    {
                        sprintf(date_time_str, "%d", data_structure[i].data.count.current_value);
                    }
                }
                else
                {
                    if(data_structure[i].data.count.current_value >= data_structure[i].data.count.step)
                    {
                        if(data_structure[i].data.count.repetition > 1)
                        {
                            rept_count++;
                            if(rept_count >= data_structure[i].data.count.repetition)
                            {
                                data_structure[i].data.count.current_value -= data_structure[i].data.count.step;
                                rept_count = 0;
                            }
                        }
                        else
                        {
                            data_structure[i].data.count.current_value -= data_structure[i].data.count.step;
                        }
                    }

                    if (data_structure[i].data.count.current_value < data_structure[i].data.count.minimum)
                    {
                        data_structure[i].data.count.current_value = data_structure[i].data.count.minimum;
                    }
                    else if (data_structure[i].data.count.current_value > data_structure[i].data.count.maximum)
                    {
                        data_structure[i].data.count.current_value = data_structure[i].data.count.maximum;
                    }

                    if (data_structure[i].data.count.lead_zero == 0)
                    {
                        formatNumberWithLeadingZeros(data_structure[i].data.count.current_value, data_structure[i].data.count.maximum, date_time_str);
                    }
                    else
                    {
                        sprintf(date_time_str, "%d", data_structure[win_content_child_num].data.count.current_value);
                    }       
                }

                printf("tempString=%s\n\r", date_time_str);    
                
                lv_obj_t *child = lv_obj_get_child(win_content, i);
                lv_label_set_text(lv_obj_get_child(child, 0), date_time_str); // 设置文本    
                sprintf(data_structure[win_content_child_num].data.count.text,"%s",date_time_str);
            }
            else if(data_structure[i].type == TYPE_DATE)
            {
                if(data_structure[i].data.date_time.date_or_time == 0)
                {
                    switch(data_structure[i].data.date_time.date_or_time_type)
                    {
                        case 0:
                            sprintf(date_time_str, "%04d/%02d/%02d", 2000 + g_system_time[0], g_system_time[1], g_system_time[2]);
                            break;
                        case 1:
                            sprintf(date_time_str, "%02d/%02d/%02d", g_system_time[0], g_system_time[1], g_system_time[2]);
                            break;
                        case 2:
                            sprintf(date_time_str, "%04d-%02d-%02d", 2000 + g_system_time[0], g_system_time[1], g_system_time[2]);
                            break;
                        case 3:
                            sprintf(date_time_str, "%02d-%02d-%02d", g_system_time[0], g_system_time[1], g_system_time[2]);
                            break;
                        case 4:
                            sprintf(date_time_str, "%04d.%02d.%02d", 2000 + g_system_time[0], g_system_time[1], g_system_time[2]);
                            break;
                        case 5:
                            sprintf(date_time_str, "%02d.%02d.%02d", g_system_time[0], g_system_time[1], g_system_time[2]);
                            break;
                        case 6:
                            sprintf(date_time_str, "%02d/%02d/%04d", g_system_time[2],  g_system_time[1], 2000 + g_system_time[0]);
                            break;
                        case 7:
                            sprintf(date_time_str, "%02d/%02d/%02d", g_system_time[2],  g_system_time[1], g_system_time[0]);
                            break;
                        case 8:
                            sprintf(date_time_str, "%02d-%02d-%04d", g_system_time[2],  g_system_time[1], 2000 + g_system_time[0]);
                            break;
                        case 9:
                            sprintf(date_time_str, "%02d-%02d-%02d", g_system_time[2],  g_system_time[1], g_system_time[0]);
                            break;
                        case 10:
                            sprintf(date_time_str, "%02d.%02d.%04d", g_system_time[2],  g_system_time[1], 2000 + g_system_time[0]);
                            break;
                        case 11:
                            sprintf(date_time_str, "%02d.%02d.%02d", g_system_time[2],  g_system_time[1], g_system_time[0]);
                            break;
                        case 12:
                            sprintf(date_time_str, "%04d年%02d月%02d日", 2000 + g_system_time[0], g_system_time[1], g_system_time[2]);
                            break;
                        case 13:
                            sprintf(date_time_str, "%02d年%02d月%02d日", g_system_time[0], g_system_time[1], g_system_time[2]);
                            break;
                        case 14:
                            sprintf(date_time_str, "%s",data_structure[i].data.date_time.text);
                            break;
                        case 15:
                            sprintf(date_time_str, "延期");
                            break;
                    }
                }
                else if(data_structure[i].data.date_time.date_or_time == 2)
                {
                    now_year =  2000 + g_system_time[0];
                    now_month =  g_system_time[1];
                    now_day =  g_system_time[2];
                    calculateExpiryDate(now_year,now_month,now_day,data_structure[i].data.date_time.year,data_structure[i].data.date_time.month,data_structure[i].data.date_time.day,&end_year,&end_month,&end_day);

                    switch(data_structure[i].data.date_time.date_or_time_type)
                    {
                        case 0:
                            sprintf(date_time_str, "%04d/%02d/%02d", end_year, end_month, end_day);
                            break;
                        case 1:
                            sprintf(date_time_str, "%02d/%02d/%02d", end_year%100, end_month, end_day);
                            break;
                        case 2:
                            sprintf(date_time_str, "%04d-%02d-%02d", end_year, end_month, end_day);
                            break;
                        case 3:
                            sprintf(date_time_str, "%02d-%02d-%02d", end_year%100, end_month, end_day);
                            break;
                        case 4:
                            sprintf(date_time_str, "%04d.%02d.%02d", end_year, end_month, end_day);
                            break;
                        case 5:
                            sprintf(date_time_str, "%02d.%02d.%02d", end_year%100, end_month, end_day);
                            break;
                        case 6:
                            sprintf(date_time_str, "%02d/%02d/%04d", end_day,  end_month, end_year);
                            break;
                        case 7:
                            sprintf(date_time_str, "%02d/%02d/%02d", end_day,  end_month, end_year%100);
                            break;
                        case 8:
                            sprintf(date_time_str, "%02d-%02d-%04d", end_day,  end_month, end_year);
                            break;
                        case 9:
                            sprintf(date_time_str, "%02d-%02d-%02d", end_day,  end_month, end_year%100);
                            break;
                        case 10:
                            sprintf(date_time_str, "%02d.%02d.%04d", end_day,  end_month, end_year);
                            break;
                        case 11:
                            sprintf(date_time_str, "%02d.%02d.%02d", end_day,  end_month, end_year%100);
                            break;
                        case 12:
                            sprintf(date_time_str, "%04d年%02d月%02d日", end_year, end_month, end_day);
                            break;
                        case 13:
                            sprintf(date_time_str, "%02d年%02d月%02d日", end_year%100, end_month, end_day);
                            break;
                        case 14:
                            sprintf(date_time_str, "%s",data_structure[i].data.date_time.text);
                            break;
                        case 15:
                            sprintf(date_time_str, "延期");
                            break;
                    }
                }
                else
                {
                    switch(data_structure[i].data.date_time.date_or_time_type)
                    {
                        case 0:
                            sprintf(date_time_str, "%02d:%02d:%02d", g_system_time[3], g_system_time[4], g_system_time[5]);
                            break;
                        case 1:
                            sprintf(date_time_str, "%02d:%02d", g_system_time[3], g_system_time[4]);
                            break;
                        case 2:
                            if (g_system_time[3] > 12)
                            {
                                sprintf(date_time_str, "%02d:%02d:%02d PM", g_system_time[3] - 12, g_system_time[4], g_system_time[5]);
                            }
                            else
                            {
                                sprintf(date_time_str, "%02d:%02d:%02d AM", g_system_time[3], g_system_time[4], g_system_time[5]);
                            }
                            break;
                        case 3:
                            if (g_system_time[3] > 12)
                            {
                                sprintf(date_time_str, "%02d:%02d PM", g_system_time[3] - 12, g_system_time[4]);
                            }
                            else
                            {
                                sprintf(date_time_str, "%02d:%02d AM", g_system_time[3], g_system_time[4]);
                            }
                            break;
                        case 4:
                            sprintf(date_time_str, "%02d时%02d分%02d秒", g_system_time[3], g_system_time[4], g_system_time[5]);
                            break;
                        case 5:
                            sprintf(date_time_str, "%s",data_structure[i].data.date_time.text);
                            break;
                        case 6:
                            sprintf(date_time_str, "延期");
                            break;
                    }  
                }    
                  
                lv_obj_t *child = lv_obj_get_child(win_content, i);
                lv_label_set_text(lv_obj_get_child(child, 0), date_time_str); // 设置文本         
            }
        }

        lv_obj_update_layout(win_content);


        snapshot = lv_snapshot_take(win_content, LV_IMG_CF_ALPHA_1BIT);

        if(snapshot == NULL)
        {
            printf("lv_snapshot_take error\n");
        }
        else
        {
            printf("lv_snapshot_take ok\n");
        }
#if 0
        lv_draw_img_dsc_t img_dsc;
        lv_draw_img_dsc_init(&img_dsc);

        canvas = lv_canvas_create(win_content);
        lv_obj_align(canvas, LV_ALIGN_TOP_LEFT, 0, 0);
        //lv_obj_center(canvas);
        /* 第三步：为画布设置缓冲区 */
        lv_canvas_set_buffer(canvas, canvasBuf, CANVAS_WIDTH, CANVAS_HEIGHT, LV_IMG_CF_TRUE_COLOR);
        lv_canvas_fill_bg(canvas, lv_color_hex(0xffffff), LV_OPA_COVER);

        lv_canvas_draw_img(canvas, 0, 0, snapshot, &img_dsc);

        lv_obj_add_flag(canvas, LV_OBJ_FLAG_HIDDEN);
#endif

        memset((char *)&subsection_structure,0,sizeof(subsection_structure));

        for (i = 0; i < win_content_child_num; i++)
        {
            if (data_structure[i].type == TYPE_BREAK)
            {
                subsection_structure.x[break_num] = data_structure[i].x;
                break_num++;
            }
        }

        subsection_structure.total = break_num;

        bubbleSort(subsection_structure.x,break_num);

        for (i = 0; i < win_content_child_num; i++)
        {
            if (data_structure[i].type == TYPE_BREAK)
            {
                lv_obj_t *child = lv_obj_get_child(win_content, i);

                if (child != NULL) 
                {
                    // 隐藏子对象
                    lv_obj_clear_flag(child, LV_OBJ_FLAG_HIDDEN);
                }
            }
        }

        lv_obj_update_layout(win_content);   

        print_button_enable = 2;    
    }
    else if(print_button_enable == 4)
    {
        print_button_enable = 0;
        lv_snapshot_free(snapshot);
    }


    flash_set_count++;
    if(system_data.print.flash_set != 0)
    {
        if((flash_set_count / 600) >= system_data.print.flash_set)
        {
            flash_set_count = 0;
            print_data.trigger_mode = 3;
            //printf("trigger_mode=%d\n", print_data.trigger_mode);
            retvalue = write(fd_ph45,(unsigned char *)&print_data, sizeof(print_data));      
            if(retvalue < 0)
            {
                printf("fd_ph45 Control Failed!\r\n");
                close(fd_ph45);
            }
            else
            {
                //printf("fd_ph45 Control ok!\r\n");
            }
        }
    }

    if(total_output_changeFlag == 1)
    {
        total_output_changeFlag = 0;
        
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            sprintf(datastr,"总产量:%u",system_data.total_output);
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            sprintf(datastr,"Total Output:%u",system_data.total_output);
        }

        lv_label_set_text(Total_output_label, datastr);
    }

    
    rc522_count++;
    if((rc522_count > 30)&&(read_card_info_result == 0))
    {
        rc522_count = 0;
        check_hp45();
    }
}


static void main_slider_event_cb(lv_event_t* e)
{
    lv_obj_t* target = lv_event_get_target(e); /* 获取触发源 */
    lv_event_code_t code = lv_event_get_code(e); /* 获取事件类型 */
    int32_t temp;
    int x_data = 0;
    if ((code == LV_EVENT_VALUE_CHANGED)&&(print_status == 0))
    {
        temp =  lv_slider_get_value(target); 
        printf("temp=%d\n", temp);
        x_data = temp * 156;
        //x_data = temp * 39;
       // lv_obj_scroll_to_x(win_content, temp*7, LV_ANIM_ON);
        lv_indev_t* indev = lv_indev_get_act(); //获取输入设备
        if (indev == NULL)  return;

        lv_point_t vect;
        lv_indev_get_vect(indev, &vect);  //获取输入坐标位移向量

        if (vect.x != 0)
        {
            //lv_coord_t x = lv_obj_get_x(win_content) - vect.x;
            //printf("x=%d\n", x);
            //printf("vect.x=%d\n", vect.x);
            //0:0
            //10:1024/10
            lv_obj_set_pos(win_content, -x_data -15, -15);//Limit drag boundaries 
        }
    }
}


static void typeface_slider_event_cb(lv_event_t* e)
{
    lv_obj_t* target = lv_event_get_target(e); /* 获取触发源 */
    lv_event_code_t code = lv_event_get_code(e); /* 获取事件类型 */
    int32_t temp;
    static int32_t temp_last = 0;
    int x_data = 0;
    if ((code == LV_EVENT_VALUE_CHANGED) && (print_status == 0))
    {
        temp = lv_slider_get_value(target);
        printf("temp=%d\n", temp);

        x_data = temp;

        if (temp_last != temp)
        {
            lv_obj_set_pos(win_content_typeface, -15, x_data-115);//Limit drag boundaries 
        }
        temp_last = temp;
    }
}
/*************************************************
 *  函数名称 :  slider_show_2
 *  参    数 ： 无
 *  函数功能 ： slider显示
 *************************************************/
void slider_show_2(void)
{
    static const lv_style_prop_t props[] = { LV_STYLE_BG_COLOR,0 };  //设置位置参数
    static lv_style_transition_dsc_t transition_dsc;               //设置转换变量
    lv_style_transition_dsc_init(&transition_dsc, props, lv_anim_path_linear, 480, 0, NULL); //初始化转换

    static lv_style_t style_main;                                  //创建样式
    static lv_style_t style_indicator;                             //创建样式
    static lv_style_t style_knob;                                  //创建样式
    static lv_style_t style_pressed_color;                         //创建样式
    lv_style_init(&style_main);                                    //初始化样式
    lv_style_set_bg_opa(&style_main, LV_OPA_TRANSP);                 //设置背景透明度
    lv_style_set_bg_color(&style_main, lv_color_hex3(0xffffff));        //设置背景颜色
    //lv_style_set_radius(&style_main,LV_RADIUS_CIRCLE);             //设置圆角
    lv_style_set_size_A(&style_main, 400, 15);
    lv_style_set_pad_ver(&style_main, 0);                          //设置上下边距

    lv_style_init(&style_indicator);                               //初始化样式
    lv_style_set_bg_opa(&style_indicator, LV_OPA_TRANSP);            //设置背景透明度
    lv_style_set_bg_color(&style_indicator, lv_color_hex3(0xffffff));//设置背景颜色
    // lv_style_set_radius(&style_indicator,LV_RADIUS_CIRCLE);        //设置圆角
    lv_style_set_transition(&style_indicator, &transition_dsc);     //设置转化

    LV_IMG_DECLARE(img_slider);

    lv_style_init(&style_knob);                                    //初始化样式
    lv_style_set_bg_opa(&style_knob, LV_OPA_TRANSP);                 //设置背景透明度
    //lv_style_set_bg_color(&style_knob,lv_palette_main(LV_PALETTE_GREY));//设置背景颜色
    lv_style_set_bg_img_src(&style_knob, &img_slider);
    lv_style_set_border_color(&style_knob, lv_palette_darken(LV_PALETTE_GREY, 3));//设置边框背景颜色
    lv_style_set_border_width(&style_knob, 0);                      //设置边框宽度
    // lv_style_set_radius(&style_knob,LV_RADIUS_CIRCLE);             //设置圆角
    lv_style_set_pad_all(&style_knob, 20);                           //设置边距
    lv_style_set_size_A(&style_knob, 20, 10);
    lv_style_set_transition(&style_knob, &transition_dsc);          //设置转化

    lv_style_init(&style_pressed_color);                           //初始化样式
    lv_style_set_bg_color(&style_pressed_color, lv_color_hex3(0xffffff));//设置背景颜色

    slider_main = lv_slider_create(lv_scr_act());            //创建滑块
    lv_obj_remove_style_all(slider_main);                               //移除所有样式

    lv_obj_add_style(slider_main, &style_main, LV_PART_MAIN);             //添加样式
    lv_obj_add_style(slider_main, &style_indicator, LV_PART_INDICATOR);   //添加样式 指示器
    lv_obj_add_style(slider_main, &style_pressed_color, LV_PART_INDICATOR | LV_STATE_PRESSED); //添加样式 指示器 按压状态
    lv_obj_add_style(slider_main, &style_knob, LV_PART_KNOB);             //添加样式 圆头
    lv_obj_add_style(slider_main, &style_pressed_color, LV_PART_KNOB | LV_STATE_PRESSED);      //添加样式 圆头 按压状态
    lv_obj_align(slider_main, LV_ALIGN_TOP_LEFT, 39, 186);
    //lv_obj_center(slider);                                         //居中显示
    lv_obj_add_event_cb(slider_main, main_slider_event_cb, LV_EVENT_VALUE_CHANGED, NULL);
}


void slider_show_typeface(void)
{
    static const lv_style_prop_t props[] = { LV_STYLE_BG_COLOR,0 };  //设置位置参数
    static lv_style_transition_dsc_t transition_dsc;               //设置转换变量
    lv_style_transition_dsc_init(&transition_dsc, props, lv_anim_path_linear,200, 0, NULL); //初始化转换

    static lv_style_t style_main;                                  //创建样式
    static lv_style_t style_indicator;                             //创建样式
    static lv_style_t style_knob;                                  //创建样式
    static lv_style_t style_pressed_color;                         //创建样式
    lv_style_init(&style_main);                                    //初始化样式
    lv_style_set_bg_opa(&style_main, LV_OPA_TRANSP);                 //设置背景透明度
    lv_style_set_bg_color(&style_main, lv_color_hex3(0xffffff));        //设置背景颜色
    lv_style_set_size_A(&style_main, 20, 142);
    lv_style_set_pad_ver(&style_main, 0);                          //设置上下边距
    lv_style_init(&style_indicator);                               //初始化样式
    lv_style_set_bg_opa(&style_indicator, LV_OPA_TRANSP);            //设置背景透明度
    lv_style_set_bg_color(&style_indicator, lv_color_hex3(0xffffff));//设置背景颜色
    lv_style_set_transition(&style_indicator, &transition_dsc);     //设置转化

    LV_IMG_DECLARE(img_slider_typeface);

    lv_style_init(&style_knob);                                    //初始化样式
    lv_style_set_bg_opa(&style_knob, LV_OPA_TRANSP);                 //设置背景透明度
    lv_style_set_bg_img_src(&style_knob, &img_slider_typeface);
    lv_style_set_border_color(&style_knob, lv_palette_darken(LV_PALETTE_GREY, 3));//设置边框背景颜色
    lv_style_set_border_width(&style_knob, 0);                      //设置边框宽度
    lv_style_set_pad_all(&style_knob, 20);                           //设置边距
    lv_style_set_size_A(&style_knob, 20, 10);
    lv_style_set_transition(&style_knob, &transition_dsc);          //设置转化
    
    lv_style_init(&style_pressed_color);                           //初始化样式
    lv_style_set_bg_color(&style_pressed_color, lv_color_hex3(0xAAAAAA));//设置背景颜色

    slider_typeface = lv_slider_create(lv_scr_act());            //创建滑块
    lv_obj_remove_style_all(slider_typeface);                               //移除所有样式

    lv_obj_add_style(slider_typeface, &style_main, LV_PART_MAIN);             //添加样式
    lv_obj_add_style(slider_typeface, &style_indicator, LV_PART_INDICATOR);   //添加样式 指示器
    lv_obj_add_style(slider_typeface, &style_pressed_color, LV_PART_INDICATOR | LV_STATE_PRESSED); //添加样式 指示器 按压状态
    lv_obj_add_style(slider_typeface, &style_knob, LV_PART_KNOB);             //添加样式 圆头
    lv_obj_add_style(slider_typeface, &style_pressed_color, LV_PART_KNOB | LV_STATE_PRESSED);      //添加样式 圆头 按压状态
    lv_obj_align(slider_typeface, LV_ALIGN_TOP_LEFT, 460, 65);
    //lv_obj_center(slider);                                         //居中显示
    lv_obj_add_event_cb(slider_typeface, typeface_slider_event_cb, LV_EVENT_VALUE_CHANGED, NULL);
    lv_slider_set_value(slider_typeface, 100, LV_ANIM_ON);
}


static void button_keyboard_return_event_cb(lv_event_t* e)
{
    lv_event_code_t code;
    code = lv_event_get_code(e);
    if (code == LV_EVENT_CLICKED)
    {
        printf("button_keyboard_return_event_cb\n");

        buzzer_enable = 1;
        lv_obj_del(textarea_bg_keyboard);
        lv_obj_del(pinyin_ime);
        lv_obj_del(textarea_text_keyboard);
        lv_obj_del(keyboard_bg);
        lv_obj_del(label_keyboard_confirm);
        lv_obj_del(btn_keyboard_confirm);
        lv_obj_del(label_keyboard_return);
        lv_obj_del(btn_keyboard_return);

        addition_text_updata();
    }
}


static void button_modification_text_keyboard_return_event_cb(lv_event_t* e)
{
    lv_event_code_t code;
    code = lv_event_get_code(e);
    if (code == LV_EVENT_CLICKED)
    {
        printf("button_modification_text_keyboard_return_event_cb\n");

        buzzer_enable = 1;
        lv_obj_del(textarea_bg_keyboard);
        lv_obj_del(pinyin_ime);
        lv_obj_del(textarea_text_keyboard);
        lv_obj_del(keyboard_bg);
        lv_obj_del(label_keyboard_confirm);
        lv_obj_del(btn_keyboard_confirm);
        lv_obj_del(label_keyboard_return);
        lv_obj_del(btn_keyboard_return);

        //addition_text_updata();
    }
}

static void button_keyboard_confirm_event_cb(lv_event_t* e)
{
    lv_event_code_t code;
    code = lv_event_get_code(e);
    if (code == LV_EVENT_CLICKED)
    {
        printf("button_keyboard_confirm_event_cb\n");
        buzzer_enable = 1;
        //获取输入框数据给到文本显示框
        lv_label_set_text(label_file_management_text_label, lv_textarea_get_text(textarea_text_keyboard));
        lv_label_set_text(label_file_management_label, lv_textarea_get_text(textarea_text_keyboard));
        lv_obj_set_style_text_opa(label_file_management_text_label, LV_OPA_COVER, LV_STATE_DEFAULT);
        lv_obj_del(textarea_bg_keyboard);
        lv_obj_del(pinyin_ime);
        lv_obj_del(textarea_text_keyboard);
        lv_obj_del(keyboard_bg);
        lv_obj_del(label_keyboard_confirm);
        lv_obj_del(btn_keyboard_confirm);
        lv_obj_del(label_keyboard_return);
        lv_obj_del(btn_keyboard_return);

        addition_text_updata();
    }
}

static void button_modification_text_keyboard_confirm_event_cb(lv_event_t* e)
{
    lv_event_code_t code;
    code = lv_event_get_code(e);
    if (code == LV_EVENT_CLICKED)
    {
        printf("button_modification_text_keyboard_confirm_event_cb\n");
        buzzer_enable = 1;
        //获取输入框数据给到文本显示框
        lv_label_set_text(label_file_management_text_label, lv_textarea_get_text(textarea_text_keyboard));
        lv_label_set_text(label_file_management_label, lv_textarea_get_text(textarea_text_keyboard));
        lv_obj_set_style_text_opa(label_file_management_text_label, LV_OPA_COVER, LV_STATE_DEFAULT);
        lv_obj_del(textarea_bg_keyboard);
        lv_obj_del(pinyin_ime);
        lv_obj_del(textarea_text_keyboard);
        lv_obj_del(keyboard_bg);
        lv_obj_del(label_keyboard_confirm);
        lv_obj_del(btn_keyboard_confirm);
        lv_obj_del(label_keyboard_return);
        lv_obj_del(btn_keyboard_return);

        //addition_text_updata();
    }
}


static void button_left_event_cb(lv_event_t* e)
{
    lv_event_code_t code;
    code = lv_event_get_code(e);
    if ((code == LV_EVENT_CLICKED)&&(print_status == 0))
    {
        printf("left\n");
        buzzer_enable = 1;
        if (temp_focused_obj != NULL)
        {
            lv_coord_t x = lv_obj_get_x(temp_focused_obj);
            printf("x=%d\n", x);
            if (x <= 0)
            {
                x = 0;
            }
            lv_obj_set_x(temp_focused_obj, x - 1);
            lv_obj_t* label = lv_obj_get_child(temp_focused_obj, 0);
            lv_obj_set_style_text_color(label, lv_color_hex(0xff0000), LV_PART_MAIN);
        }
    }
}

static void button_down_event_cb(lv_event_t* e)
{
    lv_event_code_t code;

    code = lv_event_get_code(e);
    if ((code == LV_EVENT_CLICKED)&&(print_status == 0))
    {
        printf("down\n");
         buzzer_enable = 1;
        if (temp_focused_obj != NULL)
        {
            lv_coord_t y = lv_obj_get_y(temp_focused_obj);
            printf("y=%d\n", y);
            if (y >= 160)
            {
                y = 160;
            }
            lv_obj_set_y(temp_focused_obj, y + 1);
            lv_obj_t* label = lv_obj_get_child(temp_focused_obj, 0);
            lv_obj_set_style_text_color(label, lv_color_hex(0xff0000), LV_PART_MAIN);
        }
    }
}

static void button_add_event_cb(lv_event_t* e)
{
    lv_event_code_t code;
    code = lv_event_get_code(e);
    uint32_t index;
    lv_point_t text_size;
    lv_font_t* temp_font = NULL;
    //char stringBuf[128] = { 0 };

    if ((code == LV_EVENT_CLICKED)&&(print_status == 0))
    {
        printf("add\n");
         buzzer_enable = 1;
        if (temp_focused_obj != NULL)
        {
            index = lv_obj_get_index(temp_focused_obj);

            printf("index=%u\n\r", index);
            printf("type=%u\n\r", data_structure[index].type);

            switch(data_structure[index].type)
            {
                case TYPE_WORD:
                case TYPE_SYMBOL:
                {
                    
                    if (data_structure[index].data.word.size < WORD_MAX_SIZE)
                    {
                        font_list_release(data_structure[index].data.word.typeface, data_structure[index].data.word.size, data_structure[index].data.word.italic_bold);
          
                        data_structure[index].data.word.size += 5;

                        if (data_structure[index].data.word.size >= WORD_MAX_SIZE)
                        {
                            data_structure[index].data.word.size = WORD_MAX_SIZE;
                        }
                        
                        //lv_ft_font_destroy(data_structure[index].data.word.info.font);
                    
                        //sprintf(stringBuf,"/media/%s", typeface_buf[data_structure[index].data.word.typeface]);
                        //data_structure[index].data.word.info.name = stringBuf;
                        //printf("%s\n\r", stringBuf);

                        data_structure[index].data.word.info.weight = data_structure[index].data.word.size;
                        data_structure[index].data.word.info.style = data_structure[index].data.word.italic_bold;

                        //lv_ft_font_init(&data_structure[index].data.word.info);
                        //lv_point_t text_size;
                        //lv_txt_get_size(&text_size, data_structure[index].data.word.text, data_structure[index].data.word.info.font, 0, 0, LV_COORD_MAX, LV_TEXT_FLAG_NONE);

                        printf("typeface=%d\n\r", data_structure[index].data.word.typeface);
                        temp_font = font_list_get(data_structure[index].data.word.typeface, data_structure[index].data.word.size, data_structure[index].data.word.info.style);
                        lv_txt_get_size(&text_size, data_structure[index].data.word.text, temp_font, data_structure[index].data.word.space, 0, LV_COORD_MAX, LV_TEXT_FLAG_NONE);  

                        printf("x=%u y=%u\n\r", text_size.x, text_size.y);

                        lv_obj_set_size(temp_focused_obj, text_size.x, text_size.y);
                        lv_obj_set_style_bg_opa(temp_focused_obj, LV_OPA_TRANSP, 0);
                        lv_obj_clear_flag(temp_focused_obj, LV_OBJ_FLAG_SCROLLABLE);
                        lv_obj_set_style_border_width(temp_focused_obj, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
                        lv_obj_t* label1 = lv_obj_get_child(temp_focused_obj, 0);         
                        lv_obj_remove_style(label1, &data_structure[index].data.word.style, 0);  
                        lv_style_reset(&data_structure[index].data.word.style);  
                        lv_style_init(&data_structure[index].data.word.style);
                        lv_style_set_text_font(&data_structure[index].data.word.style, temp_font);    
                        lv_obj_add_style(label1, &data_structure[index].data.word.style, 0);   
                        lv_obj_center(label1);
                        lv_obj_set_style_text_color(label1, lv_color_hex(0xff0000), LV_PART_MAIN);

                    }
                    else
                    {
                        data_structure[index].data.word.size = WORD_MAX_SIZE;

                        //lv_ft_font_destroy(data_structure[index].data.word.info.font);
                        //sprintf(stringBuf,"/media/%s", typeface_buf[data_structure[index].data.word.typeface]);
                        //data_structure[index].data.word.info.name = stringBuf;
                        //printf("%s\n\r", stringBuf);
                        data_structure[index].data.word.info.weight = data_structure[index].data.word.size;
                        data_structure[index].data.word.info.style = data_structure[index].data.word.italic_bold;

                        //lv_ft_font_init(&data_structure[index].data.word.info);
                        //lv_point_t text_size;
                        //lv_txt_get_size(&text_size, data_structure[index].data.word.text, data_structure[index].data.word.info.font, 0, 0, LV_COORD_MAX, LV_TEXT_FLAG_NONE);
                        printf("typeface=%d\n\r", data_structure[index].data.word.typeface);
                        temp_font = font_list_get(data_structure[index].data.word.typeface, data_structure[index].data.word.size, data_structure[index].data.word.info.style);
                        lv_txt_get_size(&text_size, data_structure[index].data.word.text, temp_font, data_structure[index].data.word.space, 0, LV_COORD_MAX, LV_TEXT_FLAG_NONE);  

                        printf("x=%u y=%u\n\r", text_size.x, text_size.y);

                        lv_obj_set_size(temp_focused_obj, text_size.x, text_size.y);
                        lv_obj_set_style_bg_opa(temp_focused_obj, LV_OPA_TRANSP, 0);
                        lv_obj_clear_flag(temp_focused_obj, LV_OBJ_FLAG_SCROLLABLE);
                        lv_obj_set_style_border_width(temp_focused_obj, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
                        lv_obj_t* label1 = lv_obj_get_child(temp_focused_obj, 0);
                        lv_style_reset(&data_structure[index].data.word.style);
                        lv_obj_remove_style(label1, &data_structure[index].data.word.style, 0);
                        lv_style_init(&data_structure[index].data.word.style);
                        lv_style_set_text_font(&data_structure[index].data.word.style, temp_font);
                        lv_obj_add_style(label1, &data_structure[index].data.word.style, 0);
                        lv_obj_center(label1);
                        lv_obj_set_style_text_color(label1, lv_color_hex(0xff0000), LV_PART_MAIN);
                    }

                    break;
                }
                case TYPE_DATE:
                {
                    if (data_structure[index].data.date_time.size < WORD_MAX_SIZE)
                    {
                        font_list_release(data_structure[index].data.date_time.typeface, data_structure[index].data.date_time.size, data_structure[index].data.date_time.italic_bold);

                        data_structure[index].data.date_time.size += 5;

                        if (data_structure[index].data.date_time.size >= WORD_MAX_SIZE)
                        {
                            data_structure[index].data.date_time.size = WORD_MAX_SIZE;
                        }
                        
                        //lv_ft_font_destroy(data_structure[index].data.date_time.info.font);

                        //sprintf(stringBuf,"/media/%s", typeface_buf[data_structure[index].data.date_time.typeface]);
                        //data_structure[index].data.date_time.info.name = stringBuf;
                        //printf("%s\n\r", stringBuf);
                        data_structure[index].data.date_time.info.weight = data_structure[index].data.date_time.size;
                        data_structure[index].data.date_time.info.style = data_structure[index].data.date_time.italic_bold;

                        //lv_ft_font_init(&data_structure[index].data.date_time.info);
                        //lv_point_t text_size;
                        //lv_txt_get_size(&text_size, data_structure[index].data.date_time.text, data_structure[index].data.date_time.info.font, 0, 0, LV_COORD_MAX, LV_TEXT_FLAG_NONE);
                        temp_font = font_list_get(data_structure[index].data.date_time.typeface, data_structure[index].data.date_time.size, data_structure[index].data.date_time.italic_bold);
                        lv_txt_get_size(&text_size, data_structure[index].data.date_time.text, temp_font, data_structure[index].data.date_time.space, 0, LV_COORD_MAX, LV_TEXT_FLAG_NONE);
                        printf("x=%u y=%u\n\r", text_size.x, text_size.y);

                        lv_obj_set_size(temp_focused_obj, text_size.x, text_size.y);
                        lv_obj_set_style_bg_opa(temp_focused_obj, LV_OPA_TRANSP, 0);
                        lv_obj_clear_flag(temp_focused_obj, LV_OBJ_FLAG_SCROLLABLE);
                        lv_obj_set_style_border_width(temp_focused_obj, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
                        lv_obj_t* label1 = lv_obj_get_child(temp_focused_obj, 0);
                        lv_obj_remove_style(label1, &data_structure[index].data.date_time.style, 0);
                        lv_style_reset(&data_structure[index].data.date_time.style);
                        lv_style_init(&data_structure[index].data.date_time.style);
                        lv_style_set_text_font(&data_structure[index].data.date_time.style, temp_font);
                        lv_obj_add_style(label1, &data_structure[index].data.date_time.style, 0);
                        lv_obj_center(label1);
                        lv_obj_set_style_text_color(label1, lv_color_hex(0xff0000), LV_PART_MAIN);
                    }
                    else
                    {
                        data_structure[index].data.date_time.size = WORD_MAX_SIZE;

                        //lv_ft_font_destroy(data_structure[index].data.date_time.info.font);
                        //sprintf(stringBuf,"/media/%s", typeface_buf[data_structure[index].data.date_time.typeface]);
                        //data_structure[index].data.date_time.info.name = stringBuf;
                        //printf("%s\n\r", stringBuf);
                        data_structure[index].data.date_time.info.weight = data_structure[index].data.date_time.size;
                        data_structure[index].data.date_time.info.style = data_structure[index].data.date_time.italic_bold;

                        //lv_ft_font_init(&data_structure[index].data.date_time.info);
                        //lv_point_t text_size;
                        //lv_txt_get_size(&text_size, data_structure[index].data.date_time.text, data_structure[index].data.date_time.info.font, 0, 0, LV_COORD_MAX, LV_TEXT_FLAG_NONE);
                        temp_font = font_list_get(data_structure[index].data.date_time.typeface, data_structure[index].data.date_time.size, data_structure[index].data.date_time.italic_bold);
                        lv_txt_get_size(&text_size, data_structure[index].data.date_time.text, temp_font, data_structure[index].data.date_time.space, 0, LV_COORD_MAX, LV_TEXT_FLAG_NONE);
                        printf("x=%u y=%u\n\r", text_size.x, text_size.y);

                        lv_obj_set_size(temp_focused_obj, text_size.x, text_size.y);
                        lv_obj_set_style_bg_opa(temp_focused_obj, LV_OPA_TRANSP, 0);
                        lv_obj_clear_flag(temp_focused_obj, LV_OBJ_FLAG_SCROLLABLE);
                        lv_obj_set_style_border_width(temp_focused_obj, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
                        lv_obj_t* label1 = lv_obj_get_child(temp_focused_obj, 0);
                        lv_obj_remove_style(label1, &data_structure[index].data.date_time.style, 0);
                        lv_style_reset(&data_structure[index].data.date_time.style);
                        lv_style_init(&data_structure[index].data.date_time.style);
                        lv_style_set_text_font(&data_structure[index].data.date_time.style, temp_font);
                        lv_obj_add_style(label1, &data_structure[index].data.date_time.style, 0);
                        lv_obj_center(label1);
                        lv_obj_set_style_text_color(label1, lv_color_hex(0xff0000), LV_PART_MAIN);
                    }                    
                    break;
                }
                case TYPE_COUNT:
                {
                    if (data_structure[index].data.count.size < WORD_MAX_SIZE)
                    {
                        font_list_release(data_structure[index].data.count.typeface, data_structure[index].data.count.size, 0);
                        data_structure[index].data.count.size += 5;

                        if (data_structure[index].data.count.size >= WORD_MAX_SIZE)
                        {
                            data_structure[index].data.count.size = WORD_MAX_SIZE;
                        }
                        
                        //lv_ft_font_destroy(data_structure[index].data.count.info.font);
                        //sprintf(stringBuf,"/media/%s", typeface_buf[data_structure[index].data.count.typeface]);
                        //data_structure[index].data.count.info.name = stringBuf;
                        //printf("%s\n\r", stringBuf);
                        data_structure[index].data.count.info.weight = data_structure[index].data.count.size;
                        //data_structure[index].data.count.info.style = data_structure[index].data.count.italic_bold;
                        //lv_ft_font_init(&data_structure[index].data.count.info);

                        temp_font = font_list_get(data_structure[index].data.count.typeface, data_structure[index].data.count.size, 0);
                        lv_obj_set_style_bg_opa(temp_focused_obj, LV_OPA_TRANSP, 0);
                        lv_obj_clear_flag(temp_focused_obj, LV_OBJ_FLAG_SCROLLABLE);
                        lv_obj_set_style_border_width(temp_focused_obj, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
                        lv_obj_t* label1 = lv_obj_get_child(temp_focused_obj, 0);
                        lv_txt_get_size(&text_size, lv_label_get_text(label1), temp_font, data_structure[index].data.count.space, 0, LV_COORD_MAX, LV_TEXT_FLAG_NONE);
                        printf("x=%u y=%u\n\r", text_size.x, text_size.y);
                        lv_obj_set_size(temp_focused_obj, text_size.x, text_size.y);
                        lv_obj_remove_style(label1, &data_structure[index].data.count.style, 0);

                        lv_style_init(&data_structure[index].data.count.style);
                        lv_style_set_text_font(&data_structure[index].data.count.style, temp_font);
                        lv_obj_add_style(label1, &data_structure[index].data.count.style, 0);
                        lv_obj_center(label1);
                        lv_obj_set_style_text_color(label1, lv_color_hex(0xff0000), LV_PART_MAIN);
                    }
                    else
                    {
                        data_structure[index].data.count.size = WORD_MAX_SIZE;

                        //lv_ft_font_destroy(data_structure[index].data.count.info.font);
                        //sprintf(stringBuf,"/media/%s", typeface_buf[data_structure[index].data.count.typeface]);
                        //data_structure[index].data.count.info.name = stringBuf;
                        //printf("%s\n\r", stringBuf);
                        data_structure[index].data.count.info.weight = data_structure[index].data.count.size;
                        //data_structure[index].data.count.info.style = data_structure[index].data.count.italic_bold;
                        //lv_ft_font_init(&data_structure[index].data.count.info);
                        temp_font = font_list_get(data_structure[index].data.count.typeface, data_structure[index].data.count.size, 0);
                        lv_obj_set_style_bg_opa(temp_focused_obj, LV_OPA_TRANSP, 0);
                        lv_obj_clear_flag(temp_focused_obj, LV_OBJ_FLAG_SCROLLABLE);
                        lv_obj_set_style_border_width(temp_focused_obj, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
                        lv_obj_t* label1 = lv_obj_get_child(temp_focused_obj, 0);
                        lv_txt_get_size(&text_size, lv_label_get_text(label1), temp_font, data_structure[index].data.count.space, 0, LV_COORD_MAX, LV_TEXT_FLAG_NONE);
                        printf("x=%u y=%u\n\r", text_size.x, text_size.y);
                        lv_obj_set_size(temp_focused_obj, text_size.x, text_size.y);
                        lv_obj_remove_style(label1, &data_structure[index].data.count.style, 0);
                        lv_style_init(&data_structure[index].data.count.style);
                        lv_style_set_text_font(&data_structure[index].data.count.style, data_structure[index].data.count.info.font);
                        lv_obj_add_style(label1, &data_structure[index].data.count.style, 0);
                        lv_obj_center(label1);
                        lv_obj_set_style_text_color(label1, lv_color_hex(0xff0000), LV_PART_MAIN);
                    }                      
                    break;
                }
                case TYPE_ICON:
                {
                    if( data_structure[index].data.icon.size >= 256)
                    {

                    }
                    else
                    {
                        data_structure[index].data.icon.size += 5;
                        if(data_structure[index].data.icon.size >= 256)
                        {
                            data_structure[index].data.icon.size = 256;
                        }

                        lv_obj_t* img_obj = lv_obj_get_child(temp_focused_obj,0);
                        lv_img_set_zoom(img_obj, data_structure[index].data.icon.size);

                        // 获取图片对象
                        lv_img_t* img_1 = (lv_img_t*)img_obj;

                        // 获取图片的源文件
                        lv_img_dsc_t* img_dsc = (lv_img_dsc_t*)img_1->src;

                        uint16_t zoom = lv_img_get_zoom(img_obj);

                        printf("header.w : %d, header.h: %d\n", img_dsc->header.w, img_dsc->header.h);

                        // 获取图片的宽和高
                        int width = img_dsc->header.w * zoom / 256;
                        int height = img_dsc->header.h * zoom / 256;

                        // 打印宽和高
                        printf("Image width: %d, height: %d\n", width, height);
                        lv_obj_set_size(temp_focused_obj, width, height);
                        lv_obj_align(temp_focused_obj, LV_ALIGN_OUT_TOP_LEFT, data_structure[index].x, data_structure[index].y); 
                    }
                    break;
                }
                case TYPE_PITCTURE:
                {

                    if( data_structure[index].data.picture.size >= 256)
                    {

                    }
                    else
                    {
                        data_structure[index].data.picture.size += 5;
                        if(data_structure[index].data.picture.size >= 256)
                        {
                            data_structure[index].data.picture.size = 256;
                        }

                        lv_obj_t* img_obj = lv_obj_get_child(temp_focused_obj,0);
                        lv_img_set_zoom(img_obj, data_structure[index].data.picture.size);

                        lv_img_cache_invalidate_src(lv_img_get_src(img_obj));  // 清除缓存
                        lv_obj_invalidate(img_obj);     // 强制重绘
                        lv_img_header_t header;
                        lv_res_t res = lv_img_decoder_get_info(lv_img_get_src(img_obj), &header);  // 直接传入文件路径

                        if (res == LV_RES_OK)
                        {
                            printf("PNG: %dx%d\n", header.w, header.h);
                        }
                        else
                        {
                            printf("error\n");
                        }

                        uint16_t zoom = lv_img_get_zoom(img_obj);
                        printf("zoom: %d\n", zoom);

                        int width = header.w * zoom / 256;
                        int height = header.h * zoom / 256;

                        // 打印宽和高
                        printf("Image width: %d, height: %d\n", width, height);
                        lv_obj_set_size(temp_focused_obj, width, height);
                        lv_obj_align(temp_focused_obj, LV_ALIGN_OUT_TOP_LEFT, data_structure[index].x, data_structure[index].y); 
                    }
                    break;
                }
                case TYPE_QR:
                case TYPE_BAR:
                {
                    if( data_structure[index].data.picture.size >= 256)
                    {

                    }
                    else
                    {
                        data_structure[index].data.qr_bar.size += 5;
                        if(data_structure[index].data.qr_bar.size >= 256)
                        {
                            data_structure[index].data.qr_bar.size = 256;
                        }

                        lv_obj_t* img_obj = lv_obj_get_child(temp_focused_obj,0);
                        lv_img_set_zoom(img_obj, data_structure[index].data.qr_bar.size);

                        lv_img_cache_invalidate_src(lv_img_get_src(img_obj));  // 清除缓存
                        lv_obj_invalidate(img_obj);     // 强制重绘
                        lv_img_header_t header;
                        lv_res_t res = lv_img_decoder_get_info(lv_img_get_src(img_obj), &header);  // 直接传入文件路径

                        if (res == LV_RES_OK)
                        {
                            printf("PNG: %dx%d\n", header.w, header.h);
                        }
                        else
                        {
                            printf("error\n");
                        }

                        uint16_t zoom = lv_img_get_zoom(img_obj);
                        printf("zoom: %d\n", zoom);

                        int width = header.w * zoom / 256;
                        int height = header.h * zoom / 256;

                        // 打印宽和高
                        printf("Image width: %d, height: %d\n", width, height);
                        lv_obj_set_size(temp_focused_obj, width, height);
                        lv_obj_align(temp_focused_obj, LV_ALIGN_OUT_TOP_LEFT, data_structure[index].x, data_structure[index].y); 
                    }
                    break;
                }
            }
        }
    }
}

static void button_reduce_event_cb(lv_event_t* e)
{
    lv_event_code_t code;
    uint32_t index;
    //char stringBuf[128] = { 0 };
    lv_font_t* temp_font = NULL;
    lv_point_t text_size;
 
   code = lv_event_get_code(e);
   if ((code == LV_EVENT_CLICKED)&&(print_status == 0))
   {
        printf("reduce\n");
        buzzer_enable = 1;
        if (temp_focused_obj != NULL)
        {
            index = lv_obj_get_index(temp_focused_obj);

            printf("index=%u\n\r", index);
            printf("type=%u\n\r", data_structure[index].type);
            switch(data_structure[index].type)
            {
                case TYPE_WORD:
                case TYPE_SYMBOL:
                {
                    if (data_structure[index].data.word.size > 10)
                    {
                        font_list_release(data_structure[index].data.word.typeface, data_structure[index].data.word.size, data_structure[index].data.word.italic_bold);
                        data_structure[index].data.word.size -= 5;

                        if (data_structure[index].data.word.size <= 10)
                        {
                            data_structure[index].data.word.size = 10;
                        }

                        //lv_ft_font_destroy(data_structure[index].data.word.info.font);
                        //sprintf(stringBuf, "/media/%s", typeface_buf[data_structure[index].data.word.typeface]);
                        //data_structure[index].data.word.info.name = stringBuf;
                        //printf("%s\n\r", stringBuf);
                        data_structure[index].data.word.info.weight = data_structure[index].data.word.size;
                        data_structure[index].data.word.info.style = data_structure[index].data.word.italic_bold;

                        //lv_ft_font_init(&data_structure[index].data.word.info);
                        //lv_point_t text_size;
                        //lv_txt_get_size(&text_size, data_structure[index].data.word.text, data_structure[index].data.word.info.font, 0, 0, LV_COORD_MAX, LV_TEXT_FLAG_NONE);

                        printf("typeface=%d\n\r", data_structure[index].data.word.typeface);
                        temp_font = font_list_get(data_structure[index].data.word.typeface, data_structure[index].data.word.size, data_structure[index].data.word.info.style);
                        lv_txt_get_size(&text_size, data_structure[index].data.word.text, temp_font, data_structure[index].data.word.space, 0, LV_COORD_MAX, LV_TEXT_FLAG_NONE);  

                        printf("x=%u y=%u\n\r", text_size.x, text_size.y);

                        lv_obj_set_size(temp_focused_obj, text_size.x, text_size.y);
                        lv_obj_set_style_bg_opa(temp_focused_obj, LV_OPA_TRANSP, 0);
                        lv_obj_clear_flag(temp_focused_obj, LV_OBJ_FLAG_SCROLLABLE);
                        lv_obj_set_style_border_width(temp_focused_obj, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
                        lv_obj_t* label1 = lv_obj_get_child(temp_focused_obj, 0);
                        lv_obj_remove_style(label1, &data_structure[index].data.word.style, 0);
                        lv_style_reset(&data_structure[index].data.word.style);
                        lv_style_init(&data_structure[index].data.word.style);
                        lv_style_set_text_font(&data_structure[index].data.word.style, temp_font);
                        lv_obj_add_style(label1, &data_structure[index].data.word.style, 0);
                        lv_obj_center(label1);
                        lv_obj_set_style_text_color(label1, lv_color_hex(0xff0000), LV_PART_MAIN);
                    }
                    else
                    {
                        data_structure[index].data.word.size = 10;

                        //lv_ft_font_destroy(data_structure[index].data.word.info.font);
                        //sprintf(stringBuf, "/media/%s", typeface_buf[data_structure[index].data.word.typeface]);
                        //data_structure[index].data.word.info.name = stringBuf;
                        //printf("%s\n\r", stringBuf);
                        data_structure[index].data.word.info.weight = data_structure[index].data.word.size;
                        data_structure[index].data.word.info.style = data_structure[index].data.word.italic_bold;

                        //lv_ft_font_init(&data_structure[index].data.word.info);
                        //lv_point_t text_size;
                        //lv_txt_get_size(&text_size, data_structure[index].data.word.text, data_structure[index].data.word.info.font, 0, 0, LV_COORD_MAX, LV_TEXT_FLAG_NONE);
       
                        printf("typeface=%d\n\r", data_structure[index].data.word.typeface);
                        temp_font = font_list_get(data_structure[index].data.word.typeface, data_structure[index].data.word.size, data_structure[index].data.word.info.style);
                        lv_txt_get_size(&text_size, data_structure[index].data.word.text, temp_font, data_structure[index].data.word.space, 0, LV_COORD_MAX, LV_TEXT_FLAG_NONE);  

                        printf("x=%u y=%u\n\r", text_size.x, text_size.y);

                        lv_obj_set_size(temp_focused_obj, text_size.x, text_size.y);
                        lv_obj_set_style_bg_opa(temp_focused_obj, LV_OPA_TRANSP, 0);
                        lv_obj_clear_flag(temp_focused_obj, LV_OBJ_FLAG_SCROLLABLE);
                        lv_obj_set_style_border_width(temp_focused_obj, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
                        lv_obj_t* label1 = lv_obj_get_child(temp_focused_obj, 0);
                        lv_obj_remove_style(label1, &data_structure[index].data.word.style, 0);
                        lv_style_reset(&data_structure[index].data.word.style);
                        lv_style_init(&data_structure[index].data.word.style);
                        lv_style_set_text_font(&data_structure[index].data.word.style, temp_font);
                        lv_obj_add_style(label1, &data_structure[index].data.word.style, 0);
                        lv_obj_center(label1);
                        lv_obj_set_style_text_color(label1, lv_color_hex(0xff0000), LV_PART_MAIN);
                    }

                    break;
                }
                case TYPE_DATE:
                {
                    if (data_structure[index].data.date_time.size > 12)
                    {
                        font_list_release(data_structure[index].data.date_time.typeface, data_structure[index].data.date_time.size, data_structure[index].data.date_time.italic_bold);

                        data_structure[index].data.date_time.size -= 5;

                        if (data_structure[index].data.date_time.size <= 12)
                        {
                            data_structure[index].data.date_time.size = 12;
                        }

                        //lv_ft_font_destroy(data_structure[index].data.date_time.info.font);
                        //sprintf(stringBuf, "/media/%s", typeface_buf[data_structure[index].data.date_time.typeface]);
                        //data_structure[index].data.date_time.info.name = stringBuf;
                        //printf("%s\n\r", stringBuf);
                        data_structure[index].data.date_time.info.weight = data_structure[index].data.date_time.size;
                        data_structure[index].data.date_time.info.style = data_structure[index].data.date_time.italic_bold;

                        //lv_ft_font_init(&data_structure[index].data.date_time.info);
                        //lv_point_t text_size;
                        //lv_txt_get_size(&text_size, data_structure[index].data.date_time.text, data_structure[index].data.date_time.info.font, 0, 0, LV_COORD_MAX, LV_TEXT_FLAG_NONE);
                        temp_font = font_list_get(data_structure[index].data.date_time.typeface, data_structure[index].data.date_time.size, data_structure[index].data.date_time.italic_bold);
                        lv_txt_get_size(&text_size, data_structure[index].data.date_time.text, temp_font,  data_structure[index].data.date_time.space, 0, LV_COORD_MAX, LV_TEXT_FLAG_NONE);
                        printf("x=%u y=%u\n\r", text_size.x, text_size.y);        
                        lv_obj_set_size(temp_focused_obj, text_size.x, text_size.y);
                        lv_obj_set_style_bg_opa(temp_focused_obj, LV_OPA_TRANSP, 0);
                        lv_obj_clear_flag(temp_focused_obj, LV_OBJ_FLAG_SCROLLABLE);
                        lv_obj_set_style_border_width(temp_focused_obj, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
                        lv_obj_t* label1 = lv_obj_get_child(temp_focused_obj, 0);
                        lv_obj_remove_style(label1, &data_structure[index].data.date_time.style, 0);
                        lv_style_reset(&data_structure[index].data.date_time.style);
                        lv_style_init(&data_structure[index].data.date_time.style);
                        lv_style_set_text_font(&data_structure[index].data.date_time.style, temp_font);
                        lv_obj_add_style(label1, &data_structure[index].data.date_time.style, 0);
                        lv_obj_center(label1);
                        lv_obj_set_style_text_color(label1, lv_color_hex(0xff0000), LV_PART_MAIN);
                    }
                    else
                    {
                        data_structure[index].data.date_time.size = 12;

                        //lv_ft_font_destroy(data_structure[index].data.date_time.info.font);
                        //sprintf(stringBuf, "/media/%s", typeface_buf[data_structure[index].data.date_time.typeface]);
                        //data_structure[index].data.date_time.info.name = stringBuf;
                        //printf("%s\n\r", stringBuf);
                        data_structure[index].data.date_time.info.weight = data_structure[index].data.date_time.size;
                        data_structure[index].data.date_time.info.style = data_structure[index].data.date_time.italic_bold;

                        //lv_ft_font_init(&data_structure[index].data.date_time.info);
                        //lv_point_t text_size;
                        //lv_txt_get_size(&text_size, data_structure[index].data.date_time.text, data_structure[index].data.date_time.info.font, 0, 0, LV_COORD_MAX, LV_TEXT_FLAG_NONE);
                        temp_font = font_list_get(data_structure[index].data.date_time.typeface, data_structure[index].data.date_time.size, data_structure[index].data.date_time.italic_bold);
                        lv_txt_get_size(&text_size, data_structure[index].data.date_time.text, temp_font,  data_structure[index].data.date_time.space, 0, LV_COORD_MAX, LV_TEXT_FLAG_NONE); 
                        printf("x=%u y=%u\n\r", text_size.x, text_size.y);

                        lv_obj_set_size(temp_focused_obj, text_size.x, text_size.y);
                        lv_obj_set_style_bg_opa(temp_focused_obj, LV_OPA_TRANSP, 0);
                        lv_obj_clear_flag(temp_focused_obj, LV_OBJ_FLAG_SCROLLABLE);
                        lv_obj_set_style_border_width(temp_focused_obj, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
                        lv_obj_t* label1 = lv_obj_get_child(temp_focused_obj, 0);
                        lv_obj_remove_style(label1, &data_structure[index].data.date_time.style, 0);
                        lv_style_reset(&data_structure[index].data.date_time.style);
                        lv_style_init(&data_structure[index].data.date_time.style);
                        lv_style_set_text_font(&data_structure[index].data.date_time.style, temp_font);
                        lv_obj_add_style(label1, &data_structure[index].data.date_time.style, 0);
                        lv_obj_center(label1);
                        lv_obj_set_style_text_color(label1, lv_color_hex(0xff0000), LV_PART_MAIN);
                    }                   
                    break;
                }
                case TYPE_COUNT:
                {
                    if (data_structure[index].data.count.size > 12)
                    {
                        font_list_release(data_structure[index].data.count.typeface, data_structure[index].data.count.size, 0);
                        data_structure[index].data.count.size -= 5;

                        if (data_structure[index].data.count.size <= 12)
                        {
                            data_structure[index].data.count.size = 12;
                        }

                        //lv_ft_font_destroy(data_structure[index].data.count.info.font);
                        //sprintf(stringBuf, "/media/%s", typeface_buf[data_structure[index].data.count.typeface]);
                        //data_structure[index].data.count.info.name = stringBuf;
                        //printf("%s\n\r", stringBuf);
                        data_structure[index].data.count.info.weight = data_structure[index].data.count.size;
                        //data_structure[index].data.count.info.style = data_structure[index].data.count.italic_bold;

                        //lv_ft_font_init(&data_structure[index].data.count.info);
                        temp_font = font_list_get(data_structure[index].data.count.typeface, data_structure[index].data.count.size, 0);

                        lv_obj_set_style_bg_opa(temp_focused_obj, LV_OPA_TRANSP, 0);
                        lv_obj_clear_flag(temp_focused_obj, LV_OBJ_FLAG_SCROLLABLE);
                        lv_obj_set_style_border_width(temp_focused_obj, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
                        lv_obj_t* label1 = lv_obj_get_child(temp_focused_obj, 0);
                        lv_txt_get_size(&text_size, lv_label_get_text(label1), temp_font, data_structure[index].data.count.space, 0, LV_COORD_MAX, LV_TEXT_FLAG_NONE);
                        printf("x=%u y=%u\n\r", text_size.x, text_size.y);
                        lv_obj_set_size(temp_focused_obj, text_size.x, text_size.y);
                        lv_obj_remove_style(label1, &data_structure[index].data.count.style, 0);
                        lv_style_init(&data_structure[index].data.count.style);
                        lv_style_set_text_font(&data_structure[index].data.count.style, temp_font);
                        lv_obj_add_style(label1, &data_structure[index].data.count.style, 0);
                        lv_obj_center(label1);
                        lv_obj_set_style_text_color(label1, lv_color_hex(0xff0000), LV_PART_MAIN);
                    }
                    else
                    {
                        data_structure[index].data.count.size = 12;

                        //lv_ft_font_destroy(data_structure[index].data.count.info.font);
                        //sprintf(stringBuf, "/media/%s", typeface_buf[data_structure[index].data.count.typeface]);
                        //data_structure[index].data.count.info.name = stringBuf;
                        //printf("%s\n\r", stringBuf);
                        data_structure[index].data.count.info.weight = data_structure[index].data.count.size;
                        //data_structure[index].data.count.info.style = data_structure[index].data.count.italic_bold;

                        //lv_ft_font_init(&data_structure[index].data.count.info);
                        temp_font = font_list_get(data_structure[index].data.count.typeface, data_structure[index].data.count.size, 0);

                        lv_obj_set_style_bg_opa(temp_focused_obj, LV_OPA_TRANSP, 0);
                        lv_obj_clear_flag(temp_focused_obj, LV_OBJ_FLAG_SCROLLABLE);
                        lv_obj_set_style_border_width(temp_focused_obj, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
                        lv_obj_t* label1 = lv_obj_get_child(temp_focused_obj, 0);
                        lv_txt_get_size(&text_size, lv_label_get_text(label1), temp_font, data_structure[index].data.count.space, 0, LV_COORD_MAX, LV_TEXT_FLAG_NONE);
                        printf("x=%u y=%u\n\r", text_size.x, text_size.y);
                        lv_obj_set_size(temp_focused_obj, text_size.x, text_size.y);
                        lv_obj_remove_style(label1, &data_structure[index].data.count.style, 0);
                        lv_style_init(&data_structure[index].data.count.style);
                        lv_style_set_text_font(&data_structure[index].data.count.style, temp_font);
                        lv_obj_add_style(label1, &data_structure[index].data.count.style, 0);
                        lv_obj_center(label1);
                        lv_obj_set_style_text_color(label1, lv_color_hex(0xff0000), LV_PART_MAIN);
                    }                   
                    break;
                }
                case TYPE_ICON:
                {
                    if( data_structure[index].data.icon.size <= 128)
                    {

                    }
                    else
                    {
                        data_structure[index].data.icon.size -= 5;
                        if(data_structure[index].data.icon.size <= 128)
                        {
                            data_structure[index].data.icon.size = 128;
                        }

                        lv_obj_t* img_obj = lv_obj_get_child(temp_focused_obj,0);
                        lv_img_set_zoom(img_obj, data_structure[index].data.icon.size);


                        // 获取图片对象
                        lv_img_t* img_1 = (lv_img_t*)img_obj;

                        // 获取图片的源文件
                        lv_img_dsc_t* img_dsc = (lv_img_dsc_t*)img_1->src;

                        uint16_t zoom = lv_img_get_zoom(img_obj);

                        printf("header.w : %d, header.h: %d\n", img_dsc->header.w, img_dsc->header.h);

                        // 获取图片的宽和高
                        int width = img_dsc->header.w * zoom / 256;
                        int height = img_dsc->header.h * zoom / 256;

                        // 打印宽和高
                        printf("Image width: %d, height: %d\n", width, height);
                        lv_obj_set_size(temp_focused_obj, width, height);
                        lv_obj_align(temp_focused_obj, LV_ALIGN_OUT_TOP_LEFT, data_structure[index].x, data_structure[index].y); 
                    }
                    break;
                }
                case TYPE_PITCTURE:
                {
                    printf("size=%u\n\r", data_structure[index].data.picture.size);

                    if( data_structure[index].data.picture.size <= 128)
                    {

                    }
                    else
                    {
                        data_structure[index].data.picture.size -= 5;
                        if(data_structure[index].data.picture.size <= 128)
                        {
                            data_structure[index].data.picture.size = 128;
                        }

                        lv_obj_t* img_obj = lv_obj_get_child(temp_focused_obj,0);
                        lv_img_set_zoom(img_obj, data_structure[index].data.picture.size);

                        lv_img_cache_invalidate_src(lv_img_get_src(img_obj));  // 清除缓存
                        lv_obj_invalidate(img_obj);     // 强制重绘
                        lv_img_header_t header;
                        lv_res_t res = lv_img_decoder_get_info(lv_img_get_src(img_obj), &header);  // 直接传入文件路径

                        if (res == LV_RES_OK)
                        {
                            printf("PNG: %dx%d\n", header.w, header.h);
                        }
                        else
                        {
                            printf("error\n");
                        }

                        uint16_t zoom = lv_img_get_zoom(img_obj);
                        printf("zoom: %d\n", zoom);

                        int width = header.w * zoom / 256;
                        int height = header.h * zoom / 256;

                        // 打印宽和高
                        printf("Image width: %d, height: %d\n", width, height);

                        lv_obj_set_size(temp_focused_obj, width, height);
                        lv_obj_align(temp_focused_obj, LV_ALIGN_OUT_TOP_LEFT, data_structure[index].x, data_structure[index].y); 
                    }
                    break;
                }
                case TYPE_QR:
                case TYPE_BAR:
                {
                    if( data_structure[index].data.qr_bar.size <= 128)
                    {

                    }
                    else
                    {
                        data_structure[index].data.qr_bar.size -= 5;
                        if(data_structure[index].data.qr_bar.size <= 128)
                        {
                            data_structure[index].data.qr_bar.size = 128;
                        }

                        lv_obj_t* img_obj = lv_obj_get_child(temp_focused_obj,0);
                        lv_img_set_zoom(img_obj, data_structure[index].data.qr_bar.size);
                        lv_obj_center(img_obj);

                        lv_img_cache_invalidate_src(lv_img_get_src(img_obj));  // 清除缓存
                        lv_obj_invalidate(img_obj);     // 强制重绘
                        lv_img_header_t header;
                        lv_res_t res = lv_img_decoder_get_info(lv_img_get_src(img_obj), &header);  // 直接传入文件路径

                        if (res == LV_RES_OK)
                        {
                            printf("PNG: %dx%d\n", header.w, header.h);
                        }
                        else
                        {
                            printf("error\n");
                        }

                        uint16_t zoom = lv_img_get_zoom(img_obj);
                        printf("zoom: %d\n", zoom);

                        int width = header.w * zoom / 256;
                        int height = header.h * zoom / 256;

                        // 打印宽和高
                        printf("Image width: %d, height: %d\n", width, height);

                        lv_obj_set_size(temp_focused_obj, width, height);
                        lv_obj_align(temp_focused_obj, LV_ALIGN_OUT_TOP_LEFT, data_structure[index].x, data_structure[index].y); 
                    }                  
                    break;
                }
            }
        }
    }
}


static void button_ack_event_handler(lv_event_t* e)
{
    lv_event_code_t code;
    code = lv_event_get_code(e);
    if (code == LV_EVENT_CLICKED)
    {
        printf("button_ack_event_handler\n");
        lv_obj_del(Ink_cartridge_error_content);
        lv_obj_del(Ink_cartridge_error_win);
        print_status = 0;
    }
}


static void Ink_cartridge_error_prompt_window(void)
{
    print_status = 1;

    Ink_cartridge_error_win = lv_obj_create(lv_scr_act());
    lv_obj_align(Ink_cartridge_error_win, LV_ALIGN_TOP_LEFT, 90, 80);
    lv_obj_set_size(Ink_cartridge_error_win, 300, 40);
    lv_obj_set_style_bg_color(Ink_cartridge_error_win, lv_color_hex(0x1e90ff), LV_STATE_DEFAULT);
    lv_obj_set_style_bg_opa(Ink_cartridge_error_win, LV_OPA_COVER, LV_STATE_DEFAULT);
    lv_obj_set_style_border_width(Ink_cartridge_error_win, 1, LV_STATE_DEFAULT); /* 设置边框宽度 */
    lv_obj_set_style_border_color(Ink_cartridge_error_win, lv_color_hex(0xcccccc), LV_STATE_DEFAULT); /* 设置边框颜色 */
    lv_obj_clear_flag(Ink_cartridge_error_win, LV_OBJ_FLAG_SCROLLABLE);
    lv_obj_set_style_radius(Ink_cartridge_error_win, 0, LV_STATE_DEFAULT); /* 设置圆角 */

    LV_FONT_DECLARE(heiFont16_1);
    label_warning = lv_label_create(Ink_cartridge_error_win);
    lv_obj_set_style_text_font(label_warning, &heiFont16_1, LV_STATE_DEFAULT);
    lv_obj_set_style_text_color(label_warning, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
    lv_label_set_text(label_warning, "警告");
    lv_obj_align(label_warning, LV_ALIGN_TOP_LEFT, 120, 0);


    Ink_cartridge_error_content = lv_obj_create(lv_scr_act());
    lv_obj_align(Ink_cartridge_error_content, LV_ALIGN_TOP_LEFT, 90, 120);
    lv_obj_set_size(Ink_cartridge_error_content, 300, 80);
    lv_obj_set_style_bg_color(Ink_cartridge_error_content, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
    lv_obj_set_style_bg_opa(Ink_cartridge_error_content, LV_OPA_COVER, LV_STATE_DEFAULT);
    lv_obj_set_style_border_width(Ink_cartridge_error_content, 1, LV_STATE_DEFAULT); /* 设置边框宽度 */
    lv_obj_set_style_border_color(Ink_cartridge_error_content, lv_color_hex(0xcccccc), LV_STATE_DEFAULT); /* 设置边框颜色 */
    lv_obj_clear_flag(Ink_cartridge_error_content, LV_OBJ_FLAG_SCROLLABLE);
    lv_obj_set_style_radius(Ink_cartridge_error_content, 0, LV_STATE_DEFAULT); /* 设置圆角 */


    LV_FONT_DECLARE(heiFont16_1);
    label_warning_content = lv_label_create(Ink_cartridge_error_content);
    lv_obj_set_style_text_font(label_warning_content, &heiFont16_1, LV_STATE_DEFAULT);
    lv_obj_set_style_text_color(label_warning_content, lv_color_hex(0x000000), LV_STATE_DEFAULT);
    lv_label_set_text(label_warning_content, "墨盒识别失败，请更换墨盒再试！");
    lv_obj_align(label_warning_content, LV_ALIGN_TOP_LEFT, 20, -5);


    button_ack = lv_btn_create(Ink_cartridge_error_content);
    lv_obj_add_event_cb(button_ack, button_ack_event_handler, LV_EVENT_ALL, NULL);
    lv_obj_align(button_ack, LV_ALIGN_TOP_LEFT, 100, 20);

    button_ack_label = lv_label_create(button_ack);
    lv_obj_set_style_text_font(button_ack_label, &heiFont16_1, LV_STATE_DEFAULT);
    lv_label_set_text(button_ack_label, "确定");
    lv_obj_center(button_ack_label);

}


static void button_print_event_cb(lv_event_t* e)
{
    lv_event_code_t code;
    int retvalue;
    unsigned char databuf[20]={0};
    code = lv_event_get_code(e);
    int i;
    unsigned char *p = NULL;
    unsigned int total_output_error;
    //int num;
    unsigned char crc;

    //unsigned char* pdata = NULL;
    //unsigned char* pdata1 = NULL;
    //unsigned char* pdata2 = NULL;
    //unsigned char data = 0;
    //int i, j;
    //static lv_img_dsc_t* snapshot = NULL;
    //unsigned int x1, y1, x2, y2,flag;

    if(code == LV_EVENT_CLICKED)
    {
        buzzer_enable = 1;

        if (print_status == 0)
        {
            printf("\n****************************************\n");
            printf("printing\n");
            print_status = 1;
            
            if(read_card_info_result == 1)
            {
                total_output_last = system_data.total_output;
            }

            if(g_authorization.device_id == g_sd_serial)
            {
                if(g_authorization.locked_state == 1)
                {
                    read_writer_rtc_enable = 0;

                    memset(databuf,0,sizeof(databuf));
                    databuf[0] = 0x04;
                    
                    retvalue = read(fd_rc522, databuf, 16);
                    if(retvalue < 0)
                    {
                        printf("fd_rc522 Failed!\r\n");
                        //close(fd_bm8563);
                        read_card_info_result = 0;
                    }
                    else
                    {
                        printf("读卡密文\n\r");
                        for(i=0;i<16;i++)
                        {
                            printf("0x%x ",databuf[i]);
                        }
                        printf("\n\r");

                        memset(msg, 0, MSG_SIZE);
                        memset(&context, 0, sizeof(context));
                        AES_set_key(&context, key, iv, AES_MODE_128);

                        AES_convert_key(&context);
                        memset((char *)&card_info_newest,0,sizeof(card_info_newest));
                        AES_cbc_decrypt(&context, databuf, (unsigned char *)&card_info_newest, MSG_SIZE);

                        p = (unsigned char *)&card_info_newest;
                        printf("读卡明文\n\r");
                        for(i=0;i<16;i++)
                        {
                            printf("0x%x ",*(p+i));
                        }
                        printf("\n\r");

                        crc =  CRC8(p,16);
                        if(crc == card_info_newest.crc)
                        {
                            printf("databuf ok\n");
                            read_card_info_result = 1;
                        }
                        else
                        {
                            read_card_info_result = 0;
                        }
                    }

                    read_writer_rtc_enable = 1;

                    if((card_info_newest.machine_model == g_authorization.machine_model)&&(read_card_info_result == 1))
                    {
                        LV_IMG_DECLARE(print_2);
                        lv_imgbtn_set_src(imgbtn_print, LV_IMGBTN_STATE_RELEASED, NULL, &print_2, NULL);
                        lv_obj_set_size(imgbtn_print, print_2.header.w, print_2.header.h);
                        lv_obj_align(imgbtn_print, LV_ALIGN_TOP_LEFT, 425, 207);

                        LV_FONT_DECLARE(heiFont16_1);
                        lv_obj_set_style_text_font(label_print, &heiFont16_1, LV_STATE_DEFAULT);
                        lv_obj_set_style_text_color(label_print, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
                        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
                        {
                            lv_label_set_text(label_print,  "打印中");
                        }
                        else if(system_data.system.language == LANGUAGE_ENGLISH)
                        {
                            lv_label_set_text(label_print, "Printing");
                        }
                        lv_obj_align(label_print, LV_ALIGN_TOP_LEFT, 425, 251);

                        print_button_enable = 1;
                    }
                    else
                    {
                        printf("card_info.machine_model != authorization.machine_model\n");
                        Ink_cartridge_error_prompt_window();
                    }
                }
                else if(g_authorization.locked_state == 2)
                {
                    LV_IMG_DECLARE(print_2);
                    lv_imgbtn_set_src(imgbtn_print, LV_IMGBTN_STATE_RELEASED, NULL, &print_2, NULL);
                    lv_obj_set_size(imgbtn_print, print_2.header.w, print_2.header.h);
                    lv_obj_align(imgbtn_print, LV_ALIGN_TOP_LEFT, 425, 207);

                    LV_FONT_DECLARE(heiFont16_1);
                    lv_obj_set_style_text_font(label_print, &heiFont16_1, LV_STATE_DEFAULT);
                    lv_obj_set_style_text_color(label_print, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
                    if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
                    {
                        lv_label_set_text(label_print,  "打印中");
                    }
                    else if(system_data.system.language == LANGUAGE_ENGLISH)
                    {
                        lv_label_set_text(label_print, "Printing");
                    }
                    lv_obj_align(label_print, LV_ALIGN_TOP_LEFT, 425, 251);

                    print_button_enable = 1;
                }
            }
            else
            {
                printf("id error\n");
                printf("device_id=0x%08x\n\r",g_authorization.device_id);
                printf("g_sd_serial=0x%08x\n\r",g_sd_serial);
            }
        }
        else if(read_card_info_result == 1)
        {
            printf("print\n");
            print_status = 0;
            LV_IMG_DECLARE(print);
            lv_imgbtn_set_src(imgbtn_print, LV_IMGBTN_STATE_RELEASED, NULL, &print, NULL);
            lv_obj_set_size(imgbtn_print, print.header.w, print.header.h);
            lv_obj_align(imgbtn_print, LV_ALIGN_TOP_LEFT, 425, 207);

            LV_FONT_DECLARE(heiFont16_1);
            lv_obj_set_style_text_font(label_print, &heiFont16_1, LV_STATE_DEFAULT);
            lv_obj_set_style_text_color(label_print, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
            if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
            {
                lv_label_set_text(label_print,  "打印");
            }
            else if(system_data.system.language == LANGUAGE_ENGLISH)
            {
                lv_label_set_text(label_print, "Print");
            }
            lv_obj_align(label_print, LV_ALIGN_TOP_LEFT, 428, 251);

            total_output_error = system_data.total_output - total_output_last;

            printf("total_output_error=%u\n\r",total_output_error);
            printf("total_output=%u\n\r",system_data.total_output);
            printf("total_output_last=%u\n\r",total_output_last);

            if(total_output_error > 0)
            {
                set_system_data();

                if(g_authorization.locked_state == 1)
                {
                    read_writer_rtc_enable = 0;

                    memset(databuf,0,sizeof(databuf));
                    databuf[0] = 0x04;
                    
                    retvalue = read(fd_rc522, databuf, 16);
                    if(retvalue < 0)
                    {
                        printf("fd_rc522 Failed!\r\n");
                        //close(fd_bm8563);
                        read_card_info_result = 0;
                    }
                    else
                    {
                        printf("读卡密文\n\r");
                        for(i=0;i<16;i++)
                        {
                            printf("0x%x ",databuf[i]);
                        }
                        printf("\n\r");

                        memset(msg, 0, MSG_SIZE);
                        memset(&context, 0, sizeof(context));
                        AES_set_key(&context, key, iv, AES_MODE_128);

                        AES_convert_key(&context);
                        memset((char *)&card_info_newest,0,sizeof(card_info_newest));
                        AES_cbc_decrypt(&context, databuf, (unsigned char *)&card_info_newest, MSG_SIZE);

                        p = (unsigned char *)&card_info_newest;
                        printf("读卡明文\n\r");
                        for(i=0;i<16;i++)
                        {
                            printf("0x%x ",*(p+i));
                        }
                        printf("\n\r");

                        crc =  CRC8(p,16);
                        if(crc == card_info_newest.crc)
                        {
                            printf("databuf ok\n");
                            read_card_info_result = 1;
                        }
                        else
                        {
                            read_card_info_result = 0;
                        }
                    }

                    read_writer_rtc_enable = 1;

                    if((card_info_newest.machine_model == g_authorization.machine_model)&&(read_card_info_result == 1))
                    {

                        card_info_newest.count += total_output_error;

                        printf("count=%u\n\r",card_info_newest.count);

                        read_writer_rtc_enable = 0;
        
                        card_info_newest.rtc_time.year = g_system_time[0];
                        card_info_newest.rtc_time.month = g_system_time[1];
                        card_info_newest.rtc_time.day = g_system_time[2];
                        card_info_newest.rtc_time.hour = g_system_time[3];
                        card_info_newest.rtc_time.minute =  g_system_time[4];
                        card_info_newest.rtc_time.second = g_system_time[5];
                        card_info_newest.crc = CRC8((unsigned char *)&card_info_newest,16);

                        memset(msg, 0, MSG_SIZE);
                        memset(&context, 0, sizeof(context));
                        AES_set_key(&context, key, iv, AES_MODE_128);

                        memcpy(msg, (unsigned char *)&card_info_newest, MSG_SIZE);

                        printf("写卡明文:\r\n");
                        for(i=0;i<16;i++)
                        {
                            printf("0x%x ",msg[i]);
                        }

                        printf("\n\r");

                        AES_set_key(&context, key, iv, AES_MODE_128);
                        AES_cbc_encrypt(&context, msg, out, MSG_SIZE);

                        printf("写卡密文:\r\n");
                        for(i=0;i<16;i++)
                        {
                            printf("0x%x ",out[i]);
                        }

                        printf("\n\r");

                        databuf[0] = 0x03;
                        memcpy(databuf+1,out,16);

                        /* 向/dev/beep文件写入数据 */
                        retvalue = write(fd_rc522, databuf, 17);
                        if(retvalue < 0)
                        {
                            printf("write fd_rc522 Failed!\r\n");
                            read_card_info_result = 0;
                        }
                        else
                        {
                            memset(databuf,0,sizeof(databuf));
                            databuf[0] = 0x04;
                            
                            retvalue = read(fd_rc522, databuf, 16);
                            if(retvalue < 0)
                            {
                                printf("fd_rc522 Failed!\r\n");
                                //close(fd_bm8563);
                                read_card_info_result = 0;
                            }
                            else
                            {
                                printf("读卡密文:\r\n");
                                for(i=0;i<16;i++)
                                {
                                    printf("0x%x ",databuf[i]);
                                }
                                printf("\n\r");

                                memset(msg, 0, MSG_SIZE);
                                memset(&context, 0, sizeof(context));
                                AES_set_key(&context, key, iv, AES_MODE_128);

                                CARD_INFORMATION card_info;

                                AES_convert_key(&context);
                                AES_cbc_decrypt(&context, databuf, (unsigned char *)&card_info, MSG_SIZE);

                                p = (unsigned char *)&card_info;

                                printf("读卡明文:\r\n");
                                for(i=0;i<16;i++)
                                {
                                    printf("0x%x ",*(p+i));
                                }
                                printf("\n\r");
                                
                                crc =  CRC8(p,16);
                                if(card_info.crc == crc)
                                {
                                    printf("databuf ok\n");
                                    read_card_info_result = 1;
                                }
                                else
                                {
                                    printf("crc error crc=0x%x\n\r",crc);             
                                    read_card_info_result = 0;
                                }
                            }
                        }
                    }     
                }
                else if(g_authorization.locked_state == 2)
                {
    
                }

                read_writer_rtc_enable = 1;
            }

            print_button_enable = 4;

        }
    }
}

static void button_right_event_cb(lv_event_t* e)
{
    lv_event_code_t code;
    code = lv_event_get_code(e);
    if ((code == LV_EVENT_CLICKED)&& (print_status == 0))
    {
        printf("right\n");
        buzzer_enable = 1;
        if (temp_focused_obj != NULL)
        {
            lv_coord_t x = lv_obj_get_x(temp_focused_obj);
            printf("x=%d\n",x);
            if (x >= 1024)
            {
                x = 1024;
            }
            lv_obj_set_x(temp_focused_obj, x + 1);
            lv_obj_t* label = lv_obj_get_child(temp_focused_obj, 0);
            lv_obj_set_style_text_color(label, lv_color_hex(0xff0000), LV_PART_MAIN);
        }
    }
}

static void button_up_event_cb(lv_event_t* e)
{
    lv_event_code_t code;
    code = lv_event_get_code(e);
    if ((code == LV_EVENT_CLICKED)&&(print_status == 0))
    {
        printf("up\n");
        buzzer_enable = 1;
        if (temp_focused_obj != NULL)
        {
            lv_coord_t y = lv_obj_get_y(temp_focused_obj);
            printf("y=%d\n", y);
            if (y < 0)
            {
                y = 0;
            }
            lv_obj_set_y(temp_focused_obj, y - 1);
            lv_obj_t* label = lv_obj_get_child(temp_focused_obj, 0);
            lv_obj_set_style_text_color(label, lv_color_hex(0xff0000), LV_PART_MAIN);
        }
    }
}


// 函数：去掉 .dat 后缀，结果通过指针输出
void remove_dat_suffix(const char *filename, char *output) 
{
    size_t length = 0;
    if (filename != NULL) 
    {
        // 获取字符串长度
        length = strlen(filename);

        // 检查字符串是否以 .dat 结尾
        if (length > 4 && strcmp(filename + length - 4, ".dat") == 0) 
        {
            // 去掉 .dat 后缀，复制到输出参数
            //strncpy(output, filename, length - 4);
            snprintf(output, 128, "%.*s", (int)(length - 4), filename);
            output[length - 4] = '\0'; // 确保字符串以 \0 结尾
        } 
        else 
        {
            // 如果不是以 .dat 结尾，直接复制原字符串
            strcpy(output, filename);
        }

    } 
    else 
    {
        printf("Filename is NULL!");
    }
}


static void btn_file_delete_event_cb(lv_event_t* e)
{
    lv_event_code_t code;
    char file_name[100]={0};
    //char image_name[128]={0};
    code = lv_event_get_code(e);
    if (code == LV_EVENT_CLICKED)
    {
        printf("btn_file_delete_event_cb\n");

        buzzer_enable = 1;

        if(g_file_num > 0)
        {
            //删除选中的文件，重新新建表格
            sprintf(file_name, "/media/file/%s", lv_table_get_cell_value(table_addition_picture_1, g_row, 0));
            if (unlink(file_name) == -1)
            {
                perror("unlink");
            }

            // 获取表格的行数和列数
            uint16_t row_cnt = lv_table_get_row_cnt(table_addition_picture_1);
            uint16_t col_cnt = lv_table_get_col_cnt(table_addition_picture_1);

            // 将选中行下方的所有行上移
            for (uint16_t r = g_row; r < row_cnt - 1; r++)
            {
                for (uint16_t c = 0; c < col_cnt; c++)
                {
                    const char* value = lv_table_get_cell_value(table_addition_picture_1, r + 1, c);
                    lv_table_set_cell_value(table_addition_picture_1, r, c, value);
                }
            }

            // 删除最后一行
            lv_table_set_row_cnt(table_addition_picture_1, row_cnt - 1);

            // 刷新表格
            lv_obj_invalidate(table_addition_picture_1);  // 刷新表格，触发重绘

#if 0
            memset(file_name,0,sizeof(file_name)); 
            remove_dat_suffix(lv_table_get_cell_value(table_addition_picture_1, g_row, 0),file_name);

            printf("%s\n\r", lv_table_get_cell_value(table_addition_picture_1,g_row,0));
            sprintf(image_name,"/media/img/%s.bmp", file_name);

            if (unlink(image_name) == -1)
            {
                perror("unlink");
            }
#endif

            g_file_num--;
        }
    }
}


static void btn_file_open_event_cb(lv_event_t* e)
{
    lv_event_code_t code;
    code = lv_event_get_code(e);
    if (code == LV_EVENT_CLICKED)
    {
        printf("btn_file_open_event_cb\n");
    }
}

#if 0
static void button_file_keyboard_return_event_cb(lv_event_t* e)
{
    lv_event_code_t code;
    code = lv_event_get_code(e);
    if (code == LV_EVENT_CLICKED)
    {
        buzzer_enable = 1;
        printf("button_file_keyboard_return_event_cb\n");
        lv_obj_del(textarea_bg_keyboard);
        lv_obj_del(pinyin_ime);
        lv_obj_del(textarea_text_keyboard);
        lv_obj_del(keyboard_bg);
        lv_obj_del(label_keyboard_confirm);
        lv_obj_del(btn_keyboard_confirm);
        lv_obj_del(label_keyboard_return);
        lv_obj_del(btn_keyboard_return);
    }
}
#endif

static void imgbtn_file_return_event_cb(lv_event_t* e)
{
    lv_event_code_t code;
    code = lv_event_get_code(e);
    if (code == LV_EVENT_CLICKED)
    {
        buzzer_enable = 1;
        printf("imgbtn_file_return_event_cb\n");
        lv_obj_del(obj_addition_picture_head_bg);
        lv_obj_del(label_addition_picture_head);
        //lv_obj_del(obj_addition_picture_preview_bg);
        lv_obj_del(table_addition_picture);
        lv_obj_del(win_content_typeface);   
        lv_obj_del(typeface_slider_bg);   
        lv_obj_del(obj_addition_table_bg);
        lv_obj_del(left_stop_img_typeface);
        lv_obj_del(right_stop_img_typeface);
        lv_obj_del(slider_typeface);
        lv_obj_del(obj_addition_picture_btn_bg);
        lv_obj_del(btn_addition_picture_delete);
        lv_obj_del(btn_addition_picture_open);
        lv_obj_del(obj_addition_picture_bottom_bg);
        lv_obj_del(img_addition_picture_search);
        lv_obj_del(label_addition_picture_search);
        lv_obj_del(label_btn_addition_picture_search);
        lv_obj_del(btn_addition_picture_search);
        lv_obj_del(label_addition_picture_return);
        lv_obj_del(imgbtn_addition_picture_return);
        lv_obj_del(imgbtn_addition_picture_confirm);
        lv_obj_del(label_addition_picture_confirm);
    }
}


void formatNumberWithLeadingZeros(unsigned int a, unsigned int b, char *strA)
{
    // 计算两个数的位数（0的位数为1）
    int digitsA = a == 0 ? 1 : (int)log10(a) + 1;
    int digitsB = b == 0 ? 1 : (int)log10(b) + 1;

    // 计算需要补零的个数
    int zerosNeeded = digitsB > digitsA ? digitsB - digitsA : 0;
    printf("a=%d\n\r", a);
    printf("b=%d\n\r", b);
    printf("digitsA=%d\n\r", digitsA);
    printf("digitsB=%d\n\r", digitsB);
    printf("zerosNeeded=%d\n\r", zerosNeeded);

    // 格式化输出
    if (zerosNeeded > 0)
    {
        sprintf(strA, "%0*d", digitsA + zerosNeeded, a);

        printf("strA=%s\n\r", strA);
    }
    else
    {
        sprintf(strA, "%u", a);
    }
}


static void imgbtn_file_confirm_event_cb(lv_event_t* e)
{
    lv_event_code_t code;
    int win_content_child_num = 0;
    int i;
    char file_name[128]={ 0 };
    //char temp_typeface[128] = { 0 };
    int word_space = 0;
    //int x_size = 0;
    struct zint_symbol* my_symbol = NULL;
    int str_len;
    int height_len;
    int width, height, channels;
    unsigned char* pdata = NULL; 
    unsigned char* pnew_data = NULL;
    lv_obj_t* img = NULL;
    lv_obj_t* temp_obj = NULL;
    char tempString[32] = { 0 };
    lv_point_t text_size;
    lv_obj_t* label1; 
    char bmp_name[64]={0};
    char bmp_name_1[80]={0};  
    char date_time_str[64]={ 0 };
    lv_obj_t* img_obj = NULL;
    lv_img_t* img_1 = NULL;
    lv_img_dsc_t* img_dsc = NULL;
    int success;
    unsigned char * data = NULL; 
    lv_img_header_t header;
    lv_res_t res;
    lv_font_t* temp_font = NULL;
    int now_year = 0;
    int now_month = 0;
    int now_day = 0;
    int end_year = 0;
    int end_month = 0;
    int end_day = 0;



    code = lv_event_get_code(e);
    if (code == LV_EVENT_CLICKED)
    {
        printf("imgbtn_file_confirm_event_cb\n");

        buzzer_enable = 1;

        win_content_child_num = lv_obj_get_child_cnt(win_content);

        if(win_content_child_num != 0)
        {
            for(i=0;i<win_content_child_num;i++)
            {
                if(data_structure[i].type == TYPE_WORD)
                {
                    //删除所有数据
                    lv_style_reset(&data_structure[i].data.word.style);
                    //lv_ft_font_destroy(data_structure[i].data.word.info.font);   
                    font_list_release(data_structure[i].data.word.typeface, data_structure[i].data.word.size, data_structure[i].data.word.italic_bold);
         
                }
                else if(data_structure[i].type == TYPE_DATE)
                {
                    lv_style_reset(&data_structure[i].data.date_time.style);
                    //lv_ft_font_destroy(data_structure[i].data.date_time.info.font);   
                    font_list_release(data_structure[i].data.date_time.typeface, data_structure[i].data.date_time.size, data_structure[i].data.date_time.italic_bold);
         
                }
                else if(data_structure[i].type == TYPE_PITCTURE)
                {

                }
                else if(data_structure[i].type == TYPE_ICON)
                {

                }
                else if(data_structure[i].type == TYPE_QR)
                {

                }
                else if(data_structure[i].type == TYPE_BAR)
                {

                }
                else if(data_structure[i].type == TYPE_COUNT)
                {
                    lv_style_reset(&data_structure[i].data.count.style);
                    //lv_ft_font_destroy(data_structure[i].data.count.info.font);  
                    font_list_release(data_structure[i].data.count.typeface, data_structure[i].data.count.size, 0);
                }
                else if(data_structure[i].type == TYPE_BREAK)
                {

                }
                else if(data_structure[i].type == TYPE_SYMBOL)
                {
                    //删除所有数据
                    lv_style_reset(&data_structure[i].data.word.style);
                    //lv_ft_font_destroy(data_structure[i].data.word.info.font);  
                    font_list_release(data_structure[i].data.word.typeface, data_structure[i].data.word.size, data_structure[i].data.word.italic_bold);
                }
            }   

            for(i=0;i<win_content_child_num;i++)
            {
                lv_obj_del(lv_obj_get_child(win_content, 0)); 
            }
        }

        printf("sizeof(data_structure)=%d\n\r",sizeof(data_structure));
        printf("sizeof(DATA_STRUCTURE)=%d\n\r",sizeof(DATA_STRUCTURE));

        memset(&data_structure, 0, sizeof(data_structure));


        //获取文件名称
        sprintf(file_name, "/media/file/%s", lv_table_get_cell_value(table_addition_picture_1, g_row, 0));

        printf("file_name=%s\n\r",file_name);

        // 打开文件以写入二进制数据
        FILE* file = fopen(file_name, "rb");
        if (file == NULL) 
        {
            perror("Failed to open file");
        }
        else
        {
            // 将结构体写入文件
            size_t written = fread(&data_structure, sizeof(data_structure), 1, file);
            if (written != 1) {
                perror("Failed to read data to file");
                fclose(file);
                //return EXIT_FAILURE;
            }
            else
            {
                // 关闭文件
                fclose(file);

                for(i = 0; i < NEW_TEXT_MAX_NUMBER; i++)
                {
                    printf("data_structure[%d].type=%d\n\r",i,data_structure[i].type);
                    if(data_structure[i].type == 0)
                    {
                        break;
                    }
                    else
                    {
                        switch(data_structure[i].type)
                        {
                            case TYPE_WORD:
                            {
                                temp_obj = lv_obj_create(win_content);          
                                //sprintf(temp_typeface,"/media/%s", typeface_buf[data_structure[i].data.word.typeface]);
                                //data_structure[i].data.word.info.name = temp_typeface;
                                //printf("%s\n\r", temp_typeface);
                                data_structure[i].data.word.info.weight = data_structure[i].data.word.size;
                                data_structure[i].data.word.info.style = data_structure[i].data.word.italic_bold;
                                //lv_ft_font_init(&data_structure[i].data.word.info);
                                printf("typeface=%d\n\r", data_structure[i].data.word.typeface);
                                temp_font = font_list_get(data_structure[i].data.word.typeface, data_structure[i].data.word.size, data_structure[i].data.word.info.style);
                                lv_txt_get_size(&text_size, data_structure[i].data.word.text, temp_font, data_structure[i].data.word.space, 0, LV_COORD_MAX, LV_TEXT_FLAG_NONE);  

                                lv_obj_set_style_bg_opa(temp_obj, LV_OPA_TRANSP, 0);
                                lv_obj_set_style_border_width(temp_obj, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */

                                lv_obj_add_event_cb(temp_obj, drag_event_handler, LV_EVENT_PRESSING, NULL);
                                lv_obj_add_event_cb(temp_obj, drag_event_handler, LV_EVENT_FOCUSED, NULL);
                                lv_obj_add_event_cb(temp_obj, drag_event_handler, LV_EVENT_DEFOCUSED, NULL);
                                lv_obj_clear_flag(temp_obj, LV_OBJ_FLAG_SCROLLABLE);

                                lv_style_init(&data_structure[i].data.word.style);
                                lv_style_set_text_font(&data_structure[i].data.word.style, temp_font);
                                word_space = data_structure[i].data.word.space;
                                printf("x=%u y=%u\n\r", text_size.x, text_size.y);

                                //x_size = text_size.x + text_size.x / text_size.y * word_space * 2;
                                //printf("x_size=%d\n\r", x_size);

                                lv_obj_set_size(temp_obj,  text_size.x, text_size.y);
                                lv_obj_set_style_transform_angle(temp_obj, data_structure[i].data.word.spin*10, 0);

                                if (data_structure[i].data.word.spin != 0)
                                {
                                    lv_obj_align(temp_obj, LV_ALIGN_TOP_LEFT, text_size.x, text_size.y);
                                }

                                lv_style_set_text_letter_space(&data_structure[i].data.word.style, word_space);
                                label1 = lv_label_create(temp_obj);
                                lv_obj_add_style(label1, &data_structure[i].data.word.style, 0);
                                lv_label_set_text(label1, data_structure[i].data.word.text);
                                lv_obj_center(label1);     
                                lv_obj_align(temp_obj, LV_ALIGN_OUT_TOP_LEFT, data_structure[i].x, data_structure[i].y);
                                break;
                            }
                            case TYPE_DATE:
                            {
                                temp_obj = lv_obj_create(win_content);          
                                //sprintf(temp_typeface,"/media/%s", typeface_buf[data_structure[i].data.date_time.typeface]);
                                //data_structure[i].data.date_time.info.name = temp_typeface;
                                //printf("%s\n\r", temp_typeface);
                                data_structure[i].data.date_time.info.weight = data_structure[i].data.date_time.size;
                                data_structure[i].data.date_time.info.style = data_structure[i].data.date_time.italic_bold;
                                //lv_ft_font_init(&data_structure[i].data.date_time.info);
                                //lv_txt_get_size(&text_size, data_structure[i].data.date_time.text, data_structure[i].data.date_time.info.font, 0, 0, LV_COORD_MAX, LV_TEXT_FLAG_NONE);
                                temp_font = font_list_get(data_structure[i].data.date_time.typeface, data_structure[i].data.date_time.size, data_structure[i].data.date_time.italic_bold);
                                //lv_point_t text_size;
                                lv_txt_get_size(&text_size, data_structure[i].data.date_time.text, temp_font, data_structure[i].data.date_time.space, 0, LV_COORD_MAX, LV_TEXT_FLAG_NONE);  

                                lv_obj_set_style_bg_opa(temp_obj, LV_OPA_TRANSP, 0);
                                lv_obj_set_style_border_width(temp_obj, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */

                                lv_obj_add_event_cb(temp_obj, drag_event_handler, LV_EVENT_PRESSING, NULL);
                                lv_obj_add_event_cb(temp_obj, drag_event_handler, LV_EVENT_FOCUSED, NULL);
                                lv_obj_add_event_cb(temp_obj, drag_event_handler, LV_EVENT_DEFOCUSED, NULL);
                                lv_obj_clear_flag(temp_obj, LV_OBJ_FLAG_SCROLLABLE);

                                lv_style_init(&data_structure[i].data.date_time.style);
                                lv_style_set_text_font(&data_structure[i].data.date_time.style, temp_font);

                                lv_obj_set_size(temp_obj, text_size.x, text_size.y);
                                lv_obj_set_style_transform_angle(temp_obj, data_structure[i].data.date_time.spin*10, 0);

                                if (data_structure[i].data.word.spin != 0)
                                {
                                    lv_obj_align(temp_obj, LV_ALIGN_TOP_LEFT, text_size.x, text_size.y);
                                }

                                lv_style_set_text_letter_space(&data_structure[i].data.date_time.style, word_space);
                                label1 = lv_label_create(temp_obj);
                                lv_obj_add_style(label1, &data_structure[i].data.date_time.style, 0);

                                if(data_structure[i].data.date_time.date_or_time == 0)
                                {
                                    switch(data_structure[i].data.date_time.date_or_time_type)
                                    {
                                        case 0:
                                            sprintf(date_time_str, "%04d/%02d/%02d", 2000 + g_system_time[0], g_system_time[1], g_system_time[2]);
                                            break;
                                        case 1:
                                            sprintf(date_time_str, "%02d/%02d/%02d", g_system_time[0], g_system_time[1], g_system_time[2]);
                                            break;
                                        case 2:
                                            sprintf(date_time_str, "%04d-%02d-%02d", 2000 + g_system_time[0], g_system_time[1], g_system_time[2]);
                                            break;
                                        case 3:
                                            sprintf(date_time_str, "%02d-%02d-%02d", g_system_time[0], g_system_time[1], g_system_time[2]);
                                            break;
                                        case 4:
                                            sprintf(date_time_str, "%04d.%02d.%02d", 2000 + g_system_time[0], g_system_time[1], g_system_time[2]);
                                            break;
                                        case 5:
                                            sprintf(date_time_str, "%02d.%02d.%02d", g_system_time[0], g_system_time[1], g_system_time[2]);
                                            break;
                                        case 6:
                                            sprintf(date_time_str, "%02d/%02d/%04d", g_system_time[2],  g_system_time[1], 2000 + g_system_time[0]);
                                            break;
                                        case 7:
                                            sprintf(date_time_str, "%02d/%02d/%02d", g_system_time[2],  g_system_time[1], g_system_time[0]);
                                            break;
                                        case 8:
                                            sprintf(date_time_str, "%02d-%02d-%04d", g_system_time[2],  g_system_time[1], 2000 + g_system_time[0]);
                                            break;
                                        case 9:
                                            sprintf(date_time_str, "%02d-%02d-%02d", g_system_time[2],  g_system_time[1], g_system_time[0]);
                                            break;
                                        case 10:
                                            sprintf(date_time_str, "%02d.%02d.%04d", g_system_time[2],  g_system_time[1], 2000 + g_system_time[0]);
                                            break;
                                        case 11:
                                            sprintf(date_time_str, "%02d.%02d.%02d", g_system_time[2],  g_system_time[1], g_system_time[0]);
                                            break;
                                        case 12:
                                            sprintf(date_time_str, "%04d年%02d月%02d日", 2000 + g_system_time[0], g_system_time[1], g_system_time[2]);
                                            break;
                                        case 13:
                                            sprintf(date_time_str, "%02d年%02d月%02d日", g_system_time[0], g_system_time[1], g_system_time[2]);
                                            break;
                                        case 14:
                                            sprintf(date_time_str, "%s",data_structure[i].data.date_time.text);
                                            break;
                                        case 15:
                                            sprintf(date_time_str, "延期");
                                            break;
                                    }
                                }
                                else if(data_structure[i].data.date_time.date_or_time == 2)
                                {
                                    now_year =  2000 + g_system_time[0];
                                    now_month =  g_system_time[1];
                                    now_day =  g_system_time[2];
                                    calculateExpiryDate(now_year,now_month,now_day,data_structure[i].data.date_time.year,data_structure[i].data.date_time.month,data_structure[i].data.date_time.day,&end_year,&end_month,&end_day);

                                    switch(data_structure[i].data.date_time.date_or_time_type)
                                    {
                                        case 0:
                                            sprintf(date_time_str, "%04d/%02d/%02d", end_year, end_month, end_day);
                                            break;
                                        case 1:
                                            sprintf(date_time_str, "%02d/%02d/%02d", end_year%100, end_month, end_day);
                                            break;
                                        case 2:
                                            sprintf(date_time_str, "%04d-%02d-%02d", end_year, end_month, end_day);
                                            break;
                                        case 3:
                                            sprintf(date_time_str, "%02d-%02d-%02d", end_year%100, end_month, end_day);
                                            break;
                                        case 4:
                                            sprintf(date_time_str, "%04d.%02d.%02d", end_year, end_month, end_day);
                                            break;
                                        case 5:
                                            sprintf(date_time_str, "%02d.%02d.%02d", end_year%100, end_month, end_day);
                                            break;
                                        case 6:
                                            sprintf(date_time_str, "%02d/%02d/%04d", end_day,  end_month, end_year);
                                            break;
                                        case 7:
                                            sprintf(date_time_str, "%02d/%02d/%02d", end_day,  end_month, end_year%100);
                                            break;
                                        case 8:
                                            sprintf(date_time_str, "%02d-%02d-%04d", end_day,  end_month, end_year);
                                            break;
                                        case 9:
                                            sprintf(date_time_str, "%02d-%02d-%02d", end_day,  end_month, end_year%100);
                                            break;
                                        case 10:
                                            sprintf(date_time_str, "%02d.%02d.%04d", end_day,  end_month, end_year);
                                            break;
                                        case 11:
                                            sprintf(date_time_str, "%02d.%02d.%02d", end_day,  end_month, end_year%100);
                                            break;
                                        case 12:
                                            sprintf(date_time_str, "%04d年%02d月%02d日", end_year, end_month, end_day);
                                            break;
                                        case 13:
                                            sprintf(date_time_str, "%02d年%02d月%02d日", end_year%100, end_month, end_day);
                                            break;
                                        case 14:
                                            sprintf(date_time_str, "%s",data_structure[i].data.date_time.text);
                                            break;
                                        case 15:
                                            sprintf(date_time_str, "延期");
                                            break;
                                    }
                                }
                                else
                                {
                                    switch(data_structure[i].data.date_time.date_or_time_type)
                                    {
                                        case 0:
                                            sprintf(date_time_str, "%02d:%02d:%02d", g_system_time[3], g_system_time[4], g_system_time[5]);
                                            break;
                                        case 1:
                                            sprintf(date_time_str, "%02d:%02d", g_system_time[3], g_system_time[4]);
                                            break;
                                        case 2:
                                            if (g_system_time[3] > 12)
                                            {
                                                sprintf(date_time_str, "%02d:%02d:%02d PM", g_system_time[3] - 12, g_system_time[4], g_system_time[5]);
                                            }
                                            else
                                            {
                                                sprintf(date_time_str, "%02d:%02d:%02d AM", g_system_time[3], g_system_time[4], g_system_time[5]);
                                            }
                                            break;
                                        case 3:
                                            if (g_system_time[3] > 12)
                                            {
                                                sprintf(date_time_str, "%02d:%02d PM", g_system_time[3] - 12, g_system_time[4]);
                                            }
                                            else
                                            {
                                                sprintf(date_time_str, "%02d:%02d AM", g_system_time[3], g_system_time[4]);
                                            }
                                            break;
                                        case 4:
                                            sprintf(date_time_str, "%02d时%02d分%02d秒", g_system_time[3], g_system_time[4], g_system_time[5]);
                                            break;
                                        case 5:
                                            sprintf(date_time_str, "%s",data_structure[i].data.date_time.text);
                                            break;
                                        case 6:
                                            sprintf(date_time_str, "延期");
                                            break;
                                    }              
                                }

                                lv_label_set_text(label1, date_time_str);
                                lv_obj_center(label1);     
                                lv_obj_align(temp_obj, LV_ALIGN_OUT_TOP_LEFT, data_structure[i].x, data_structure[i].y);
                                break;
                            }
                            case TYPE_QR:

                                str_len = strlen(data_structure[i].data.qr_bar.text) + 1;
                                
                                temp_obj = lv_obj_create(win_content);
                                lv_obj_set_style_bg_opa(temp_obj, LV_OPA_TRANSP, 0);
                                lv_obj_set_style_border_width(temp_obj, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */

                                lv_obj_add_event_cb(temp_obj, drag_event_handler, LV_EVENT_PRESSING, NULL);
                                lv_obj_add_event_cb(temp_obj, drag_event_handler, LV_EVENT_FOCUSED, NULL);
                                lv_obj_add_event_cb(temp_obj, drag_event_handler, LV_EVENT_DEFOCUSED, NULL);
                                lv_obj_clear_flag(temp_obj, LV_OBJ_FLAG_SCROLLABLE);

                                my_symbol = ZBarcode_Create();

                                switch (data_structure[i].data.qr_bar.symbology)
                                {
                                    case 0:
                                    default:

                                        height_len = data_structure[i].data.qr_bar.height;
                                        my_symbol->symbology = BARCODE_QRCODE;
                                        my_symbol->scale = 1;
                                        my_symbol->option_1 = 2; //容错级别

                                        if(str_len < 20)
                                        {
                                            my_symbol->option_2 = 1;
                                        }
                                        else if(str_len < 38)
                                        {
                                            my_symbol->option_2 = 2;
                                        }
                                        else if(str_len < 61)
                                        {
                                            my_symbol->option_2 = 3;
                                        }
                                        else if(str_len < 90)
                                        {
                                            my_symbol->option_2 = 4;
                                        }
                                        else if(str_len < 122)
                                        {
                                            my_symbol->option_2 = 5;
                                        }
#if 0
                                        if( data_structure[i].data.qr_bar.figure== 1)
                                        {
                                            my_symbol->show_hrt = 1;
                                            memcpy(my_symbol->text,data_structure[i].data.qr_bar.text,str_len);
                                        }
#endif

                                        if (data_structure[i].data.qr_bar.borders == 1)
                                        {
                                            my_symbol->output_options = BARCODE_BOX;
                                            my_symbol->whitespace_width = 3;
                                            my_symbol-> whitespace_height = 3; 
                                            my_symbol-> border_width = 2;   /* Size of border in X-dimensions */
                                        }

                                        strcpy(my_symbol->outfile, "out.bmp");
                                        ZBarcode_Encode(my_symbol, (unsigned char *)data_structure[i].data.qr_bar.text, 0);

                                        ZBarcode_Print(my_symbol, 0);
                                        //ZBarcode_Delete(my_symbol);

                                        pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                                        printf("width=%d\n\r", width);
                                        printf("height=%d\n\r", height);
                                        printf("channels=%d\n\r", channels);
                            
                                        //my_symbol->scale = (float)((float)150.0*(float)height_len/(float)100.0/(float)width);
                                        //   my_symbol->scale = (float)height_len/(float)height;
                                        my_symbol->scale = (float)((float)150.0*(float)height_len/(float)QR_BAR_MAX_HIGHT/(float)height);

                
                                        strcpy(my_symbol->outfile, "out.bmp");
                                        ZBarcode_Encode(my_symbol, (unsigned char *)data_structure[i].data.qr_bar.text, 0);

                                        ZBarcode_Print(my_symbol, 0);
                                        ZBarcode_Delete(my_symbol);
                                        stbi_image_free(pdata);
                                
                                        pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                                        printf("width=%d\n\r", width);
                                        printf("height=%d\n\r", height);
                                        printf("channels=%d\n\r", channels);

                                        lv_obj_set_size(temp_obj, width, height);

                                        pnew_data = (unsigned char*)lv_mem_alloc(width * height * 4); // 为32位数据分配内存
                                        if (!pnew_data) 
                                        {
                                            fprintf(stderr, "Memory allocation failed\n");
                                            stbi_image_free(pdata);
                                            return;
                                        }
                                        else
                                        {
                                            printf("lv_mem_alloc ok\n\r");
                                        }

                                        for (int y = 0; y < height; y++) 
                                        {
                                            for (int x = 0; x < width; x++) 
                                            {
                                                int index = y * width + x; // 计算当前像素在原始数据中的索引
                                                unsigned char color = pdata[index]; // 获取当前像素的灰度值（0或255）
                                                // 映射到RGBA值

                                                if (color == 0)
                                                {
                                                    pnew_data[index * 4 + 0] = 0; // R
                                                    pnew_data[index * 4 + 1] = 0; // G
                                                    pnew_data[index * 4 + 2] = 0; // B
                                                    pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                                                }
                                                else
                                                {
                                                    pnew_data[index * 4 + 0] = 255; // R
                                                    pnew_data[index * 4 + 1] = 255; // G
                                                    pnew_data[index * 4 + 2] = 255; // B
                                                    pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                                                }
                                            }
                                        }

                                        sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.bmp",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                                        stbi_write_bmp(bmp_name, width, height, 4, pnew_data);
                                        // 使用data进行图像处理...
                                        lv_mem_free(pnew_data);
                                        stbi_image_free(pdata); // 释放内存

                                        data = stbi_load(bmp_name, &width, &height, &channels, 0);
                                        if (!data) 
                                        {
                                            printf("错误：无法加载图片 %s\n", bmp_name);
                                        }
                                        printf("图片加载成功：%dx%d，%d 通道\n", width, height, channels);

                                        sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.png",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                                     
                                        success = stbi_write_png(bmp_name, width, height, channels, data, width * channels);
                                        if (!success) 
                                        {
                                            printf("错误：保存 PNG 失败\n");
                                        } 
                                        else
                                        {
                                            printf("PNG 保存成功：%s\n", bmp_name);
                                        }

                                        // 释放内存
                                        stbi_image_free(data);

                                        //显示图像
                                        img = lv_img_create(temp_obj);
                                        sprintf(bmp_name_1,"A:%s",bmp_name);
                                        lv_img_set_src(img, bmp_name_1);
                                        lv_obj_center(img);

                                        res = lv_img_decoder_get_info(bmp_name_1, &header);  // 直接传入文件路径

                                        if (res == LV_RES_OK)
                                        {
                                            printf("PNG: %dx%d\n", header.w, header.h);
                                        }
                                        else
                                        {
                                            printf("lv_img_decoder_get_info error\n");
                                        }

                                        lv_img_set_zoom(img,data_structure[i].data.qr_bar.size);

                                        width = header.w * data_structure[i].data.qr_bar.size / 256;
                                        height = header.h * data_structure[i].data.qr_bar.size / 256;

                                        lv_obj_set_size(temp_obj, width, height);

                                        lv_obj_align(temp_obj, LV_ALIGN_OUT_TOP_LEFT, data_structure[i].x, data_structure[i].y);

                                        break;
                                    case 1:
                            
                                        my_symbol->symbology = BARCODE_PDF417;
                                        height_len =  data_structure[i].data.qr_bar.height;
                                        my_symbol->scale = 1;

           
                                         if (data_structure[i].data.qr_bar.borders == 1)
                                        {
                                            my_symbol->output_options = BARCODE_BOX;
                                            my_symbol->whitespace_width = 3;
                                            my_symbol-> whitespace_height = 3; 
                                            my_symbol-> border_width = 2;   /* Size of border in X-dimensions */
                                        }

                                        strcpy(my_symbol->outfile, "out.bmp");
                                        ZBarcode_Encode(my_symbol, (unsigned char *)data_structure[i].data.qr_bar.text, 0);

                                        ZBarcode_Print(my_symbol, 0);
                                        //ZBarcode_Delete(my_symbol);

                            
                                        pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                                        printf("width=%d\n\r", width);
                                        printf("height=%d\n\r", height);
                                        printf("channels=%d\n\r", channels);
                            
                                      //  my_symbol->scale = (float)((float)150.0*(float)height_len/(float)100.0/(float)height);
                                       //  my_symbol->scale = (float)height_len/(float)height;
                                          my_symbol->scale = (float)((float)150.0*(float)height_len/(float)QR_BAR_MAX_HIGHT/(float)height);
                                        printf("scale=%f\n\r", (double)my_symbol->scale);
                
                                        strcpy(my_symbol->outfile, "out.bmp");
                                        ZBarcode_Encode(my_symbol, (unsigned char *)data_structure[i].data.qr_bar.text, 0);

                                        ZBarcode_Print(my_symbol, 0);
                                        ZBarcode_Delete(my_symbol);
                                        stbi_image_free(pdata);
                                
                                        pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                                        printf("width=%d\n\r", width);
                                        printf("height=%d\n\r", height);
                                        printf("channels=%d\n\r", channels);

                                        lv_obj_set_size(temp_obj, width, height);

                                        pnew_data = (unsigned char*)lv_mem_alloc(width * height * 4); // 为32位数据分配内存
                                        if (!pnew_data) 
                                        {
                                            fprintf(stderr, "Memory allocation failed\n");
                                            stbi_image_free(pdata);
                                            return;
                                        }
                                        else
                                        {
                                            printf("lv_mem_alloc ok\n\r");
                                        }

                                        for (int y = 0; y < height; y++) 
                                        {
                                            for (int x = 0; x < width; x++) 
                                            {
                                                int index = y * width + x; // 计算当前像素在原始数据中的索引
                                                unsigned char color = pdata[index]; // 获取当前像素的灰度值（0或255）
                                                // 映射到RGBA值

                                                if (color == 0)
                                                {
                                                    pnew_data[index * 4 + 0] = 0; // R
                                                    pnew_data[index * 4 + 1] = 0; // G
                                                    pnew_data[index * 4 + 2] = 0; // B
                                                    pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                                                }
                                                else
                                                {
                                                    pnew_data[index * 4 + 0] = 255; // R
                                                    pnew_data[index * 4 + 1] = 255; // G
                                                    pnew_data[index * 4 + 2] = 255; // B
                                                    pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                                                }
                                            }
                                        }

#if 0
                                        stbi_write_bmp("QR_bar_code.bmp", width, height, 4, pnew_data);
                                        // 使用data进行图像处理...
                                        lv_mem_free(pnew_data);
                                        stbi_image_free(pdata); // 释放内存

                                        //显示图像
                                        lv_obj_t* img = lv_img_create(temp_obj);
                                        lv_img_set_src(img, "A:/root/QR_bar_code.bmp");
                                        lv_obj_center(img);
#endif

                                        sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.bmp",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                                        stbi_write_bmp(bmp_name, width, height, 4, pnew_data);
                                        // 使用data进行图像处理...
                                        lv_mem_free(pnew_data);
                                        stbi_image_free(pdata); // 释放内存

                                        data = stbi_load(bmp_name, &width, &height, &channels, 0);
                                        if (!data) 
                                        {
                                            printf("错误：无法加载图片 %s\n", bmp_name);
                                        }
                                        printf("图片加载成功：%dx%d，%d 通道\n", width, height, channels);

                                        sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.png",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                                     
                                        success = stbi_write_png(bmp_name, width, height, channels, data, width * channels);
                                        if (!success) 
                                        {
                                            printf("错误：保存 PNG 失败\n");
                                        } 
                                        else
                                        {
                                            printf("PNG 保存成功：%s\n", bmp_name);
                                        }
                                        stbi_image_free(data); // 释放内存

                                        //显示图像
                                        img = lv_img_create(temp_obj);
                                        sprintf(bmp_name_1,"A:%s",bmp_name);
                                        lv_img_set_src(img, bmp_name_1);
                                        lv_obj_center(img);
   
                                        res = lv_img_decoder_get_info(bmp_name_1, &header);  // 直接传入文件路径

                                        if (res == LV_RES_OK)
                                        {
                                            printf("PNG: %dx%d\n", header.w, header.h);
                                        }
                                        else
                                        {
                                            printf("lv_img_decoder_get_info error\n");
                                        }

                                        lv_img_set_zoom(img,data_structure[i].data.qr_bar.size);

                                        width = header.w * data_structure[i].data.qr_bar.size / 256;
                                        height = header.h * data_structure[i].data.qr_bar.size / 256;

                                        lv_obj_set_size(temp_obj, width, height);

                                        lv_obj_align(temp_obj, LV_ALIGN_OUT_TOP_LEFT, data_structure[i].x, data_structure[i].y);

                                        break;
                                    case 2:
                                        my_symbol->symbology = BARCODE_DATAMATRIX;
                                        height_len =  data_structure[i].data.qr_bar.height;
                                        my_symbol->scale = 1;

                                        if (data_structure[i].data.qr_bar.borders == 1)
                                        {
                                            my_symbol->output_options = BARCODE_BOX;
                                            my_symbol->whitespace_width = 3;
                                            my_symbol-> whitespace_height = 3; 
                                            my_symbol-> border_width = 2;   /* Size of border in X-dimensions */
                                        }

                                        strcpy(my_symbol->outfile, "out.bmp");
                                        ZBarcode_Encode(my_symbol, (unsigned char *)data_structure[i].data.qr_bar.text, 0);

                                        ZBarcode_Print(my_symbol, 0);
                                        //ZBarcode_Delete(my_symbol);

                                        pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                                        printf("width=%d\n\r", width);
                                        printf("height=%d\n\r", height);
                                        printf("channels=%d\n\r", channels);
                            
                                      //  my_symbol->scale = (float)((float)150.0*(float)height_len/(float)100.0/(float)height);
                                       //  my_symbol->scale = (float)height_len/(float)height;
                                          my_symbol->scale = (float)((float)150.0*(float)height_len/(float)QR_BAR_MAX_HIGHT/(float)height);
                                        printf("scale=%f\n\r", (double)my_symbol->scale);
                
                                        strcpy(my_symbol->outfile, "out.bmp");
                                        ZBarcode_Encode(my_symbol, (unsigned char *)data_structure[i].data.qr_bar.text, 0);

                                        ZBarcode_Print(my_symbol, 0);
                                        ZBarcode_Delete(my_symbol);
                                        stbi_image_free(pdata);
                                
                                        pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                                        printf("width=%d\n\r", width);
                                        printf("height=%d\n\r", height);
                                        printf("channels=%d\n\r", channels);

                                        lv_obj_set_size(temp_obj, width, height);

                                        pnew_data = (unsigned char*)lv_mem_alloc(width * height * 4); // 为32位数据分配内存
                                        if (!pnew_data) 
                                        {
                                            fprintf(stderr, "Memory allocation failed\n");
                                            stbi_image_free(pdata);
                                            return;
                                        }
                                        else
                                        {
                                            printf("lv_mem_alloc ok\n\r");
                                        }

                                        for (int y = 0; y < height; y++) 
                                        {
                                            for (int x = 0; x < width; x++) 
                                            {
                                                int index = y * width + x; // 计算当前像素在原始数据中的索引
                                                unsigned char color = pdata[index]; // 获取当前像素的灰度值（0或255）
                                                // 映射到RGBA值

                                                if (color == 0)
                                                {
                                                    pnew_data[index * 4 + 0] = 0; // R
                                                    pnew_data[index * 4 + 1] = 0; // G
                                                    pnew_data[index * 4 + 2] = 0; // B
                                                    pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                                                }
                                                else
                                                {
                                                    pnew_data[index * 4 + 0] = 255; // R
                                                    pnew_data[index * 4 + 1] = 255; // G
                                                    pnew_data[index * 4 + 2] = 255; // B
                                                    pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                                                }
                                            }
                                        }

#if 0
                                        stbi_write_bmp("QR_bar_code.bmp", width, height, 4, pnew_data);
                                        // 使用data进行图像处理...
                                        lv_mem_free(pnew_data);
                                        stbi_image_free(pdata); // 释放内存

                                        //显示图像
                                        img = lv_img_create(temp_obj);
                                        lv_img_set_src(img, "A:/root/QR_bar_code.bmp");
                                        lv_obj_center(img);
#endif

                                        sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.bmp",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                                        stbi_write_bmp(bmp_name, width, height, 4, pnew_data);
                                        // 使用data进行图像处理...
                                        lv_mem_free(pnew_data);
                                        stbi_image_free(pdata); // 释放内存

                                        data = stbi_load(bmp_name, &width, &height, &channels, 0);
                                        if (!data) 
                                        {
                                            printf("错误：无法加载图片 %s\n", bmp_name);
                                        }
                                        printf("图片加载成功：%dx%d，%d 通道\n", width, height, channels);

                                        sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.png",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                                     
                                        success = stbi_write_png(bmp_name, width, height, channels, data, width * channels);
                                        if (!success) 
                                        {
                                            printf("错误：保存 PNG 失败\n");
                                        } 
                                        else
                                        {
                                            printf("PNG 保存成功：%s\n", bmp_name);
                                        }
                                        stbi_image_free(data); // 释放内存

                                        //显示图像
                                        img = lv_img_create(temp_obj);
                                        sprintf(bmp_name_1,"A:%s",bmp_name);
                                        lv_img_set_src(img, bmp_name_1);
                                        lv_obj_center(img);

                                        res = lv_img_decoder_get_info(bmp_name_1, &header);  // 直接传入文件路径

                                        if (res == LV_RES_OK)
                                        {
                                            printf("PNG: %dx%d\n", header.w, header.h);
                                        }
                                        else
                                        {
                                            printf("lv_img_decoder_get_info error\n");
                                        }

                                        lv_img_set_zoom(img,data_structure[i].data.qr_bar.size);

                                        width = header.w * data_structure[i].data.qr_bar.size / 256;
                                        height = header.h * data_structure[i].data.qr_bar.size / 256;

                                        lv_obj_set_size(temp_obj, width, height);

                                        lv_obj_align(temp_obj, LV_ALIGN_OUT_TOP_LEFT, data_structure[i].x, data_structure[i].y);

                                        break;
                                    case 3:
                                        my_symbol->symbology = BARCODE_HANXIN;
                                        height_len = data_structure[i].data.qr_bar.height;
                                        my_symbol->scale = 1;
                       
                                        if (data_structure[i].data.qr_bar.borders == 1)
                                        {
                                            my_symbol->output_options = BARCODE_BOX;
                                            my_symbol->whitespace_width = 3;
                                            my_symbol-> whitespace_height = 3; 
                                            my_symbol-> border_width = 2;   /* Size of border in X-dimensions */
                                        }

                                        strcpy(my_symbol->outfile, "out.bmp");
                                        ZBarcode_Encode(my_symbol, (unsigned char *)data_structure[i].data.qr_bar.text, 0);

                                        ZBarcode_Print(my_symbol, 0);
                                        //ZBarcode_Delete(my_symbol);

                                        pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                                        printf("width=%d\n\r", width);
                                        printf("height=%d\n\r", height);
                                        printf("channels=%d\n\r", channels);
                            
                                     //   my_symbol->scale = (float)((float)150.0*(float)height_len/(float)100.0/(float)height);
                                      //  my_symbol->scale = (float)height_len/(float)height;
                                         my_symbol->scale = (float)((float)150.0*(float)height_len/(float)QR_BAR_MAX_HIGHT/(float)height);
                                        printf("scale=%f\n\r", (double)my_symbol->scale);
                
                                        strcpy(my_symbol->outfile, "out.bmp");
                                        ZBarcode_Encode(my_symbol, (unsigned char *)data_structure[i].data.qr_bar.text, 0);

                                        ZBarcode_Print(my_symbol, 0);
                                        ZBarcode_Delete(my_symbol);
                                        stbi_image_free(pdata);
                                
                                        pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                                        printf("width=%d\n\r", width);
                                        printf("height=%d\n\r", height);
                                        printf("channels=%d\n\r", channels);

                                        lv_obj_set_size(temp_obj, width, height);

                                        pnew_data = (unsigned char*)lv_mem_alloc(width * height * 4); // 为32位数据分配内存
                                        if (!pnew_data) 
                                        {
                                            fprintf(stderr, "Memory allocation failed\n");
                                            stbi_image_free(pdata);
                                            return;
                                        }
                                        else
                                        {
                                            printf("lv_mem_alloc ok\n\r");
                                        }

                                        for (int y = 0; y < height; y++) 
                                        {
                                            for (int x = 0; x < width; x++) 
                                            {
                                                int index = y * width + x; // 计算当前像素在原始数据中的索引
                                                unsigned char color = pdata[index]; // 获取当前像素的灰度值（0或255）
                                                // 映射到RGBA值

                                                if (color == 0)
                                                {
                                                    pnew_data[index * 4 + 0] = 0; // R
                                                    pnew_data[index * 4 + 1] = 0; // G
                                                    pnew_data[index * 4 + 2] = 0; // B
                                                    pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                                                }
                                                else
                                                {
                                                    pnew_data[index * 4 + 0] = 255; // R
                                                    pnew_data[index * 4 + 1] = 255; // G
                                                    pnew_data[index * 4 + 2] = 255; // B
                                                    pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                                                }
                                            }
                                        }

#if 0
                                        stbi_write_bmp("QR_bar_code.bmp", width, height, 4, pnew_data);
                                        // 使用data进行图像处理...
                                        lv_mem_free(pnew_data);
                                        stbi_image_free(pdata); // 释放内存

                                        //显示图像
                                        img = lv_img_create(temp_obj);
                                        lv_img_set_src(img, "A:/root/QR_bar_code.bmp");
                                        lv_obj_center(img);
#endif

                                        sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.bmp",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                                        stbi_write_bmp(bmp_name, width, height, 4, pnew_data);
                                        // 使用data进行图像处理...
                                        lv_mem_free(pnew_data);
                                        stbi_image_free(pdata); // 释放内存

                                        data = stbi_load(bmp_name, &width, &height, &channels, 0);
                                        if (!data) 
                                        {
                                            printf("错误：无法加载图片 %s\n", bmp_name);
                                        }
                                        printf("图片加载成功：%dx%d，%d 通道\n", width, height, channels);

                                        sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.png",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                                     
                                        success = stbi_write_png(bmp_name, width, height, channels, data, width * channels);
                                        if (!success) 
                                        {
                                            printf("错误：保存 PNG 失败\n");
                                        } 
                                        else
                                        {
                                            printf("PNG 保存成功：%s\n", bmp_name);
                                        }
                                        stbi_image_free(data); // 释放内存

                                        //显示图像
                                        img = lv_img_create(temp_obj);
                                        sprintf(bmp_name_1,"A:%s",bmp_name);
                                        lv_img_set_src(img, bmp_name_1);
                                        lv_obj_center(img);
            
                                        res = lv_img_decoder_get_info(bmp_name_1, &header);  // 直接传入文件路径

                                        if (res == LV_RES_OK)
                                        {
                                            printf("PNG: %dx%d\n", header.w, header.h);
                                        }
                                        else
                                        {
                                            printf("lv_img_decoder_get_info error\n");
                                        }

                                        lv_img_set_zoom(img,data_structure[i].data.qr_bar.size);

                                        width = header.w * data_structure[i].data.qr_bar.size / 256;
                                        height = header.h * data_structure[i].data.qr_bar.size / 256;

                                        lv_obj_set_size(temp_obj, width, height);

                                        lv_obj_align(temp_obj, LV_ALIGN_OUT_TOP_LEFT, data_structure[i].x, data_structure[i].y);

                                        break;
                                }
                                break;
                            case TYPE_BAR:

                                str_len = strlen(data_structure[i].data.qr_bar.text) + 1;
                                
                                temp_obj = lv_obj_create(win_content);
                                lv_obj_set_style_bg_opa(temp_obj, LV_OPA_TRANSP, 0);
                                lv_obj_set_style_border_width(temp_obj, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */

                                lv_obj_add_event_cb(temp_obj, drag_event_handler, LV_EVENT_PRESSING, NULL);
                                lv_obj_add_event_cb(temp_obj, drag_event_handler, LV_EVENT_FOCUSED, NULL);
                                lv_obj_add_event_cb(temp_obj, drag_event_handler, LV_EVENT_DEFOCUSED, NULL);
                                lv_obj_clear_flag(temp_obj, LV_OBJ_FLAG_SCROLLABLE);

                                my_symbol = ZBarcode_Create();
                                switch (data_structure[i].data.qr_bar.symbology )
                                {
                                    case 0:
                                    default:
                                        my_symbol->symbology = BARCODE_CODE39;
                                        height_len =  data_structure[i].data.qr_bar.height;
                                        my_symbol->scale = 1;
        
                                        if (data_structure[i].data.qr_bar.figure == 1)
                                        {
                                            my_symbol->show_hrt = 1;
                                            memcpy(my_symbol->text,lv_label_get_text(label_btn_addition_QR_code_text),strlen(lv_label_get_text(label_btn_addition_QR_code_text))+ 1);
                                        }
                                        else
                                        {
                                            my_symbol->show_hrt = 0;
                                        }

                                         if (data_structure[i].data.qr_bar.borders == 1)
                                        {
                                            my_symbol->output_options = BARCODE_BOX;
                                            my_symbol->whitespace_width = 3;
                                            my_symbol-> whitespace_height = 3; 
                                            my_symbol-> border_width = 2;   /* Size of border in X-dimensions */
                                        }
        
                                        strcpy(my_symbol->outfile, "out.bmp");
                                        ZBarcode_Encode(my_symbol, (unsigned char *)data_structure[i].data.qr_bar.text, 0);

                                        ZBarcode_Print(my_symbol, 0);
                                        //ZBarcode_Delete(my_symbol);

                                        pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                                        printf("width=%d\n\r", width);
                                        printf("height=%d\n\r", height);
                                        printf("channels=%d\n\r", channels);
                            
                                       // my_symbol->scale = (float)((float)150.0*(float)height_len/(float)100.0/(float)height);
                                        //  my_symbol->scale = (float)height_len/(float)height;
                                           my_symbol->scale = (float)((float)150.0*(float)height_len/(float)QR_BAR_MAX_HIGHT/(float)height);
                                        printf("scale=%f\n\r", (double)my_symbol->scale);
                
                                        strcpy(my_symbol->outfile, "out.bmp");
                                        ZBarcode_Encode(my_symbol, (unsigned char *)data_structure[i].data.qr_bar.text, 0);

                                        ZBarcode_Print(my_symbol, 0);
                                        ZBarcode_Delete(my_symbol);
                                        stbi_image_free(pdata);
                                
                                        pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                                        printf("width=%d\n\r", width);
                                        printf("height=%d\n\r", height);
                                        printf("channels=%d\n\r", channels);

                                        lv_obj_set_size(temp_obj, width, height);

                                        pnew_data = (unsigned char*)lv_mem_alloc(width * height * 4); // 为32位数据分配内存
                                        if (!pnew_data) 
                                        {
                                            fprintf(stderr, "Memory allocation failed\n");
                                            stbi_image_free(pdata);
                                            return;
                                        }
                                        else
                                        {
                                            printf("lv_mem_alloc ok\n\r");
                                        }

                                        for (int y = 0; y < height; y++) 
                                        {
                                            for (int x = 0; x < width; x++) 
                                            {
                                                int index = y * width + x; // 计算当前像素在原始数据中的索引
                                                unsigned char color = pdata[index]; // 获取当前像素的灰度值（0或255）
                                                // 映射到RGBA值

                                                if (color == 0)
                                                {
                                                    pnew_data[index * 4 + 0] = 0; // R
                                                    pnew_data[index * 4 + 1] = 0; // G
                                                    pnew_data[index * 4 + 2] = 0; // B
                                                    pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                                                }
                                                else
                                                {
                                                    pnew_data[index * 4 + 0] = 255; // R
                                                    pnew_data[index * 4 + 1] = 255; // G
                                                    pnew_data[index * 4 + 2] = 255; // B
                                                    pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                                                }
                                            }
                                        }

#if 0
                                        stbi_write_bmp("QR_bar_code.bmp", width, height, 4, pnew_data);
                                        // 使用data进行图像处理...
                                        lv_mem_free(pnew_data);
                                        stbi_image_free(pdata); // 释放内存

                                        //显示图像
                                        img = lv_img_create(temp_obj);
                                        lv_img_set_src(img, "A:/root/QR_bar_code.bmp");
                                        lv_obj_center(img);
#endif

                                        sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.bmp",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                                        stbi_write_bmp(bmp_name, width, height, 4, pnew_data);
                                        // 使用data进行图像处理...
                                        lv_mem_free(pnew_data);
                                        stbi_image_free(pdata); // 释放内存


                                        data = stbi_load(bmp_name, &width, &height, &channels, 0);
                                        if (!data) 
                                        {
                                            printf("错误：无法加载图片 %s\n", bmp_name);
                                        }
                                        printf("图片加载成功：%dx%d，%d 通道\n", width, height, channels);

                                        sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.png",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                                     
                                        success = stbi_write_png(bmp_name, width, height, channels, data, width * channels);
                                        if (!success) 
                                        {
                                            printf("错误：保存 PNG 失败\n");
                                        } 
                                        else
                                        {
                                            printf("PNG 保存成功：%s\n", bmp_name);
                                        }
                                        stbi_image_free(data); // 释放内存

                                        //显示图像
                                        img = lv_img_create(temp_obj);
                                        sprintf(bmp_name_1,"A:%s",bmp_name);
                                        lv_img_set_src(img, bmp_name_1);
                                        lv_obj_center(img);

                                        res = lv_img_decoder_get_info(bmp_name_1, &header);  // 直接传入文件路径

                                        if (res == LV_RES_OK)
                                        {
                                            printf("PNG: %dx%d\n", header.w, header.h);
                                        }
                                        else
                                        {
                                            printf("lv_img_decoder_get_info error\n");
                                        }

                                        lv_img_set_zoom(img,data_structure[i].data.qr_bar.size);

                                        width = header.w * data_structure[i].data.qr_bar.size / 256;
                                        height = header.h * data_structure[i].data.qr_bar.size / 256;

                                        lv_obj_set_size(temp_obj, width, height);

                                        lv_obj_align(temp_obj, LV_ALIGN_OUT_TOP_LEFT, data_structure[i].x, data_structure[i].y);

                                        break;
                                    case 1:
                                        my_symbol->symbology = BARCODE_CODE128;
                                        height_len = data_structure[win_content_child_num].data.qr_bar.height;
                                        my_symbol->scale = 1;

                                        if (data_structure[i].data.qr_bar.figure == 1)
                                        {
                                            my_symbol->show_hrt = 1;
                                            memcpy(my_symbol->text,lv_label_get_text(label_btn_addition_QR_code_text),strlen(lv_label_get_text(label_btn_addition_QR_code_text))+ 1);
                                        }
                                        else
                                        {
                                            my_symbol->show_hrt = 0;
                                        }

                                         if (data_structure[i].data.qr_bar.borders == 1)
                                        {
                                            my_symbol->output_options = BARCODE_BOX;
                                            my_symbol->whitespace_width = 3;
                                            my_symbol-> whitespace_height = 3; 
                                            my_symbol-> border_width = 2;   /* Size of border in X-dimensions */
                                        }

                                        strcpy(my_symbol->outfile, "out.bmp");
                                        ZBarcode_Encode(my_symbol, (unsigned char *)data_structure[i].data.qr_bar.text, 0);

                                        ZBarcode_Print(my_symbol, 0);
                                        //ZBarcode_Delete(my_symbol);

                                        pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                                        printf("width=%d\n\r", width);
                                        printf("height=%d\n\r", height);
                                        printf("channels=%d\n\r", channels);
                            
                                      //  my_symbol->scale = (float)((float)150.0*(float)height_len/(float)100.0/(float)height);
                                        // my_symbol->scale = (float)height_len/(float)height;
                                          my_symbol->scale = (float)((float)150.0*(float)height_len/(float)QR_BAR_MAX_HIGHT/(float)height);
                                        printf("scale=%f\n\r",(double)my_symbol->scale);
                
                                        strcpy(my_symbol->outfile, "out.bmp");
                                        ZBarcode_Encode(my_symbol, (unsigned char *)data_structure[i].data.qr_bar.text, 0);

                                        ZBarcode_Print(my_symbol, 0);
                                        ZBarcode_Delete(my_symbol);
                                        stbi_image_free(pdata);
                                
                                        pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                                        printf("width=%d\n\r", width);
                                        printf("height=%d\n\r", height);
                                        printf("channels=%d\n\r", channels);

                                        lv_obj_set_size(temp_obj, width, height);

                                        pnew_data = (unsigned char*)lv_mem_alloc(width * height * 4); // 为32位数据分配内存
                                        if (!pnew_data) 
                                        {
                                            fprintf(stderr, "Memory allocation failed\n");
                                            stbi_image_free(pdata);
                                            return;
                                        }
                                        else
                                        {
                                            printf("lv_mem_alloc ok\n\r");
                                        }

                                        for (int y = 0; y < height; y++) 
                                        {
                                            for (int x = 0; x < width; x++) 
                                            {
                                                int index = y * width + x; // 计算当前像素在原始数据中的索引
                                                unsigned char color = pdata[index]; // 获取当前像素的灰度值（0或255）
                                                // 映射到RGBA值

                                                if (color == 0)
                                                {
                                                    pnew_data[index * 4 + 0] = 0; // R
                                                    pnew_data[index * 4 + 1] = 0; // G
                                                    pnew_data[index * 4 + 2] = 0; // B
                                                    pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                                                }
                                                else
                                                {
                                                    pnew_data[index * 4 + 0] = 255; // R
                                                    pnew_data[index * 4 + 1] = 255; // G
                                                    pnew_data[index * 4 + 2] = 255; // B
                                                    pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                                                }
                                            }
                                        }

#if 0
                                        stbi_write_bmp("QR_bar_code.bmp", width, height, 4, pnew_data);
                                        // 使用data进行图像处理...
                                        lv_mem_free(pnew_data);
                                        stbi_image_free(pdata); // 释放内存

                                        //显示图像
                                        img = lv_img_create(temp_obj);
                                        lv_img_set_src(img, "A:/root/QR_bar_code.bmp");
                                        lv_obj_center(img);
#endif

                                        sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.bmp",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                                        stbi_write_bmp(bmp_name, width, height, 4, pnew_data);
                                        // 使用data进行图像处理...
                                        lv_mem_free(pnew_data);
                                        stbi_image_free(pdata); // 释放内存

                                        data = stbi_load(bmp_name, &width, &height, &channels, 0);
                                        if (!data) 
                                        {
                                            printf("错误：无法加载图片 %s\n", bmp_name);
                                        }
                                        printf("图片加载成功：%dx%d，%d 通道\n", width, height, channels);

                                        sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.png",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                                     
                                        success = stbi_write_png(bmp_name, width, height, channels, data, width * channels);
                                        if (!success) 
                                        {
                                            printf("错误：保存 PNG 失败\n");
                                        } 
                                        else
                                        {
                                            printf("PNG 保存成功：%s\n", bmp_name);
                                        }
                                        stbi_image_free(data); // 释放内存

                                        //显示图像
                                        img = lv_img_create(temp_obj);
                                        sprintf(bmp_name_1,"A:%s",bmp_name);
                                        lv_img_set_src(img, bmp_name_1);
                                        lv_obj_center(img);

                                        res = lv_img_decoder_get_info(bmp_name_1, &header);  // 直接传入文件路径

                                        if (res == LV_RES_OK)
                                        {
                                            printf("PNG: %dx%d\n", header.w, header.h);
                                        }
                                        else
                                        {
                                            printf("lv_img_decoder_get_info error\n");
                                        }

                                        lv_img_set_zoom(img,data_structure[i].data.qr_bar.size);

                                        width = header.w * data_structure[i].data.qr_bar.size / 256;
                                        height = header.h * data_structure[i].data.qr_bar.size / 256;

                                        lv_obj_set_size(temp_obj, width, height);


                                        lv_obj_align(temp_obj, LV_ALIGN_OUT_TOP_LEFT, data_structure[i].x, data_structure[i].y);

                                        break;
                                    case 2:
                                    case 3:
                                        my_symbol->symbology = BARCODE_EANX;
                                        height_len = data_structure[i].data.qr_bar.height;
                                        my_symbol->scale = 1;

                                        if (data_structure[i].data.qr_bar.figure == 1)
                                        {
                                            my_symbol->show_hrt = 1;
                                            memcpy(my_symbol->text,lv_label_get_text(label_btn_addition_QR_code_text),strlen(lv_label_get_text(label_btn_addition_QR_code_text))+ 1);
                                        }
                                        else
                                        {
                                            my_symbol->show_hrt = 0;
                                        }

                                         if (data_structure[i].data.qr_bar.borders == 1)
                                        {
                                            my_symbol->output_options = BARCODE_BOX;
                                            my_symbol->whitespace_width = 3;
                                            my_symbol-> whitespace_height = 3; 
                                            my_symbol-> border_width = 2;   /* Size of border in X-dimensions */
                                        }

                                        strcpy(my_symbol->outfile, "out.bmp");
                                        ZBarcode_Encode(my_symbol, (unsigned char *)data_structure[i].data.qr_bar.text, 0);

                                        ZBarcode_Print(my_symbol, 0);
                                        //ZBarcode_Delete(my_symbol);

                                        pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                                        printf("width=%d\n\r", width);
                                        printf("height=%d\n\r", height);
                                        printf("channels=%d\n\r", channels);
                            
                                     //   my_symbol->scale = (float)((float)150.0*(float)height_len/(float)100.0/(float)height);
                                        //my_symbol->scale = (float)height_len/(float)height;
                                         my_symbol->scale = (float)((float)150.0*(float)height_len/(float)QR_BAR_MAX_HIGHT/(float)height);
                                        printf("scale=%f\n\r", (double)my_symbol->scale);
                
                                        strcpy(my_symbol->outfile, "out.bmp");
                                        ZBarcode_Encode(my_symbol, (unsigned char *)data_structure[i].data.qr_bar.text, 0);

                                        ZBarcode_Print(my_symbol, 0);
                                        ZBarcode_Delete(my_symbol);
                                        stbi_image_free(pdata);
                                
                                        pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                                        printf("width=%d\n\r", width);
                                        printf("height=%d\n\r", height);
                                        printf("channels=%d\n\r", channels);

                                        lv_obj_set_size(temp_obj, width, height);

                                        pnew_data = (unsigned char*)lv_mem_alloc(width * height * 4); // 为32位数据分配内存
                                        if (!pnew_data) 
                                        {
                                            fprintf(stderr, "Memory allocation failed\n");
                                            stbi_image_free(pdata);
                                            return;
                                        }
                                        else
                                        {
                                            printf("lv_mem_alloc ok\n\r");
                                        }

                                        for (int y = 0; y < height; y++) 
                                        {
                                            for (int x = 0; x < width; x++) 
                                            {
                                                int index = y * width + x; // 计算当前像素在原始数据中的索引
                                                unsigned char color = pdata[index]; // 获取当前像素的灰度值（0或255）
                                                // 映射到RGBA值

                                                if (color == 0)
                                                {
                                                    pnew_data[index * 4 + 0] = 0; // R
                                                    pnew_data[index * 4 + 1] = 0; // G
                                                    pnew_data[index * 4 + 2] = 0; // B
                                                    pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                                                }
                                                else
                                                {
                                                    pnew_data[index * 4 + 0] = 255; // R
                                                    pnew_data[index * 4 + 1] = 255; // G
                                                    pnew_data[index * 4 + 2] = 255; // B
                                                    pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                                                }
                                            }
                                        }

#if 0
                                        stbi_write_bmp("QR_bar_code.bmp", width, height, 4, pnew_data);
                                        // 使用data进行图像处理...
                                        lv_mem_free(pnew_data);
                                        stbi_image_free(pdata); // 释放内存

                                        //显示图像
                                        img = lv_img_create(temp_obj);
                                        lv_img_set_src(img, "A:/root/QR_bar_code.bmp");
                                        lv_obj_center(img);
#endif

                                        sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.bmp",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                                        stbi_write_bmp(bmp_name, width, height, 4, pnew_data);
                                        // 使用data进行图像处理...
                                        lv_mem_free(pnew_data);
                                        stbi_image_free(pdata); // 释放内存

                                        data = stbi_load(bmp_name, &width, &height, &channels, 0);
                                        if (!data) 
                                        {
                                            printf("错误：无法加载图片 %s\n", bmp_name);
                                        }
                                        printf("图片加载成功：%dx%d，%d 通道\n", width, height, channels);

                                        sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.png",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                                     
                                        success = stbi_write_png(bmp_name, width, height, channels, data, width * channels);
                                        if (!success) 
                                        {
                                            printf("错误：保存 PNG 失败\n");
                                        } 
                                        else
                                        {
                                            printf("PNG 保存成功：%s\n", bmp_name);
                                        }
                                        stbi_image_free(data); // 释放内存

                                        //显示图像
                                        img = lv_img_create(temp_obj);
                                        sprintf(bmp_name_1,"A:%s",bmp_name);
                                        lv_img_set_src(img, bmp_name_1);
                                        lv_obj_center(img);

                                        res = lv_img_decoder_get_info(bmp_name_1, &header);  // 直接传入文件路径

                                        if (res == LV_RES_OK)
                                        {
                                            printf("PNG: %dx%d\n", header.w, header.h);
                                        }
                                        else
                                        {
                                            printf("lv_img_decoder_get_info error\n");
                                        }

                                        lv_img_set_zoom(img,data_structure[i].data.qr_bar.size);

                                        width = header.w * data_structure[i].data.qr_bar.size / 256;
                                        height = header.h * data_structure[i].data.qr_bar.size / 256;

                                        lv_obj_set_size(temp_obj, width, height);

                                        lv_obj_align(temp_obj, LV_ALIGN_OUT_TOP_LEFT, data_structure[i].x, data_structure[i].y);

                                        break;
                                    case 4:
                                        my_symbol->symbology = BARCODE_EAN128;
                                        my_symbol->input_mode |= GS1PARENS_MODE;
                                        height_len =  data_structure[i].data.qr_bar.height ;
                                        my_symbol->scale = 1;

                                        if (data_structure[i].data.qr_bar.figure == 1)
                                        {
                                            my_symbol->show_hrt = 1;
                                            memcpy(my_symbol->text,lv_label_get_text(label_btn_addition_QR_code_text),strlen(lv_label_get_text(label_btn_addition_QR_code_text))+ 1);
                                        }
                                        else
                                        {
                                            my_symbol->show_hrt = 0;
                                        }

                                         if (data_structure[i].data.qr_bar.borders == 1)
                                        {
                                            my_symbol->output_options = BARCODE_BOX;
                                            my_symbol->whitespace_width = 3;
                                            my_symbol-> whitespace_height = 3; 
                                            my_symbol-> border_width = 2;   /* Size of border in X-dimensions */
                                        }
                                        strcpy(my_symbol->outfile, "out.bmp");

                                        ZBarcode_Encode(my_symbol, (unsigned char *)data_structure[i].data.qr_bar.text, 0);
                                        //ZBarcode_Encode(my_symbol, (unsigned char *)"(01)98898765432106(3202)012345(15)991231", 0);

                                        ZBarcode_Print(my_symbol, 0);
                                        //ZBarcode_Delete(my_symbol);

                                        pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                                        printf("width=%d\n\r", width);
                                        printf("height=%d\n\r", height);
                                        printf("channels=%d\n\r", channels);
                            
                                        my_symbol->scale = (float)((float)118.0*(float)height_len/(float)QR_BAR_MAX_HIGHT/(float)height);
                                        printf("scale=%f\n\r",(double)my_symbol->scale);
                
                                        strcpy(my_symbol->outfile, "out.bmp");
                                        ZBarcode_Encode(my_symbol, (unsigned char *)data_structure[i].data.qr_bar.text, 0);

                                        ZBarcode_Print(my_symbol, 0);
                                        ZBarcode_Delete(my_symbol);
                                        stbi_image_free(pdata);
                                
                                        pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                                        printf("width=%d\n\r", width);
                                        printf("height=%d\n\r", height);
                                        printf("channels=%d\n\r", channels);

                                        lv_obj_set_size(temp_obj, width, height);

                                        pnew_data = (unsigned char*)lv_mem_alloc(width * height * 4); // 为32位数据分配内存
                                        if (!pnew_data) 
                                        {
                                            fprintf(stderr, "Memory allocation failed\n");
                                            stbi_image_free(pdata);
                                            return;
                                        }
                                        else
                                        {
                                            printf("lv_mem_alloc ok\n\r");
                                        }

                                        for (int y = 0; y < height; y++) 
                                        {
                                            for (int x = 0; x < width; x++) 
                                            {
                                                int index = y * width + x; // 计算当前像素在原始数据中的索引
                                                unsigned char color = pdata[index]; // 获取当前像素的灰度值（0或255）
                                                // 映射到RGBA值

                                                if (color == 0)
                                                {
                                                    pnew_data[index * 4 + 0] = 0; // R
                                                    pnew_data[index * 4 + 1] = 0; // G
                                                    pnew_data[index * 4 + 2] = 0; // B
                                                    pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                                                }
                                                else
                                                {
                                                    pnew_data[index * 4 + 0] = 255; // R
                                                    pnew_data[index * 4 + 1] = 255; // G
                                                    pnew_data[index * 4 + 2] = 255; // B
                                                    pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                                                }
                                            }
                                        }

#if 0
                                        stbi_write_bmp("QR_bar_code.bmp", width, height, 4, pnew_data);
                                        // 使用data进行图像处理...
                                        lv_mem_free(pnew_data);
                                        stbi_image_free(pdata); // 释放内存

                                        //显示图像
                                        img = lv_img_create(temp_obj);
                                        lv_img_set_src(img, "A:/root/QR_bar_code.bmp");
                                        lv_obj_center(img);
#endif

                                        sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.bmp",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                                        stbi_write_bmp(bmp_name, width, height, 4, pnew_data);
                                        // 使用data进行图像处理...
                                        lv_mem_free(pnew_data);
                                        stbi_image_free(pdata); // 释放内存

                                        data = stbi_load(bmp_name, &width, &height, &channels, 0);
                                        if (!data) 
                                        {
                                            printf("错误：无法加载图片 %s\n", bmp_name);
                                        }
                                        printf("图片加载成功：%dx%d，%d 通道\n", width, height, channels);

                                        sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.png",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                                     
                                        success = stbi_write_png(bmp_name, width, height, channels, data, width * channels);
                                        if (!success) 
                                        {
                                            printf("错误：保存 PNG 失败\n");
                                        } 
                                        else
                                        {
                                            printf("PNG 保存成功：%s\n", bmp_name);
                                        }
                                        stbi_image_free(data); // 释放内存

                                        //显示图像
                                        img = lv_img_create(temp_obj);
                                        sprintf(bmp_name_1,"A:%s",bmp_name);
                                        lv_img_set_src(img, bmp_name_1);
                                        lv_obj_center(img);

                                        res = lv_img_decoder_get_info(bmp_name_1, &header);  // 直接传入文件路径

                                        if (res == LV_RES_OK)
                                        {
                                            printf("PNG: %dx%d\n", header.w, header.h);
                                        }
                                        else
                                        {
                                            printf("lv_img_decoder_get_info error\n");
                                        }

                                        lv_img_set_zoom(img,data_structure[i].data.qr_bar.size);

                                        width = header.w * data_structure[i].data.qr_bar.size / 256;
                                        height = header.h * data_structure[i].data.qr_bar.size / 256;

                                        lv_obj_set_size(temp_obj, width, height);

                                        lv_obj_align(temp_obj, LV_ALIGN_OUT_TOP_LEFT, data_structure[i].x, data_structure[i].y);

                                        break;
                                    case 5:
                                        my_symbol->symbology = BARCODE_UPCA;
                                        height_len = data_structure[i].data.qr_bar.height;
                                        my_symbol->scale = 1;

                                        if (data_structure[i].data.qr_bar.figure == 1)
                                        {
                                            my_symbol->show_hrt = 1;
                                            memcpy(my_symbol->text,lv_label_get_text(label_btn_addition_QR_code_text),strlen(lv_label_get_text(label_btn_addition_QR_code_text))+ 1);
                                        }
                                        else
                                        {
                                            my_symbol->show_hrt = 0;
                                        }

                                         if (data_structure[i].data.qr_bar.borders == 1)
                                        {
                                            my_symbol->output_options = BARCODE_BOX;
                                            my_symbol->whitespace_width = 3;
                                            my_symbol-> whitespace_height = 3; 
                                            my_symbol-> border_width = 2;   /* Size of border in X-dimensions */
                                        }

                                        strcpy(my_symbol->outfile, "out.bmp");
                                        ZBarcode_Encode(my_symbol, (unsigned char *)data_structure[i].data.qr_bar.text, 0);

                                        ZBarcode_Print(my_symbol, 0);
                                        //ZBarcode_Delete(my_symbol);

                                        pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                                        printf("width=%d\n\r", width);
                                        printf("height=%d\n\r", height);
                                        printf("channels=%d\n\r", channels);
                            
                                      //  my_symbol->scale = (float)((float)150.0*(float)height_len/(float)100.0/(float)height);
                                         //my_symbol->scale = (float)height_len/(float)height;
                                          my_symbol->scale = (float)((float)150.0*(float)height_len/(float)QR_BAR_MAX_HIGHT/(float)height);
                                        printf("scale=%f\n\r",(double)my_symbol->scale);
                
                                        strcpy(my_symbol->outfile, "out.bmp");
                                        ZBarcode_Encode(my_symbol, (unsigned char *)data_structure[i].data.qr_bar.text, 0);

                                        ZBarcode_Print(my_symbol, 0);
                                        ZBarcode_Delete(my_symbol);
                                        stbi_image_free(pdata);
                                
                                        pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                                        printf("width=%d\n\r", width);
                                        printf("height=%d\n\r", height);
                                        printf("channels=%d\n\r", channels);

                                        lv_obj_set_size(temp_obj, width, height);

                                        pnew_data = (unsigned char*)lv_mem_alloc(width * height * 4); // 为32位数据分配内存
                                        if (!pnew_data) 
                                        {
                                            fprintf(stderr, "Memory allocation failed\n");
                                            stbi_image_free(pdata);
                                            return;
                                        }
                                        else
                                        {
                                            printf("lv_mem_alloc ok\n\r");
                                        }

                                        for (int y = 0; y < height; y++) 
                                        {
                                            for (int x = 0; x < width; x++) 
                                            {
                                                int index = y * width + x; // 计算当前像素在原始数据中的索引
                                                unsigned char color = pdata[index]; // 获取当前像素的灰度值（0或255）
                                                // 映射到RGBA值

                                                if (color == 0)
                                                {
                                                    pnew_data[index * 4 + 0] = 0; // R
                                                    pnew_data[index * 4 + 1] = 0; // G
                                                    pnew_data[index * 4 + 2] = 0; // B
                                                    pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                                                }
                                                else
                                                {
                                                    pnew_data[index * 4 + 0] = 255; // R
                                                    pnew_data[index * 4 + 1] = 255; // G
                                                    pnew_data[index * 4 + 2] = 255; // B
                                                    pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                                                }
                                            }
                                        }

#if 0
                                        stbi_write_bmp("QR_bar_code.bmp", width, height, 4, pnew_data);
                                        // 使用data进行图像处理...
                                        lv_mem_free(pnew_data);
                                        stbi_image_free(pdata); // 释放内存

                                        //显示图像
                                        img = lv_img_create(temp_obj);
                                        lv_img_set_src(img, "A:/root/QR_bar_code.bmp");
                                        lv_obj_center(img);
#endif

                                        sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.bmp",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                                        stbi_write_bmp(bmp_name, width, height, 4, pnew_data);
                                        // 使用data进行图像处理...
                                        lv_mem_free(pnew_data);
                                        stbi_image_free(pdata); // 释放内存

                                        data = stbi_load(bmp_name, &width, &height, &channels, 0);
                                        if (!data) 
                                        {
                                            printf("错误：无法加载图片 %s\n", bmp_name);
                                        }
                                        printf("图片加载成功：%dx%d，%d 通道\n", width, height, channels);

                                        sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.png",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                                     
                                        success = stbi_write_png(bmp_name, width, height, channels, data, width * channels);
                                        if (!success) 
                                        {
                                            printf("错误：保存 PNG 失败\n");
                                        } 
                                        else
                                        {
                                            printf("PNG 保存成功：%s\n", bmp_name);
                                        }
                                        stbi_image_free(data); // 释放内存

                                        //显示图像
                                        img = lv_img_create(temp_obj);
                                        sprintf(bmp_name_1,"A:%s",bmp_name);
                                        lv_img_set_src(img, bmp_name_1);
                                        lv_obj_center(img);

                                        res = lv_img_decoder_get_info(bmp_name_1, &header);  // 直接传入文件路径

                                        if (res == LV_RES_OK)
                                        {
                                            printf("PNG: %dx%d\n", header.w, header.h);
                                        }
                                        else
                                        {
                                            printf("lv_img_decoder_get_info error\n");
                                        }

                                        lv_img_set_zoom(img,data_structure[i].data.qr_bar.size);

                                        width = header.w * data_structure[i].data.qr_bar.size / 256;
                                        height = header.h * data_structure[i].data.qr_bar.size / 256;

                                        lv_obj_set_size(temp_obj, width, height);

                                        lv_obj_align(temp_obj, LV_ALIGN_OUT_TOP_LEFT, data_structure[i].x, data_structure[i].y);

                                        break;
                                    case 6:
                                        my_symbol->symbology = BARCODE_UPCE;
                                        height_len = data_structure[i].data.qr_bar.height;
                                        my_symbol->scale = 1;

                                        if (data_structure[i].data.qr_bar.figure == 1)
                                        {
                                            my_symbol->show_hrt = 1;
                                            memcpy(my_symbol->text,lv_label_get_text(label_btn_addition_QR_code_text),strlen(lv_label_get_text(label_btn_addition_QR_code_text))+ 1);
                                        }
                                        else
                                        {
                                            my_symbol->show_hrt = 0;
                                        }

                                         if (data_structure[i].data.qr_bar.borders == 1)
                                        {
                                            my_symbol->output_options = BARCODE_BOX;
                                            my_symbol->whitespace_width = 3;
                                            my_symbol-> whitespace_height = 3; 
                                            my_symbol-> border_width = 2;   /* Size of border in X-dimensions */
                                        }
                                        strcpy(my_symbol->outfile, "out.bmp");
                                        ZBarcode_Encode(my_symbol, (unsigned char *)data_structure[i].data.qr_bar.text, 0);

                                        ZBarcode_Print(my_symbol, 0);
                                        //ZBarcode_Delete(my_symbol);

                                        pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                                        printf("width=%d\n\r", width);
                                        printf("height=%d\n\r", height);
                                        printf("channels=%d\n\r", channels);
                            
                                      //  my_symbol->scale = (float)((float)150.0*(float)height_len/(float)100.0/(float)height);
                                        // my_symbol->scale = (float)height_len/(float)height;
                                          my_symbol->scale = (float)((float)150.0*(float)height_len/(float)QR_BAR_MAX_HIGHT/(float)height);
                                        printf("scale=%f\n\r", (double)my_symbol->scale);
                
                                        strcpy(my_symbol->outfile, "out.bmp");
                                        ZBarcode_Encode(my_symbol, (unsigned char *)data_structure[i].data.qr_bar.text, 0);

                                        ZBarcode_Print(my_symbol, 0);
                                        ZBarcode_Delete(my_symbol);
                                        stbi_image_free(pdata);
                                
                                        pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                                        printf("width=%d\n\r", width);
                                        printf("height=%d\n\r", height);
                                        printf("channels=%d\n\r", channels);

                                        lv_obj_set_size(temp_obj, width, height);

                                        pnew_data = (unsigned char*)lv_mem_alloc(width * height * 4); // 为32位数据分配内存
                                        if (!pnew_data) 
                                        {
                                            fprintf(stderr, "Memory allocation failed\n");
                                            stbi_image_free(pdata);
                                            return;
                                        }
                                        else
                                        {
                                            printf("lv_mem_alloc ok\n\r");
                                        }

                                        for (int y = 0; y < height; y++) 
                                        {
                                            for (int x = 0; x < width; x++) 
                                            {
                                                int index = y * width + x; // 计算当前像素在原始数据中的索引
                                                unsigned char color = pdata[index]; // 获取当前像素的灰度值（0或255）
                                                // 映射到RGBA值

                                                if (color == 0)
                                                {
                                                    pnew_data[index * 4 + 0] = 0; // R
                                                    pnew_data[index * 4 + 1] = 0; // G
                                                    pnew_data[index * 4 + 2] = 0; // B
                                                    pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                                                }
                                                else
                                                {
                                                    pnew_data[index * 4 + 0] = 255; // R
                                                    pnew_data[index * 4 + 1] = 255; // G
                                                    pnew_data[index * 4 + 2] = 255; // B
                                                    pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                                                }
                                            }
                                        }

#if 0
                                        stbi_write_bmp("QR_bar_code.bmp", width, height, 4, pnew_data);
                                        // 使用data进行图像处理...
                                        lv_mem_free(pnew_data);
                                        stbi_image_free(pdata); // 释放内存

                                        //显示图像
                                        img = lv_img_create(temp_obj);
                                        lv_img_set_src(img, "A:/root/QR_bar_code.bmp");
                                        lv_obj_center(img);     
#endif

                                        sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.bmp",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                                        stbi_write_bmp(bmp_name, width, height, 4, pnew_data);
                                        // 使用data进行图像处理...
                                        lv_mem_free(pnew_data);
                                        stbi_image_free(pdata); // 释放内存

                                        data = stbi_load(bmp_name, &width, &height, &channels, 0);
                                        if (!data) 
                                        {
                                            printf("错误：无法加载图片 %s\n", bmp_name);
                                        }
                                        printf("图片加载成功：%dx%d，%d 通道\n", width, height, channels);

                                        sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.png",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                                     
                                        success = stbi_write_png(bmp_name, width, height, channels, data, width * channels);
                                        if (!success) 
                                        {
                                            printf("错误：保存 PNG 失败\n");
                                        } 
                                        else
                                        {
                                            printf("PNG 保存成功：%s\n", bmp_name);
                                        }
                                        stbi_image_free(data); // 释放内存

                                        //显示图像
                                        img = lv_img_create(temp_obj);
                                        sprintf(bmp_name_1,"A:%s",bmp_name);
                                        lv_img_set_src(img, bmp_name_1);
                                        lv_obj_center(img); 

                                        res = lv_img_decoder_get_info(bmp_name_1, &header);  // 直接传入文件路径

                                        if (res == LV_RES_OK)
                                        {
                                            printf("PNG: %dx%d\n", header.w, header.h);
                                        }
                                        else
                                        {
                                            printf("lv_img_decoder_get_info error\n");
                                        }

                                        lv_img_set_zoom(img,data_structure[i].data.qr_bar.size);

                                        width = header.w * data_structure[i].data.qr_bar.size / 256;
                                        height = header.h * data_structure[i].data.qr_bar.size / 256;

                                        lv_obj_set_size(temp_obj, width, height);

                                        lv_obj_align(temp_obj, LV_ALIGN_OUT_TOP_LEFT, data_structure[i].x, data_structure[i].y); 

                                        break;
                                    case 7:
                                        my_symbol->symbology = BARCODE_ITF14;
                                        height_len = data_structure[i].data.qr_bar.height;
                                        my_symbol->scale = 1;

                                        if (data_structure[i].data.qr_bar.figure == 1)
                                        {
                                            my_symbol->show_hrt = 1;
                                            memcpy(my_symbol->text,lv_label_get_text(label_btn_addition_QR_code_text),strlen(lv_label_get_text(label_btn_addition_QR_code_text))+ 1);
                                        }
                                        else
                                        {
                                            my_symbol->show_hrt = 0;
                                        }

                                         if (data_structure[i].data.qr_bar.borders == 1)
                                        {
                                            my_symbol->output_options = BARCODE_BOX;
                                            my_symbol->whitespace_width = 3;
                                            my_symbol-> whitespace_height = 3; 
                                            my_symbol-> border_width = 2;   /* Size of border in X-dimensions */
                                        }

                                        strcpy(my_symbol->outfile, "out.bmp");
                                        ZBarcode_Encode(my_symbol, (unsigned char *)data_structure[i].data.qr_bar.text, 0);

                                        ZBarcode_Print(my_symbol, 0);
                                        //ZBarcode_Delete(my_symbol);

                                        pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                                        printf("width=%d\n\r", width);
                                        printf("height=%d\n\r", height);
                                        printf("channels=%d\n\r", channels);
                            
                                      //  my_symbol->scale = (float)((float)150.0*(float)height_len/(float)100.0/(float)height);
                                         //my_symbol->scale = (float)height_len/(float)height;
                                          my_symbol->scale = (float)((float)150.0*(float)height_len/(float)QR_BAR_MAX_HIGHT/(float)height);
                                        printf("scale=%f\n\r", (double)my_symbol->scale);
                
                                        strcpy(my_symbol->outfile, "out.bmp");
                                        ZBarcode_Encode(my_symbol, (unsigned char *)data_structure[i].data.qr_bar.text, 0);

                                        ZBarcode_Print(my_symbol, 0);
                                        ZBarcode_Delete(my_symbol);
                                        stbi_image_free(pdata);
                                
                                        pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                                        printf("width=%d\n\r", width);
                                        printf("height=%d\n\r", height);
                                        printf("channels=%d\n\r", channels);

                                        lv_obj_set_size(temp_obj, width, height);

                                        pnew_data = (unsigned char*)lv_mem_alloc(width * height * 4); // 为32位数据分配内存
                                        if (!pnew_data) 
                                        {
                                            fprintf(stderr, "Memory allocation failed\n");
                                            stbi_image_free(pdata);
                                            return;
                                        }
                                        else
                                        {
                                            printf("lv_mem_alloc ok\n\r");
                                        }

                                        for (int y = 0; y < height; y++) 
                                        {
                                            for (int x = 0; x < width; x++) 
                                            {
                                                int index = y * width + x; // 计算当前像素在原始数据中的索引
                                                unsigned char color = pdata[index]; // 获取当前像素的灰度值（0或255）
                                                // 映射到RGBA值

                                                if (color == 0)
                                                {
                                                    pnew_data[index * 4 + 0] = 0; // R
                                                    pnew_data[index * 4 + 1] = 0; // G
                                                    pnew_data[index * 4 + 2] = 0; // B
                                                    pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                                                }
                                                else
                                                {
                                                    pnew_data[index * 4 + 0] = 255; // R
                                                    pnew_data[index * 4 + 1] = 255; // G
                                                    pnew_data[index * 4 + 2] = 255; // B
                                                    pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                                                }
                                            }
                                        }

#if 0
                                        stbi_write_bmp("QR_bar_code.bmp", width, height, 4, pnew_data);
                                        // 使用data进行图像处理...
                                        lv_mem_free(pnew_data);
                                        stbi_image_free(pdata); // 释放内存

                                        //显示图像
                                        img = lv_img_create(temp_obj);
                                        lv_img_set_src(img, "A:/root/QR_bar_code.bmp");
                                        lv_obj_center(img);
#endif

                                        sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.bmp",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                                        stbi_write_bmp(bmp_name, width, height, 4, pnew_data);
                                        // 使用data进行图像处理...
                                        lv_mem_free(pnew_data);
                                        stbi_image_free(pdata); // 释放内存


                                        data = stbi_load(bmp_name, &width, &height, &channels, 0);
                                        if (!data) 
                                        {
                                            printf("错误：无法加载图片 %s\n", bmp_name);
                                        }
                                        printf("图片加载成功：%dx%d，%d 通道\n", width, height, channels);

                                        sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.png",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                                     
                                        success = stbi_write_png(bmp_name, width, height, channels, data, width * channels);
                                        if (!success) 
                                        {
                                            printf("错误：保存 PNG 失败\n");
                                        } 
                                        else
                                        {
                                            printf("PNG 保存成功：%s\n", bmp_name);
                                        }
                                        stbi_image_free(data); // 释放内存

                                        //显示图像
                                        img = lv_img_create(temp_obj);
                                        sprintf(bmp_name_1,"A:%s",bmp_name);
                                        lv_img_set_src(img, bmp_name_1);
                                        lv_obj_center(img);

                                        res = lv_img_decoder_get_info(bmp_name_1, &header);  // 直接传入文件路径

                                        if (res == LV_RES_OK)
                                        {
                                            printf("PNG: %dx%d\n", header.w, header.h);
                                        }
                                        else
                                        {
                                            printf("lv_img_decoder_get_info error\n");
                                        }

                                        lv_img_set_zoom(img,data_structure[i].data.qr_bar.size);

                                        width = header.w * data_structure[i].data.qr_bar.size / 256;
                                        height = header.h * data_structure[i].data.qr_bar.size / 256;

                                        lv_obj_set_size(temp_obj, width, height);

                                        lv_obj_align(temp_obj, LV_ALIGN_OUT_TOP_LEFT, data_structure[i].x, data_structure[i].y); 

                                        break;
                                    case 8:
                                        my_symbol->symbology = BARCODE_C25INTER;
                                        height_len = data_structure[i].data.qr_bar.height;
                                        my_symbol->scale = 1;

                                        if (data_structure[i].data.qr_bar.figure == 1)
                                        {
                                            my_symbol->show_hrt = 1;
                                            memcpy(my_symbol->text,lv_label_get_text(label_btn_addition_QR_code_text),strlen(lv_label_get_text(label_btn_addition_QR_code_text))+ 1);
                                        }
                                        else
                                        {
                                            my_symbol->show_hrt = 0;
                                        }

                                         if (data_structure[i].data.qr_bar.borders == 1)
                                        {
                                            my_symbol->output_options = BARCODE_BOX;
                                            my_symbol->whitespace_width = 3;
                                            my_symbol-> whitespace_height = 3; 
                                            my_symbol-> border_width = 2;   /* Size of border in X-dimensions */
                                        }

                                        strcpy(my_symbol->outfile, "out.bmp");
                                        ZBarcode_Encode(my_symbol, (unsigned char *)data_structure[i].data.qr_bar.text, 0);

                                        ZBarcode_Print(my_symbol, 0);
                                        //ZBarcode_Delete(my_symbol);

                                        pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                                        printf("width=%d\n\r", width);
                                        printf("height=%d\n\r", height);
                                        printf("channels=%d\n\r", channels);
                            
                                      //  my_symbol->scale = (float)((float)150.0*(float)height_len/(float)100.0/(float)height);
                                        // my_symbol->scale = (float)height_len/(float)height;
                                          my_symbol->scale = (float)((float)150.0*(float)height_len/(float)QR_BAR_MAX_HIGHT/(float)height);
                                        printf("scale=%f\n\r", (double)my_symbol->scale);
                
                                        strcpy(my_symbol->outfile, "out.bmp");
                                        ZBarcode_Encode(my_symbol, (unsigned char *)data_structure[i].data.qr_bar.text, 0);

                                        ZBarcode_Print(my_symbol, 0);
                                        ZBarcode_Delete(my_symbol);
                                        stbi_image_free(pdata);
                        
                                        pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                                        printf("width=%d\n\r", width);
                                        printf("height=%d\n\r", height);
                                        printf("channels=%d\n\r", channels);

                                        lv_obj_set_size(temp_obj, width, height);

                                        pnew_data = (unsigned char*)lv_mem_alloc(width * height * 4); // 为32位数据分配内存
                                        if (!pnew_data) 
                                        {
                                            fprintf(stderr, "Memory allocation failed\n");
                                            stbi_image_free(pdata);
                                            return;
                                        }
                                        else
                                        {
                                            printf("lv_mem_alloc ok\n\r");
                                        }

                                        for (int y = 0; y < height; y++) 
                                        {
                                            for (int x = 0; x < width; x++) 
                                            {
                                                int index = y * width + x; // 计算当前像素在原始数据中的索引
                                                unsigned char color = pdata[index]; // 获取当前像素的灰度值（0或255）
                                                // 映射到RGBA值

                                                if (color == 0)
                                                {
                                                    pnew_data[index * 4 + 0] = 0; // R
                                                    pnew_data[index * 4 + 1] = 0; // G
                                                    pnew_data[index * 4 + 2] = 0; // B
                                                    pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                                                }
                                                else
                                                {
                                                    pnew_data[index * 4 + 0] = 255; // R
                                                    pnew_data[index * 4 + 1] = 255; // G
                                                    pnew_data[index * 4 + 2] = 255; // B
                                                    pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                                                }
                                            }
                                        }

#if 0
                                        stbi_write_bmp("QR_bar_code.bmp", width, height, 4, pnew_data);
                                        // 使用data进行图像处理...
                                        lv_mem_free(pnew_data);
                                        stbi_image_free(pdata); // 释放内存

                                        //显示图像
                                        img = lv_img_create(temp_obj);
                                        lv_img_set_src(img, "A:/root/QR_bar_code.bmp");
                                        lv_obj_center(img);
#endif

                                        sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.bmp",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                                        stbi_write_bmp(bmp_name, width, height, 4, pnew_data);
                                        // 使用data进行图像处理...
                                        lv_mem_free(pnew_data);
                                        stbi_image_free(pdata); // 释放内存


                                        data = stbi_load(bmp_name, &width, &height, &channels, 0);
                                        if (!data) 
                                        {
                                            printf("错误：无法加载图片 %s\n", bmp_name);
                                        }
                                        printf("图片加载成功：%dx%d，%d 通道\n", width, height, channels);

                                        sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.png",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                                     
                                        success = stbi_write_png(bmp_name, width, height, channels, data, width * channels);
                                        if (!success) 
                                        {
                                            printf("错误：保存 PNG 失败\n");
                                        } 
                                        else
                                        {
                                            printf("PNG 保存成功：%s\n", bmp_name);
                                        }
                                        stbi_image_free(data); // 释放内存

                                        //显示图像
                                        img = lv_img_create(temp_obj);
                                        sprintf(bmp_name_1,"A:%s",bmp_name);
                                        lv_img_set_src(img, bmp_name_1);
                                        lv_obj_center(img);

                                        res = lv_img_decoder_get_info(bmp_name_1, &header);  // 直接传入文件路径

                                        if (res == LV_RES_OK)
                                        {
                                            printf("PNG: %dx%d\n", header.w, header.h);
                                        }
                                        else
                                        {
                                            printf("lv_img_decoder_get_info error\n");
                                        }

                                        lv_img_set_zoom(img,data_structure[i].data.qr_bar.size);

                                        width = header.w * data_structure[i].data.qr_bar.size / 256;
                                        height = header.h * data_structure[i].data.qr_bar.size / 256;

                                        lv_obj_set_size(temp_obj, width, height);

                                        lv_obj_align(temp_obj, LV_ALIGN_OUT_TOP_LEFT, data_structure[i].x, data_structure[i].y); 

                                        break;
                                    case 9:
                                        my_symbol->symbology = BARCODE_EAN14;
                                        height_len = data_structure[i].data.qr_bar.height;
                                        my_symbol->scale = 1;
                         
                                        if (data_structure[i].data.qr_bar.figure == 1)
                                        {
                                            my_symbol->show_hrt = 1;
                                            memcpy(my_symbol->text,lv_label_get_text(label_btn_addition_QR_code_text),strlen(lv_label_get_text(label_btn_addition_QR_code_text))+ 1);
                                        }
                                        else
                                        {
                                            my_symbol->show_hrt = 0;
                                        }

                                         if (data_structure[i].data.qr_bar.borders == 1)
                                        {
                                            my_symbol->output_options = BARCODE_BOX;
                                            my_symbol->whitespace_width = 3;
                                            my_symbol-> whitespace_height = 3; 
                                            my_symbol-> border_width = 2;   /* Size of border in X-dimensions */
                                        }

                                        strcpy(my_symbol->outfile, "out.bmp");
                                        ZBarcode_Encode(my_symbol, (unsigned char *)data_structure[i].data.qr_bar.text, 0);

                                        ZBarcode_Print(my_symbol, 0);
                                        //ZBarcode_Delete(my_symbol);

                                        pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                                        printf("width=%d\n\r", width);
                                        printf("height=%d\n\r", height);
                                        printf("channels=%d\n\r", channels);
                            
                                       // my_symbol->scale = (float)((float)150.0*(float)height_len/(float)100.0/(float)height);
                                         // my_symbol->scale = (float)height_len/(float)height;
                                           my_symbol->scale = (float)((float)150.0*(float)height_len/(float)QR_BAR_MAX_HIGHT/(float)height);
                                        printf("scale=%f\n\r", (double)my_symbol->scale);
        
                                        strcpy(my_symbol->outfile, "out.bmp");
                                        ZBarcode_Encode(my_symbol, (unsigned char *)data_structure[i].data.qr_bar.text, 0);

                                        ZBarcode_Print(my_symbol, 0);
                                        ZBarcode_Delete(my_symbol);
                                        stbi_image_free(pdata);
                                
                                        pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                                        printf("width=%d\n\r", width);
                                        printf("height=%d\n\r", height);
                                        printf("channels=%d\n\r", channels);

                                        lv_obj_set_size(temp_obj, width, height);

                                        pnew_data = (unsigned char*)lv_mem_alloc(width * height * 4); // 为32位数据分配内存
                                        if (!pnew_data) 
                                        {
                                            fprintf(stderr, "Memory allocation failed\n");
                                            stbi_image_free(pdata);
                                            return;
                                        }
                                        else
                                        {
                                            printf("lv_mem_alloc ok\n\r");
                                        }

                                        for (int y = 0; y < height; y++) 
                                        {
                                            for (int x = 0; x < width; x++) 
                                            {
                                                int index = y * width + x; // 计算当前像素在原始数据中的索引
                                                unsigned char color = pdata[index]; // 获取当前像素的灰度值（0或255）
                                                // 映射到RGBA值

                                                if (color == 0)
                                                {
                                                    pnew_data[index * 4 + 0] = 0; // R
                                                    pnew_data[index * 4 + 1] = 0; // G
                                                    pnew_data[index * 4 + 2] = 0; // B
                                                    pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                                                }
                                                else
                                                {
                                                    pnew_data[index * 4 + 0] = 255; // R
                                                    pnew_data[index * 4 + 1] = 255; // G
                                                    pnew_data[index * 4 + 2] = 255; // B
                                                    pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                                                }
                                            }
                                        }

#if 0
                                        stbi_write_bmp("QR_bar_code.bmp", width, height, 4, pnew_data);
                                        // 使用data进行图像处理...
                                        lv_mem_free(pnew_data);
                                        stbi_image_free(pdata); // 释放内存

                                        //显示图像
                                        img = lv_img_create(temp_obj);
                                        lv_img_set_src(img, "A:/root/QR_bar_code.bmp");
                                        lv_obj_center(img);
#endif

                                        sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.bmp",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                                        stbi_write_bmp(bmp_name, width, height, 4, pnew_data);
                                        // 使用data进行图像处理...
                                        lv_mem_free(pnew_data);
                                        stbi_image_free(pdata); // 释放内存


                                        data = stbi_load(bmp_name, &width, &height, &channels, 0);
                                        if (!data) 
                                        {
                                            printf("错误：无法加载图片 %s\n", bmp_name);
                                        }
                                        printf("图片加载成功：%dx%d，%d 通道\n", width, height, channels);

                                        sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.png",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                                     
                                        success = stbi_write_png(bmp_name, width, height, channels, data, width * channels);
                                        if (!success) 
                                        {
                                            printf("错误：保存 PNG 失败\n");
                                        } 
                                        else
                                        {
                                            printf("PNG 保存成功：%s\n", bmp_name);
                                        }
                                        stbi_image_free(data); // 释放内存

                                        //显示图像
                                        img = lv_img_create(temp_obj);
                                        sprintf(bmp_name_1,"A:%s",bmp_name);
                                        lv_img_set_src(img, bmp_name_1);
                                        lv_obj_center(img);

                                        res = lv_img_decoder_get_info(bmp_name_1, &header);  // 直接传入文件路径

                                        if (res == LV_RES_OK)
                                        {
                                            printf("PNG: %dx%d\n", header.w, header.h);
                                        }
                                        else
                                        {
                                            printf("lv_img_decoder_get_info error\n");
                                        }

                                        lv_img_set_zoom(img,data_structure[i].data.qr_bar.size);

                                        width = header.w * data_structure[i].data.qr_bar.size / 256;
                                        height = header.h * data_structure[i].data.qr_bar.size / 256;

                                        lv_obj_set_size(temp_obj, width, height);

                                        lv_obj_align(temp_obj, LV_ALIGN_OUT_TOP_LEFT, data_structure[i].x, data_structure[i].y); 

                                        break;
                                }
                                break;
                            case TYPE_PITCTURE:

                                temp_obj = lv_obj_create(win_content);

                                lv_obj_set_style_bg_opa(temp_obj, LV_OPA_TRANSP, 0);
                                lv_obj_set_style_border_width(temp_obj, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */

                                lv_obj_add_event_cb(temp_obj, drag_event_handler, LV_EVENT_PRESSING, NULL);
                                lv_obj_add_event_cb(temp_obj, drag_event_handler, LV_EVENT_FOCUSED, NULL);
                                lv_obj_add_event_cb(temp_obj, drag_event_handler, LV_EVENT_DEFOCUSED, NULL);
                                lv_obj_clear_flag(temp_obj, LV_OBJ_FLAG_SCROLLABLE);

                                char picture_name[128]={0};

                                // 假设你有一个图片对象
                                img_obj = lv_img_create(temp_obj);

                                if(strcmp(data_structure[i].data.picture.text_1,"png") != 0)
                                {
                                    data = stbi_load(data_structure[i].data.picture.text_1, &width, &height, &channels, 0);
                                    if (!data) 
                                    {
                                        printf("错误：无法加载图片 %s\n", data_structure[i].data.picture.text_1);
                                    }

                                    printf("图片加载成功：%dx%d，%d 通道\n", width, height, channels);


                                    // 步骤 2：将数据保存为 PNG
                                    success = stbi_write_png(data_structure[i].data.picture.text_2, width, height, channels, data, width * channels);
                                    if (!success) 
                                    {
                                        printf("错误：保存 PNG 失败\n");
                                    } 
                                    else 
                                    {
                                        printf("PNG 保存成功：%s\n", data_structure[i].data.picture.text_2);
                                    }

                                    sprintf(picture_name, "A:%s", data_structure[i].data.picture.text_2);

                                    stbi_image_free(data);
                                }
                                else
                                {
                                    sprintf(picture_name, "A:%s", data_structure[i].data.picture.text_1);
                                }
                                
                                lv_img_set_src(img_obj, picture_name);
                                lv_obj_center(img_obj);

                                res = lv_img_decoder_get_info(picture_name, &header);  // 直接传入文件路径

                                if (res == LV_RES_OK)
                                {
                                    printf("PNG: %dx%d\n", header.w, header.h);
                                }
                                else
                                {
                                    printf("lv_img_decoder_get_info error\n");
                                }

                                lv_img_set_zoom(img_obj,data_structure[i].data.picture.size);

                                width = header.w * data_structure[i].data.picture.size / 256;
                                height = header.h * data_structure[i].data.picture.size / 256;

                                lv_obj_set_size(temp_obj, width, height);
                                lv_obj_align(temp_obj, LV_ALIGN_OUT_TOP_LEFT, data_structure[i].x, data_structure[i].y); 
                                break;
                            case TYPE_ICON:

                                temp_obj = lv_obj_create(win_content);

                                lv_obj_set_style_bg_opa(temp_obj, LV_OPA_TRANSP, 0);
                                lv_obj_set_style_border_width(temp_obj, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */

                                lv_obj_add_event_cb(temp_obj, drag_event_handler, LV_EVENT_PRESSING, NULL);
                                lv_obj_add_event_cb(temp_obj, drag_event_handler, LV_EVENT_FOCUSED, NULL);
                                lv_obj_add_event_cb(temp_obj, drag_event_handler, LV_EVENT_DEFOCUSED, NULL);
                                lv_obj_clear_flag(temp_obj, LV_OBJ_FLAG_SCROLLABLE);

                                // 假设你有一个图片对象
                                img_obj = lv_img_create(temp_obj);
                                lv_img_set_src(img_obj,  &icon_buf[data_structure[i].data.icon.type]);

                                lv_obj_center(img_obj);
                                
                                lv_img_set_zoom(img_obj, data_structure[i].data.icon.size);

                                // 获取图片对象
                                img_1 = (lv_img_t*)img_obj;

                                // 获取图片的源文件
                                img_dsc = (lv_img_dsc_t*)img_1->src;

                                // 获取图片的宽和高
                                width = img_dsc->header.w * data_structure[i].data.icon.size / 256;
                                height = img_dsc->header.h * data_structure[i].data.icon.size / 256;

                                // 打印宽和高
                                printf("Image width: %d, height: %d\n", width, height);
                                lv_obj_set_size(temp_obj, width, height);
                                lv_obj_align(temp_obj, LV_ALIGN_OUT_TOP_LEFT, data_structure[i].x, data_structure[i].y); 
                                break;
                            case TYPE_BREAK:
                                temp_obj = lv_obj_create(win_content);
                                lv_obj_set_style_bg_opa(temp_obj, LV_OPA_COVER, 0);
                                lv_obj_set_style_bg_color(temp_obj, lv_color_hex(0xFF6A6A), LV_STATE_DEFAULT);
                                lv_obj_set_style_border_width(temp_obj, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */

                                lv_obj_add_event_cb(temp_obj, drag_event_handler, LV_EVENT_PRESSING, NULL);
                                lv_obj_add_event_cb(temp_obj, drag_event_handler, LV_EVENT_FOCUSED, NULL);
                                lv_obj_add_event_cb(temp_obj, drag_event_handler, LV_EVENT_DEFOCUSED, NULL);
                                lv_obj_clear_flag(temp_obj, LV_OBJ_FLAG_SCROLLABLE);

                                lv_obj_set_size(temp_obj, 5, 150);

                                lv_obj_align(temp_obj, LV_ALIGN_OUT_TOP_LEFT, data_structure[i].x, data_structure[i].y); 
                                break;
                            case TYPE_COUNT:
                                temp_obj = lv_obj_create(win_content);
                                //sprintf(temp_typeface, "/media/%s", typeface_buf[data_structure[win_content_child_num].data.count.typeface]);
                                //data_structure[win_content_child_num].data.count.typeface = i;
                                //printf("%s\n", temp_typeface);
                                //data_structure[win_content_child_num].data.count.info.name = temp_typeface;
                                data_structure[i].data.count.info.weight = data_structure[i].data.count.size;
                                word_space =  data_structure[i].data.count.space;

                                //lv_ft_font_init(&data_structure[win_content_child_num].data.count.info);
                                temp_font = font_list_get(data_structure[i].data.count.typeface, data_structure[i].data.count.size, 0);
                        
                                printf("lead_zero=%d\n\r", data_structure[i].data.count.lead_zero);
                                printf("law=%d\n\r", data_structure[i].data.count.law);

                                //确定显示值的位数
                                //递增
                                if (data_structure[i].data.count.law == 0)
                                {
                                    if (data_structure[i].data.count.current_value < data_structure[i].data.count.minimum)
                                    {
                                        data_structure[i].data.count.current_value = data_structure[i].data.count.minimum;
                                    }
                                    else if(data_structure[i].data.count.current_value > data_structure[i].data.count.maximum)
                                    {
                                        data_structure[i].data.count.current_value = data_structure[i].data.count.maximum;
                                    }

                                    if (data_structure[i].data.count.lead_zero == 0)
                                    {
                                        formatNumberWithLeadingZeros(data_structure[i].data.count.current_value, data_structure[i].data.count.maximum, tempString);
                                    }
                                    else
                                    {
                                        sprintf(tempString, "%d", data_structure[i].data.count.current_value);
                                    }
                                }
                                else
                                {
                                    if (data_structure[i].data.count.current_value < data_structure[i].data.count.minimum)
                                    {
                                        data_structure[i].data.count.current_value = data_structure[i].data.count.minimum;
                                    }
                                    else if (data_structure[i].data.count.current_value > data_structure[i].data.count.maximum)
                                    {
                                        data_structure[i].data.count.current_value = data_structure[i].data.count.maximum;
                                    }

                                    if (data_structure[i].data.count.lead_zero == 0)
                                    {
                                        formatNumberWithLeadingZeros(data_structure[i].data.count.current_value, data_structure[i].data.count.maximum, tempString);
                                    }
                                    else
                                    {
                                        sprintf(tempString, "%d", data_structure[i].data.count.current_value);
                                    }       
                                }

                                printf("tempString=%s\n\r", tempString);
   
                                //lv_txt_get_size(&text_size, lv_label_get_text(label_file_management_label), temp_font, word_space, 0, LV_COORD_MAX, LV_TEXT_FLAG_NONE);
                                lv_txt_get_size(&text_size, tempString, temp_font, word_space, 0, LV_COORD_MAX, LV_TEXT_FLAG_NONE);

                                lv_obj_set_style_bg_opa(temp_obj, LV_OPA_TRANSP, 0);
                                lv_obj_set_style_border_width(temp_obj, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */

                                lv_obj_add_event_cb(temp_obj, drag_event_handler, LV_EVENT_PRESSING, NULL);
                                lv_obj_add_event_cb(temp_obj, drag_event_handler, LV_EVENT_FOCUSED, NULL);
                                lv_obj_add_event_cb(temp_obj, drag_event_handler, LV_EVENT_DEFOCUSED, NULL);
                                lv_obj_clear_flag(temp_obj, LV_OBJ_FLAG_SCROLLABLE);

                                lv_style_init(&data_structure[i].data.count.style);
                                lv_style_set_text_font(&data_structure[i].data.count.style,temp_font);
         
                                printf("x=%u y=%u\n\r", text_size.x, text_size.y);
                                lv_obj_set_size(temp_obj, text_size.x, text_size.y);

                                lv_style_set_text_letter_space(&data_structure[i].data.count.style, word_space);
                                label1 = lv_label_create(temp_obj);
                                lv_obj_add_style(label1, &data_structure[i].data.count.style, 0);
                                lv_label_set_text(label1, tempString);
                                lv_obj_center(label1);
        
                                lv_obj_align(temp_obj, LV_ALIGN_OUT_TOP_LEFT, data_structure[i].x, data_structure[i].y); 

                                break;
                            case TYPE_SYMBOL:
                                temp_obj = lv_obj_create(win_content);

                                //sprintf(temp_typeface, "/media/%s", typeface_buf[0]);
                                //data_structure[win_content_child_num].data.word.typeface = 0;
                                //info.name = "./lvgl/src/extra/libs/freetype/arial.ttf";
                                //info.name = "./lvgl/src/extra/libs/freetype/simsun.ttc";
                                //sprintf(temp_typeface, "./lvgl/src/extra/libs/freetype/%s", typeface_buf[SOURCE_HAN_SERIF_CN_REGULAR_1]);
                                //printf("%s\n", temp_typeface);
                                //data_structure[win_content_child_num].data.word.info.name = temp_typeface;
                                data_structure[i].data.word.info.weight = data_structure[i].data.word.size;
                                data_structure[i].data.word.spin = 0;
                                data_structure[i].data.word.info.style = FT_FONT_STYLE_NORMAL;

                                //lv_ft_font_init(&data_structure[win_content_child_num].data.word.info);
                                temp_font = font_list_get(0, data_structure[i].data.word.size, 0);

                                lv_txt_get_size(&text_size, data_structure[i].data.word.text, temp_font, 0, 0, LV_COORD_MAX, LV_TEXT_FLAG_NONE);

                                lv_obj_set_style_bg_opa(temp_obj, LV_OPA_TRANSP, 0);
                                lv_obj_set_style_border_width(temp_obj, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */

                                lv_obj_add_event_cb(temp_obj, drag_event_handler, LV_EVENT_PRESSING, NULL);
                                lv_obj_add_event_cb(temp_obj, drag_event_handler, LV_EVENT_FOCUSED, NULL);
                                lv_obj_add_event_cb(temp_obj, drag_event_handler, LV_EVENT_DEFOCUSED, NULL);
                                lv_obj_clear_flag(temp_obj, LV_OBJ_FLAG_SCROLLABLE);

                                lv_style_init(&data_structure[i].data.word.style);
                                lv_style_set_text_font(&data_structure[i].data.word.style, temp_font);

                                lv_obj_set_size(temp_obj, text_size.x, text_size.y);

                                label1 = lv_label_create(temp_obj);
                                lv_obj_add_style(label1, &data_structure[i].data.word.style, 0);
                                lv_label_set_text(label1, data_structure[i].data.word.text);
                                lv_obj_center(label1);
                                lv_obj_align(temp_obj, LV_ALIGN_OUT_TOP_LEFT, data_structure[i].x, data_structure[i].y); 
                                break;
                        }     
                    }
                }
            }
        }

        lv_obj_del(obj_addition_picture_head_bg);
        lv_obj_del(label_addition_picture_head);
        //lv_obj_del(obj_addition_picture_preview_bg);
        lv_obj_del(table_addition_picture);
        lv_obj_del(win_content_typeface);   
        lv_obj_del(typeface_slider_bg);   
        lv_obj_del(obj_addition_table_bg);
        lv_obj_del(left_stop_img_typeface);
        lv_obj_del(right_stop_img_typeface);
        lv_obj_del(slider_typeface);
        lv_obj_del(obj_addition_picture_btn_bg);
        lv_obj_del(btn_addition_picture_delete);
        lv_obj_del(btn_addition_picture_open);
        lv_obj_del(obj_addition_picture_bottom_bg);
        lv_obj_del(img_addition_picture_search);
        lv_obj_del(label_addition_picture_search);
        lv_obj_del(label_btn_addition_picture_search);
        lv_obj_del(btn_addition_picture_search);
        lv_obj_del(label_addition_picture_return);
        lv_obj_del(imgbtn_addition_picture_return);
        lv_obj_del(imgbtn_addition_picture_confirm);
        lv_obj_del(label_addition_picture_confirm);
    }
}

static void file_slider_event_cb(lv_event_t* e)
{
    lv_obj_t* target = lv_event_get_target(e); /* 获取触发源 */
    lv_event_code_t code = lv_event_get_code(e); /* 获取事件类型 */
    int32_t temp;
    static int32_t temp_last = 0;
    int x_data = 0;
    if ((code == LV_EVENT_VALUE_CHANGED) && (print_status == 0))
    {
        temp = lv_slider_get_value(target);
        printf("temp=%d\n", temp);

        x_data = (100 - temp) * 6;

        if (temp_last != temp)
        {
            lv_obj_set_pos(win_content_typeface, -15, -15 - x_data);//Limit drag boundaries 
        }
        temp_last = temp;
    }
}



static void slider_show_file()
{
    static const lv_style_prop_t props[] = { LV_STYLE_BG_COLOR,0 };  //设置位置参数
    static lv_style_transition_dsc_t transition_dsc;               //设置转换变量
    lv_style_transition_dsc_init(&transition_dsc, props, lv_anim_path_linear, 200, 0, NULL); //初始化转换

    static lv_style_t style_main;                                  //创建样式
    static lv_style_t style_indicator;                             //创建样式
    static lv_style_t style_knob;                                  //创建样式
    static lv_style_t style_pressed_color;                         //创建样式
    lv_style_init(&style_main);                                    //初始化样式
    lv_style_set_bg_opa(&style_main, LV_OPA_TRANSP);                 //设置背景透明度
    lv_style_set_bg_color(&style_main, lv_color_hex3(0xffffff));        //设置背景颜色
    lv_style_set_size_A(&style_main, 20, 113);
    lv_style_set_pad_ver(&style_main, 0);                          //设置上下边距
    lv_style_init(&style_indicator);                               //初始化样式
    lv_style_set_bg_opa(&style_indicator, LV_OPA_TRANSP);            //设置背景透明度
    lv_style_set_bg_color(&style_indicator, lv_color_hex3(0xffffff));//设置背景颜色
    lv_style_set_transition(&style_indicator, &transition_dsc);     //设置转化

    LV_IMG_DECLARE(img_slider_typeface);

    lv_style_init(&style_knob);                                    //初始化样式
    lv_style_set_bg_opa(&style_knob, LV_OPA_TRANSP);                 //设置背景透明度
    lv_style_set_bg_img_src(&style_knob, &img_slider_typeface);
    lv_style_set_border_color(&style_knob, lv_palette_darken(LV_PALETTE_GREY, 3));//设置边框背景颜色
    lv_style_set_border_width(&style_knob, 0);                      //设置边框宽度
    lv_style_set_pad_all(&style_knob, 20);                           //设置边距
    lv_style_set_size_A(&style_knob, 20, 10);
    lv_style_set_transition(&style_knob, &transition_dsc);          //设置转化

    lv_style_init(&style_pressed_color);                           //初始化样式
    lv_style_set_bg_color(&style_pressed_color, lv_color_hex3(0xAAAAAA));//设置背景颜色

    slider_typeface = lv_slider_create(lv_scr_act());            //创建滑块
    lv_obj_remove_style_all(slider_typeface);                               //移除所有样式

    lv_obj_add_style(slider_typeface, &style_main, LV_PART_MAIN);             //添加样式
    lv_obj_add_style(slider_typeface, &style_indicator, LV_PART_INDICATOR);   //添加样式 指示器
    lv_obj_add_style(slider_typeface, &style_pressed_color, LV_PART_INDICATOR | LV_STATE_PRESSED); //添加样式 指示器 按压状态
    lv_obj_add_style(slider_typeface, &style_knob, LV_PART_KNOB);             //添加样式 圆头
    lv_obj_add_style(slider_typeface, &style_pressed_color, LV_PART_KNOB | LV_STATE_PRESSED);      //添加样式 圆头 按压状态
    lv_obj_align(slider_typeface, LV_ALIGN_TOP_LEFT, 460, 94);
    //lv_obj_center(slider);                                         //居中显示
    lv_obj_add_event_cb(slider_typeface, file_slider_event_cb, LV_EVENT_VALUE_CHANGED, NULL);
    lv_slider_set_value(slider_typeface, 100, LV_ANIM_ON);
}


// 检查文件是否为图片文件
static int is_dat_file(const char *filename) 
{
    const char *ext = strrchr(filename, '.');
    if (ext != NULL) 
    {
        if (strcmp(ext, ".dat") == 0)
        {
            return 1;
        }
    }
    return 0;
}


static void file_draw_event_cb(lv_event_t* e)
{
    lv_obj_draw_part_dsc_t* dsc = lv_event_get_draw_part_dsc(e);
    /*If the cells are drawn...*/
    if (dsc->part == LV_PART_ITEMS)
    {
        //printf("dsc->id=%d\n\r", dsc->id);
        if ((dsc->id / 2) == g_row)
        {
            dsc->rect_dsc->bg_color = lv_color_hex(0x00FF00);  // 绿色
            dsc->rect_dsc->bg_opa = LV_OPA_COVER;  // 完全不透明
        }
        else {
            dsc->rect_dsc->bg_color = lv_color_hex(0xFFFFFF);  // 白色
            dsc->rect_dsc->bg_opa = LV_OPA_COVER;  // 完全不透明
        }
    }
}


// 将月份名称转换为数字
static int month_to_num(const char *month) {
    const char *months[] = {"Jan", "Feb", "Mar", "Apr", "May", "Jun",
                            "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"};
    for (int i = 0; i < 12; i++) {
        if (strcmp(month, months[i]) == 0) {
            return i + 1; // 返回月份数字（1-12）
        }
    }
    return 0; // 如果未找到，返回0
}


// 格式化时间字符串为年/月/日
static void format_time(const char *ctime_str, char *output) {
    char month[4];
    int day, year;

    // 从ctime字符串中提取月份、日期和年份
    sscanf(ctime_str, "%*s %3s %d %*d:%*d:%*d %d", month, &day, &year);

    // 将月份名称转换为数字
    int month_num = month_to_num(month);

    // 格式化输出为年/月/日（年份取后两位）
    snprintf(output, 20, "%02d/%02d/%02d", year, month_num, day);
}





static int isSubstring(char* str, char* subStr) 
{
    if (strstr(str, subStr) != NULL) {
        return 1;
    }
    return 0;
}


static void button_file_search_keyboard_confirm_event_cb(lv_event_t* e)
{
    lv_event_code_t code;
    //char file_name[100]={0};
    //DIR *dir;
    //struct dirent *entry;
    //struct stat file_stat;
    //char path[128];
    //unsigned char picture_count = 0;
    //int picture_type = 0;
    //char created_time[20] ={0};
    //char size_str[20]; // 存储转换后的字符串
    //char image_name[50]; // 存储提取的图片名称
    char file_name_short[100]={0};

    code = lv_event_get_code(e);
    int len = 0;
    if (code == LV_EVENT_CLICKED)
    {
        printf("button_file_search_keyboard_confirm_event_cb\n");

        buzzer_enable = 1;
        //获取输入框数据给到文本显示框
        lv_label_set_text(label_btn_addition_picture_search, lv_textarea_get_text(textarea_text_keyboard));
        len = strlen(lv_label_get_text(label_btn_addition_picture_search));
        printf("len=%d\n\r", len);
        lv_obj_del(textarea_bg_keyboard);
        lv_obj_del(pinyin_ime);
        lv_obj_del(textarea_text_keyboard);
        lv_obj_del(keyboard_bg);
        lv_obj_del(label_keyboard_confirm);
        lv_obj_del(btn_keyboard_confirm);
        lv_obj_del(label_keyboard_return);
        lv_obj_del(btn_keyboard_return);

        lv_obj_del(table_addition_picture_1);

        static lv_style_t table_cell_style1;
        lv_style_init(&table_cell_style1);
        lv_style_set_pad_all(&table_cell_style1, 2); // 设置所有方向的填充为5像素

        table_addition_picture_1 = lv_table_create(win_content_typeface);
        LV_FONT_DECLARE(heiFont16_1);
        lv_obj_add_style(table_addition_picture_1, &table_cell_style1, LV_PART_ITEMS); // 应用样式到表格的单元格部分
        lv_obj_align(table_addition_picture_1, LV_ALIGN_TOP_LEFT, 0, 0);
        lv_obj_set_style_text_font(table_addition_picture_1, &heiFont16_1, LV_STATE_DEFAULT);

        lv_table_set_col_width(table_addition_picture_1, 0, 367);
        lv_table_set_col_width(table_addition_picture_1, 1, 90);

        //重新绘制表格
        if (len == 0)
        {
            DIR *dir;
            struct dirent *entry;
            struct stat file_stat;
            char path[300];
            //unsigned char picture_count = 0;
            //int picture_type = 0;
            char created_time[20] ={0};
            //char size_str[20]; // 存储转换后的字符串
            //char image_name[128]; // 存储提取的图片名称

            g_file_num = 0;

            dir = opendir("/media/file");
            if (dir == NULL) 
            {
                perror("opendir");
                exit(EXIT_FAILURE);
            }

            while ((entry = readdir(dir)) != NULL) 
            {
                snprintf(path, sizeof(path), "/media/file/%s", entry->d_name);
                if (stat(path, &file_stat) == -1) 
                {
                    perror("stat");
                    continue;
                }

                if ((S_ISREG(file_stat.st_mode))&&(g_file_num < USB_PICTURE_NUMBER))
                {  
                    // 只处理普通文件
                    if (is_dat_file(entry->d_name)) 
                    {
                        //print_file_info(entry->d_name, &file_stat);
                        lv_table_set_cell_value(table_addition_picture_1, g_file_num, 0, entry->d_name);
                        printf("Created: %s", ctime(&file_stat.st_ctime));
                        format_time(ctime(&file_stat.st_ctime), created_time);
                        printf("created_time=%s\n\r",created_time);
                        lv_table_set_cell_value(table_addition_picture_1, g_file_num, 1, created_time);
                        g_file_num++;
                    }
                }
            }

            closedir(dir);
#if 0
            remove_dat_suffix(lv_table_get_cell_value(table_addition_picture_1, g_row, 0),file_name);

            printf("%s\n\r", lv_table_get_cell_value(table_addition_picture_1,g_row,0));
            sprintf(image_name,"A:/media/img/%s.bmp", file_name);

            //显示图片
            picture_img = lv_img_create(obj_addition_picture_preview_bg);
            lv_img_set_src(picture_img, image_name);
            //lv_obj_align(picture_img, LV_ALIGN_CENTER, 0, 10);
            //lv_img_set_zoom(picture_img, 128); 
#endif
        }
        else
        {
            //显示含有输入字符的内容
            strcpy(file_name_short,lv_label_get_text(label_btn_addition_picture_search));

            DIR *dir;
            struct dirent *entry;
            struct stat file_stat;
            char path[300];
            unsigned char picture_count = 0;
            //int picture_type = 0;
            char created_time[20] ={0};
            //char size_str[20]; // 存储转换后的字符串
            //char image_name[128]; // 存储提取的图片名称

            dir = opendir("/media/file");
            if (dir == NULL) 
            {
                perror("opendir");
                exit(EXIT_FAILURE);
            }

            while ((entry = readdir(dir)) != NULL) 
            {
                snprintf(path, sizeof(path), "/media/file/%s", entry->d_name);
                if (stat(path, &file_stat) == -1) 
                {
                    perror("stat");
                    continue;
                }

                if ((S_ISREG(file_stat.st_mode))&&(picture_count < USB_PICTURE_NUMBER)&&(isSubstring(entry->d_name,file_name_short)))
                {  
                    // 只处理普通文件
                    if (is_dat_file(entry->d_name)) 
                    {
                        //print_file_info(entry->d_name, &file_stat);
                        lv_table_set_cell_value(table_addition_picture_1, picture_count, 0, entry->d_name);
                        printf("Created: %s", ctime(&file_stat.st_ctime));
                        format_time(ctime(&file_stat.st_ctime), created_time);
                        printf("created_time=%s\n\r",created_time);
                        lv_table_set_cell_value(table_addition_picture_1, picture_count, 1, created_time);
                        picture_count++;
                    }
                }
            }

            closedir(dir);
#if 0

            remove_dat_suffix(lv_table_get_cell_value(table_addition_picture_1, g_row, 0),file_name);

            printf("%s\n\r", lv_table_get_cell_value(table_addition_picture_1,g_row,0));
            sprintf(image_name,"A:/media/img/%s.bmp", file_name);

            //显示图片
            picture_img = lv_img_create(obj_addition_picture_preview_bg);
            lv_img_set_src(picture_img, image_name);
            //lv_obj_align(picture_img, LV_ALIGN_CENTER, 0, 10);
            //lv_img_set_zoom(picture_img, 128); 
#endif
        }

        lv_obj_add_event_cb(table_addition_picture_1, file_draw_event_cb, LV_EVENT_DRAW_PART_BEGIN, NULL);
        lv_obj_add_event_cb(table_addition_picture_1, file_change_event_cb, LV_EVENT_PRESSED, NULL);
    }
}



static void button_file_search_keyboard_return_event_cb(lv_event_t* e)
{
    lv_event_code_t code;
    //char file_name[100]={0};
    //DIR *dir;
    //struct dirent *entry;
    //struct stat file_stat;
    //char path[128];
    //unsigned char picture_count = 0;
    //int picture_type = 0;
    //char created_time[20] ={0};
    //char size_str[20]; // 存储转换后的字符串
    //char image_name[50]; // 存储提取的图片名称
    //char file_name_short[100]={0};

    code = lv_event_get_code(e);
    //int len = 0;
    if (code == LV_EVENT_CLICKED)
    {
        printf("button_file_search_keyboard_return_event_cb\n");

        buzzer_enable = 1;
        lv_obj_del(textarea_bg_keyboard);
        lv_obj_del(pinyin_ime);
        lv_obj_del(textarea_text_keyboard);
        lv_obj_del(keyboard_bg);
        lv_obj_del(label_keyboard_confirm);
        lv_obj_del(btn_keyboard_confirm);
        lv_obj_del(label_keyboard_return);
        lv_obj_del(btn_keyboard_return);

        lv_obj_del(table_addition_picture_1);
    }
}





static void file_change_event_cb(lv_event_t* e)
{
    lv_obj_t* obj = lv_event_get_target(e);
    uint16_t col;
    uint16_t row;
    //char picture_name[100] = { 0 };
    //char picture_name_1[128] = { 0 };

    lv_table_get_selected_cell(obj, &row, &col);
    printf("row=%d\n\r", row);

    buzzer_enable = 1;

    g_row = row;
    lv_obj_invalidate(obj);  // 刷新表格，触发重绘

    //remove_dat_suffix(lv_table_get_cell_value(table_addition_picture_1, g_row, 0),picture_name);
    //sprintf(picture_name_1,"A:/media/img/%s.bmp", picture_name);
    
    //lv_img_set_src(picture_img, picture_name_1);
    //lv_obj_align(picture_img, LV_ALIGN_CENTER, 0, 10);
    //lv_img_set_zoom(picture_img, 128); 
}

static void btn_file_search_event_cb(lv_event_t* e)
{
     lv_event_code_t code;
    int len;
    code = lv_event_get_code(e);

    if (code == LV_EVENT_CLICKED)
    {
        printf("btn_file_search_event_cb\n\r");

        buzzer_enable = 1;

        textarea_bg_keyboard = lv_obj_create(lv_scr_act());

        /* 设置大小 */
        lv_obj_set_size(textarea_bg_keyboard, 480, 272);
        lv_obj_align(textarea_bg_keyboard, LV_ALIGN_TOP_LEFT, 0, 0);
        lv_obj_set_style_border_width(textarea_bg_keyboard, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_border_color(textarea_bg_keyboard, lv_color_hex(0x9bcd9b), LV_STATE_DEFAULT); /* 设置边框颜色 */
        //lv_obj_set_style_border_opa(file_management_win, 100, LV_STATE_DEFAULT); /* 设置边框透明度 */
        lv_obj_set_style_radius(textarea_bg_keyboard, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_color(textarea_bg_keyboard, lv_color_hex(0x1fadd3), LV_STATE_DEFAULT);

        //输入框+键盘
        LV_FONT_DECLARE(heiFont16_1);
        pinyin_ime = lv_ime_pinyin_create(lv_scr_act());
        lv_obj_set_style_text_font(pinyin_ime, &heiFont16_1, 0);
        //lv_obj_set_style_text_font(pinyin_ime, &lv_font_simsun_16_cjk, 0);
        //lv_ime_pinyin_set_dict(pinyin_ime, your_dict); // Use a custom dictionary. If it is not set, the built-in dictionary will be used.

        textarea_text_keyboard = lv_textarea_create(lv_scr_act());
        //lv_textarea_set_one_line(textarea_text_keyboard, true);
        lv_obj_set_size(textarea_text_keyboard, 480, 95);
        lv_obj_set_style_text_font(textarea_text_keyboard, &heiFont16_1, 0);
        lv_obj_align(textarea_text_keyboard, LV_ALIGN_TOP_LEFT, 0, 0);
        lv_textarea_set_max_length(textarea_text_keyboard, 200);
        //lv_textarea_set_placeholder_text(textarea_text_keyboard, "Smart printer");
        //lv_obj_add_event_cb(textarea_text_keyboard, textarea_text_event_cb, LV_EVENT_ALL, NULL);
        lv_obj_set_style_border_width(textarea_text_keyboard, 1, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_border_color(textarea_text_keyboard, lv_color_hex(0xAAAAAA), LV_STATE_DEFAULT); /* 设置边框颜色 */
        lv_obj_set_style_border_opa(textarea_text_keyboard, 100, LV_STATE_DEFAULT); /* 设置边框透明度 */
        lv_obj_set_style_radius(textarea_text_keyboard, 0, LV_STATE_DEFAULT); /* 设置圆角 */

        len = strlen(lv_label_get_text(label_btn_addition_picture_search));

        printf("len=%u\n\r", len);

        if (strlen(lv_label_get_text(label_btn_addition_picture_search)) != 0)
        {
            lv_textarea_set_text(textarea_text_keyboard, lv_label_get_text(label_btn_addition_picture_search));
        }

        /*Create a keyboard and add it to ime_pinyin*/
        text_edit_keyboard = lv_keyboard_create(lv_scr_act());
        lv_ime_pinyin_set_keyboard(pinyin_ime, text_edit_keyboard);
        lv_keyboard_set_textarea(text_edit_keyboard, textarea_text_keyboard);
        //lv_obj_set_style_bg_color(text_edit_keyboard, lv_color_hex(0xff4040), LV_PART_MAIN);
        lv_obj_set_style_bg_color(text_edit_keyboard, lv_color_hex(0x1fadd3), LV_PART_MAIN);
        lv_obj_add_event_cb(textarea_text_keyboard, textarea_text_event_cb, LV_EVENT_ALL, text_edit_keyboard);
        lv_obj_align(text_edit_keyboard, LV_ALIGN_TOP_LEFT, 0, 115);
        lv_obj_set_size(text_edit_keyboard, 480, 133);

        /*Get the cand_panel, and adjust its size and position*/
        keyboard_cand_panel = lv_ime_pinyin_get_cand_panel(pinyin_ime);
        lv_obj_set_size(keyboard_cand_panel, LV_PCT(100), LV_PCT(10));
        lv_obj_align_to(keyboard_cand_panel, text_edit_keyboard, LV_ALIGN_OUT_TOP_MID, 0, 5);
        lv_obj_set_style_bg_color(keyboard_cand_panel, lv_color_hex(0x8B1A1A), LV_PART_MAIN);
        lv_obj_set_style_text_font(keyboard_cand_panel, &heiFont16_1, 0);

        keyboard_bg = lv_obj_create(lv_scr_act());
        lv_obj_set_size(keyboard_bg, 480, 24);
        lv_obj_align(keyboard_bg, LV_ALIGN_TOP_LEFT, 0, 248);
        lv_obj_set_style_border_width(keyboard_bg, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_radius(keyboard_bg, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_color(keyboard_bg, lv_color_hex(0x28536a), LV_STATE_DEFAULT);
        lv_obj_remove_style(keyboard_bg, 0, LV_PART_SCROLLBAR);


        LV_FONT_DECLARE(heiFont16_1);
        label_keyboard_return = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_keyboard_return, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_keyboard_return, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_keyboard_return, "返回");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_keyboard_return, "Return");
        }
        lv_obj_align(label_keyboard_return, LV_ALIGN_TOP_LEFT, 140, 252);

        LV_IMG_DECLARE(get_back);
        btn_keyboard_return = lv_imgbtn_create(lv_scr_act());
        lv_imgbtn_set_src(btn_keyboard_return, LV_IMGBTN_STATE_RELEASED, NULL, &get_back, NULL);
        lv_obj_set_size(btn_keyboard_return, get_back.header.w, get_back.header.h);
        lv_obj_align(btn_keyboard_return, LV_ALIGN_TOP_LEFT, 180, 250);
        lv_obj_add_event_cb(btn_keyboard_return, button_file_search_keyboard_return_event_cb, LV_EVENT_CLICKED, NULL);

        LV_IMG_DECLARE(confirm);
        btn_keyboard_confirm = lv_imgbtn_create(lv_scr_act());
        lv_imgbtn_set_src(btn_keyboard_confirm, LV_IMGBTN_STATE_RELEASED, NULL, &confirm, NULL);
        lv_obj_set_size(btn_keyboard_confirm, get_back.header.w, get_back.header.h);
        lv_obj_align(btn_keyboard_confirm, LV_ALIGN_TOP_LEFT, 250, 250);
        lv_obj_add_event_cb(btn_keyboard_confirm, button_file_search_keyboard_confirm_event_cb, LV_EVENT_CLICKED, NULL);

        LV_FONT_DECLARE(heiFont16_1);
        label_keyboard_confirm = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_keyboard_confirm, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_keyboard_confirm, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_keyboard_confirm, "确定");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_keyboard_confirm, "Confirm");
        }
        lv_obj_align(label_keyboard_confirm, LV_ALIGN_TOP_LEFT, 277, 252);
    }
}


typedef struct {
    char name[64];    // 文件名
    time_t mtime;      // 修改时间
} FileInfo;



// 比较函数，用于qsort排序
int compare_files(const void *a, const void *b) {
    const FileInfo *fa = (const FileInfo *)a;
    const FileInfo *fb = (const FileInfo *)b;
    
    // 按修改时间排序，最新的在前
    if (fa->mtime > fb->mtime) return -1;
    if (fa->mtime < fb->mtime) return 1;
    return 0;
}

#if 0

static void button_file_event_cb(lv_event_t* e)
{
    lv_event_code_t code;
    char file_name[100]={0};
    FileInfo *files = NULL;
    int count = 0;
    char full_path[512];


    code = lv_event_get_code(e);
    if ((code == LV_EVENT_CLICKED)&&(print_status == 0))
    {
        buzzer_enable = 1;

        printf("file\n");
        obj_addition_picture_head_bg = lv_obj_create(lv_scr_act());
        lv_obj_set_size(obj_addition_picture_head_bg, 480, 24);
        lv_obj_align(obj_addition_picture_head_bg, LV_ALIGN_TOP_LEFT, 0, 0);
        lv_obj_set_style_border_width(obj_addition_picture_head_bg, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_radius(obj_addition_picture_head_bg, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_color(obj_addition_picture_head_bg, lv_color_hex(0x28536a), LV_STATE_DEFAULT);
        lv_obj_remove_style(obj_addition_picture_head_bg, 0, LV_PART_SCROLLBAR);


        LV_FONT_DECLARE(heiFont16_1);
        label_addition_picture_head = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_addition_picture_head, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_addition_picture_head, lv_color_hex(0xFFFFFF), LV_STATE_DEFAULT);

        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_addition_picture_head, "文件");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_addition_picture_head, "File");
        }

        lv_obj_align(label_addition_picture_head, LV_ALIGN_TOP_LEFT, 200, 4);


        obj_addition_picture_preview_bg = lv_obj_create(lv_scr_act());
        lv_obj_set_size(obj_addition_picture_preview_bg, 240, 160);
        lv_obj_align(obj_addition_picture_preview_bg, LV_ALIGN_TOP_LEFT, 0, 24);
        lv_obj_set_style_border_width(obj_addition_picture_preview_bg, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_radius(obj_addition_picture_preview_bg, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_color(obj_addition_picture_preview_bg, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        lv_obj_remove_style(obj_addition_picture_preview_bg, 0, LV_PART_SCROLLBAR);


        static lv_style_t table_cell_style;
        lv_style_init(&table_cell_style);
        lv_style_set_pad_all(&table_cell_style, 2); // 设置所有方向的填充为5像素

        table_addition_picture = lv_table_create(lv_scr_act());
        lv_obj_add_style(table_addition_picture, &table_cell_style, LV_PART_ITEMS); // 应用样式到表格的单元格部分
        LV_FONT_DECLARE(heiFont16_1);
        lv_obj_set_style_text_font(table_addition_picture, &heiFont16_1, LV_STATE_DEFAULT);

        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_table_set_cell_value(table_addition_picture, 0, 0, "名称");
            lv_table_set_cell_value(table_addition_picture, 0, 1, "时间");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_table_set_cell_value(table_addition_picture, 0, 0, "Name");
            lv_table_set_cell_value(table_addition_picture, 0, 1, "Time");
        }

        lv_obj_align(table_addition_picture, LV_ALIGN_TOP_LEFT, 160, 24);
        lv_table_set_col_width(table_addition_picture, 0, 210);
        lv_table_set_col_width(table_addition_picture, 1, 90);



        obj_addition_table_bg = lv_obj_create(lv_scr_act());
        lv_obj_set_size(obj_addition_table_bg, 300, 203);
        lv_obj_align(obj_addition_table_bg, LV_ALIGN_TOP_LEFT, 160, 45);
        lv_obj_set_style_border_width(obj_addition_table_bg, 1, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_radius(obj_addition_table_bg, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_color(obj_addition_table_bg, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        lv_obj_remove_style(obj_addition_table_bg, 0, LV_PART_SCROLLBAR);

        win_content_typeface = lv_obj_create(obj_addition_table_bg);
        lv_obj_set_size(win_content_typeface, 300, 500);
        lv_obj_align(win_content_typeface, LV_ALIGN_TOP_LEFT, -16, -16);
        lv_obj_set_style_bg_color(win_content_typeface, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        lv_obj_set_style_border_width(win_content_typeface, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_border_color(win_content_typeface, lv_color_hex(0xcccccc), LV_STATE_DEFAULT); /* 设置边框颜色 */
        lv_obj_clear_flag(win_content_typeface, LV_OBJ_FLAG_SCROLLABLE);
        lv_obj_set_style_radius(win_content_typeface, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_pad_all(win_content_typeface, 0, LV_STATE_DEFAULT);


        table_addition_picture_1 = lv_table_create(win_content_typeface);
        LV_FONT_DECLARE(heiFont16_1);
        lv_obj_add_style(table_addition_picture_1, &table_cell_style, LV_PART_ITEMS); // 应用样式到表格的单元格部分
        lv_obj_align(table_addition_picture_1, LV_ALIGN_TOP_LEFT, 0, 0);
        lv_obj_set_style_text_font(table_addition_picture_1, &heiFont16_1, LV_STATE_DEFAULT);

        lv_table_set_col_width(table_addition_picture_1, 0, 210);
        lv_table_set_col_width(table_addition_picture_1, 1, 90);

        DIR *dir;
        struct dirent *entry;
        struct stat file_stat;
        //char path[300];
        //unsigned char picture_count = 0;
        //int picture_type = 0;
        char created_time[20] ={0};
        //char size_str[20]; // 存储转换后的字符串
        char image_name[128]; // 存储提取的图片名称

        g_file_num = 0;

        dir = opendir("/media/file");
        if (dir == NULL) 
        {
            perror("opendir");
            exit(EXIT_FAILURE);
        }

#if 0

        while ((entry = readdir(dir)) != NULL) 
        {
            snprintf(path, sizeof(path), "%s/%s", "/media/file", entry->d_name);
            if (stat(path, &file_stat) == -1) 
            {
                perror("stat");
                continue;
            }

            if ((S_ISREG(file_stat.st_mode))&&(g_file_num < USB_PICTURE_NUMBER))
            {  
                // 只处理普通文件
                if (is_dat_file(entry->d_name)) 
                {
                    //print_file_info(entry->d_name, &file_stat);
                    lv_table_set_cell_value(table_addition_picture_1, g_file_num, 0, entry->d_name);
                    printf("Created: %s", ctime(&file_stat.st_ctime));
                    format_time(ctime(&file_stat.st_ctime), created_time);
                    printf("created_time=%s\n\r",created_time);
                    lv_table_set_cell_value(table_addition_picture_1, g_file_num, 1, created_time);
                    g_file_num++;
                }
            }
        }
#endif

        // 第一次遍历，统计文件数量
        while ((entry = readdir(dir)) != NULL) 
        {
            if (strcmp(entry->d_name, ".") == 0 || strcmp(entry->d_name, "..") == 0) {
                continue;
            }
            count++;
        }
        rewinddir(dir);

        // 分配内存
        files = (FileInfo *)malloc(count * sizeof(FileInfo));
        if (files == NULL) {
            perror("malloc");
            closedir(dir);
            //return -1;
        }

            // 第二次遍历，收集文件信息
        int index = 0;
        while ((entry = readdir(dir)) != NULL && index < count) 
        {
            if (strcmp(entry->d_name, ".") == 0 || strcmp(entry->d_name, "..") == 0) {
                continue;
            }

            // 构建完整路径
            snprintf(full_path, sizeof(full_path), "%s/%s", "/media/file", entry->d_name);

            // 获取文件状态
            if (stat(full_path, &file_stat) == -1) {
                perror("stat");
                continue;
            }

            // 只处理普通文件
            if (S_ISREG(file_stat.st_mode)) 
            {
                strncpy(files[index].name, entry->d_name, sizeof(files[index].name) - 1);
                files[index].mtime = file_stat.st_mtime;
                index++;
            }
        }


        // 实际有效的文件数
        count = index;

        // 按修改时间排序
        qsort(files, count, sizeof(FileInfo), compare_files);

        // 输出结果
        //printf("%-40s %-20s %s\n", "Filename", "Modification Time", "Size");
        //printf("------------------------------------------------------------\n");
        
        for (int i = 0; i < count; i++) 
        {
            //char time_str[20];
            //struct tm *tm_info = localtime(&files[i].mtime);
            //strftime(time_str, sizeof(time_str), "%Y-%m-%d %H:%M:%S", tm_info);    
            //printf("%-40s %-20s %ld bytes\n", files[i].name, time_str, (long)files[i].size);

            //print_file_info(entry->d_name, &file_stat);
            lv_table_set_cell_value(table_addition_picture_1, g_file_num, 0, files[i].name);
            printf("Created: %s", ctime(&files[i].mtime));
            format_time(ctime(&files[i].mtime), created_time);
            printf("created_time=%s\n\r",created_time);
            lv_table_set_cell_value(table_addition_picture_1, g_file_num, 1, created_time);
            g_file_num++;
        }

        // 清理
        free(files);

        closedir(dir);

        remove_dat_suffix(lv_table_get_cell_value(table_addition_picture_1, g_row, 0),file_name);

        printf("%s\n\r", lv_table_get_cell_value(table_addition_picture_1,g_row,0));
        sprintf(image_name,"A:/media/img/%s.bmp", file_name);

        printf("file_name=%s\n\r", file_name);

        //显示图片
        picture_img = lv_img_create(obj_addition_picture_preview_bg);
        lv_img_set_src(picture_img, image_name);

        //lv_img_set_zoom(picture_img, 128); 

        lv_obj_add_event_cb(table_addition_picture_1, file_draw_event_cb, LV_EVENT_DRAW_PART_BEGIN, NULL);
        lv_obj_add_event_cb(table_addition_picture_1, file_change_event_cb, LV_EVENT_PRESSED, NULL);


        typeface_slider_bg = lv_obj_create(lv_scr_act());
        lv_obj_set_size(typeface_slider_bg, 20, 224);
        lv_obj_align(typeface_slider_bg, LV_ALIGN_TOP_LEFT, 460, 24);
        lv_obj_set_style_border_width(typeface_slider_bg, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_border_color(typeface_slider_bg, lv_color_hex(0xaaaaaa), LV_STATE_DEFAULT); /* 设置边框颜色 */
        lv_obj_set_style_radius(typeface_slider_bg, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_color(typeface_slider_bg, lv_color_hex(0xaaaaaa), LV_STATE_DEFAULT);

        //左滑块停止
        LV_IMG_DECLARE(left_stop_typeface);
        left_stop_img_typeface = lv_img_create(lv_scr_act());
        lv_img_set_src(left_stop_img_typeface, &left_stop_typeface);
        lv_obj_align(left_stop_img_typeface, LV_ALIGN_TOP_LEFT, 460, 228);

        slider_show_file();

        //右滑块停止
        LV_IMG_DECLARE(right_stop_typeface);
        right_stop_img_typeface = lv_img_create(lv_scr_act());
        lv_img_set_src(right_stop_img_typeface, &right_stop_typeface);
        lv_obj_align(right_stop_img_typeface, LV_ALIGN_TOP_LEFT, 460, 24);


        obj_addition_picture_btn_bg = lv_obj_create(lv_scr_act());
        lv_obj_set_size(obj_addition_picture_btn_bg, 160, 98);
        lv_obj_align(obj_addition_picture_btn_bg, LV_ALIGN_TOP_LEFT, 0, 174);
        lv_obj_set_style_border_width(obj_addition_picture_btn_bg, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_radius(obj_addition_picture_btn_bg, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_color(obj_addition_picture_btn_bg, lv_color_hex(0x1fadd3), LV_STATE_DEFAULT);
        lv_obj_remove_style(obj_addition_picture_btn_bg, 0, LV_PART_SCROLLBAR);


        LV_IMG_DECLARE(picture_delete);
        btn_addition_picture_delete = lv_imgbtn_create(lv_scr_act());
        lv_imgbtn_set_src(btn_addition_picture_delete, LV_IMGBTN_STATE_RELEASED, NULL, &picture_delete, NULL);
        lv_obj_set_size(btn_addition_picture_delete, picture_delete.header.w, picture_delete.header.h);
        lv_obj_align(btn_addition_picture_delete, LV_ALIGN_TOP_LEFT, 10, 180);
        lv_obj_add_event_cb(btn_addition_picture_delete, btn_file_delete_event_cb, LV_EVENT_CLICKED, NULL);

        //打开
        LV_IMG_DECLARE(open_25_1);
        btn_addition_picture_open = lv_imgbtn_create(lv_scr_act());
        lv_imgbtn_set_src(btn_addition_picture_open, LV_IMGBTN_STATE_RELEASED, NULL, &open_25_1, NULL);
        lv_obj_set_size(btn_addition_picture_open, open_25_1.header.w, open_25_1.header.h);
        lv_obj_align(btn_addition_picture_open, LV_ALIGN_TOP_LEFT, 90, 180);
        lv_obj_add_event_cb(btn_addition_picture_open, imgbtn_file_confirm_event_cb, LV_EVENT_CLICKED, NULL);


        obj_addition_picture_bottom_bg = lv_obj_create(lv_scr_act());
        lv_obj_set_size(obj_addition_picture_bottom_bg, 480, 24);
        lv_obj_align(obj_addition_picture_bottom_bg, LV_ALIGN_TOP_LEFT, 0, 248);
        lv_obj_set_style_border_width(obj_addition_picture_bottom_bg, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_radius(obj_addition_picture_bottom_bg, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_color(obj_addition_picture_bottom_bg, lv_color_hex(0x28536a), LV_STATE_DEFAULT);
        lv_obj_remove_style(obj_addition_picture_bottom_bg, 0, LV_PART_SCROLLBAR);


        LV_IMG_DECLARE(search);
        img_addition_picture_search = lv_img_create(lv_scr_act());
        lv_img_set_src(img_addition_picture_search, &search);
        lv_obj_align(img_addition_picture_search, LV_ALIGN_TOP_LEFT, 10, 218);

        LV_FONT_DECLARE(heiFont16_1);
        label_addition_picture_search = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_addition_picture_search, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_addition_picture_search, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_addition_picture_search, "搜索");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_addition_picture_search, "Search");
        }
        lv_obj_align(label_addition_picture_search, LV_ALIGN_TOP_LEFT, 42, 222);


        LV_FONT_DECLARE(heiFont16_1);
        btn_addition_picture_search = lv_btn_create(lv_scr_act());
        lv_obj_set_size(btn_addition_picture_search, 70, 24);
        lv_obj_align(btn_addition_picture_search, LV_ALIGN_TOP_LEFT, 82, 218);
        lv_obj_set_style_border_width(btn_addition_picture_search, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_radius(btn_addition_picture_search, 10, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_color(btn_addition_picture_search, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        label_btn_addition_picture_search = lv_label_create(btn_addition_picture_search);
        lv_obj_set_style_text_font(label_btn_addition_picture_search, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_btn_addition_picture_search, lv_color_hex(0x1C1C1C), LV_STATE_DEFAULT);
        lv_label_set_text(label_btn_addition_picture_search, "");
        lv_obj_align(label_btn_addition_picture_search, LV_ALIGN_CENTER, 0, 0);
        lv_obj_set_style_border_width(label_btn_addition_picture_search, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_border_color(label_btn_addition_picture_search, lv_color_hex(0x8a8a8a), LV_STATE_DEFAULT); /* 设置边框颜色 */
        lv_obj_set_style_border_opa(label_btn_addition_picture_search, 100, LV_STATE_DEFAULT); /* 设置边框透明度 */
        lv_obj_set_style_radius(label_btn_addition_picture_search, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_opa(label_btn_addition_picture_search, LV_OPA_COVER, LV_PART_MAIN);
        lv_obj_set_style_bg_color(label_btn_addition_picture_search, lv_color_hex(0xffffff), LV_PART_MAIN);
        lv_obj_add_event_cb(btn_addition_picture_search, btn_file_search_event_cb, LV_EVENT_CLICKED, NULL);


        LV_FONT_DECLARE(heiFont16_1);
        label_addition_picture_return = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_addition_picture_return, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_addition_picture_return, lv_color_hex(0xffffff), LV_STATE_DEFAULT);

        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_addition_picture_return, "返回");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_addition_picture_return, "Return");
        }
        lv_obj_align(label_addition_picture_return, LV_ALIGN_TOP_LEFT, 140, 252);


        LV_IMG_DECLARE(get_back);
        imgbtn_addition_picture_return = lv_imgbtn_create(lv_scr_act());
        lv_imgbtn_set_src(imgbtn_addition_picture_return, LV_IMGBTN_STATE_RELEASED, NULL, &get_back, NULL);
        lv_obj_set_size(imgbtn_addition_picture_return, get_back.header.w, get_back.header.h);
        lv_obj_align(imgbtn_addition_picture_return, LV_ALIGN_TOP_LEFT, 180, 250);
        lv_obj_add_event_cb(imgbtn_addition_picture_return, imgbtn_file_return_event_cb, LV_EVENT_CLICKED, NULL);

        LV_IMG_DECLARE(confirm);
        imgbtn_addition_picture_confirm = lv_imgbtn_create(lv_scr_act());
        lv_imgbtn_set_src(imgbtn_addition_picture_confirm, LV_IMGBTN_STATE_RELEASED, NULL, &confirm, NULL);
        lv_obj_set_size(imgbtn_addition_picture_confirm, get_back.header.w, get_back.header.h);
        lv_obj_align(imgbtn_addition_picture_confirm, LV_ALIGN_TOP_LEFT, 250, 250);
        lv_obj_add_event_cb(imgbtn_addition_picture_confirm, imgbtn_file_confirm_event_cb, LV_EVENT_CLICKED, NULL);

        LV_FONT_DECLARE(heiFont16_1);
        label_addition_picture_confirm = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_addition_picture_confirm, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_addition_picture_confirm, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_addition_picture_confirm, "确定");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_addition_picture_confirm, "Confirm");
        }
        lv_obj_align(label_addition_picture_confirm, LV_ALIGN_TOP_LEFT, 277, 252);
    }
}
#endif




static void button_file_event_cb(lv_event_t* e)
{
    lv_event_code_t code;
    //char file_name[100]={0};
    FileInfo *files = NULL;
    int count = 0;
    char full_path[512];


    code = lv_event_get_code(e);
    if ((code == LV_EVENT_CLICKED)&&(print_status == 0))
    {
        buzzer_enable = 1;

        printf("file\n");
        obj_addition_picture_head_bg = lv_obj_create(lv_scr_act());
        lv_obj_set_size(obj_addition_picture_head_bg, 480, 24);
        lv_obj_align(obj_addition_picture_head_bg, LV_ALIGN_TOP_LEFT, 0, 0);
        lv_obj_set_style_border_width(obj_addition_picture_head_bg, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_radius(obj_addition_picture_head_bg, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_color(obj_addition_picture_head_bg, lv_color_hex(0x28536a), LV_STATE_DEFAULT);
        lv_obj_remove_style(obj_addition_picture_head_bg, 0, LV_PART_SCROLLBAR);


        LV_FONT_DECLARE(heiFont16_1);
        label_addition_picture_head = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_addition_picture_head, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_addition_picture_head, lv_color_hex(0xFFFFFF), LV_STATE_DEFAULT);

        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_addition_picture_head, "文件");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_addition_picture_head, "File");
        }

        lv_obj_align(label_addition_picture_head, LV_ALIGN_TOP_LEFT, 200, 4);


        obj_addition_picture_btn_bg = lv_obj_create(lv_scr_act());
        lv_obj_set_size(obj_addition_picture_btn_bg, 480, 30);
        lv_obj_align(obj_addition_picture_btn_bg, LV_ALIGN_TOP_LEFT, 0, 24);
        lv_obj_set_style_border_width(obj_addition_picture_btn_bg, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_radius(obj_addition_picture_btn_bg, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_color(obj_addition_picture_btn_bg, lv_color_hex(0x1fadd3), LV_STATE_DEFAULT);
        lv_obj_remove_style(obj_addition_picture_btn_bg, 0, LV_PART_SCROLLBAR);


        
        LV_IMG_DECLARE(search);
        img_addition_picture_search = lv_img_create(lv_scr_act());
        lv_img_set_src(img_addition_picture_search, &search);
        lv_obj_align(img_addition_picture_search, LV_ALIGN_TOP_LEFT, 10, 28);

        LV_FONT_DECLARE(heiFont16_1);
        label_addition_picture_search = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_addition_picture_search, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_addition_picture_search, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_addition_picture_search, "搜索");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_addition_picture_search, "Search");
        }
        lv_obj_align(label_addition_picture_search, LV_ALIGN_TOP_LEFT, 40, 32);


        LV_FONT_DECLARE(heiFont16_1);
        btn_addition_picture_search = lv_btn_create(lv_scr_act());
        lv_obj_set_size(btn_addition_picture_search, 200, 24);
        lv_obj_align(btn_addition_picture_search, LV_ALIGN_TOP_LEFT, 84, 28);
        lv_obj_set_style_border_width(btn_addition_picture_search, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_radius(btn_addition_picture_search, 5, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_color(btn_addition_picture_search, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        label_btn_addition_picture_search = lv_label_create(btn_addition_picture_search);
        lv_obj_set_style_text_font(label_btn_addition_picture_search, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_btn_addition_picture_search, lv_color_hex(0x1C1C1C), LV_STATE_DEFAULT);
        lv_label_set_text(label_btn_addition_picture_search, "");
        lv_obj_align(label_btn_addition_picture_search, LV_ALIGN_CENTER, 0, 0);
        lv_obj_set_style_border_width(label_btn_addition_picture_search, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_border_color(label_btn_addition_picture_search, lv_color_hex(0x8a8a8a), LV_STATE_DEFAULT); /* 设置边框颜色 */
        lv_obj_set_style_border_opa(label_btn_addition_picture_search, 100, LV_STATE_DEFAULT); /* 设置边框透明度 */
        lv_obj_set_style_radius(label_btn_addition_picture_search, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_opa(label_btn_addition_picture_search, LV_OPA_COVER, LV_PART_MAIN);
        lv_obj_set_style_bg_color(label_btn_addition_picture_search, lv_color_hex(0xffffff), LV_PART_MAIN);
        lv_obj_add_event_cb(btn_addition_picture_search, btn_file_search_event_cb, LV_EVENT_CLICKED, NULL);



        LV_IMG_DECLARE(picture_delete);
        btn_addition_picture_delete = lv_imgbtn_create(lv_scr_act());
        lv_imgbtn_set_src(btn_addition_picture_delete, LV_IMGBTN_STATE_RELEASED, NULL, &picture_delete, NULL);
        lv_obj_set_size(btn_addition_picture_delete, picture_delete.header.w, picture_delete.header.h);
        lv_obj_align(btn_addition_picture_delete, LV_ALIGN_TOP_LEFT, 310, 27);
        lv_obj_add_event_cb(btn_addition_picture_delete, btn_file_delete_event_cb, LV_EVENT_CLICKED, NULL);

        //打开
        LV_IMG_DECLARE(open_25_1);
        btn_addition_picture_open = lv_imgbtn_create(lv_scr_act());
        lv_imgbtn_set_src(btn_addition_picture_open, LV_IMGBTN_STATE_RELEASED, NULL, &open_25_1, NULL);
        lv_obj_set_size(btn_addition_picture_open, open_25_1.header.w, open_25_1.header.h);
        lv_obj_align(btn_addition_picture_open, LV_ALIGN_TOP_LEFT, 400, 27);
        lv_obj_add_event_cb(btn_addition_picture_open, imgbtn_file_confirm_event_cb, LV_EVENT_CLICKED, NULL);


        static lv_style_t table_cell_style;
        lv_style_init(&table_cell_style);
        lv_style_set_pad_all(&table_cell_style, 2); // 设置所有方向的填充为5像素

        table_addition_picture = lv_table_create(lv_scr_act());
        lv_obj_add_style(table_addition_picture, &table_cell_style, LV_PART_ITEMS); // 应用样式到表格的单元格部分
        LV_FONT_DECLARE(heiFont16_1);
        lv_obj_set_style_text_font(table_addition_picture, &heiFont16_1, LV_STATE_DEFAULT);

        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_table_set_cell_value(table_addition_picture, 0, 0, " 名称");
            lv_table_set_cell_value(table_addition_picture, 0, 1, "   时间");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_table_set_cell_value(table_addition_picture, 0, 0, " Name");
            lv_table_set_cell_value(table_addition_picture, 0, 1, "   Time");
        }

        lv_obj_align(table_addition_picture, LV_ALIGN_TOP_LEFT, 0, 54);
        lv_table_set_col_width(table_addition_picture, 0, 367);
        lv_table_set_col_width(table_addition_picture, 1, 90);



        obj_addition_table_bg = lv_obj_create(lv_scr_act());
        lv_obj_set_size(obj_addition_table_bg, 460, 176);
        lv_obj_align(obj_addition_table_bg, LV_ALIGN_TOP_LEFT, 0, 75);
        lv_obj_set_style_border_width(obj_addition_table_bg, 1, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_radius(obj_addition_table_bg, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_color(obj_addition_table_bg, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        lv_obj_remove_style(obj_addition_table_bg, 0, LV_PART_SCROLLBAR);

        win_content_typeface = lv_obj_create(obj_addition_table_bg);
        lv_obj_set_size(win_content_typeface, 460, 500);
        lv_obj_align(win_content_typeface, LV_ALIGN_TOP_LEFT, -16, -16);
        lv_obj_set_style_bg_color(win_content_typeface, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        lv_obj_set_style_border_width(win_content_typeface, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_border_color(win_content_typeface, lv_color_hex(0xcccccc), LV_STATE_DEFAULT); /* 设置边框颜色 */
        lv_obj_clear_flag(win_content_typeface, LV_OBJ_FLAG_SCROLLABLE);
        lv_obj_set_style_radius(win_content_typeface, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_pad_all(win_content_typeface, 0, LV_STATE_DEFAULT);


        table_addition_picture_1 = lv_table_create(win_content_typeface);
        LV_FONT_DECLARE(heiFont16_1);
        lv_obj_add_style(table_addition_picture_1, &table_cell_style, LV_PART_ITEMS); // 应用样式到表格的单元格部分
        lv_obj_align(table_addition_picture_1, LV_ALIGN_TOP_LEFT, 0, 0);
        lv_obj_set_style_text_font(table_addition_picture_1, &heiFont16_1, LV_STATE_DEFAULT);

        lv_table_set_col_width(table_addition_picture_1, 0, 367);
        lv_table_set_col_width(table_addition_picture_1, 1, 90);

        DIR *dir;
        struct dirent *entry;
        struct stat file_stat;
        //char path[300];
        //unsigned char picture_count = 0;
        //int picture_type = 0;
        char created_time[20] ={0};
        //char size_str[20]; // 存储转换后的字符串
        //char image_name[128]; // 存储提取的图片名称

        g_file_num = 0;

        dir = opendir("/media/file");
        if (dir == NULL) 
        {
            perror("opendir");
            exit(EXIT_FAILURE);
        }

#if 0

        while ((entry = readdir(dir)) != NULL) 
        {
            snprintf(path, sizeof(path), "%s/%s", "/media/file", entry->d_name);
            if (stat(path, &file_stat) == -1) 
            {
                perror("stat");
                continue;
            }

            if ((S_ISREG(file_stat.st_mode))&&(g_file_num < USB_PICTURE_NUMBER))
            {  
                // 只处理普通文件
                if (is_dat_file(entry->d_name)) 
                {
                    //print_file_info(entry->d_name, &file_stat);
                    lv_table_set_cell_value(table_addition_picture_1, g_file_num, 0, entry->d_name);
                    printf("Created: %s", ctime(&file_stat.st_ctime));
                    format_time(ctime(&file_stat.st_ctime), created_time);
                    printf("created_time=%s\n\r",created_time);
                    lv_table_set_cell_value(table_addition_picture_1, g_file_num, 1, created_time);
                    g_file_num++;
                }
            }
        }
#endif

        // 第一次遍历，统计文件数量
        while ((entry = readdir(dir)) != NULL) 
        {
            if (strcmp(entry->d_name, ".") == 0 || strcmp(entry->d_name, "..") == 0) {
                continue;
            }
            count++;
        }
        rewinddir(dir);

        // 分配内存
        files = (FileInfo *)malloc(count * sizeof(FileInfo));
        if (files == NULL) {
            perror("malloc");
            closedir(dir);
            //return -1;
        }

            // 第二次遍历，收集文件信息
        int index = 0;
        while ((entry = readdir(dir)) != NULL && index < count) 
        {
            if (strcmp(entry->d_name, ".") == 0 || strcmp(entry->d_name, "..") == 0) {
                continue;
            }

            // 构建完整路径
            snprintf(full_path, sizeof(full_path), "%s/%s", "/media/file", entry->d_name);

            // 获取文件状态
            if (stat(full_path, &file_stat) == -1) {
                perror("stat");
                continue;
            }

            // 只处理普通文件
            if (S_ISREG(file_stat.st_mode)) 
            {
                strncpy(files[index].name, entry->d_name, sizeof(files[index].name) - 1);
                files[index].mtime = file_stat.st_mtime;
                index++;
            }
        }


        // 实际有效的文件数
        count = index;

        // 按修改时间排序
        qsort(files, count, sizeof(FileInfo), compare_files);

        // 输出结果
        //printf("%-40s %-20s %s\n", "Filename", "Modification Time", "Size");
        //printf("------------------------------------------------------------\n");
        
        for (int i = 0; i < count; i++) 
        {
            //char time_str[20];
            //struct tm *tm_info = localtime(&files[i].mtime);
            //strftime(time_str, sizeof(time_str), "%Y-%m-%d %H:%M:%S", tm_info);    
            //printf("%-40s %-20s %ld bytes\n", files[i].name, time_str, (long)files[i].size);

            //print_file_info(entry->d_name, &file_stat);
            lv_table_set_cell_value(table_addition_picture_1, g_file_num, 0, files[i].name);
            printf("Created: %s", ctime(&files[i].mtime));
            format_time(ctime(&files[i].mtime), created_time);
            printf("created_time=%s\n\r",created_time);
            lv_table_set_cell_value(table_addition_picture_1, g_file_num, 1, created_time);
            g_file_num++;
        }

        // 清理
        free(files);

        closedir(dir);
#if 0
        remove_dat_suffix(lv_table_get_cell_value(table_addition_picture_1, g_row, 0),file_name);

        printf("%s\n\r", lv_table_get_cell_value(table_addition_picture_1,g_row,0));
        sprintf(image_name,"A:/media/img/%s.bmp", file_name);

        printf("file_name=%s\n\r", file_name);

        //显示图片
        picture_img = lv_img_create(obj_addition_picture_preview_bg);
        lv_img_set_src(picture_img, image_name);
#endif

        //lv_img_set_zoom(picture_img, 128); 

        lv_obj_add_event_cb(table_addition_picture_1, file_draw_event_cb, LV_EVENT_DRAW_PART_BEGIN, NULL);
        lv_obj_add_event_cb(table_addition_picture_1, file_change_event_cb, LV_EVENT_PRESSED, NULL);


        typeface_slider_bg = lv_obj_create(lv_scr_act());
        lv_obj_set_size(typeface_slider_bg, 20, 195);
        lv_obj_align(typeface_slider_bg, LV_ALIGN_TOP_LEFT, 460, 54);
        lv_obj_set_style_border_width(typeface_slider_bg, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_border_color(typeface_slider_bg, lv_color_hex(0xaaaaaa), LV_STATE_DEFAULT); /* 设置边框颜色 */
        lv_obj_set_style_radius(typeface_slider_bg, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_color(typeface_slider_bg, lv_color_hex(0xaaaaaa), LV_STATE_DEFAULT);

        //左滑块停止
        LV_IMG_DECLARE(left_stop_typeface);
        left_stop_img_typeface = lv_img_create(lv_scr_act());
        lv_img_set_src(left_stop_img_typeface, &left_stop_typeface);
        lv_obj_align(left_stop_img_typeface, LV_ALIGN_TOP_LEFT, 460, 54);

        slider_show_file();

        //右滑块停止
        LV_IMG_DECLARE(right_stop_typeface);
        right_stop_img_typeface = lv_img_create(lv_scr_act());
        lv_img_set_src(right_stop_img_typeface, &right_stop_typeface);
        lv_obj_align(right_stop_img_typeface, LV_ALIGN_TOP_LEFT, 460, 228);


        
        obj_addition_picture_bottom_bg = lv_obj_create(lv_scr_act());
        lv_obj_set_size(obj_addition_picture_bottom_bg, 480, 24);
        lv_obj_align(obj_addition_picture_bottom_bg, LV_ALIGN_TOP_LEFT, 0, 248);
        lv_obj_set_style_border_width(obj_addition_picture_bottom_bg, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_radius(obj_addition_picture_bottom_bg, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_color(obj_addition_picture_bottom_bg, lv_color_hex(0x28536a), LV_STATE_DEFAULT);
        lv_obj_remove_style(obj_addition_picture_bottom_bg, 0, LV_PART_SCROLLBAR);


        LV_FONT_DECLARE(heiFont16_1);
        label_addition_picture_return = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_addition_picture_return, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_addition_picture_return, lv_color_hex(0xffffff), LV_STATE_DEFAULT);

        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_addition_picture_return, "返回");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_addition_picture_return, "Return");
        }
        lv_obj_align(label_addition_picture_return, LV_ALIGN_TOP_LEFT, 140, 252);


        LV_IMG_DECLARE(get_back);
        imgbtn_addition_picture_return = lv_imgbtn_create(lv_scr_act());
        lv_imgbtn_set_src(imgbtn_addition_picture_return, LV_IMGBTN_STATE_RELEASED, NULL, &get_back, NULL);
        lv_obj_set_size(imgbtn_addition_picture_return, get_back.header.w, get_back.header.h);
        lv_obj_align(imgbtn_addition_picture_return, LV_ALIGN_TOP_LEFT, 180, 250);
        lv_obj_add_event_cb(imgbtn_addition_picture_return, imgbtn_file_return_event_cb, LV_EVENT_CLICKED, NULL);

        LV_IMG_DECLARE(confirm);
        imgbtn_addition_picture_confirm = lv_imgbtn_create(lv_scr_act());
        lv_imgbtn_set_src(imgbtn_addition_picture_confirm, LV_IMGBTN_STATE_RELEASED, NULL, &confirm, NULL);
        lv_obj_set_size(imgbtn_addition_picture_confirm, get_back.header.w, get_back.header.h);
        lv_obj_align(imgbtn_addition_picture_confirm, LV_ALIGN_TOP_LEFT, 250, 250);
        lv_obj_add_event_cb(imgbtn_addition_picture_confirm, imgbtn_file_confirm_event_cb, LV_EVENT_CLICKED, NULL);

        LV_FONT_DECLARE(heiFont16_1);
        label_addition_picture_confirm = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_addition_picture_confirm, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_addition_picture_confirm, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_addition_picture_confirm, "确定");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_addition_picture_confirm, "Confirm");
        }
        lv_obj_align(label_addition_picture_confirm, LV_ALIGN_TOP_LEFT, 277, 252);
    }
}


static void button_save_keyboard_return_event_cb(lv_event_t* e)
{
    lv_event_code_t code;
    code = lv_event_get_code(e);
    if (code == LV_EVENT_CLICKED)
    {
        printf("button_save_keyboard_return_event_cb\n");

        buzzer_enable = 1;

        lv_obj_del(textarea_bg_keyboard);
        lv_obj_del(pinyin_ime);
        lv_obj_del(textarea_text_keyboard);
        lv_obj_del(keyboard_bg);
        lv_obj_del(label_keyboard_confirm);
        lv_obj_del(btn_keyboard_confirm);
        lv_obj_del(label_keyboard_return);
        lv_obj_del(btn_keyboard_return);
    }
}

#if 0
// 保存截图为 BMP 文件的函数
void save_as_bmp(const char *filename, const lv_img_dsc_t *img) {
    FILE *file = fopen(filename, "wb");
    if (!file) {
        printf("Failed to open file for writing\n");
        return;
    }

    // 缩小后的尺寸（原尺寸的 50%）
    uint32_t new_width = img->header.w / 2;
    uint32_t new_height = img->header.h / 2;

    // BMP 文件头
    uint32_t file_size = 54 + new_width * new_height * 3; // 54字节头 + 数据大小
    uint32_t data_offset = 54;
    uint32_t header_size = 40;
    uint16_t planes = 1;
    uint16_t bpp = 24; // 24位真彩色
    uint32_t compression = 0;
    uint32_t data_size = new_width* new_height * 3;
    uint32_t temp_w = new_width;
    uint32_t temp_h = new_height;

    // 写入 BMP 文件头
    fwrite("BM", 1, 2, file);
    fwrite(&file_size, 4, 1, file);
    fwrite("\0\0\0\0", 1, 4, file);
    fwrite(&data_offset, 4, 1, file);
    fwrite(&header_size, 4, 1, file);
    //fwrite(&img->header.w, 4, 1, file);
    //fwrite(&img->header.h, 4, 1, file);
    fwrite(&temp_w, 4, 1, file);
    fwrite(&temp_h, 4, 1, file);
    fwrite(&planes, 2, 1, file);
    fwrite(&bpp, 2, 1, file);
    fwrite(&compression, 4, 1, file);
    fwrite(&data_size, 4, 1, file);
    fwrite("\0\0\0\0", 1, 4, file); // 保留字段
    fwrite("\0\0\0\0", 1, 4, file); // 保留字段
    fwrite("\0\0\0\0", 1, 4, file); // 保留字段
    fwrite("\0\0\0\0", 1, 4, file); // 保留字段

    // 写入像素数据
    for (int y = img->header.h - 1; y >= 0; y-=2) {
        for (int x = 0; x < img->header.w; x+=2) {
            uint32_t pixel = ((uint32_t *)img->data)[y * img->header.w + x];
            uint8_t b = pixel & 0xFF;
            uint8_t g = (pixel >> 8) & 0xFF;
            uint8_t r = (pixel >> 16) & 0xFF;
            fwrite(&b, 1, 1, file);
            fwrite(&g, 1, 1, file);
            fwrite(&r, 1, 1, file);
        }
    }

    fclose(file);
}



//#define STB_IMAGE_WRITE_IMPLEMENTATION
//#include "stb_image_write.h"

void save_as_png_stb(const char *filename, const lv_img_dsc_t *img) {
    uint8_t *pixels = (uint8_t *)img->data;
    int width = img->header.w;
    int height = img->header.h;

    // 如果是 ARGB8888，转换为 RGBA
    uint8_t *rgba_data = NULL;
    if (img->header.cf == LV_IMG_CF_TRUE_COLOR_ALPHA) {
        rgba_data = (uint8_t *)lv_mem_alloc(width * height * 4);
        for (int i = 0; i < width * height; i++) {
            uint32_t pixel = ((uint32_t *)pixels)[i];
            rgba_data[i * 4 + 0] = (pixel >> 16) & 0xFF; // R
            rgba_data[i * 4 + 1] = (pixel >> 8) & 0xFF;  // G
            rgba_data[i * 4 + 2] = pixel & 0xFF;         // B
            rgba_data[i * 4 + 3] = (pixel >> 24) & 0xFF; // A
        }
        pixels = rgba_data;
    }

    // 使用 stb_image_write 保存 PNG
    stbi_write_png(filename, width, height, 4, pixels, width * 4);

    if (rgba_data) {
        lv_mem_free(rgba_data);
    }
}




void save_as_bmp_half_size(const char *filename, const lv_img_dsc_t *img) {
    FILE *file = fopen(filename, "wb");
    if (!file) {
        perror("Failed to open file");
        return;
    }

    // 缩小后的尺寸（原尺寸的 50%）
    uint32_t new_width = img->header.w / 2;
    uint32_t new_height = img->header.h / 2;

    // BMP 行对齐计算（每行必须是 4 的倍数）
    uint32_t row_size = (new_width * 3 + 3) & ~3; // 3 bytes per pixel (RGB)
    uint32_t data_size = row_size * new_height;
    uint32_t file_size = 54 + data_size; // 54字节头 + 数据大小

    // BMP 文件头
    uint8_t header[54] = {
        'B', 'M',                             // 签名
        file_size & 0xFF, (file_size >> 8) & 0xFF, (file_size >> 16) & 0xFF, (file_size >> 24) & 0xFF, // 文件大小
        0, 0, 0, 0,                           // 保留
        54, 0, 0, 0,                           // 像素数据偏移量
        40, 0, 0, 0,                           // 信息头大小
        new_width & 0xFF, (new_width >> 8) & 0xFF, (new_width >> 16) & 0xFF, (new_width >> 24) & 0xFF, // 宽度
        new_height & 0xFF, (new_height >> 8) & 0xFF, (new_height >> 16) & 0xFF, (new_height >> 24) & 0xFF, // 高度
        1, 0,                                  // 颜色平面数
        24, 0,                                 // 每像素位数（24 = RGB）
        0, 0, 0, 0,                            // 压缩方式
        data_size & 0xFF, (data_size >> 8) & 0xFF, (data_size >> 16) & 0xFF, (data_size >> 24) & 0xFF, // 像素数据大小
        0, 0, 0, 0,                            // 水平分辨率
        0, 0, 0, 0,                            // 垂直分辨率
        0, 0, 0, 0,                            // 调色板
        0, 0, 0, 0                             // 重要颜色
    };

    // 写入文件头
    fwrite(header, 1, 54, file);

    // 写入像素数据（缩小 50% 并处理对齐）
    uint8_t padding[3] = {0};
    for (int y = img->header.h - 1; y >= 0; y -= 2) {      // 每隔一行采样
        for (int x = 0; x < img->header.w; x += 2) {       // 每隔一列采样
            uint32_t pixel = ((uint32_t *)img->data)[y * img->header.w + x];
            uint8_t b = pixel & 0xFF;
            uint8_t g = (pixel >> 8) & 0xFF;
            uint8_t r = (pixel >> 16) & 0xFF;
            fwrite(&b, 1, 1, file);
            fwrite(&g, 1, 1, file);
            fwrite(&r, 1, 1, file);
        }
        // 填充对齐字节（如果行字节数不是 4 的倍数）
        if (row_size > new_width * 3) {
            fwrite(padding, 1, row_size - new_width * 3, file);
        }
    }

    fclose(file);
    printf("BMP saved: %s (Size: %dx%d)\n", filename, new_width, new_height);
}




void save_as_bmp_half_size_fixed(const char* filename, const lv_img_dsc_t* img) {
    // 检查输入
    if (!img || img->header.cf != LV_IMG_CF_TRUE_COLOR_ALPHA) {
        printf("Invalid image format\n");
        return;
    }

    FILE* file = fopen(filename, "wb");
    if (!file) {
        perror("Failed to open file");
        return;
    }

    // 计算新尺寸
    uint32_t new_width = img->header.w / 2;
    uint32_t new_height = img->header.h / 2;

    // BMP 行对齐计算（每行必须是4的倍数）
    uint32_t row_stride = (new_width * 3 + 3) & ~3;
    uint32_t image_size = row_stride * new_height;
    uint32_t file_size = 54 + image_size;

    // 准备BMP文件头
    uint8_t header[54] = {0};
    header[0] = 'B';
    header[1] = 'M';
    memcpy(header + 2, &file_size, 4);
    header[10] = 54;  // 像素数据偏移
    header[14] = 40;  // 信息头大小
    memcpy(header + 18, &new_width, 4);
    memcpy(header + 22, &new_height, 4);
    header[26] = 1;   // 颜色平面数
    header[28] = 24;  // 每像素位数
    memcpy(header + 34, &image_size, 4);

    // 写入文件头
    fwrite(header, 1, 54, file);

    // 准备行缓冲区
    uint8_t* row_buffer = (uint8_t*)lv_mem_alloc(row_stride);
    if (!row_buffer) {
        fclose(file);
        printf("Memory allocation failed\n");
        return;
    }

    // 处理像素数据
    const uint32_t* src = (const uint32_t*)img->data;
    for (uint32_t y = 0; y < new_height; y++) {
        uint8_t* dst = row_buffer;
        for (uint32_t x = 0; x < new_width; x++) {
            // 采样源图像(注意Y方向从下往上)
            uint32_t src_y = img->header.h - 1 - y * 2;
            uint32_t src_x = x * 2;
            uint32_t pixel = src[src_y * img->header.w + src_x];
            
            // ARGB转BGR(忽略Alpha)
            *dst++ = pixel & 0xFF;        // B
            *dst++ = (pixel >> 8) & 0xFF; // G
            *dst++ = (pixel >> 16) & 0xFF;// R
        }
        // 写入行数据
        fwrite(row_buffer, 1, row_stride, file);
    }

    // 清理
    lv_mem_free(row_buffer);
    fclose(file);
    printf("BMP saved: %s (%dx%d)\n", filename, new_width, new_height);
}
#endif



void save_as_bmp_half_size_noalloc(const char* filename, const lv_img_dsc_t* img) {
    // 输入验证
    if (!img || img->header.cf != LV_IMG_CF_TRUE_COLOR_ALPHA) {
        printf("Invalid image format\n");
        return;
    }

    FILE* file = fopen(filename, "wb");
    if (!file) {
        perror("Failed to open file");
        return;
    }

    // 计算新尺寸
    uint32_t new_width = img->header.w / 2;
    uint32_t new_height = img->header.h / 2;

    // BMP行对齐计算（每行必须是4的倍数）
    uint32_t row_stride = (new_width * 3 + 3) & ~3;
    uint32_t image_size = row_stride * new_height;
    uint32_t file_size = 54 + image_size;

    // BMP文件头
    uint8_t header[54] = {0};
    header[0] = 'B';
    header[1] = 'M';
    memcpy(header + 2, &file_size, 4);
    header[10] = 54;  // 像素数据偏移
    header[14] = 40;  // 信息头大小
    memcpy(header + 18, &new_width, 4);
    memcpy(header + 22, &new_height, 4);
    header[26] = 1;   // 颜色平面数
    header[28] = 24;  // 每像素位数
    memcpy(header + 34, &image_size, 4);

    // 写入文件头
    fwrite(header, 1, 54, file);

    // 直接写入像素数据
    const uint32_t* src = (const uint32_t*)img->data;
    uint8_t pixel_buffer[3];  // 单个像素的BGR缓冲区
    uint8_t padding[3] = {0}; // 对齐填充
    
    for (uint32_t y = 0; y < new_height; y++) {
        // 从底部开始采样(Y方向翻转)
        uint32_t src_y = img->header.h - 1 - y * 2;
        
        for (uint32_t x = 0; x < new_width; x++) {
            uint32_t src_x = x * 2;
            uint32_t pixel = src[src_y * img->header.w + src_x];
            
            // ARGB转BGR(忽略Alpha)
            pixel_buffer[0] = pixel & 0xFF;        // B
            pixel_buffer[1] = (pixel >> 8) & 0xFF; // G
            pixel_buffer[2] = (pixel >> 16) & 0xFF;// R
            
            fwrite(pixel_buffer, 1, 3, file);
        }
        
        // 写入对齐填充（如果需要）
        uint32_t padding_size = row_stride - new_width * 3;
        if (padding_size > 0) {
            fwrite(padding, 1, padding_size, file);
        }
    }

    fclose(file);
    printf("BMP saved: %s (%dx%d)\n", filename, new_width, new_height);
}



static void button_save_keyboard_confirm_event_cb(lv_event_t* e)
{
    lv_event_code_t code;
    code = lv_event_get_code(e);
    int win_content_child_num = 0;
    int i;

    //int len = 0;
    char file_name[128] = { 0 };
    //char img_name[128] = { 0 };
    //static lv_img_dsc_t* snapshot_1 = NULL;
    if (code == LV_EVENT_CLICKED)
    {
        lv_obj_del(label_keyboard_confirm);
        lv_obj_del(btn_keyboard_confirm);
        lv_obj_del(label_keyboard_return);
        lv_obj_del(btn_keyboard_return);

        printf("button_save_keyboard_confirm_event_cb\n");
        buzzer_enable = 1;

        win_content_child_num = lv_obj_get_child_cnt(win_content);

        printf("win_content_child_num=%d\n\r",win_content_child_num);

        for(i=win_content_child_num;i<NEW_TEXT_MAX_NUMBER;i++)
        {
            memset((char *)&data_structure[i],0,sizeof(DATA_STRUCTURE));
        }
        
        //获取文件名称
        sprintf(file_name, "/media/file/%s.dat", lv_textarea_get_text(textarea_text_keyboard));
        // 打开文件以写入二进制数据
        FILE* file = fopen(file_name, "wb");
        if (file == NULL) {
            perror("Failed to open file");
            //return EXIT_FAILURE;
        }

        // 将结构体写入文件
        size_t written = fwrite(&data_structure, sizeof(data_structure), 1, file);
        if (written != 1) {
            perror("Failed to write data to file");
            fclose(file);
            //return EXIT_FAILURE;
        }

        // 刷新缓冲区确保数据写入磁盘
        if (fsync(fileno(file)) != 0)
        {
            printf("Fsync failed\r\n");
        }
            

        // 关闭文件
        fclose(file);

        //写图片
        //sprintf(img_name, "/media/img/%s.bmp", lv_textarea_get_text(textarea_text_keyboard));

        lv_obj_del(textarea_bg_keyboard);
        lv_obj_del(pinyin_ime);
        lv_obj_del(textarea_text_keyboard);
        lv_obj_del(keyboard_bg);
#if 0
        snapshot_1 = lv_snapshot_take(win_content, LV_IMG_CF_TRUE_COLOR_ALPHA);

        //使用示例
        //save_as_bmp(img_name, snapshot_1);
        //save_as_bmp_half_size(img_name, snapshot_1);
        save_as_bmp_half_size_noalloc(img_name, snapshot_1);
        //save_as_png_stb(img_name,snapshot_1);
        lv_mem_free(snapshot_1);
#endif
    }
}


static void button_save_event_cb(lv_event_t* e)
{
    lv_event_code_t code;
    int win_content_child_num = 0;
    //int len = 0;
    code = lv_event_get_code(e);
    if ((code == LV_EVENT_CLICKED)&& (print_status == 0))
    {
        printf("save\n");

        buzzer_enable = 1;
        //如果子控件数量大于0,才能保存
        win_content_child_num = lv_obj_get_child_cnt(win_content);
        if (win_content_child_num > 0)
        {
            //命名界面
            textarea_bg_keyboard = lv_obj_create(lv_scr_act());

            lv_obj_set_size(textarea_bg_keyboard, 480, 272);
            lv_obj_align(textarea_bg_keyboard, LV_ALIGN_TOP_LEFT, 0, 0);
            lv_obj_set_style_border_width(textarea_bg_keyboard, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
            lv_obj_set_style_border_color(textarea_bg_keyboard, lv_color_hex(0x9bcd9b), LV_STATE_DEFAULT); /* 设置边框颜色 */
            //lv_obj_set_style_border_opa(file_management_win, 100, LV_STATE_DEFAULT); /* 设置边框透明度 */
            lv_obj_set_style_radius(textarea_bg_keyboard, 0, LV_STATE_DEFAULT); /* 设置圆角 */
            lv_obj_set_style_bg_color(textarea_bg_keyboard, lv_color_hex(0x1fadd3), LV_STATE_DEFAULT);

            //输入框+键盘
            LV_FONT_DECLARE(heiFont16_1);
            pinyin_ime = lv_ime_pinyin_create(lv_scr_act());
            lv_obj_set_style_text_font(pinyin_ime, &heiFont16_1, 0);
            //lv_obj_set_style_text_font(pinyin_ime, &lv_font_simsun_16_cjk, 0);
            //lv_ime_pinyin_set_dict(pinyin_ime, your_dict); // Use a custom dictionary. If it is not set, the built-in dictionary will be used.

            textarea_text_keyboard = lv_textarea_create(lv_scr_act());
            //lv_textarea_set_one_line(textarea_text_keyboard, true);
            lv_obj_set_size(textarea_text_keyboard, 480, 95);
            lv_obj_set_style_text_font(textarea_text_keyboard, &heiFont16_1, 0);
            lv_obj_align(textarea_text_keyboard, LV_ALIGN_TOP_LEFT, 0, 0);
            lv_textarea_set_max_length(textarea_text_keyboard, 100);
            //lv_textarea_set_placeholder_text(textarea_text_keyboard, "Smart printer");
            //lv_obj_add_event_cb(textarea_text_keyboard, textarea_text_event_cb, LV_EVENT_ALL, NULL);
            lv_obj_set_style_border_width(textarea_text_keyboard, 1, LV_STATE_DEFAULT); /* 设置边框宽度 */
            lv_obj_set_style_border_color(textarea_text_keyboard, lv_color_hex(0xAAAAAA), LV_STATE_DEFAULT); /* 设置边框颜色 */
            lv_obj_set_style_border_opa(textarea_text_keyboard, 100, LV_STATE_DEFAULT); /* 设置边框透明度 */
            lv_obj_set_style_radius(textarea_text_keyboard, 0, LV_STATE_DEFAULT); /* 设置圆角 */
            lv_textarea_set_text(textarea_text_keyboard, "");

            /*Create a keyboard and add it to ime_pinyin*/
            text_edit_keyboard = lv_keyboard_create(lv_scr_act());
            lv_ime_pinyin_set_keyboard(pinyin_ime, text_edit_keyboard);
            lv_keyboard_set_textarea(text_edit_keyboard, textarea_text_keyboard);
            //lv_obj_set_style_bg_color(text_edit_keyboard, lv_color_hex(0xff4040), LV_PART_MAIN);
            lv_obj_set_style_bg_color(text_edit_keyboard, lv_color_hex(0x1fadd3), LV_PART_MAIN);
            lv_obj_add_event_cb(textarea_text_keyboard, textarea_text_event_cb, LV_EVENT_ALL, text_edit_keyboard);
            lv_obj_align(text_edit_keyboard, LV_ALIGN_TOP_LEFT, 0, 115);
            lv_obj_set_size(text_edit_keyboard, 480, 133);

            /*Get the cand_panel, and adjust its size and position*/
            keyboard_cand_panel = lv_ime_pinyin_get_cand_panel(pinyin_ime);
            lv_obj_set_size(keyboard_cand_panel, LV_PCT(100), LV_PCT(10));
            lv_obj_align_to(keyboard_cand_panel, text_edit_keyboard, LV_ALIGN_OUT_TOP_MID, 0, 5);
            lv_obj_set_style_bg_color(keyboard_cand_panel, lv_color_hex(0x8B1A1A), LV_PART_MAIN);
            lv_obj_set_style_text_font(keyboard_cand_panel, &heiFont16_1, 0);

            keyboard_bg = lv_obj_create(lv_scr_act());
            lv_obj_set_size(keyboard_bg, 480, 24);
            lv_obj_align(keyboard_bg, LV_ALIGN_TOP_LEFT, 0, 248);
            lv_obj_set_style_border_width(keyboard_bg, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
            lv_obj_set_style_radius(keyboard_bg, 0, LV_STATE_DEFAULT); /* 设置圆角 */
            lv_obj_set_style_bg_color(keyboard_bg, lv_color_hex(0x28536a), LV_STATE_DEFAULT);
            lv_obj_remove_style(keyboard_bg, 0, LV_PART_SCROLLBAR);


            LV_FONT_DECLARE(heiFont16_1);
            label_keyboard_return = lv_label_create(lv_scr_act());
            lv_obj_set_style_text_font(label_keyboard_return, &heiFont16_1, LV_STATE_DEFAULT);
            lv_obj_set_style_text_color(label_keyboard_return, lv_color_hex(0xffffff), LV_STATE_DEFAULT);

            if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
            {
                lv_label_set_text(label_keyboard_return, "返回");
            }
            else if(system_data.system.language == LANGUAGE_ENGLISH)
            {
                lv_label_set_text(label_keyboard_return, "Return");
            }
            lv_obj_align(label_keyboard_return, LV_ALIGN_TOP_LEFT, 140, 252);

            LV_IMG_DECLARE(get_back);
            btn_keyboard_return = lv_imgbtn_create(lv_scr_act());
            lv_imgbtn_set_src(btn_keyboard_return, LV_IMGBTN_STATE_RELEASED, NULL, &get_back, NULL);
            lv_obj_set_size(btn_keyboard_return, get_back.header.w, get_back.header.h);
            lv_obj_align(btn_keyboard_return, LV_ALIGN_TOP_LEFT, 180, 250);
            lv_obj_add_event_cb(btn_keyboard_return, button_save_keyboard_return_event_cb, LV_EVENT_CLICKED, NULL);

            LV_IMG_DECLARE(confirm);
            btn_keyboard_confirm = lv_imgbtn_create(lv_scr_act());
            lv_imgbtn_set_src(btn_keyboard_confirm, LV_IMGBTN_STATE_RELEASED, NULL, &confirm, NULL);
            lv_obj_set_size(btn_keyboard_confirm, get_back.header.w, get_back.header.h);
            lv_obj_align(btn_keyboard_confirm, LV_ALIGN_TOP_LEFT, 250, 250);
            lv_obj_add_event_cb(btn_keyboard_confirm, button_save_keyboard_confirm_event_cb, LV_EVENT_CLICKED, NULL);

            LV_FONT_DECLARE(heiFont16_1);
            label_keyboard_confirm = lv_label_create(lv_scr_act());
            lv_obj_set_style_text_font(label_keyboard_confirm, &heiFont16_1, LV_STATE_DEFAULT);
            lv_obj_set_style_text_color(label_keyboard_confirm, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
            if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
            {
                lv_label_set_text(label_keyboard_confirm, "确定");
            }
            else if(system_data.system.language == LANGUAGE_ENGLISH)
            {
                lv_label_set_text(label_keyboard_confirm, "Confirm");
            }
            lv_obj_align(label_keyboard_confirm, LV_ALIGN_TOP_LEFT, 277, 252);
        }
    }
}

static void button_file_management_return_event_cb(lv_event_t* e)
{
    lv_event_code_t code;
    code = lv_event_get_code(e);
    if (code == LV_EVENT_CLICKED)
    {
        printf("get_back\n");

        lv_obj_del(file_management_win);
        lv_obj_del(file_management_head_bg);
        //lv_obj_del(label_file_management_total_output);
        lv_obj_del(label_file_management);
        //lv_obj_del(label_file_management_date);
        //lv_obj_del(label_file_management_time);
        //lv_obj_del(img_file_management_battery_level);
        lv_obj_del(label_file_management_label);
        lv_obj_del(file_management_middle_bg);
        lv_obj_del(img_file_management_text);
        lv_obj_del(label_file_management_text);
        lv_obj_del(label_file_management_text_label);
        lv_obj_del(label_file_management_text_label_1);

        lv_obj_del(img_file_management_typeface);
        lv_obj_del(label_file_management_typeface);
        lv_obj_del(label_file_management_typeface_label);

        lv_obj_del(img_file_management_word_space);
        lv_obj_del(label_file_management_word_space);
        lv_obj_del(label_file_management_word_space_label);

        lv_obj_del(img_file_management_word_size);
        lv_obj_del(label_file_management_word_size);
        lv_obj_del(label_file_management_word_size_label);

        lv_obj_del(img_file_management_spin);
        lv_obj_del(label_file_management_spin);
        lv_obj_del(label_btn_addition_text_spin);

        //lv_obj_del(img_file_management_width);
        //lv_obj_del(label_file_management_width);
        //lv_obj_del(label_file_management_width_label);

        lv_obj_del(img_file_management_bold);
        lv_obj_del(label_file_management_bold);
        lv_obj_del(sw_file_management_bold);

        lv_obj_del(img_management_line_italic);
        lv_obj_del(label_management_line_italic);
        lv_obj_del(sw_management_line_italic);

        lv_obj_del(file_management_bottom_bg);
        lv_obj_del(label_file_management_return);
        lv_obj_del(imgbtn_file_management_get_back);
        lv_obj_del(imgbtn_file_management_confirm);
        lv_obj_del(label_file_management_confirm);

        lv_obj_del(btn_file_management_text);
        lv_obj_del(btn_file_management_typeface);
        lv_obj_del(btn_file_management_word_space_label);
        lv_obj_del(btn_file_management_word_size_label);
        lv_obj_del(btn_addition_text_spin);

        //删除添加界面
        lv_obj_del(img_addition_bg);
        lv_obj_del(btn_addition_text);
        lv_obj_del(label_btn_addition_text);
        lv_obj_del(btn_addition_date);
        lv_obj_del(label_btn_addition_date);
        lv_obj_del(btn_addition_picture);
        lv_obj_del(label_btn_addition_picture);
        lv_obj_del(btn_addition_QR_code);
        lv_obj_del(label_btn_addition_QR_code);
        lv_obj_del(btn_addition_bar_code);
        lv_obj_del(label_btn_addition_bar_code);
        lv_obj_del(btn_addition_count);
        lv_obj_del(label_btn_addition_count);
        lv_obj_del(btn_addition_subsection);
        lv_obj_del(label_btn_addition_subsection);
        lv_obj_del(btn_addition_symbol);
        lv_obj_del(label_btn_addition_symbol);
        lv_obj_del(btn_addition_icon);
        lv_obj_del(label_btn_addition_icon);
        lv_obj_del(btn_addition_more_functions);
        lv_obj_del(label_btn_addition_more_functions);
        lv_obj_del(btn_addition_return);
    }
}


static void drag_event_handler(lv_event_t* e)
{
    lv_obj_t* obj = lv_event_get_target(e);
    lv_event_code_t code = lv_event_get_code(e);
    int index = 0;

    if (print_status == 1)
    {
        return;
    }

    g_data_structure_count = 0;

    if (code == LV_EVENT_PRESSING)
    {
        lv_indev_t* indev = lv_indev_get_act();
        if (indev == NULL)
        {
            return;
        }

        lv_point_t vect;
        lv_indev_get_vect(indev, &vect);

        index = lv_obj_get_index(obj);

        if (data_structure[index].type == TYPE_BREAK)
        {

            lv_coord_t x = lv_obj_get_x(obj) + vect.x;

            if (x <= 0)
            {
                x = 0;
            }

            if (x >= 10000)
            {
                x = 10000;
            }

            lv_obj_set_pos(obj, x, 0);
            //printf("x=%u y=%u\n", x, y);
            data_structure[index].x = x;
        }
        else
        {
            lv_coord_t x = lv_obj_get_x(obj) + vect.x;

            if (x <= 0)
            {
                x = 0;
            }

            if (x >= 10000)
            {
                x = 10000;
            }

            lv_coord_t y = lv_obj_get_y(obj) + vect.y;

            if (y <= -100)
            {
                y = -100;
            }

            if (y >= 150)
            {
                y = 150;
            }
            lv_obj_set_pos(obj, x, y);
            //printf("x=%u y=%u\n", x, y);

            data_structure[index].x = x;
            data_structure[index].y = y;
        }

    
      
    }
    else if (code == LV_EVENT_FOCUSED)
    {
        index = lv_obj_get_index(obj);
        if (data_structure[index].type != TYPE_BREAK)
        {
            lv_obj_t* label = lv_obj_get_child(obj, 0);
            lv_obj_set_style_text_color(label, lv_color_hex(0xff0000), LV_PART_MAIN);
            temp_focused_obj = obj;

            //lv_coord_t x = lv_obj_get_x(obj);
            //lv_coord_t y = lv_obj_get_y(obj);
            //printf("x=%u y=%u\n", x, y);
        }
        else
        {
            temp_focused_obj = obj;
            lv_obj_set_style_bg_color(obj, lv_color_hex(0xFF6A6A), LV_STATE_DEFAULT);
        }

    }
    else if (code == LV_EVENT_DEFOCUSED)
    {
        index = lv_obj_get_index(obj);
        if (data_structure[index].type != TYPE_BREAK)
        {
            lv_obj_t* label = lv_obj_get_child(obj, 0);
            lv_obj_set_style_text_color(label, lv_color_black(), LV_PART_MAIN);

            //lv_coord_t x = lv_obj_get_x(obj);
            //lv_coord_t y = lv_obj_get_y(obj);
            //printf("x=%u y=%u\n", x, y);
        }
        else
        {
            lv_obj_set_style_bg_color(obj, lv_color_hex(0x000000), LV_STATE_DEFAULT);
        }
    }
}
//文本界面，默认字体，思源1
//新建的时候，先收集数据
//再依次更新
static void button_file_management_confirm_event_cb(lv_event_t* e)
{
    lv_event_code_t code;
    code = lv_event_get_code(e);
    char temp_typeface[128] = { 0 };
    int i = 0;
    int word_space = 0;
    int word_size = 0;
    int win_content_child_num = 0;

    if (code == LV_EVENT_CLICKED)
    {
        printf("button_file_management_confirm_event_cb\n");
        buzzer_enable = 1;

        int len = strlen(lv_label_get_text(label_file_management_label)) + 1;
        printf("len=%u\n\r", len);

        win_content_child_num = lv_obj_get_child_cnt(win_content);

        printf("win_content_child_num=%u\n\r", win_content_child_num);

        if ((len > 1)&&(win_content_child_num < NEW_TEXT_MAX_NUMBER))
        {
            lv_obj_t* temp_obj = lv_obj_create(win_content);


            for (i = 0; i < TYPEFACE_NUMBER; i++)
            {
                if (strncmp(lv_label_get_text(label_file_management_typeface_label), typeface_name[i], strlen(lv_label_get_text(label_file_management_typeface_label))) == 0)
                {
                    break;
                }
            }

            sprintf(temp_typeface, "/media/%s", typeface_buf[i]);
            data_structure[win_content_child_num].data.word.typeface = i;

            //info.name = "./lvgl/src/extra/libs/freetype/arial.ttf";
            //info.name = "./lvgl/src/extra/libs/freetype/simsun.ttc";
            //sprintf(temp_typeface, "./lvgl/src/extra/libs/freetype/%s", typeface_buf[SOURCE_HAN_SERIF_CN_REGULAR_1]);
            //printf("%s\n", temp_typeface);

            //data_structure[win_content_child_num].data.word.info.name = temp_typeface;


            word_size = atoi(lv_label_get_text(label_file_management_word_size_label));

            if (word_size < 12)
            {
                word_size = 12;
            }

            if (word_size > 200)
            {
                word_size = 200;
            }

            printf("word_size=%u\n\r", word_size);

            word_space = atoi(lv_label_get_text(label_file_management_word_space_label));

            if (word_space < 0)
            {
                word_space = 0;
            }

            if (word_space > 100)
            {
                word_space = 100;
            }

            printf("word_space=%u\n\r", word_space);

            data_structure[win_content_child_num].data.word.info.weight = word_size;

            data_structure[win_content_child_num].data.word.spin = atoi(lv_label_get_text(label_btn_addition_text_spin));

            printf("spin=%u\n\r", data_structure[win_content_child_num].data.word.spin);

            data_structure[win_content_child_num].data.word.info.style = FT_FONT_STYLE_NORMAL;

            if (lv_obj_has_state(sw_management_line_italic, LV_STATE_CHECKED) == 1)
            {
                data_structure[win_content_child_num].data.word.info.style |= FT_FONT_STYLE_ITALIC;
            }

            if (lv_obj_has_state(sw_file_management_bold, LV_STATE_CHECKED) == 1)
            {
                data_structure[win_content_child_num].data.word.info.style |= FT_FONT_STYLE_BOLD;
            }

            //lv_ft_font_init(&data_structure[win_content_child_num].data.word.info);

            lv_font_t* temp_font = font_list_get(i, word_size, data_structure[win_content_child_num].data.word.info.style);


            lv_point_t text_size;
            lv_txt_get_size(&text_size, lv_label_get_text(label_file_management_label), temp_font, word_space, 0, LV_COORD_MAX, LV_TEXT_FLAG_NONE);

            //printf("x=%u y=%u\n\r", text_size.x, text_size.y);

            //lv_obj_set_size(temp_obj, text_size.x, text_size.y);

            lv_obj_set_style_bg_opa(temp_obj, LV_OPA_TRANSP, 0);
            lv_obj_set_style_border_width(temp_obj, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */

            lv_obj_add_event_cb(temp_obj, drag_event_handler, LV_EVENT_PRESSING, NULL);
            lv_obj_add_event_cb(temp_obj, drag_event_handler, LV_EVENT_FOCUSED, NULL);
            lv_obj_add_event_cb(temp_obj, drag_event_handler, LV_EVENT_DEFOCUSED, NULL);
            lv_obj_clear_flag(temp_obj, LV_OBJ_FLAG_SCROLLABLE);

            lv_style_init(&data_structure[win_content_child_num].data.word.style);
            lv_style_set_text_font(&data_structure[win_content_child_num].data.word.style, temp_font);
  
            printf("x=%u y=%u\n\r", text_size.x, text_size.y);

            lv_obj_set_style_transform_angle(temp_obj, data_structure[win_content_child_num].data.word.spin*10, 0);
#if 0
            if (data_structure[win_content_child_num].data.word.spin != 0)
            {
                lv_obj_align(temp_obj, LV_ALIGN_TOP_LEFT, text_size.x, text_size.y);
            }
            else
            {
                 lv_obj_align(temp_obj, LV_ALIGN_TOP_LEFT, 30, 0);
            }
#endif

            lv_obj_align(temp_obj, LV_ALIGN_TOP_LEFT, 30 + 20*win_content_child_num, 6*win_content_child_num);

            //x_size = text_size.x + text_size.x / text_size.y * word_space * 2;

            //printf("x_size=%d\n\r", x_size);

            lv_obj_set_size(temp_obj, text_size.x,text_size.y);

            lv_style_set_text_letter_space(&data_structure[win_content_child_num].data.word.style, word_space);

            lv_obj_t* label1 = lv_label_create(temp_obj);
            lv_obj_add_style(label1, &data_structure[win_content_child_num].data.word.style, 0);
            lv_label_set_text(label1, lv_label_get_text(label_file_management_label));
            lv_obj_center(label1);
            strncpy(data_structure[win_content_child_num].data.word.text, lv_label_get_text(label_file_management_label),len);
            data_structure[win_content_child_num].data.word.size = word_size;
            data_structure[win_content_child_num].data.word.space = word_space;
            data_structure[win_content_child_num].data.word.italic_bold = data_structure[win_content_child_num].data.word.info.style;
            data_structure[win_content_child_num].type = TYPE_WORD;
            printf("text=%s\n\r", data_structure[win_content_child_num].data.word.text);
  
        }

        lv_obj_del(file_management_win);
        lv_obj_del(file_management_head_bg);
        //lv_obj_del(label_file_management_total_output);
        lv_obj_del(label_file_management);
        //lv_obj_del(label_file_management_date);
        //lv_obj_del(label_file_management_time);
        //lv_obj_del(img_file_management_battery_level);
        lv_obj_del(label_file_management_label);
        lv_obj_del(file_management_middle_bg);
        lv_obj_del(img_file_management_text);
        lv_obj_del(label_file_management_text);
        lv_obj_del(label_file_management_text_label);
        lv_obj_del(label_file_management_text_label_1);

        lv_obj_del(img_file_management_typeface);
        lv_obj_del(label_file_management_typeface);
        lv_obj_del(label_file_management_typeface_label);

        lv_obj_del(img_file_management_word_space);
        lv_obj_del(label_file_management_word_space);
        lv_obj_del(label_file_management_word_space_label);

        lv_obj_del(img_file_management_word_size);
        lv_obj_del(label_file_management_word_size);
        lv_obj_del(label_file_management_word_size_label);

        lv_obj_del(img_file_management_spin);
        lv_obj_del(label_file_management_spin);
        lv_obj_del(label_btn_addition_text_spin);

        //lv_obj_del(img_file_management_width);
        //lv_obj_del(label_file_management_width);
        //lv_obj_del(label_file_management_width_label);

        lv_obj_del(img_file_management_bold);
        lv_obj_del(label_file_management_bold);
        lv_obj_del(sw_file_management_bold);

        lv_obj_del(img_management_line_italic);
        lv_obj_del(label_management_line_italic);
        lv_obj_del(sw_management_line_italic);

        lv_obj_del(file_management_bottom_bg);
        lv_obj_del(label_file_management_return);
        lv_obj_del(imgbtn_file_management_get_back);
        lv_obj_del(imgbtn_file_management_confirm);
        lv_obj_del(label_file_management_confirm);

        lv_obj_del(btn_file_management_text);
        lv_obj_del(btn_file_management_typeface);
        lv_obj_del(btn_file_management_word_space_label);
        lv_obj_del(btn_file_management_word_size_label);
        lv_obj_del(btn_addition_text_spin);

        //删除添加界面
        lv_obj_del(img_addition_bg);
        lv_obj_del(btn_addition_text);
        lv_obj_del(label_btn_addition_text);
        lv_obj_del(btn_addition_date);
        lv_obj_del(label_btn_addition_date);
        lv_obj_del(btn_addition_picture);
        lv_obj_del(label_btn_addition_picture);
        lv_obj_del(btn_addition_QR_code);
        lv_obj_del(label_btn_addition_QR_code);
        lv_obj_del(btn_addition_bar_code);
        lv_obj_del(label_btn_addition_bar_code);
        lv_obj_del(btn_addition_count);
        lv_obj_del(label_btn_addition_count);
        lv_obj_del(btn_addition_subsection);
        lv_obj_del(label_btn_addition_subsection);
        lv_obj_del(btn_addition_symbol);
        lv_obj_del(label_btn_addition_symbol);
        lv_obj_del(btn_addition_icon);
        lv_obj_del(label_btn_addition_icon);
        lv_obj_del(btn_addition_more_functions);
        lv_obj_del(label_btn_addition_more_functions);
        lv_obj_del(btn_addition_return);
    }
}


static void textarea_text_event_cb(lv_event_t* e)
{
    lv_event_code_t code = lv_event_get_code(e);
    //lv_obj_t* target = lv_event_get_target(e);

    printf("code=%d\n",code);

    

    if (code == LV_EVENT_FOCUSED)
    {
        printf("lv_keyboard_set_textarea\n");
    }
    else if (code == LV_EVENT_VALUE_CHANGED)
    {
        printf("LV_EVENT_VALUE_CHANGED\n");
        //const char* txt = lv_textarea_get_text(target);
        buzzer_enable = 1;
    }
    else if (code == LV_EVENT_CANCEL)
    {
        printf("LV_EVENT_CANCEL\n");
        //lv_obj_set_style_text_font(target,&myFont,LV_PART_MAIN);
    }
}

static void btn_file_management_text_event_cb(lv_event_t* e)
{
    lv_event_code_t code;
    int len =0;

    code = lv_event_get_code(e);
    if (code == LV_EVENT_CLICKED)
    {
        printf("btn_file_management_text_event_cb\n");
        buzzer_enable = 1;

        textarea_bg_keyboard = lv_obj_create(lv_scr_act());
        /* 设置大小 */
        lv_obj_set_size(textarea_bg_keyboard, 480, 272);
        lv_obj_align(textarea_bg_keyboard, LV_ALIGN_TOP_LEFT, 0, 0);
        lv_obj_set_style_border_width(textarea_bg_keyboard, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_border_color(textarea_bg_keyboard, lv_color_hex(0x9bcd9b), LV_STATE_DEFAULT); /* 设置边框颜色 */
        //lv_obj_set_style_border_opa(file_management_win, 100, LV_STATE_DEFAULT); /* 设置边框透明度 */
        lv_obj_set_style_radius(textarea_bg_keyboard, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_color(textarea_bg_keyboard, lv_color_hex(0x1fadd3), LV_STATE_DEFAULT);

        //输入框+键盘
        LV_FONT_DECLARE(heiFont7);
        pinyin_ime = lv_ime_pinyin_create(lv_scr_act());
        lv_obj_set_style_text_font(pinyin_ime, &heiFont7, 0);
        //lv_obj_set_style_text_font(pinyin_ime, &lv_font_simsun_16_cjk, 0);
        //lv_ime_pinyin_set_dict(pinyin_ime, your_dict); // Use a custom dictionary. If it is not set, the built-in dictionary will be used.

        textarea_text_keyboard = lv_textarea_create(lv_scr_act());
        //lv_textarea_set_one_line(textarea_text_keyboard, true);
        lv_obj_set_size(textarea_text_keyboard, 480, 95);
        lv_obj_set_style_text_font(textarea_text_keyboard, &heiFont7, 0);
        lv_obj_align(textarea_text_keyboard, LV_ALIGN_TOP_LEFT, 0, 0);
        lv_textarea_set_max_length(textarea_text_keyboard, 160);
        lv_textarea_set_placeholder_text(textarea_text_keyboard, "Smart printer");
        //lv_obj_add_event_cb(textarea_text_keyboard, textarea_text_event_cb, LV_EVENT_ALL, NULL);
        lv_obj_set_style_border_width(textarea_text_keyboard, 1, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_border_color(textarea_text_keyboard, lv_color_hex(0xAAAAAA), LV_STATE_DEFAULT); /* 设置边框颜色 */
        lv_obj_set_style_border_opa(textarea_text_keyboard, 100, LV_STATE_DEFAULT); /* 设置边框透明度 */
        lv_obj_set_style_radius(textarea_text_keyboard, 0, LV_STATE_DEFAULT); /* 设置圆角 */
     
        len = strlen(lv_label_get_text(label_file_management_text_label));

        printf("len=%u\n\r", len);

        if (strlen(lv_label_get_text(label_file_management_text_label)) != 0)
        {
            lv_textarea_set_text(textarea_text_keyboard, lv_label_get_text(label_file_management_text_label));
        }

        /*Create a keyboard and add it to ime_pinyin*/
        text_edit_keyboard = lv_keyboard_create(lv_scr_act());
        lv_ime_pinyin_set_keyboard(pinyin_ime, text_edit_keyboard);
        lv_keyboard_set_textarea(text_edit_keyboard, textarea_text_keyboard);
        //lv_obj_set_style_bg_color(text_edit_keyboard, lv_color_hex(0xff4040), LV_PART_MAIN);
        lv_obj_set_style_bg_color(text_edit_keyboard, lv_color_hex(0x1fadd3), LV_PART_MAIN);
        lv_obj_add_event_cb(textarea_text_keyboard, textarea_text_event_cb, LV_EVENT_ALL, text_edit_keyboard);
        lv_obj_align(text_edit_keyboard, LV_ALIGN_TOP_LEFT, 0, 115);
        lv_obj_set_size(text_edit_keyboard, 480, 133);

        /*Get the cand_panel, and adjust its size and position*/
        keyboard_cand_panel = lv_ime_pinyin_get_cand_panel(pinyin_ime);
        lv_obj_set_size(keyboard_cand_panel, LV_PCT(100), LV_PCT(10));
        lv_obj_align_to(keyboard_cand_panel, text_edit_keyboard, LV_ALIGN_OUT_TOP_MID, 0, 5);
        lv_obj_set_style_bg_color(keyboard_cand_panel, lv_color_hex(0x8B1A1A), LV_PART_MAIN);
    

        keyboard_bg = lv_obj_create(lv_scr_act());
        lv_obj_set_size(keyboard_bg, 480, 24);
        lv_obj_align(keyboard_bg, LV_ALIGN_TOP_LEFT, 0, 248);
        lv_obj_set_style_border_width(keyboard_bg, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_radius(keyboard_bg, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_color(keyboard_bg, lv_color_hex(0x28536a), LV_STATE_DEFAULT);
        lv_obj_remove_style(keyboard_bg, 0, LV_PART_SCROLLBAR);


        LV_FONT_DECLARE(heiFont16_1);
        label_keyboard_return = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_keyboard_return, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_keyboard_return, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_keyboard_return,  "返回");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_keyboard_return, "Return");
        }
        lv_obj_align(label_keyboard_return, LV_ALIGN_TOP_LEFT, 140, 252);

        LV_IMG_DECLARE(get_back);
        btn_keyboard_return = lv_imgbtn_create(lv_scr_act());
        lv_imgbtn_set_src(btn_keyboard_return, LV_IMGBTN_STATE_RELEASED, NULL, &get_back, NULL);
        lv_obj_set_size(btn_keyboard_return, get_back.header.w, get_back.header.h);
        lv_obj_align(btn_keyboard_return, LV_ALIGN_TOP_LEFT, 180, 250);
        lv_obj_add_event_cb(btn_keyboard_return, button_keyboard_return_event_cb, LV_EVENT_CLICKED, NULL);

        LV_IMG_DECLARE(confirm);
        btn_keyboard_confirm = lv_imgbtn_create(lv_scr_act());
        lv_imgbtn_set_src(btn_keyboard_confirm, LV_IMGBTN_STATE_RELEASED, NULL, &confirm, NULL);
        lv_obj_set_size(btn_keyboard_confirm, get_back.header.w, get_back.header.h);
        lv_obj_align(btn_keyboard_confirm, LV_ALIGN_TOP_LEFT, 250, 250);
        lv_obj_add_event_cb(btn_keyboard_confirm, button_keyboard_confirm_event_cb, LV_EVENT_CLICKED, NULL);

        LV_FONT_DECLARE(heiFont16_1);
        label_keyboard_confirm = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_keyboard_confirm, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_keyboard_confirm, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_keyboard_confirm, "确定");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_keyboard_confirm, "Confirm");
        }
        lv_obj_align(label_keyboard_confirm, LV_ALIGN_TOP_LEFT, 277, 252);
    }
}



static void btn_modification_text_event_cb(lv_event_t* e)
{
    lv_event_code_t code;
    int len =0;

    code = lv_event_get_code(e);
    if (code == LV_EVENT_CLICKED)
    {
        printf("btn_modification_text_event_cb\n");
        buzzer_enable = 1;

        textarea_bg_keyboard = lv_obj_create(lv_scr_act());
        /* 设置大小 */
        lv_obj_set_size(textarea_bg_keyboard, 480, 272);
        lv_obj_align(textarea_bg_keyboard, LV_ALIGN_TOP_LEFT, 0, 0);
        lv_obj_set_style_border_width(textarea_bg_keyboard, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_border_color(textarea_bg_keyboard, lv_color_hex(0x9bcd9b), LV_STATE_DEFAULT); /* 设置边框颜色 */
        //lv_obj_set_style_border_opa(file_management_win, 100, LV_STATE_DEFAULT); /* 设置边框透明度 */
        lv_obj_set_style_radius(textarea_bg_keyboard, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_color(textarea_bg_keyboard, lv_color_hex(0x1fadd3), LV_STATE_DEFAULT);

        //输入框+键盘
        LV_FONT_DECLARE(heiFont7);
        pinyin_ime = lv_ime_pinyin_create(lv_scr_act());
        lv_obj_set_style_text_font(pinyin_ime, &heiFont7, 0);
        //lv_obj_set_style_text_font(pinyin_ime, &lv_font_simsun_16_cjk, 0);
        //lv_ime_pinyin_set_dict(pinyin_ime, your_dict); // Use a custom dictionary. If it is not set, the built-in dictionary will be used.

        textarea_text_keyboard = lv_textarea_create(lv_scr_act());
        //lv_textarea_set_one_line(textarea_text_keyboard, true);
        lv_obj_set_size(textarea_text_keyboard, 480, 95);
        lv_obj_set_style_text_font(textarea_text_keyboard, &heiFont7, 0);
        lv_obj_align(textarea_text_keyboard, LV_ALIGN_TOP_LEFT, 0, 0);
        lv_textarea_set_max_length(textarea_text_keyboard, 160);
        lv_textarea_set_placeholder_text(textarea_text_keyboard, "Smart printer");
        //lv_obj_add_event_cb(textarea_text_keyboard, textarea_text_event_cb, LV_EVENT_ALL, NULL);
        lv_obj_set_style_border_width(textarea_text_keyboard, 1, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_border_color(textarea_text_keyboard, lv_color_hex(0xAAAAAA), LV_STATE_DEFAULT); /* 设置边框颜色 */
        lv_obj_set_style_border_opa(textarea_text_keyboard, 100, LV_STATE_DEFAULT); /* 设置边框透明度 */
        lv_obj_set_style_radius(textarea_text_keyboard, 0, LV_STATE_DEFAULT); /* 设置圆角 */
     
        len = strlen(lv_label_get_text(label_file_management_text_label));

        printf("len=%u\n\r", len);

        if (strlen(lv_label_get_text(label_file_management_text_label)) != 0)
        {
            lv_textarea_set_text(textarea_text_keyboard, lv_label_get_text(label_file_management_text_label));
        }

        /*Create a keyboard and add it to ime_pinyin*/
        text_edit_keyboard = lv_keyboard_create(lv_scr_act());
        lv_ime_pinyin_set_keyboard(pinyin_ime, text_edit_keyboard);
        lv_keyboard_set_textarea(text_edit_keyboard, textarea_text_keyboard);
        //lv_obj_set_style_bg_color(text_edit_keyboard, lv_color_hex(0xff4040), LV_PART_MAIN);
        lv_obj_set_style_bg_color(text_edit_keyboard, lv_color_hex(0x1fadd3), LV_PART_MAIN);
        lv_obj_add_event_cb(textarea_text_keyboard, textarea_text_event_cb, LV_EVENT_ALL, text_edit_keyboard);
        lv_obj_align(text_edit_keyboard, LV_ALIGN_TOP_LEFT, 0, 115);
        lv_obj_set_size(text_edit_keyboard, 480, 133);

        /*Get the cand_panel, and adjust its size and position*/
        keyboard_cand_panel = lv_ime_pinyin_get_cand_panel(pinyin_ime);
        lv_obj_set_size(keyboard_cand_panel, LV_PCT(100), LV_PCT(10));
        lv_obj_align_to(keyboard_cand_panel, text_edit_keyboard, LV_ALIGN_OUT_TOP_MID, 0, 5);
        lv_obj_set_style_bg_color(keyboard_cand_panel, lv_color_hex(0x8B1A1A), LV_PART_MAIN);
    

        keyboard_bg = lv_obj_create(lv_scr_act());
        lv_obj_set_size(keyboard_bg, 480, 24);
        lv_obj_align(keyboard_bg, LV_ALIGN_TOP_LEFT, 0, 248);
        lv_obj_set_style_border_width(keyboard_bg, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_radius(keyboard_bg, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_color(keyboard_bg, lv_color_hex(0x28536a), LV_STATE_DEFAULT);
        lv_obj_remove_style(keyboard_bg, 0, LV_PART_SCROLLBAR);


        LV_FONT_DECLARE(heiFont16_1);
        label_keyboard_return = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_keyboard_return, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_keyboard_return, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_keyboard_return,  "返回");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_keyboard_return, "Return");
        }
        lv_obj_align(label_keyboard_return, LV_ALIGN_TOP_LEFT, 140, 252);

        LV_IMG_DECLARE(get_back);
        btn_keyboard_return = lv_imgbtn_create(lv_scr_act());
        lv_imgbtn_set_src(btn_keyboard_return, LV_IMGBTN_STATE_RELEASED, NULL, &get_back, NULL);
        lv_obj_set_size(btn_keyboard_return, get_back.header.w, get_back.header.h);
        lv_obj_align(btn_keyboard_return, LV_ALIGN_TOP_LEFT, 180, 250);
        lv_obj_add_event_cb(btn_keyboard_return, button_modification_text_keyboard_return_event_cb, LV_EVENT_CLICKED, NULL);

        LV_IMG_DECLARE(confirm);
        btn_keyboard_confirm = lv_imgbtn_create(lv_scr_act());
        lv_imgbtn_set_src(btn_keyboard_confirm, LV_IMGBTN_STATE_RELEASED, NULL, &confirm, NULL);
        lv_obj_set_size(btn_keyboard_confirm, get_back.header.w, get_back.header.h);
        lv_obj_align(btn_keyboard_confirm, LV_ALIGN_TOP_LEFT, 250, 250);
        lv_obj_add_event_cb(btn_keyboard_confirm, button_modification_text_keyboard_confirm_event_cb, LV_EVENT_CLICKED, NULL);

        LV_FONT_DECLARE(heiFont16_1);
        label_keyboard_confirm = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_keyboard_confirm, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_keyboard_confirm, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_keyboard_confirm, "确定");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_keyboard_confirm, "Confirm");
        }
        lv_obj_align(label_keyboard_confirm, LV_ALIGN_TOP_LEFT, 277, 252);
    }
}

static void button_typeface_event_cb(lv_event_t* e)
{
    lv_event_code_t code;
    int i;
    lv_obj_t* obj = lv_event_get_target(e);
    code = lv_event_get_code(e);
    if (code == LV_EVENT_FOCUSED)
    {
        printf("button_typeface_event_cb LV_EVENT_FOCUSED\n");
        buzzer_enable = 1;
        lv_obj_t* label = lv_obj_get_child(obj, 0);
        lv_obj_set_style_bg_color(obj, lv_color_hex(0x7FFFD4), LV_PART_MAIN);
#if 0
        if (strncmp(lv_label_get_text(label), "常用宋体", strlen(lv_label_get_text(label))) == 0)
        {
            g_typeface = CHANG_YONG_SONG_TI;
        }
        else if (strncmp(lv_label_get_text(label), "常用黑体", strlen(lv_label_get_text(label))) == 0)
        {
            g_typeface = CHANG_YONG_HEI_TI;
        }
        else if (strncmp(lv_label_get_text(label), "常用楷体", strlen(lv_label_get_text(label))) == 0)
        {
            g_typeface = CHANG_YONG_KAI_TI;
        }
        else if (strncmp(lv_label_get_text(label), "常用隶书", strlen(lv_label_get_text(label))) == 0)
        {
            g_typeface = CHANG_YONG_LI_SHU_GBK;
        }
        else if (strncmp(lv_label_get_text(label), "方正黑体", strlen(lv_label_get_text(label))) == 0)
        {
            g_typeface = FANG_ZHENG_HEI_TI_GBK;
        }
        else if (strncmp(lv_label_get_text(label), "思源黑体", strlen(lv_label_get_text(label))) == 0)
        {
            g_typeface = SOURCE_HAN_SANS_SC_REGULAR;
        }
        else
        {
            g_typeface = CHANG_YONG_SONG_TI;
        }
#endif
        for (i = 0; i < TYPEFACE_NUMBER; i++)
        {
            if (strncmp(lv_label_get_text(label), typeface_name[i], strlen(lv_label_get_text(label))) == 0)
            {
                break;
            }
        }
        g_typeface = i;
        printf("g_typeface=%d\n", g_typeface);
    }
    else if (code == LV_EVENT_DEFOCUSED)
    {
        printf("button_typeface_event_cb LV_EVENT_DEFOCUSED\n");
        lv_obj_set_style_bg_color(obj, lv_color_hex(0xffffff), LV_PART_MAIN);
    }
}


static void button_typeface_return_event_cb(lv_event_t* e)
{
    lv_event_code_t code;
    int i;
    code = lv_event_get_code(e);

    if (code == LV_EVENT_CLICKED)
    {
        printf("button_typeface_return_event_cb\n");
        buzzer_enable = 1;
        lv_obj_del(typeface_head_bg);
        lv_obj_del(label_typeface_return);
        lv_obj_del(btn_typeface_return);
        lv_obj_del(btn_typeface_confirm);
        lv_obj_del(label_typeface_confirm);
        lv_obj_del(label_typeface_head);

        for (i = 0; i < TYPEFACE_NUMBER; i++)
        {
            lv_obj_del(typeface_obj[i].obj_typeface_label);
            lv_obj_del(typeface_obj[i].obj_typeface_btn);
        }

        lv_obj_del(win_content_typeface);
        lv_obj_del(win_obj_typeface);
        lv_obj_del(left_stop_img_typeface);
        lv_obj_del(right_stop_img_typeface);
        lv_obj_del(typeface_slider_bg);
        lv_obj_del(slider_typeface);
    }
}

static void button_typeface_confirm_event_cb(lv_event_t* e)
{
    lv_event_code_t code;
    int i;
    code = lv_event_get_code(e);
    if (code == LV_EVENT_CLICKED)
    {
        printf("button_typeface_confirm_event_cb\n");
        buzzer_enable = 1;

        lv_label_set_text(label_file_management_typeface_label, typeface_name[g_typeface]);
        lv_obj_del(typeface_head_bg);
        lv_obj_del(label_typeface_return);
        lv_obj_del(btn_typeface_return);
        lv_obj_del(btn_typeface_confirm);
        lv_obj_del(label_typeface_confirm);
        lv_obj_del(label_typeface_head);

        for (i = 0; i < TYPEFACE_NUMBER; i++)
        {
            lv_obj_del(typeface_obj[i].obj_typeface_label);
            lv_obj_del(typeface_obj[i].obj_typeface_btn);
        }

        lv_obj_del(win_content_typeface);
        lv_obj_del(win_obj_typeface);
        lv_obj_del(left_stop_img_typeface);
        lv_obj_del(right_stop_img_typeface);
        lv_obj_del(typeface_slider_bg);
        lv_obj_del(slider_typeface);
    }
}

static void btn_file_management_typeface_event_cb(lv_event_t* e)
{
    lv_event_code_t code;

    code = lv_event_get_code(e);
    int i;
    int size_wide = 85;
    int size_high = 24;

    if (code == LV_EVENT_CLICKED)
    {
        printf("btn_file_management_typeface_event_cb\n");
        buzzer_enable = 1;

        typeface_head_bg = lv_obj_create(lv_scr_act());
        lv_obj_set_size(typeface_head_bg, 480, 24);
        lv_obj_align(typeface_head_bg, LV_ALIGN_TOP_LEFT, 0, 0);
        lv_obj_set_style_border_width(typeface_head_bg, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_border_color(typeface_head_bg, lv_color_hex(0x9bcd9b), LV_STATE_DEFAULT); /* 设置边框颜色 */
        lv_obj_set_style_radius(typeface_head_bg, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_color(typeface_head_bg, lv_color_hex(0x1fadd3), LV_STATE_DEFAULT);

        LV_FONT_DECLARE(heiFont16_1);
        label_typeface_head = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_typeface_head, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_typeface_head, lv_color_hex(0xFFFFFF), LV_STATE_DEFAULT);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_typeface_head,  "字体");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_typeface_head, "Typeface");
        }
        lv_obj_align(label_typeface_head, LV_ALIGN_TOP_LEFT, 200, 4);

        win_obj_typeface = lv_obj_create(lv_scr_act());
        lv_obj_align(win_obj_typeface, LV_ALIGN_TOP_LEFT, 0, 24);
        lv_obj_set_size(win_obj_typeface, 480, 224);
        lv_obj_set_style_bg_color(win_obj_typeface, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        lv_obj_set_style_bg_opa(win_obj_typeface, LV_OPA_COVER, LV_STATE_DEFAULT);
        lv_obj_set_style_border_width(win_obj_typeface, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_border_color(win_obj_typeface, lv_color_hex(0xcccccc), LV_STATE_DEFAULT); /* 设置边框颜色 */
        lv_obj_clear_flag(win_obj_typeface, LV_OBJ_FLAG_SCROLLABLE);
        lv_obj_set_style_radius(win_obj_typeface, 0, LV_STATE_DEFAULT); /* 设置圆角 */

        win_content_typeface = lv_obj_create(win_obj_typeface);
        lv_obj_set_size(win_content_typeface, 460, 500);
        lv_obj_align(win_content_typeface, LV_ALIGN_TOP_LEFT, -15, -15);
        lv_obj_set_style_bg_color(win_content_typeface, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        lv_obj_set_style_border_width(win_content_typeface, 2, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_border_color(win_content_typeface, lv_color_hex(0xcccccc), LV_STATE_DEFAULT); /* 设置边框颜色 */
        lv_obj_clear_flag(win_content_typeface, LV_OBJ_FLAG_SCROLLABLE);
        lv_obj_set_style_radius(win_content_typeface, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_pad_all(win_content_typeface, 0, LV_STATE_DEFAULT);

       // LV_#if 0IMG_DECLARE(Slider_base_color);
       // lv_obj_t* Slider_base_color_img = lv_img_create(lv_scr_act());
      //  lv_img_set_src(Slider_base_color_img, &Slider_base_color);
      //  lv_obj_align(Slider_base_color_img, LV_ALIGN_TOP_LEFT, 0, 183);

        typeface_slider_bg = lv_obj_create(lv_scr_act());
        lv_obj_set_size(typeface_slider_bg, 20, 224);
        lv_obj_align(typeface_slider_bg, LV_ALIGN_TOP_LEFT, 460, 24);
        lv_obj_set_style_border_width(typeface_slider_bg, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_border_color(typeface_slider_bg, lv_color_hex(0xaaaaaa), LV_STATE_DEFAULT); /* 设置边框颜色 */
        lv_obj_set_style_radius(typeface_slider_bg, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_color(typeface_slider_bg, lv_color_hex(0xaaaaaa), LV_STATE_DEFAULT);

        //左滑块停止
        LV_IMG_DECLARE(left_stop_typeface);
        left_stop_img_typeface = lv_img_create(lv_scr_act());
        lv_img_set_src(left_stop_img_typeface, &left_stop_typeface);
        lv_obj_align(left_stop_img_typeface, LV_ALIGN_TOP_LEFT, 460, 228);

        slider_show_typeface();

        //右滑块停止
        LV_IMG_DECLARE(right_stop_typeface);
        right_stop_img_typeface = lv_img_create(lv_scr_act());
        lv_img_set_src(right_stop_img_typeface, &right_stop_typeface);
        lv_obj_align(right_stop_img_typeface, LV_ALIGN_TOP_LEFT, 460, 24);

 
        for (i = 0; i < TYPEFACE_NUMBER; i++)
        {
            typeface_obj[i].obj_typeface_btn = lv_btn_create(win_content_typeface);
            lv_obj_set_size(typeface_obj[i].obj_typeface_btn, size_wide, size_high);
            lv_obj_align(typeface_obj[i].obj_typeface_btn, LV_ALIGN_TOP_LEFT, (i%5 + 1)*5 + (i%5) * size_wide, (i/5+1)*5+i/5* size_high);
            lv_obj_set_style_border_width(typeface_obj[i].obj_typeface_btn, 1, LV_PART_MAIN); /* 设置边框宽度 */
            lv_obj_set_style_border_color(typeface_obj[i].obj_typeface_btn, lv_color_hex(0x000000), LV_PART_MAIN); /* 设置边框颜色 */
            lv_obj_set_style_radius(typeface_obj[i].obj_typeface_btn, 0, LV_PART_MAIN); /* 设置圆角 */
            lv_obj_set_style_bg_color(typeface_obj[i].obj_typeface_btn, lv_color_hex(0xffffff), LV_PART_MAIN);
            lv_obj_set_style_shadow_width(typeface_obj[i].obj_typeface_btn, 0, LV_PART_MAIN);
            lv_obj_add_event_cb(typeface_obj[i].obj_typeface_btn, button_typeface_event_cb, LV_EVENT_ALL, NULL);

            LV_FONT_DECLARE(heiFont16_1);
            typeface_obj[i].obj_typeface_label = lv_label_create(typeface_obj[i].obj_typeface_btn);
            lv_obj_set_style_text_font(typeface_obj[i].obj_typeface_label, &heiFont16_1, LV_STATE_DEFAULT);
            lv_label_set_text(typeface_obj[i].obj_typeface_label, typeface_name[i]);
            lv_obj_center(typeface_obj[i].obj_typeface_label);
            lv_obj_set_style_text_color(typeface_obj[i].obj_typeface_label, lv_color_hex(0x000000), LV_STATE_DEFAULT);
        }

        LV_FONT_DECLARE(heiFont16_1);
        label_typeface_return = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_typeface_return, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_typeface_return, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_typeface_return,  "返回");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_typeface_return, "Return");
        }
        lv_obj_align(label_typeface_return, LV_ALIGN_TOP_LEFT, 140, 252);

        LV_IMG_DECLARE(get_back);
        btn_typeface_return = lv_imgbtn_create(lv_scr_act());
        lv_imgbtn_set_src(btn_typeface_return, LV_IMGBTN_STATE_RELEASED, NULL, &get_back, NULL);
        lv_obj_set_size(btn_typeface_return, get_back.header.w, get_back.header.h);
        lv_obj_align(btn_typeface_return, LV_ALIGN_TOP_LEFT, 180, 250);
        lv_obj_add_event_cb(btn_typeface_return, button_typeface_return_event_cb, LV_EVENT_CLICKED, NULL);


        LV_IMG_DECLARE(confirm);
        btn_typeface_confirm = lv_imgbtn_create(lv_scr_act());
        lv_imgbtn_set_src(btn_typeface_confirm, LV_IMGBTN_STATE_RELEASED, NULL, &confirm, NULL);
        lv_obj_set_size(btn_typeface_confirm, get_back.header.w, get_back.header.h);
        lv_obj_align(btn_typeface_confirm, LV_ALIGN_TOP_LEFT, 250, 250);
        lv_obj_add_event_cb(btn_typeface_confirm, button_typeface_confirm_event_cb, LV_EVENT_CLICKED, NULL);

        LV_FONT_DECLARE(heiFont16_1);
        label_typeface_confirm = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_typeface_confirm, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_typeface_confirm, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_typeface_confirm,  "确定");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_typeface_confirm, "Confirm");
        }
        lv_obj_align(label_typeface_confirm, LV_ALIGN_TOP_LEFT, 277, 252);
    }
}


static void button_work_space_return_event_cb(lv_event_t* e)
{
    lv_event_code_t code;

    code = lv_event_get_code(e);
    if (code == LV_EVENT_CLICKED)
    {
        printf("button_work_space_return_event_cb\n");
        buzzer_enable = 1;
        lv_obj_del(typeface_head_bg);
        lv_obj_del(label_typeface_head);
        lv_obj_del(typeface_slider_bg);
        lv_obj_del(pwd_text_area);
        lv_obj_del(pwd_keyboard);
        
        lv_obj_del(label_typeface_return);
        lv_obj_del(btn_typeface_return);
        lv_obj_del(btn_typeface_confirm);
        lv_obj_del(label_typeface_confirm);
    }
}


static void button_work_size_return_event_cb(lv_event_t* e)
{
    lv_event_code_t code;
    code = lv_event_get_code(e);
    if (code == LV_EVENT_CLICKED)
    {
        printf("button_work_space_return_event_cb\n");
        buzzer_enable = 1;
        lv_obj_del(typeface_head_bg);
        lv_obj_del(label_typeface_head);
        lv_obj_del(typeface_slider_bg);
        lv_obj_del(pwd_text_area);
        lv_obj_del(pwd_keyboard);

        lv_obj_del(label_typeface_return);
        lv_obj_del(btn_typeface_return);
        lv_obj_del(btn_typeface_confirm);
        lv_obj_del(label_typeface_confirm);
    }
}

static void button_word_space_confirm_event_cb(lv_event_t* e)
{
    lv_event_code_t code;
    int i = 0;
    char temp_str[12] = { 0 };
    code = lv_event_get_code(e);
    if (code == LV_EVENT_CLICKED)
    {
        printf("button_word_space_confirm_event_cb\n");
        buzzer_enable = 1;
        const char* pwd_txt = lv_textarea_get_text(pwd_text_area);
        if ((pwd_txt != NULL))
        {
            i = atoi(pwd_txt);
            if (i > 150)
            {
                i = 150;
            }
        }

        sprintf(temp_str, "%d", i);
        lv_label_set_text(label_file_management_word_space_label, temp_str);
        
        lv_obj_del(typeface_head_bg);
        lv_obj_del(label_typeface_head);
        lv_obj_del(typeface_slider_bg);
        lv_obj_del(pwd_text_area);
        lv_obj_del(pwd_keyboard);
        
        lv_obj_del(label_typeface_return);
        lv_obj_del(btn_typeface_return);
        lv_obj_del(btn_typeface_confirm);
        lv_obj_del(label_typeface_confirm);
    }
}


static void button_word_size_confirm_event_cb(lv_event_t* e)
{
    lv_event_code_t code;
    int i = 0;
    char temp_str[12] = { 0 };
    code = lv_event_get_code(e);
    if (code == LV_EVENT_CLICKED)
    {
        printf("button_word_size_confirm_event_cb\n");
        buzzer_enable = 1;
        const char* pwd_txt = lv_textarea_get_text(pwd_text_area);
        if ((pwd_txt != NULL))
        {
            i = atoi(pwd_txt);
            if (i > WORD_MAX_SIZE)
            {
                i = WORD_MAX_SIZE;
            }
        }

        sprintf(temp_str, "%d", i);
        lv_label_set_text(label_file_management_word_size_label, temp_str);
       
        lv_obj_del(typeface_head_bg);
        lv_obj_del(label_typeface_head);
        lv_obj_del(typeface_slider_bg);
        lv_obj_del(pwd_text_area);
        lv_obj_del(pwd_keyboard);

        lv_obj_del(label_typeface_return);
        lv_obj_del(btn_typeface_return);
        lv_obj_del(btn_typeface_confirm);
        lv_obj_del(label_typeface_confirm);
    }
}

static void btn_file_management_word_space_event_cb(lv_event_t* e)
{
    lv_event_code_t code;

    code = lv_event_get_code(e);
    //lv_obj_t* obj = lv_event_get_target(e);

    if (code == LV_EVENT_CLICKED)
    {
        printf("btn_file_management_word_space_label\n");

        buzzer_enable = 1;
        typeface_head_bg = lv_obj_create(lv_scr_act());
        lv_obj_set_size(typeface_head_bg, 480, 24);
        lv_obj_align(typeface_head_bg, LV_ALIGN_TOP_LEFT, 0, 0);
        lv_obj_set_style_border_width(typeface_head_bg, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_border_color(typeface_head_bg, lv_color_hex(0x9bcd9b), LV_STATE_DEFAULT); /* 设置边框颜色 */
        lv_obj_set_style_radius(typeface_head_bg, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_color(typeface_head_bg, lv_color_hex(0x1fadd3), LV_STATE_DEFAULT);

        LV_FONT_DECLARE(heiFont16_1);
        label_typeface_head = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_typeface_head, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_typeface_head, lv_color_hex(0xFFFFFF), LV_STATE_DEFAULT);
        lv_obj_align(label_typeface_head, LV_ALIGN_TOP_LEFT, 200, 4);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_typeface_head,  "间隔");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_typeface_head, "Space");
        }

        typeface_slider_bg = lv_obj_create(lv_scr_act());
        lv_obj_set_size(typeface_slider_bg, 480, 224);
        lv_obj_align(typeface_slider_bg, LV_ALIGN_TOP_LEFT, 0, 24);
        lv_obj_set_style_border_width(typeface_slider_bg, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_border_color(typeface_slider_bg, lv_color_hex(0xaaaaaa), LV_STATE_DEFAULT); /* 设置边框颜色 */
        lv_obj_set_style_radius(typeface_slider_bg, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_color(typeface_slider_bg, lv_color_hex(0xaaaaaa), LV_STATE_DEFAULT);

        //数字键盘
        pwd_text_area = lv_textarea_create(lv_scr_act());
        if (pwd_text_area == NULL)
        {
            printf("[%s:%d] create pwd_text_area obj failed\n", __FUNCTION__, __LINE__);
            return;
        }

        // 密码框样式
        static lv_style_t pwd_text_style;
        lv_style_init(&pwd_text_style); // 初始化样式
        lv_style_set_radius(&pwd_text_style, 0); // 设置样式的圆角弧度
        lv_style_set_border_width(&pwd_text_style, 1); // 设置边框宽度
        lv_style_set_pad_all(&pwd_text_style, 0); // 设置样式的内部填充
        lv_style_set_text_font(&pwd_text_style, &lv_font_montserrat_18); //设置字体
        //lv_textarea_set_password_mode(pwd_text_area, true); // 文本区域开启密码模式
        lv_textarea_set_max_length(pwd_text_area, 3); // 设置可输入的文本的最大长度
        lv_obj_add_style(pwd_text_area, &pwd_text_style, 0); // 给btn_label添加样式
        lv_obj_set_size(pwd_text_area, 480, 50); // 设置对象大小
        lv_textarea_set_text(pwd_text_area, ""); // 文本框置空
        lv_obj_align(pwd_text_area, LV_ALIGN_TOP_LEFT, 0, 24);

        // 基于键盘背景对象创建密码校验提示标签
        hint_label = lv_label_create(lv_scr_act());
        if (hint_label == NULL)
        {
            printf("[%s:%d] create hint_label obj failed\n", __FUNCTION__, __LINE__);
            return;
        }

        // 密码提示文本样式
        static lv_style_t hint_label_style;
        lv_style_init(&hint_label_style); // 初始化样式
        lv_style_set_radius(&hint_label_style, 0); // 设置样式的圆角弧度
        lv_style_set_border_width(&hint_label_style, 0); //设置边框宽度
        lv_style_set_text_color(&hint_label_style, lv_palette_main(LV_PALETTE_RED));  // 字体颜色设置为红色
        lv_style_set_text_font(&hint_label_style, &lv_font_montserrat_12); //设置字体
        lv_label_set_long_mode(hint_label, LV_LABEL_LONG_SCROLL_CIRCULAR); // 长文本循环滚动
        lv_obj_add_style(hint_label, &hint_label_style, 0); // 给btn_label添加样式
        lv_obj_align(hint_label, LV_ALIGN_TOP_MID, 0, 110); // 顶部居中显示
        lv_label_set_text(hint_label, ""); // 设置文本内容

        // 基于键盘背景对象创建键盘对象
        pwd_keyboard = lv_keyboard_create(lv_scr_act());
        if (pwd_keyboard == NULL)
        {
            printf("[%s:%d] create pwd_keyboard obj failed\n", __FUNCTION__, __LINE__);
            return;
        }

        //键盘样式
        static lv_style_t pwd_kb_style;
        lv_style_init(&pwd_kb_style); // 初始化样式
        lv_style_set_radius(&pwd_kb_style, 5); // 设置样式的圆角弧度
        lv_style_set_border_width(&pwd_kb_style, 0); //设置边框宽度
        lv_style_set_bg_color(&pwd_kb_style, lv_color_hex(0xF98E2D));
        lv_style_set_text_opa(&pwd_kb_style, LV_OPA_COVER);
        lv_style_set_text_font(&pwd_kb_style, &lv_font_montserrat_20); //设置字体
        lv_obj_set_size(pwd_keyboard, 480, 174); //设置键盘大小
        lv_keyboard_set_mode(pwd_keyboard, LV_KEYBOARD_MODE_NUMBER_2); //设置键盘模式为数字键盘
        lv_keyboard_set_map(pwd_keyboard, LV_KEYBOARD_MODE_NUMBER_2, keyboard_map, keyboard_ctrl); // 设置键盘映射
        lv_keyboard_set_textarea(pwd_keyboard, pwd_text_area); // 键盘对象和文本框绑定
        lv_obj_add_style(pwd_keyboard, &pwd_kb_style, 0); // 添加样式
        lv_obj_align(pwd_keyboard, LV_ALIGN_TOP_LEFT, 0, 74);


        LV_FONT_DECLARE(heiFont16_1);
        label_typeface_return = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_typeface_return, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_typeface_return, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_typeface_return,  "返回");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_typeface_return, "Return");
        }
        lv_obj_align(label_typeface_return, LV_ALIGN_TOP_LEFT, 140, 252);

        LV_IMG_DECLARE(get_back);
        btn_typeface_return = lv_imgbtn_create(lv_scr_act());
        lv_imgbtn_set_src(btn_typeface_return, LV_IMGBTN_STATE_RELEASED, NULL, &get_back, NULL);
        lv_obj_set_size(btn_typeface_return, get_back.header.w, get_back.header.h);
        lv_obj_align(btn_typeface_return, LV_ALIGN_TOP_LEFT, 180, 250);
        lv_obj_add_event_cb(btn_typeface_return, button_work_space_return_event_cb, LV_EVENT_CLICKED, NULL);


        LV_IMG_DECLARE(confirm);
        btn_typeface_confirm = lv_imgbtn_create(lv_scr_act());
        lv_imgbtn_set_src(btn_typeface_confirm, LV_IMGBTN_STATE_RELEASED, NULL, &confirm, NULL);
        lv_obj_set_size(btn_typeface_confirm, get_back.header.w, get_back.header.h);
        lv_obj_align(btn_typeface_confirm, LV_ALIGN_TOP_LEFT, 250, 250);
        lv_obj_add_event_cb(btn_typeface_confirm, button_word_space_confirm_event_cb, LV_EVENT_CLICKED, NULL);

        LV_FONT_DECLARE(heiFont16_1);
        label_typeface_confirm = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_typeface_confirm, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_typeface_confirm, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_typeface_confirm,  "确定");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_typeface_confirm, "Confirm");
        }
        lv_obj_align(label_typeface_confirm, LV_ALIGN_TOP_LEFT, 277, 252);
    }
}


static void btn_file_management_word_size_event_cb(lv_event_t* e)
{
    lv_event_code_t code;

    code = lv_event_get_code(e);
    //lv_obj_t* obj = lv_event_get_target(e);

    if (code == LV_EVENT_CLICKED)
    {
        printf("btn_file_management_word_size_label\n");

        buzzer_enable = 1;
        typeface_head_bg = lv_obj_create(lv_scr_act());
        lv_obj_set_size(typeface_head_bg, 480, 24);
        lv_obj_align(typeface_head_bg, LV_ALIGN_TOP_LEFT, 0, 0);
        lv_obj_set_style_border_width(typeface_head_bg, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_border_color(typeface_head_bg, lv_color_hex(0x9bcd9b), LV_STATE_DEFAULT); /* 设置边框颜色 */
        lv_obj_set_style_radius(typeface_head_bg, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_color(typeface_head_bg, lv_color_hex(0x1fadd3), LV_STATE_DEFAULT);

        LV_FONT_DECLARE(heiFont16_1);
        label_typeface_head = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_typeface_head, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_typeface_head, lv_color_hex(0xFFFFFF), LV_STATE_DEFAULT);
        lv_obj_align(label_typeface_head, LV_ALIGN_TOP_LEFT, 200, 4);

        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_typeface_head,  "字号");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_typeface_head, "Size");
        }

        typeface_slider_bg = lv_obj_create(lv_scr_act());
        lv_obj_set_size(typeface_slider_bg, 480, 224);
        lv_obj_align(typeface_slider_bg, LV_ALIGN_TOP_LEFT, 0, 24);
        lv_obj_set_style_border_width(typeface_slider_bg, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_border_color(typeface_slider_bg, lv_color_hex(0xaaaaaa), LV_STATE_DEFAULT); /* 设置边框颜色 */
        lv_obj_set_style_radius(typeface_slider_bg, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_color(typeface_slider_bg, lv_color_hex(0xaaaaaa), LV_STATE_DEFAULT);

        //数字键盘
        pwd_text_area = lv_textarea_create(lv_scr_act());
        if (pwd_text_area == NULL)
        {
            printf("[%s:%d] create pwd_text_area obj failed\n", __FUNCTION__, __LINE__);
            return;
        }

        // 密码框样式
        static lv_style_t pwd_text_style;
        lv_style_init(&pwd_text_style); // 初始化样式
        lv_style_set_radius(&pwd_text_style, 0); // 设置样式的圆角弧度
        lv_style_set_border_width(&pwd_text_style, 1); // 设置边框宽度
        lv_style_set_pad_all(&pwd_text_style, 0); // 设置样式的内部填充
        lv_style_set_text_font(&pwd_text_style, &lv_font_montserrat_18); //设置字体
        //lv_textarea_set_password_mode(pwd_text_area, true); // 文本区域开启密码模式
        lv_textarea_set_max_length(pwd_text_area, 3); // 设置可输入的文本的最大长度
        lv_obj_add_style(pwd_text_area, &pwd_text_style, 0); // 给btn_label添加样式
        lv_obj_set_size(pwd_text_area, 480, 50); // 设置对象大小
        lv_textarea_set_text(pwd_text_area, ""); // 文本框置空
        lv_obj_align(pwd_text_area, LV_ALIGN_TOP_LEFT, 0, 24);

        // 基于键盘背景对象创建密码校验提示标签
        hint_label = lv_label_create(lv_scr_act());
        if (hint_label == NULL)
        {
            printf("[%s:%d] create hint_label obj failed\n", __FUNCTION__, __LINE__);
            return;
        }

        // 密码提示文本样式
        static lv_style_t hint_label_style;
        lv_style_init(&hint_label_style); // 初始化样式
        lv_style_set_radius(&hint_label_style, 0); // 设置样式的圆角弧度
        lv_style_set_border_width(&hint_label_style, 0); //设置边框宽度
        lv_style_set_text_color(&hint_label_style, lv_palette_main(LV_PALETTE_RED));  // 字体颜色设置为红色
        lv_style_set_text_font(&hint_label_style, &lv_font_montserrat_12); //设置字体
        lv_label_set_long_mode(hint_label, LV_LABEL_LONG_SCROLL_CIRCULAR); // 长文本循环滚动
        lv_obj_add_style(hint_label, &hint_label_style, 0); // 给btn_label添加样式
        lv_obj_align(hint_label, LV_ALIGN_TOP_MID, 0, 110); // 顶部居中显示
        lv_label_set_text(hint_label, ""); // 设置文本内容

        // 基于键盘背景对象创建键盘对象
        pwd_keyboard = lv_keyboard_create(lv_scr_act());
        if (pwd_keyboard == NULL)
        {
            printf("[%s:%d] create pwd_keyboard obj failed\n", __FUNCTION__, __LINE__);
            return;
        }

        //键盘样式
        static lv_style_t pwd_kb_style;
        lv_style_init(&pwd_kb_style); // 初始化样式
        lv_style_set_radius(&pwd_kb_style, 5); // 设置样式的圆角弧度
        lv_style_set_border_width(&pwd_kb_style, 0); //设置边框宽度
        lv_style_set_bg_color(&pwd_kb_style, lv_color_hex(0xF98E2D));
        lv_style_set_text_opa(&pwd_kb_style, LV_OPA_COVER);
        lv_style_set_text_font(&pwd_kb_style, &lv_font_montserrat_20); //设置字体
        lv_obj_set_size(pwd_keyboard, 480, 174); //设置键盘大小
        lv_keyboard_set_mode(pwd_keyboard, LV_KEYBOARD_MODE_NUMBER_2); //设置键盘模式为数字键盘
        lv_keyboard_set_map(pwd_keyboard, LV_KEYBOARD_MODE_NUMBER_2, keyboard_map, keyboard_ctrl); // 设置键盘映射
        lv_keyboard_set_textarea(pwd_keyboard, pwd_text_area); // 键盘对象和文本框绑定
        lv_obj_add_style(pwd_keyboard, &pwd_kb_style, 0); // 添加样式
        lv_obj_align(pwd_keyboard, LV_ALIGN_TOP_LEFT, 0, 74);


        LV_FONT_DECLARE(heiFont16_1);
        label_typeface_return = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_typeface_return, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_typeface_return, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_typeface_return,  "返回");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_typeface_return, "Return");
        }
        lv_obj_align(label_typeface_return, LV_ALIGN_TOP_LEFT, 140, 252);

        LV_IMG_DECLARE(get_back);
        btn_typeface_return = lv_imgbtn_create(lv_scr_act());
        lv_imgbtn_set_src(btn_typeface_return, LV_IMGBTN_STATE_RELEASED, NULL, &get_back, NULL);
        lv_obj_set_size(btn_typeface_return, get_back.header.w, get_back.header.h);
        lv_obj_align(btn_typeface_return, LV_ALIGN_TOP_LEFT, 180, 250);
        lv_obj_add_event_cb(btn_typeface_return, button_work_size_return_event_cb, LV_EVENT_CLICKED, NULL);


        LV_IMG_DECLARE(confirm);
        btn_typeface_confirm = lv_imgbtn_create(lv_scr_act());
        lv_imgbtn_set_src(btn_typeface_confirm, LV_IMGBTN_STATE_RELEASED, NULL, &confirm, NULL);
        lv_obj_set_size(btn_typeface_confirm, get_back.header.w, get_back.header.h);
        lv_obj_align(btn_typeface_confirm, LV_ALIGN_TOP_LEFT, 250, 250);
        lv_obj_add_event_cb(btn_typeface_confirm, button_word_size_confirm_event_cb, LV_EVENT_CLICKED, NULL);

        LV_FONT_DECLARE(heiFont16_1);
        label_typeface_confirm = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_typeface_confirm, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_typeface_confirm, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_typeface_confirm,  "确定");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_typeface_confirm, "Confirm");
        }
        lv_obj_align(label_typeface_confirm, LV_ALIGN_TOP_LEFT, 277, 252);
    }
}

static void btn_addition_text_spin_confirm_event_cb(lv_event_t* e)
{
    lv_event_code_t code;
    int i=0;
    char temp_str[12] = { 0 };
    code = lv_event_get_code(e);
    if (code == LV_EVENT_CLICKED)
    {
        printf("btn_addition_text_spin_confirm_event_cb\n");
        buzzer_enable = 1;
        const char* pwd_txt = lv_textarea_get_text(pwd_text_area);
        if ((pwd_txt != NULL))
        {
            i = atoi(pwd_txt);
            if (i > 360)
            {
                i = 360;
            }
            else if (i < 0)
            {
                i = 0;
            }
        }

        sprintf(temp_str, "%d", i);
        lv_label_set_text(label_btn_addition_text_spin, temp_str);

        lv_obj_del(typeface_head_bg);
        lv_obj_del(label_typeface_head);
        lv_obj_del(typeface_slider_bg);
        lv_obj_del(pwd_text_area);
        lv_obj_del(pwd_keyboard);

        lv_obj_del(label_typeface_return);
        lv_obj_del(btn_typeface_return);
        lv_obj_del(btn_typeface_confirm);
        lv_obj_del(label_typeface_confirm);

    }
}

static void btn_addition_text_spin_event_cb(lv_event_t* e)
{
    lv_event_code_t code;

    code = lv_event_get_code(e);
    //int len = 0;
    //int i;
    //int offset_x;
    //int offset_y;
    //int line_num = 5;
    //int size_wide = 85;
    //int size_high = 24;
    //lv_obj_t* obj = lv_event_get_target(e);

    if (code == LV_EVENT_CLICKED)
    {
        buzzer_enable = 1;
        printf("[%s:%d] btn_addition_text_spin_event_cb\n", __FUNCTION__, __LINE__);
        typeface_head_bg = lv_obj_create(lv_scr_act());
        lv_obj_set_size(typeface_head_bg, 480, 24);
        lv_obj_align(typeface_head_bg, LV_ALIGN_TOP_LEFT, 0, 0);
        lv_obj_set_style_border_width(typeface_head_bg, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_border_color(typeface_head_bg, lv_color_hex(0x9bcd9b), LV_STATE_DEFAULT); /* 设置边框颜色 */
        lv_obj_set_style_radius(typeface_head_bg, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_color(typeface_head_bg, lv_color_hex(0x1fadd3), LV_STATE_DEFAULT);

        LV_FONT_DECLARE(heiFont16_1);
        label_typeface_head = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_typeface_head, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_typeface_head, lv_color_hex(0xFFFFFF), LV_STATE_DEFAULT);
        lv_obj_align(label_typeface_head, LV_ALIGN_TOP_LEFT, 200, 4);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_typeface_head,  "旋转");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_typeface_head, "Spin");
        }

        typeface_slider_bg = lv_obj_create(lv_scr_act());
        lv_obj_set_size(typeface_slider_bg, 480, 224);
        lv_obj_align(typeface_slider_bg, LV_ALIGN_TOP_LEFT, 0, 24);
        lv_obj_set_style_border_width(typeface_slider_bg, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_border_color(typeface_slider_bg, lv_color_hex(0xaaaaaa), LV_STATE_DEFAULT); /* 设置边框颜色 */
        lv_obj_set_style_radius(typeface_slider_bg, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_color(typeface_slider_bg, lv_color_hex(0xaaaaaa), LV_STATE_DEFAULT);

        //数字键盘
        pwd_text_area = lv_textarea_create(lv_scr_act());
        if (pwd_text_area == NULL)
        {
            printf("[%s:%d] create pwd_text_area obj failed\n", __FUNCTION__, __LINE__);
            return;
        }

        // 密码框样式
        static lv_style_t pwd_text_style;
        lv_style_init(&pwd_text_style); // 初始化样式
        lv_style_set_radius(&pwd_text_style, 0); // 设置样式的圆角弧度
        lv_style_set_border_width(&pwd_text_style, 1); // 设置边框宽度
        lv_style_set_pad_all(&pwd_text_style, 0); // 设置样式的内部填充
        lv_style_set_text_font(&pwd_text_style, &heiFont16_1); //设置字体
        //lv_obj_set_style_text_font(label_typeface_head, &heiFont16_1, LV_STATE_DEFAULT);
        //lv_textarea_set_password_mode(pwd_text_area, true); // 文本区域开启密码模式
        lv_textarea_set_max_length(pwd_text_area, 3); // 设置可输入的文本的最大长度
        lv_obj_add_style(pwd_text_area, &pwd_text_style, 0); // 给btn_label添加样式
        lv_obj_set_size(pwd_text_area, 480, 50); // 设置对象大小
        lv_textarea_set_text(pwd_text_area, ""); // 文本框置空
        lv_textarea_set_placeholder_text(pwd_text_area, "请输入0~360的数值");
        lv_obj_align(pwd_text_area, LV_ALIGN_TOP_LEFT, 0, 24);

        // 基于键盘背景对象创建密码校验提示标签
        hint_label = lv_label_create(lv_scr_act());
        if (hint_label == NULL)
        {
            printf("[%s:%d] create hint_label obj failed\n", __FUNCTION__, __LINE__);
            return;
        }

        // 密码提示文本样式
        static lv_style_t hint_label_style;
        lv_style_init(&hint_label_style); // 初始化样式
        lv_style_set_radius(&hint_label_style, 0); // 设置样式的圆角弧度
        lv_style_set_border_width(&hint_label_style, 0); //设置边框宽度
        lv_style_set_text_color(&hint_label_style, lv_palette_main(LV_PALETTE_RED));  // 字体颜色设置为红色
        lv_style_set_text_font(&hint_label_style, &lv_font_montserrat_12); //设置字体
        lv_label_set_long_mode(hint_label, LV_LABEL_LONG_SCROLL_CIRCULAR); // 长文本循环滚动
        lv_obj_add_style(hint_label, &hint_label_style, 0); // 给btn_label添加样式
        lv_obj_align(hint_label, LV_ALIGN_TOP_MID, 0, 110); // 顶部居中显示
        lv_label_set_text(hint_label, ""); // 设置文本内容

        // 基于键盘背景对象创建键盘对象
        pwd_keyboard = lv_keyboard_create(lv_scr_act());
        if (pwd_keyboard == NULL)
        {
            printf("[%s:%d] create pwd_keyboard obj failed\n", __FUNCTION__, __LINE__);
            return;
        }

        //键盘样式
        static lv_style_t pwd_kb_style;
        lv_style_init(&pwd_kb_style); // 初始化样式
        lv_style_set_radius(&pwd_kb_style, 5); // 设置样式的圆角弧度
        lv_style_set_border_width(&pwd_kb_style, 0); //设置边框宽度
        lv_style_set_bg_color(&pwd_kb_style, lv_color_hex(0xF98E2D));
        lv_style_set_text_opa(&pwd_kb_style, LV_OPA_COVER);
        lv_style_set_text_font(&pwd_kb_style, &lv_font_montserrat_20); //设置字体
        lv_obj_set_size(pwd_keyboard, 480, 174); //设置键盘大小
        lv_keyboard_set_mode(pwd_keyboard, LV_KEYBOARD_MODE_NUMBER_2); //设置键盘模式为数字键盘
        lv_keyboard_set_map(pwd_keyboard, LV_KEYBOARD_MODE_NUMBER_2, keyboard_map, keyboard_ctrl); // 设置键盘映射
        lv_keyboard_set_textarea(pwd_keyboard, pwd_text_area); // 键盘对象和文本框绑定
        lv_obj_add_style(pwd_keyboard, &pwd_kb_style, 0); // 添加样式
        lv_obj_align(pwd_keyboard, LV_ALIGN_TOP_LEFT, 0, 74);


        LV_FONT_DECLARE(heiFont16_1);
        label_typeface_return = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_typeface_return, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_typeface_return, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_typeface_return, "返回");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_typeface_return, "Return");
        }
        lv_obj_align(label_typeface_return, LV_ALIGN_TOP_LEFT, 140, 252);

        LV_IMG_DECLARE(get_back);
        btn_typeface_return = lv_imgbtn_create(lv_scr_act());
        lv_imgbtn_set_src(btn_typeface_return, LV_IMGBTN_STATE_RELEASED, NULL, &get_back, NULL);
        lv_obj_set_size(btn_typeface_return, get_back.header.w, get_back.header.h);
        lv_obj_align(btn_typeface_return, LV_ALIGN_TOP_LEFT, 180, 250);
        lv_obj_add_event_cb(btn_typeface_return, button_work_size_return_event_cb, LV_EVENT_CLICKED, NULL);

        LV_IMG_DECLARE(confirm);
        btn_typeface_confirm = lv_imgbtn_create(lv_scr_act());
        lv_imgbtn_set_src(btn_typeface_confirm, LV_IMGBTN_STATE_RELEASED, NULL, &confirm, NULL);
        lv_obj_set_size(btn_typeface_confirm, get_back.header.w, get_back.header.h);
        lv_obj_align(btn_typeface_confirm, LV_ALIGN_TOP_LEFT, 250, 250);
        lv_obj_add_event_cb(btn_typeface_confirm, btn_addition_text_spin_confirm_event_cb, LV_EVENT_CLICKED, NULL);

        LV_FONT_DECLARE(heiFont16_1);
        label_typeface_confirm = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_typeface_confirm, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_typeface_confirm, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_typeface_confirm, "确定");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_typeface_confirm, "Confirm");
        }
        lv_obj_align(label_typeface_confirm, LV_ALIGN_TOP_LEFT, 277, 252);
    }
}



static void sw_addition_bold_event_cb(lv_event_t* e)
{
    lv_event_code_t code = lv_event_get_code(e);
    lv_obj_t* obj = lv_event_get_target(e);
    if (code == LV_EVENT_VALUE_CHANGED)
    {
        printf("State: %s\n", lv_obj_has_state(obj, LV_STATE_CHECKED) ? "On" : "Off");
        buzzer_enable = 1;
    }
}


void addition_text_updata(void)
{
    int len = strlen(lv_label_get_text(label_file_management_label));
    printf("len=%u\n\r", len);
    if (len == 0)
    {
        lv_obj_set_style_bg_opa(label_file_management_text_label, LV_OPA_TRANSP, LV_PART_MAIN);
        lv_obj_clear_flag(label_file_management_text_label_1, LV_OBJ_FLAG_HIDDEN);
    }
    else
    {
        lv_obj_set_style_bg_opa(label_file_management_text_label, LV_OPA_COVER, LV_PART_MAIN);
        lv_obj_add_flag(label_file_management_text_label_1, LV_OBJ_FLAG_HIDDEN);
    }
}

static void button_addition_text_event_cb(lv_event_t* e)
{
    lv_event_code_t code;
    //lv_obj_t* keyboard;
    //lv_obj_t* textarea;
    //lv_obj_t* pinyin_ime;
    //lv_obj_t* cand_panel;

    code = lv_event_get_code(e);

    if ((code == LV_EVENT_CLICKED)&& (print_status == 0))
    {
        printf("addition text\n");
        buzzer_enable = 1;
        file_management_win = lv_obj_create(lv_scr_act());
        /* 设置大小 */
        lv_obj_set_size(file_management_win, 480, 272);
        lv_obj_align(file_management_win, LV_ALIGN_TOP_LEFT, 0, 0);
        lv_obj_set_style_border_width(file_management_win, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_radius(file_management_win, 0, LV_STATE_DEFAULT); /* 设置圆角 */

        file_management_head_bg = lv_obj_create(lv_scr_act());
        /* 设置大小 */
        lv_obj_set_size(file_management_head_bg, 480, 24);
        lv_obj_align(file_management_head_bg, LV_ALIGN_TOP_LEFT, 0, 0);
        lv_obj_set_style_border_width(file_management_head_bg, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_radius(file_management_head_bg, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_color(file_management_head_bg, lv_color_hex(0x28536a), LV_STATE_DEFAULT);
        lv_obj_remove_style(file_management_head_bg, 0, LV_PART_SCROLLBAR);

#if 0
        LV_FONT_DECLARE(heiFont16_1);
        label_file_management_total_output = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_file_management_total_output, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_file_management_total_output, lv_color_hex(0xFFFFFF), LV_STATE_DEFAULT);
        lv_label_set_text(label_file_management_total_output, "总产量:99999");
        lv_obj_align(label_file_management_total_output, LV_ALIGN_TOP_LEFT, 0, 4);
#endif

        LV_FONT_DECLARE(heiFont16_1);
        label_file_management = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_file_management, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_file_management, lv_color_hex(0xFFFFFF), LV_STATE_DEFAULT);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_file_management,  "文本");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_file_management, "Text");
        }
        lv_obj_align(label_file_management, LV_ALIGN_TOP_LEFT, 200, 4);

#if 0
        LV_FONT_DECLARE(heiFont12);
        label_file_management_date = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_file_management_date, &heiFont12, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_file_management_date, lv_color_hex(0xFFFFFF), LV_STATE_DEFAULT);
        lv_label_set_text(label_file_management_date, "2024-09-09");
        lv_obj_align(label_file_management_date, LV_ALIGN_TOP_LEFT, 350, 2);


        LV_FONT_DECLARE(heiFont12);
        label_file_management_time = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_file_management_time, &heiFont12, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_file_management_time, lv_color_hex(0xFFFFFF), LV_STATE_DEFAULT);
        lv_label_set_text(label_file_management_time, "09:52:32");
        lv_obj_align(label_file_management_time, LV_ALIGN_TOP_LEFT, 360, 12);


        LV_IMG_DECLARE(electric_quantity_60);
        img_file_management_battery_level = lv_img_create(lv_scr_act());
        lv_img_set_src(img_file_management_battery_level, &electric_quantity_60);
        lv_obj_align(img_file_management_battery_level, LV_ALIGN_TOP_LEFT, 425, 2);

#endif


        LV_FONT_DECLARE(heiFont16_1);
        label_file_management_label = lv_label_create(lv_scr_act());
        lv_obj_set_width(label_file_management_label, 480);
        lv_obj_set_height(label_file_management_label, 108);
        lv_obj_set_style_text_font(label_file_management_label, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_file_management_label, lv_color_hex(0x1C1C1C), LV_STATE_DEFAULT);
        lv_label_set_text(label_file_management_label, "");
        lv_obj_align(label_file_management_label, LV_ALIGN_TOP_LEFT, 0, 24);

        
        file_management_middle_bg = lv_obj_create(lv_scr_act());
        lv_obj_set_size(file_management_middle_bg, 480, 140);
        lv_obj_align(file_management_middle_bg, LV_ALIGN_TOP_LEFT, 0, 132);
        lv_obj_set_style_border_width(file_management_middle_bg, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_radius(file_management_middle_bg, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_color(file_management_middle_bg, lv_color_hex(0x1fadd3), LV_STATE_DEFAULT);

        LV_IMG_DECLARE(text);
        img_file_management_text = lv_img_create(lv_scr_act());
        lv_img_set_src(img_file_management_text, &text);
        lv_obj_align(img_file_management_text, LV_ALIGN_TOP_LEFT, 10, 134);

        LV_FONT_DECLARE(heiFont16_1);
        label_file_management_text = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_file_management_text, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_file_management_text, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_file_management_text,  "文本");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_file_management_text, "Text");
        }
        lv_obj_align(label_file_management_text, LV_ALIGN_TOP_LEFT, 45, 139);

        LV_FONT_DECLARE(heiFont16_1);
        btn_file_management_text = lv_btn_create(lv_scr_act());
        lv_obj_set_size(btn_file_management_text, 125, 24);
        lv_obj_align(btn_file_management_text, LV_ALIGN_TOP_LEFT, 95, 136);
        lv_obj_set_style_border_width(btn_file_management_text, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_radius(btn_file_management_text, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_color(btn_file_management_text, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        label_file_management_text_label = lv_label_create(btn_file_management_text);
        lv_obj_set_style_text_font(label_file_management_text_label, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_file_management_text_label, lv_color_hex(0x1C1C1C), LV_STATE_DEFAULT);
        lv_label_set_text(label_file_management_text_label, "");
        lv_obj_align(label_file_management_text_label, LV_ALIGN_CENTER, 0, 0);
        lv_obj_set_style_border_width(label_file_management_text_label, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_border_color(label_file_management_text_label, lv_color_hex(0x8a8a8a), LV_STATE_DEFAULT); /* 设置边框颜色 */
        lv_obj_set_style_border_opa(label_file_management_text_label, 100, LV_STATE_DEFAULT); /* 设置边框透明度 */
        lv_obj_set_style_radius(label_file_management_text_label, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_opa(label_file_management_text_label, LV_OPA_COVER, LV_PART_MAIN);
        lv_obj_set_style_bg_color(label_file_management_text_label, lv_color_hex(0xffffff), LV_PART_MAIN);
        lv_obj_add_event_cb(btn_file_management_text, btn_file_management_text_event_cb, LV_EVENT_CLICKED, NULL);
        lv_obj_set_style_text_opa(label_file_management_text_label, LV_OPA_60, LV_STATE_DEFAULT);


        label_file_management_text_label_1 = lv_label_create(btn_file_management_text);
        lv_obj_set_style_text_font(label_file_management_text_label_1, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_file_management_text_label_1, lv_color_hex(0x1C1C1C), LV_STATE_DEFAULT);
        lv_label_set_text(label_file_management_text_label_1, "请输入文字");
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_file_management_text_label_1, "请输入文字");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_file_management_text_label_1, "Please enter the text.");
        }
        lv_obj_align(label_file_management_text_label_1, LV_ALIGN_CENTER, 0, 0);
        lv_obj_set_style_border_width(label_file_management_text_label_1, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_border_color(label_file_management_text_label_1, lv_color_hex(0x8a8a8a), LV_STATE_DEFAULT); /* 设置边框颜色 */
        lv_obj_set_style_border_opa(label_file_management_text_label_1, 100, LV_STATE_DEFAULT); /* 设置边框透明度 */
        lv_obj_set_style_radius(label_file_management_text_label_1, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_opa(label_file_management_text_label_1, LV_OPA_COVER, LV_PART_MAIN);
        lv_obj_set_style_bg_color(label_file_management_text_label_1, lv_color_hex(0xffffff), LV_PART_MAIN);
        lv_obj_set_style_text_opa(label_file_management_text_label_1, LV_OPA_60, LV_STATE_DEFAULT);


        LV_IMG_DECLARE(typeface);
        img_file_management_typeface = lv_img_create(lv_scr_act());
        lv_img_set_src(img_file_management_typeface, &typeface);
        lv_obj_align(img_file_management_typeface, LV_ALIGN_TOP_LEFT, 10, 162);

        LV_FONT_DECLARE(heiFont16_1);
        label_file_management_typeface = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_file_management_typeface, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_file_management_typeface, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_file_management_typeface,  "字体");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_file_management_typeface, "Typeface");
        }
        lv_obj_align(label_file_management_typeface, LV_ALIGN_TOP_LEFT, 45, 167);


        LV_FONT_DECLARE(heiFont16_1);
        btn_file_management_typeface = lv_btn_create(lv_scr_act());
        lv_obj_set_size(btn_file_management_typeface, 125, 24);
        lv_obj_align(btn_file_management_typeface, LV_ALIGN_TOP_LEFT, 95, 164);
        lv_obj_set_style_border_width(btn_file_management_typeface, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_radius(btn_file_management_typeface, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_color(btn_file_management_typeface, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        label_file_management_typeface_label = lv_label_create(btn_file_management_typeface);
        lv_obj_set_style_text_font(label_file_management_typeface_label, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_file_management_typeface_label, lv_color_hex(0x1C1C1C), LV_STATE_DEFAULT);
        lv_label_set_text(label_file_management_typeface_label, "常用宋体");
        lv_obj_align(label_file_management_typeface_label, LV_ALIGN_CENTER, 0, 0);
        lv_obj_set_style_border_width(label_file_management_typeface_label, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_border_color(label_file_management_typeface_label, lv_color_hex(0x8a8a8a), LV_STATE_DEFAULT); /* 设置边框颜色 */
        lv_obj_set_style_border_opa(label_file_management_typeface_label, 100, LV_STATE_DEFAULT); /* 设置边框透明度 */
        lv_obj_set_style_radius(label_file_management_typeface_label, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_opa(label_file_management_typeface_label, LV_OPA_COVER, LV_PART_MAIN);
        lv_obj_set_style_bg_color(label_file_management_typeface_label, lv_color_hex(0xffffff), LV_PART_MAIN);
        lv_obj_add_event_cb(btn_file_management_typeface, btn_file_management_typeface_event_cb, LV_EVENT_CLICKED, NULL);


        LV_IMG_DECLARE(word_space);
        img_file_management_word_space = lv_img_create(lv_scr_act());
        lv_img_set_src(img_file_management_word_space, &word_space);
        lv_obj_align(img_file_management_word_space, LV_ALIGN_TOP_LEFT, 250, 134);

        LV_FONT_DECLARE(heiFont16_1);
        label_file_management_word_space = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_file_management_word_space, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_file_management_word_space, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_file_management_word_space,  "间隔");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_file_management_word_space, "Space");
        }
        lv_obj_align(label_file_management_word_space, LV_ALIGN_TOP_LEFT, 285, 139);


        LV_FONT_DECLARE(heiFont16_1);
        btn_file_management_word_space_label = lv_btn_create(lv_scr_act());
        lv_obj_set_size(btn_file_management_word_space_label, 125, 24);
        lv_obj_align(btn_file_management_word_space_label, LV_ALIGN_TOP_LEFT, 338, 136);
        lv_obj_set_style_border_width(btn_file_management_word_space_label, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_radius(btn_file_management_word_space_label, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_color(btn_file_management_word_space_label, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        label_file_management_word_space_label = lv_label_create(btn_file_management_word_space_label);
        lv_obj_set_style_text_font(label_file_management_word_space_label, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_file_management_word_space_label, lv_color_hex(0x1C1C1C), LV_STATE_DEFAULT);
        lv_label_set_text(label_file_management_word_space_label, "000");
        lv_obj_align(label_file_management_word_space_label, LV_ALIGN_CENTER, 0, 0);
        lv_obj_set_style_border_width(label_file_management_word_space_label, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_border_color(label_file_management_word_space_label, lv_color_hex(0x8a8a8a), LV_STATE_DEFAULT); /* 设置边框颜色 */
        lv_obj_set_style_border_opa(label_file_management_word_space_label, 100, LV_STATE_DEFAULT); /* 设置边框透明度 */
        lv_obj_set_style_radius(label_file_management_word_space_label, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_opa(label_file_management_word_space_label, LV_OPA_COVER, LV_PART_MAIN);
        lv_obj_set_style_bg_color(label_file_management_word_space_label, lv_color_hex(0xffffff), LV_PART_MAIN);
        lv_obj_add_event_cb(btn_file_management_word_space_label, btn_file_management_word_space_event_cb, LV_EVENT_CLICKED, NULL);


        LV_IMG_DECLARE(word_size);
        img_file_management_word_size = lv_img_create(lv_scr_act());
        lv_img_set_src(img_file_management_word_size, &word_size);
        lv_obj_align(img_file_management_word_size, LV_ALIGN_TOP_LEFT, 10, 190);

        LV_FONT_DECLARE(heiFont16_1);
        label_file_management_word_size = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_file_management_word_size, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_file_management_word_size, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_file_management_word_size,  "字号");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_file_management_word_size, "Size");
        }
        lv_obj_align(label_file_management_word_size, LV_ALIGN_TOP_LEFT, 45, 195);


        LV_FONT_DECLARE(heiFont16_1);
        btn_file_management_word_size_label = lv_btn_create(lv_scr_act());
        lv_obj_set_size(btn_file_management_word_size_label, 125, 24);
        lv_obj_align(btn_file_management_word_size_label, LV_ALIGN_TOP_LEFT, 95, 192);
        lv_obj_set_style_border_width(btn_file_management_word_size_label, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_radius(btn_file_management_word_size_label, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_color(btn_file_management_word_size_label, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        label_file_management_word_size_label = lv_label_create(btn_file_management_word_size_label);
        lv_obj_set_style_text_font(label_file_management_word_size_label, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_file_management_word_size_label, lv_color_hex(0x1C1C1C), LV_STATE_DEFAULT);
        lv_label_set_text(label_file_management_word_size_label, "48");
        lv_obj_align(label_file_management_word_size_label, LV_ALIGN_CENTER, 0, 0);
        lv_obj_set_style_border_width(label_file_management_word_size_label, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_border_color(label_file_management_word_size_label, lv_color_hex(0x8a8a8a), LV_STATE_DEFAULT); /* 设置边框颜色 */
        lv_obj_set_style_border_opa(label_file_management_word_size_label, 100, LV_STATE_DEFAULT); /* 设置边框透明度 */
        lv_obj_set_style_radius(label_file_management_word_size_label, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_opa(label_file_management_word_size_label, LV_OPA_COVER, LV_PART_MAIN);
        lv_obj_set_style_bg_color(label_file_management_word_size_label, lv_color_hex(0xffffff), LV_PART_MAIN);
        lv_obj_add_event_cb(btn_file_management_word_size_label, btn_file_management_word_size_event_cb, LV_EVENT_CLICKED, NULL);



        LV_IMG_DECLARE(spin);
        img_file_management_spin = lv_img_create(lv_scr_act());
        lv_img_set_src(img_file_management_spin, &spin);
        //lv_obj_align(img_file_management_spin, LV_ALIGN_TOP_LEFT, 250, 190);
        lv_obj_align(img_file_management_spin, LV_ALIGN_TOP_LEFT, 250, 162);

        LV_FONT_DECLARE(heiFont16_1);
        label_file_management_spin = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_file_management_spin, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_file_management_spin, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_file_management_spin, "旋转");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_file_management_spin, "Spin");
        }
        lv_obj_align(label_file_management_spin, LV_ALIGN_TOP_LEFT, 285, 167);


        LV_FONT_DECLARE(heiFont16_1);
        btn_addition_text_spin = lv_btn_create(lv_scr_act());
        lv_obj_set_size(btn_addition_text_spin, 125, 24);
        lv_obj_align(btn_addition_text_spin, LV_ALIGN_TOP_LEFT, 338, 164);
        lv_obj_set_style_border_width(btn_addition_text_spin, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_radius(btn_addition_text_spin, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_color(btn_addition_text_spin, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        label_btn_addition_text_spin = lv_label_create(btn_addition_text_spin);
        lv_obj_set_style_text_font(label_btn_addition_text_spin, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_btn_addition_text_spin, lv_color_hex(0x1C1C1C), LV_STATE_DEFAULT);
        lv_label_set_text(label_btn_addition_text_spin, "0°");
        lv_obj_align(label_btn_addition_text_spin, LV_ALIGN_CENTER, 0, 0);
        lv_obj_set_style_border_width(label_btn_addition_text_spin, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_border_color(label_btn_addition_text_spin, lv_color_hex(0x8a8a8a), LV_STATE_DEFAULT); /* 设置边框颜色 */
        lv_obj_set_style_border_opa(label_btn_addition_text_spin, 100, LV_STATE_DEFAULT); /* 设置边框透明度 */
        lv_obj_set_style_radius(label_btn_addition_text_spin, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_opa(label_btn_addition_text_spin, LV_OPA_COVER, LV_PART_MAIN);
        lv_obj_set_style_bg_color(label_btn_addition_text_spin, lv_color_hex(0xffffff), LV_PART_MAIN);
        lv_obj_add_event_cb(btn_addition_text_spin, btn_addition_text_spin_event_cb, LV_EVENT_CLICKED, NULL);



#if 0
        LV_IMG_DECLARE(width);
        img_file_management_width = lv_img_create(lv_scr_act());
        lv_img_set_src(img_file_management_width, &width);
        lv_obj_align(img_file_management_width, LV_ALIGN_TOP_LEFT, 250, 162);

        LV_FONT_DECLARE(heiFont16_1);
        label_file_management_width = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_file_management_width, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_file_management_width, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        lv_label_set_text(label_file_management_width, "宽度");
        lv_obj_align(label_file_management_width, LV_ALIGN_TOP_LEFT, 285, 167);

        LV_FONT_DECLARE(heiFont16_1);
        label_file_management_width_label = lv_label_create(lv_scr_act());
        lv_obj_set_width(label_file_management_width_label, 125);
        lv_obj_set_height(label_file_management_width_label, 24);
        lv_obj_set_style_text_font(label_file_management_width_label, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_file_management_width_label, lv_color_hex(0x1C1C1C), LV_STATE_DEFAULT);
        lv_label_set_text(label_file_management_width_label, "ABCDEF");
        lv_obj_align(label_file_management_width_label, LV_ALIGN_TOP_LEFT, 338, 164);
        lv_obj_set_style_border_width(label_file_management_width_label, 1, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_border_color(label_file_management_width_label, lv_color_hex(0x8a8a8a), LV_STATE_DEFAULT); /* 设置边框颜色 */
        lv_obj_set_style_border_opa(label_file_management_width_label, 100, LV_STATE_DEFAULT); /* 设置边框透明度 */
        lv_obj_set_style_radius(label_file_management_width_label, 2, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_opa(label_file_management_width_label, LV_OPA_COVER, LV_PART_MAIN);
        lv_obj_set_style_bg_color(label_file_management_width_label, lv_color_hex(0xffffff), LV_PART_MAIN);
#endif

        LV_IMG_DECLARE(bold);
        img_file_management_bold = lv_img_create(lv_scr_act());
        lv_img_set_src(img_file_management_bold, &bold);
        lv_obj_align(img_file_management_bold, LV_ALIGN_TOP_LEFT, 250, 218);

        LV_FONT_DECLARE(heiFont16_1);
        label_file_management_bold = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_file_management_bold, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_file_management_bold, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_file_management_bold, "粗体");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_file_management_bold, "Bold");
        }
        lv_obj_align(label_file_management_bold, LV_ALIGN_TOP_LEFT, 285, 223);

        sw_file_management_bold = lv_switch_create(lv_scr_act());
        lv_obj_set_pos(sw_file_management_bold, 343, 220);
        lv_obj_set_width(sw_file_management_bold, 48);
        lv_obj_set_height(sw_file_management_bold, 23);
        lv_obj_set_style_bg_color(sw_file_management_bold, lv_color_hex(0x00ff00), LV_STATE_CHECKED | LV_PART_INDICATOR);
        lv_obj_add_event_cb(sw_file_management_bold, sw_addition_bold_event_cb, LV_EVENT_CLICKED, NULL);


        LV_IMG_DECLARE(italic);
        img_management_line_italic = lv_img_create(lv_scr_act());
        lv_img_set_src(img_management_line_italic, &italic);
        lv_obj_align(img_management_line_italic, LV_ALIGN_TOP_LEFT, 10, 218);

        LV_FONT_DECLARE(heiFont16_1);
        label_management_line_italic = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_management_line_italic, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_management_line_italic, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_management_line_italic, "斜体");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_management_line_italic, "Italic");
        }
        lv_obj_align(label_management_line_italic, LV_ALIGN_TOP_LEFT, 45, 223);

        sw_management_line_italic = lv_switch_create(lv_scr_act());
        lv_obj_set_pos(sw_management_line_italic, 95, 220);
        lv_obj_set_width(sw_management_line_italic, 48);
        lv_obj_set_height(sw_management_line_italic, 23);
        //lv_obj_set_style_bg_color(bold_sw, lv_color_hex(0x00ff00), LV_PART_MAIN);
        lv_obj_set_style_bg_color(sw_management_line_italic, lv_color_hex(0x00ff00), LV_STATE_CHECKED | LV_PART_INDICATOR);
        lv_obj_add_event_cb(sw_management_line_italic, sw_addition_bold_event_cb, LV_EVENT_CLICKED, NULL);

        file_management_bottom_bg = lv_obj_create(lv_scr_act());
        lv_obj_set_size(file_management_bottom_bg, 480, 24);
        lv_obj_align(file_management_bottom_bg, LV_ALIGN_TOP_LEFT, 0, 248);
        lv_obj_set_style_border_width(file_management_bottom_bg, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_radius(file_management_bottom_bg, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_color(file_management_bottom_bg, lv_color_hex(0x28536a), LV_STATE_DEFAULT);
        lv_obj_remove_style(file_management_bottom_bg, 0, LV_PART_SCROLLBAR);


        LV_FONT_DECLARE(heiFont16_1);
        label_file_management_return = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_file_management_return, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_file_management_return, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_file_management_return, "返回");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_file_management_return, "Return");
        }
        lv_obj_align(label_file_management_return, LV_ALIGN_TOP_LEFT, 140, 252);


        LV_IMG_DECLARE(get_back);
        imgbtn_file_management_get_back = lv_imgbtn_create(lv_scr_act());
        lv_imgbtn_set_src(imgbtn_file_management_get_back, LV_IMGBTN_STATE_RELEASED, NULL, &get_back, NULL);
        lv_obj_set_size(imgbtn_file_management_get_back, get_back.header.w, get_back.header.h);
        lv_obj_align(imgbtn_file_management_get_back, LV_ALIGN_TOP_LEFT, 180, 250);
        lv_obj_add_event_cb(imgbtn_file_management_get_back, button_file_management_return_event_cb, LV_EVENT_CLICKED, NULL);

        LV_IMG_DECLARE(confirm);
        imgbtn_file_management_confirm = lv_imgbtn_create(lv_scr_act());
        lv_imgbtn_set_src(imgbtn_file_management_confirm, LV_IMGBTN_STATE_RELEASED, NULL, &confirm, NULL);
        lv_obj_set_size(imgbtn_file_management_confirm, get_back.header.w, get_back.header.h);
        lv_obj_align(imgbtn_file_management_confirm, LV_ALIGN_TOP_LEFT, 250, 250);
        lv_obj_add_event_cb(imgbtn_file_management_confirm, button_file_management_confirm_event_cb, LV_EVENT_CLICKED, NULL);

        LV_FONT_DECLARE(heiFont16_1);
        label_file_management_confirm = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_file_management_confirm, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_file_management_confirm, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_file_management_confirm, "确定");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_file_management_confirm, "Confirm");
        }
        lv_obj_align(label_file_management_confirm, LV_ALIGN_TOP_LEFT, 277, 252);

        addition_text_updata();
    }
}


static void btn_speed_print_mode_confirm_event_cb(lv_event_t* e)
{
    lv_event_code_t code;
    int i=0;
    char temp_str[12] = { 0 };
    code = lv_event_get_code(e);
    if (code == LV_EVENT_CLICKED)
    {
        printf("btn_speed_print_mode_confirm_event_cb\n");
        buzzer_enable = 1;
        const char* pwd_txt = lv_textarea_get_text(pwd_text_area);
        if ((pwd_txt != NULL))
        {
            i = atoi(pwd_txt);
            if (i > 250)
            {
                i = 250;
            }
        }

        sprintf(temp_str, "%d", i);
        lv_label_set_text(label_btn_label_speed_print_mode, temp_str);

        
        lv_obj_del(typeface_head_bg);
        lv_obj_del(label_typeface_head);
        lv_obj_del(typeface_slider_bg);
        lv_obj_del(pwd_text_area);
        lv_obj_del(pwd_keyboard);

        lv_obj_del(label_typeface_return);
        lv_obj_del(btn_typeface_return);
        lv_obj_del(btn_typeface_confirm);
        lv_obj_del(label_typeface_confirm);
    }
}


static void btn_speed_print_mode_return_event_cb(lv_event_t* e)
{
    lv_event_code_t code;
    //int i=0;
    //char temp_str[12] = { 0 };
    code = lv_event_get_code(e);
    if (code == LV_EVENT_CLICKED)
    {
        printf("btn_speed_print_mode_return_event_cb\n");
        buzzer_enable = 1;   
        lv_obj_del(typeface_head_bg);
        lv_obj_del(label_typeface_head);
        lv_obj_del(typeface_slider_bg);
        lv_obj_del(pwd_text_area);
        lv_obj_del(pwd_keyboard);

        lv_obj_del(label_typeface_return);
        lv_obj_del(btn_typeface_return);
        lv_obj_del(btn_typeface_confirm);
        lv_obj_del(label_typeface_confirm);
    }
}

static void btn_label_speed_print_mode_event_cb(lv_event_t* e)
{
    lv_event_code_t code;

    code = lv_event_get_code(e);
    //int len = 0;
   // int i;
    //int offset_x;
    //int offset_y;
   // int line_num = 5;
   // int size_wide = 85;
   // int size_high = 24;
   // lv_obj_t* obj = lv_event_get_target(e);

    if (code == LV_EVENT_CLICKED)
    {
        buzzer_enable = 1;
        typeface_head_bg = lv_obj_create(lv_scr_act());
        lv_obj_set_size(typeface_head_bg, 480, 24);
        lv_obj_align(typeface_head_bg, LV_ALIGN_TOP_LEFT, 0, 0);
        lv_obj_set_style_border_width(typeface_head_bg, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_border_color(typeface_head_bg, lv_color_hex(0x9bcd9b), LV_STATE_DEFAULT); /* 设置边框颜色 */
        lv_obj_set_style_radius(typeface_head_bg, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_color(typeface_head_bg, lv_color_hex(0x1fadd3), LV_STATE_DEFAULT);

        LV_FONT_DECLARE(heiFont16_1);
        label_typeface_head = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_typeface_head, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_typeface_head, lv_color_hex(0xFFFFFF), LV_STATE_DEFAULT);
        lv_obj_align(label_typeface_head, LV_ALIGN_TOP_LEFT, 200, 4);


        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_typeface_head,  "喷印速度");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_typeface_head, "Printing speed");
        }

        typeface_slider_bg = lv_obj_create(lv_scr_act());
        lv_obj_set_size(typeface_slider_bg, 480, 224);
        lv_obj_align(typeface_slider_bg, LV_ALIGN_TOP_LEFT, 0, 24);
        lv_obj_set_style_border_width(typeface_slider_bg, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_border_color(typeface_slider_bg, lv_color_hex(0xaaaaaa), LV_STATE_DEFAULT); /* 设置边框颜色 */
        lv_obj_set_style_radius(typeface_slider_bg, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_color(typeface_slider_bg, lv_color_hex(0xaaaaaa), LV_STATE_DEFAULT);

        //数字键盘
        pwd_text_area = lv_textarea_create(lv_scr_act());
        if (pwd_text_area == NULL)
        {
            printf("[%s:%d] create pwd_text_area obj failed\n", __FUNCTION__, __LINE__);
            return;
        }

        // 密码框样式
        static lv_style_t pwd_text_style;
        lv_style_init(&pwd_text_style); // 初始化样式
        lv_style_set_radius(&pwd_text_style, 0); // 设置样式的圆角弧度
        lv_style_set_border_width(&pwd_text_style, 1); // 设置边框宽度
        lv_style_set_pad_all(&pwd_text_style, 0); // 设置样式的内部填充
        lv_style_set_text_font(&pwd_text_style, &lv_font_montserrat_18); //设置字体
        //lv_textarea_set_password_mode(pwd_text_area, true); // 文本区域开启密码模式
        lv_textarea_set_max_length(pwd_text_area, 3); // 设置可输入的文本的最大长度
        lv_obj_add_style(pwd_text_area, &pwd_text_style, 0); // 给btn_label添加样式
        lv_obj_set_size(pwd_text_area, 480, 50); // 设置对象大小
        lv_textarea_set_text(pwd_text_area, ""); // 文本框置空
        lv_obj_align(pwd_text_area, LV_ALIGN_TOP_LEFT, 0, 24);

        // 基于键盘背景对象创建密码校验提示标签
        hint_label = lv_label_create(lv_scr_act());
        if (hint_label == NULL)
        {
            printf("[%s:%d] create hint_label obj failed\n", __FUNCTION__, __LINE__);
            return;
        }

        // 密码提示文本样式
        static lv_style_t hint_label_style;
        lv_style_init(&hint_label_style); // 初始化样式
        lv_style_set_radius(&hint_label_style, 0); // 设置样式的圆角弧度
        lv_style_set_border_width(&hint_label_style, 0); //设置边框宽度
        lv_style_set_text_color(&hint_label_style, lv_palette_main(LV_PALETTE_RED));  // 字体颜色设置为红色
        lv_style_set_text_font(&hint_label_style, &lv_font_montserrat_12); //设置字体
        lv_label_set_long_mode(hint_label, LV_LABEL_LONG_SCROLL_CIRCULAR); // 长文本循环滚动
        lv_obj_add_style(hint_label, &hint_label_style, 0); // 给btn_label添加样式
        lv_obj_align(hint_label, LV_ALIGN_TOP_MID, 0, 110); // 顶部居中显示
        lv_label_set_text(hint_label, ""); // 设置文本内容

        // 基于键盘背景对象创建键盘对象
        pwd_keyboard = lv_keyboard_create(lv_scr_act());
        if (pwd_keyboard == NULL)
        {
            printf("[%s:%d] create pwd_keyboard obj failed\n", __FUNCTION__, __LINE__);
            return;
        }

        //键盘样式
        static lv_style_t pwd_kb_style;
        lv_style_init(&pwd_kb_style); // 初始化样式
        lv_style_set_radius(&pwd_kb_style, 5); // 设置样式的圆角弧度
        lv_style_set_border_width(&pwd_kb_style, 0); //设置边框宽度
        lv_style_set_bg_color(&pwd_kb_style, lv_color_hex(0xF98E2D));
        lv_style_set_text_opa(&pwd_kb_style, LV_OPA_COVER);
        lv_style_set_text_font(&pwd_kb_style, &lv_font_montserrat_20); //设置字体
        lv_obj_set_size(pwd_keyboard, 480, 174); //设置键盘大小
        lv_keyboard_set_mode(pwd_keyboard, LV_KEYBOARD_MODE_NUMBER_2); //设置键盘模式为数字键盘
        lv_keyboard_set_map(pwd_keyboard, LV_KEYBOARD_MODE_NUMBER_2, keyboard_map, keyboard_ctrl); // 设置键盘映射
        lv_keyboard_set_textarea(pwd_keyboard, pwd_text_area); // 键盘对象和文本框绑定
        lv_obj_add_style(pwd_keyboard, &pwd_kb_style, 0); // 添加样式
        lv_obj_align(pwd_keyboard, LV_ALIGN_TOP_LEFT, 0, 74);


        LV_FONT_DECLARE(heiFont16_1);
        label_typeface_return = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_typeface_return, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_typeface_return, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_typeface_return,  "返回");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_typeface_return, "Return");
        }
        lv_obj_align(label_typeface_return, LV_ALIGN_TOP_LEFT, 140, 252);

        LV_IMG_DECLARE(get_back);
        btn_typeface_return = lv_imgbtn_create(lv_scr_act());
        lv_imgbtn_set_src(btn_typeface_return, LV_IMGBTN_STATE_RELEASED, NULL, &get_back, NULL);
        lv_obj_set_size(btn_typeface_return, get_back.header.w, get_back.header.h);
        lv_obj_align(btn_typeface_return, LV_ALIGN_TOP_LEFT, 180, 250);
        lv_obj_add_event_cb(btn_typeface_return, btn_speed_print_mode_return_event_cb, LV_EVENT_CLICKED, NULL);


        LV_IMG_DECLARE(confirm);
        btn_typeface_confirm = lv_imgbtn_create(lv_scr_act());
        lv_imgbtn_set_src(btn_typeface_confirm, LV_IMGBTN_STATE_RELEASED, NULL, &confirm, NULL);
        lv_obj_set_size(btn_typeface_confirm, get_back.header.w, get_back.header.h);
        lv_obj_align(btn_typeface_confirm, LV_ALIGN_TOP_LEFT, 250, 250);
        lv_obj_add_event_cb(btn_typeface_confirm, btn_speed_print_mode_confirm_event_cb, LV_EVENT_CLICKED, NULL);

        LV_FONT_DECLARE(heiFont16_1);
        label_typeface_confirm = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_typeface_confirm, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_typeface_confirm, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_typeface_confirm,  "确定");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_typeface_confirm, "Confirm");
        }
        lv_obj_align(label_typeface_confirm, LV_ALIGN_TOP_LEFT, 277, 252);
    }
}


static void dropdown_addition_count_law_event_handler(lv_event_t* e)
{
    lv_event_code_t code = lv_event_get_code(e);
    lv_obj_t* obj = lv_event_get_target(e);
    if (code == LV_EVENT_VALUE_CHANGED)
    {
        char buf[32];
        buzzer_enable = 1;
        lv_dropdown_get_selected_str(obj, buf, sizeof(buf));
        printf("Option: %s", buf);
    }
}

static void button_addition_count_times_repetition_confirm_event_cb(lv_event_t* e)
{
    lv_event_code_t code;
    int i=0;
    char temp_str[12] = { 0 };
    code = lv_event_get_code(e);
    if (code == LV_EVENT_CLICKED)
    {
        printf("button_addition_count_times_repetition_confirm_event_cb\n");
        buzzer_enable = 1;
        const char* pwd_txt = lv_textarea_get_text(pwd_text_area);
        if ((pwd_txt != NULL))
        {
            i = atoi(pwd_txt);
            if (i > 150)
            {
                i = 150;
            }
        }

        sprintf(temp_str, "%d", i);
        lv_label_set_text(label_btn_addition_count_times_repetition, temp_str);

       
        lv_obj_del(typeface_head_bg);
        lv_obj_del(label_typeface_head);
        lv_obj_del(typeface_slider_bg);
        lv_obj_del(pwd_text_area);
        lv_obj_del(pwd_keyboard);

        lv_obj_del(label_typeface_return);
        lv_obj_del(btn_typeface_return);
        lv_obj_del(btn_typeface_confirm);
        lv_obj_del(label_typeface_confirm);
    }
}



static void button_addition_count_times_repetition_return_event_cb(lv_event_t* e)
{
    lv_event_code_t code;

    code = lv_event_get_code(e);
    if (code == LV_EVENT_CLICKED)
    {
        printf("button_addition_count_times_repetition_return_event_cb\n");
        buzzer_enable = 1;
        lv_obj_del(typeface_head_bg);
        lv_obj_del(label_typeface_head);
        lv_obj_del(typeface_slider_bg);
        lv_obj_del(pwd_text_area);
        lv_obj_del(pwd_keyboard);

        lv_obj_del(label_typeface_return);
        lv_obj_del(btn_typeface_return);
        lv_obj_del(btn_typeface_confirm);
        lv_obj_del(label_typeface_confirm);
    }
}




static void btn_addition_count_times_repetition_mode_event_cb(lv_event_t* e)
{
    lv_event_code_t code;

    code = lv_event_get_code(e);

    if (code == LV_EVENT_CLICKED)
    {
        printf("btn_addition_count_times_repetition_mode_event_cb\n");
        buzzer_enable = 1;
        typeface_head_bg = lv_obj_create(lv_scr_act());
        lv_obj_set_size(typeface_head_bg, 480, 24);
        lv_obj_align(typeface_head_bg, LV_ALIGN_TOP_LEFT, 0, 0);
        lv_obj_set_style_border_width(typeface_head_bg, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_border_color(typeface_head_bg, lv_color_hex(0x9bcd9b), LV_STATE_DEFAULT); /* 设置边框颜色 */
        lv_obj_set_style_radius(typeface_head_bg, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_color(typeface_head_bg, lv_color_hex(0x1fadd3), LV_STATE_DEFAULT);

        LV_FONT_DECLARE(heiFont16_1);
        label_typeface_head = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_typeface_head, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_typeface_head, lv_color_hex(0xFFFFFF), LV_STATE_DEFAULT);
        lv_obj_align(label_typeface_head, LV_ALIGN_TOP_LEFT, 200, 4);
       
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_typeface_head,  "重复");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_typeface_head, "Repetition");
        }
        typeface_slider_bg = lv_obj_create(lv_scr_act());
        lv_obj_set_size(typeface_slider_bg, 480, 224);
        lv_obj_align(typeface_slider_bg, LV_ALIGN_TOP_LEFT, 0, 24);
        lv_obj_set_style_border_width(typeface_slider_bg, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_border_color(typeface_slider_bg, lv_color_hex(0xaaaaaa), LV_STATE_DEFAULT); /* 设置边框颜色 */
        lv_obj_set_style_radius(typeface_slider_bg, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_color(typeface_slider_bg, lv_color_hex(0xaaaaaa), LV_STATE_DEFAULT);

        //数字键盘
        pwd_text_area = lv_textarea_create(lv_scr_act());
        if (pwd_text_area == NULL)
        {
            printf("[%s:%d] create pwd_text_area obj failed\n", __FUNCTION__, __LINE__);
            return;
        }

        // 密码框样式
        static lv_style_t pwd_text_style;
        lv_style_init(&pwd_text_style); // 初始化样式
        lv_style_set_radius(&pwd_text_style, 0); // 设置样式的圆角弧度
        lv_style_set_border_width(&pwd_text_style, 1); // 设置边框宽度
        lv_style_set_pad_all(&pwd_text_style, 0); // 设置样式的内部填充
        lv_style_set_text_font(&pwd_text_style, &lv_font_montserrat_18); //设置字体
        //lv_textarea_set_password_mode(pwd_text_area, true); // 文本区域开启密码模式
        lv_textarea_set_max_length(pwd_text_area, 3); // 设置可输入的文本的最大长度
        lv_obj_add_style(pwd_text_area, &pwd_text_style, 0); // 给btn_label添加样式
        lv_obj_set_size(pwd_text_area, 480, 50); // 设置对象大小
        lv_textarea_set_text(pwd_text_area, ""); // 文本框置空
        lv_obj_align(pwd_text_area, LV_ALIGN_TOP_LEFT, 0, 24);

        // 基于键盘背景对象创建密码校验提示标签
        hint_label = lv_label_create(lv_scr_act());
        if (hint_label == NULL)
        {
            printf("[%s:%d] create hint_label obj failed\n", __FUNCTION__, __LINE__);
            return;
        }

        // 密码提示文本样式
        static lv_style_t hint_label_style;
        lv_style_init(&hint_label_style); // 初始化样式
        lv_style_set_radius(&hint_label_style, 0); // 设置样式的圆角弧度
        lv_style_set_border_width(&hint_label_style, 0); //设置边框宽度
        lv_style_set_text_color(&hint_label_style, lv_palette_main(LV_PALETTE_RED));  // 字体颜色设置为红色
        lv_style_set_text_font(&hint_label_style, &lv_font_montserrat_12); //设置字体
        lv_label_set_long_mode(hint_label, LV_LABEL_LONG_SCROLL_CIRCULAR); // 长文本循环滚动
        lv_obj_add_style(hint_label, &hint_label_style, 0); // 给btn_label添加样式
        lv_obj_align(hint_label, LV_ALIGN_TOP_MID, 0, 110); // 顶部居中显示
        lv_label_set_text(hint_label, ""); // 设置文本内容

        // 基于键盘背景对象创建键盘对象
        pwd_keyboard = lv_keyboard_create(lv_scr_act());
        if (pwd_keyboard == NULL)
        {
            printf("[%s:%d] create pwd_keyboard obj failed\n", __FUNCTION__, __LINE__);
            return;
        }

        //键盘样式
        static lv_style_t pwd_kb_style;
        lv_style_init(&pwd_kb_style); // 初始化样式
        lv_style_set_radius(&pwd_kb_style, 5); // 设置样式的圆角弧度
        lv_style_set_border_width(&pwd_kb_style, 0); //设置边框宽度
        lv_style_set_bg_color(&pwd_kb_style, lv_color_hex(0xF98E2D));
        lv_style_set_text_opa(&pwd_kb_style, LV_OPA_COVER);
        lv_style_set_text_font(&pwd_kb_style, &lv_font_montserrat_20); //设置字体
        lv_obj_set_size(pwd_keyboard, 480, 174); //设置键盘大小
        lv_keyboard_set_mode(pwd_keyboard, LV_KEYBOARD_MODE_NUMBER_2); //设置键盘模式为数字键盘
        lv_keyboard_set_map(pwd_keyboard, LV_KEYBOARD_MODE_NUMBER_2, keyboard_map, keyboard_ctrl); // 设置键盘映射
        lv_keyboard_set_textarea(pwd_keyboard, pwd_text_area); // 键盘对象和文本框绑定
        lv_obj_add_style(pwd_keyboard, &pwd_kb_style, 0); // 添加样式
        lv_obj_align(pwd_keyboard, LV_ALIGN_TOP_LEFT, 0, 74);


        LV_FONT_DECLARE(heiFont16_1);
        label_typeface_return = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_typeface_return, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_typeface_return, lv_color_hex(0xffffff), LV_STATE_DEFAULT);

        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_typeface_return, "返回");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_typeface_return, "Return");
        }
        lv_obj_align(label_typeface_return, LV_ALIGN_TOP_LEFT, 140, 252);

        LV_IMG_DECLARE(get_back);
        btn_typeface_return = lv_imgbtn_create(lv_scr_act());
        lv_imgbtn_set_src(btn_typeface_return, LV_IMGBTN_STATE_RELEASED, NULL, &get_back, NULL);
        lv_obj_set_size(btn_typeface_return, get_back.header.w, get_back.header.h);
        lv_obj_align(btn_typeface_return, LV_ALIGN_TOP_LEFT, 180, 250);
        lv_obj_add_event_cb(btn_typeface_return, button_addition_count_times_repetition_return_event_cb, LV_EVENT_CLICKED, NULL);


        LV_IMG_DECLARE(confirm);
        btn_typeface_confirm = lv_imgbtn_create(lv_scr_act());
        lv_imgbtn_set_src(btn_typeface_confirm, LV_IMGBTN_STATE_RELEASED, NULL, &confirm, NULL);
        lv_obj_set_size(btn_typeface_confirm, get_back.header.w, get_back.header.h);
        lv_obj_align(btn_typeface_confirm, LV_ALIGN_TOP_LEFT, 250, 250);
        lv_obj_add_event_cb(btn_typeface_confirm, button_addition_count_times_repetition_confirm_event_cb, LV_EVENT_CLICKED, NULL);

        LV_FONT_DECLARE(heiFont16_1);
        label_typeface_confirm = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_typeface_confirm, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_typeface_confirm, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_typeface_confirm, "确定");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_typeface_confirm, "Confirm");
        }
        lv_obj_align(label_typeface_confirm, LV_ALIGN_TOP_LEFT, 277, 252);
    }
}



static void button_addition_count_typeface_return_event_cb(lv_event_t* e)
{
    lv_event_code_t code;
    int i;
    code = lv_event_get_code(e);
    if (code == LV_EVENT_CLICKED)
    {
        printf("button_addition_count_typeface_return_event_cb\n");
        buzzer_enable = 1;

        lv_obj_del(typeface_head_bg);
        lv_obj_del(label_typeface_return);
        lv_obj_del(btn_typeface_return);
        lv_obj_del(btn_typeface_confirm);
        lv_obj_del(label_typeface_confirm);
        lv_obj_del(label_typeface_head);

        for (i = 0; i < TYPEFACE_NUMBER; i++)
        {
            lv_obj_del(typeface_obj[i].obj_typeface_label);
            lv_obj_del(typeface_obj[i].obj_typeface_btn);
        }

        lv_obj_del(win_content_typeface);
        lv_obj_del(win_obj_typeface);
        lv_obj_del(left_stop_img_typeface);
        lv_obj_del(right_stop_img_typeface);
        lv_obj_del(typeface_slider_bg);
        lv_obj_del(slider_typeface);
    }
}




static void button_addition_count_typeface_confirm_event_cb(lv_event_t* e)
{
    lv_event_code_t code;
    int i;
    code = lv_event_get_code(e);
    if (code == LV_EVENT_CLICKED)
    {
        printf("button_addition_count_typeface_confirm_event_cb\n");
        buzzer_enable = 1;
        lv_label_set_text(label_btn_addition_count_typeface, typeface_name[g_typeface]);

        lv_obj_del(typeface_head_bg);
        lv_obj_del(label_typeface_return);
        lv_obj_del(btn_typeface_return);
        lv_obj_del(btn_typeface_confirm);
        lv_obj_del(label_typeface_confirm);
        lv_obj_del(label_typeface_head);

        for (i = 0; i < TYPEFACE_NUMBER; i++)
        {
            lv_obj_del(typeface_obj[i].obj_typeface_label);
            lv_obj_del(typeface_obj[i].obj_typeface_btn);
        }

        lv_obj_del(win_content_typeface);
        lv_obj_del(win_obj_typeface);
        lv_obj_del(left_stop_img_typeface);
        lv_obj_del(right_stop_img_typeface);
        lv_obj_del(typeface_slider_bg);
        lv_obj_del(slider_typeface);
    }
}




static void btn_addition_count_typeface_event_cb(lv_event_t* e)
{
    lv_event_code_t code;

    code = lv_event_get_code(e);
    int i;
    int size_wide = 85;
    int size_high = 24;

    if (code == LV_EVENT_CLICKED)
    {
        printf("btn_addition_count_typeface_event_cb\n");
        buzzer_enable = 1;
        typeface_head_bg = lv_obj_create(lv_scr_act());
        lv_obj_set_size(typeface_head_bg, 480, 24);
        lv_obj_align(typeface_head_bg, LV_ALIGN_TOP_LEFT, 0, 0);
        lv_obj_set_style_border_width(typeface_head_bg, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_border_color(typeface_head_bg, lv_color_hex(0x9bcd9b), LV_STATE_DEFAULT); /* 设置边框颜色 */
        lv_obj_set_style_radius(typeface_head_bg, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_color(typeface_head_bg, lv_color_hex(0x1fadd3), LV_STATE_DEFAULT);

        LV_FONT_DECLARE(heiFont16_1);
        label_typeface_head = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_typeface_head, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_typeface_head, lv_color_hex(0xFFFFFF), LV_STATE_DEFAULT);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_typeface_head,  "字体");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_typeface_head, "Typeface");
        }
        lv_obj_align(label_typeface_head, LV_ALIGN_TOP_LEFT, 200, 4);

        win_obj_typeface = lv_obj_create(lv_scr_act());
        lv_obj_align(win_obj_typeface, LV_ALIGN_TOP_LEFT, 0, 24);
        lv_obj_set_size(win_obj_typeface, 480, 224);
        lv_obj_set_style_bg_color(win_obj_typeface, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        lv_obj_set_style_bg_opa(win_obj_typeface, LV_OPA_COVER, LV_STATE_DEFAULT);
        lv_obj_set_style_border_width(win_obj_typeface, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_border_color(win_obj_typeface, lv_color_hex(0xcccccc), LV_STATE_DEFAULT); /* 设置边框颜色 */
        lv_obj_clear_flag(win_obj_typeface, LV_OBJ_FLAG_SCROLLABLE);
        lv_obj_set_style_radius(win_obj_typeface, 0, LV_STATE_DEFAULT); /* 设置圆角 */

        win_content_typeface = lv_obj_create(win_obj_typeface);
        lv_obj_set_size(win_content_typeface, 460, 500);
        lv_obj_align(win_content_typeface, LV_ALIGN_TOP_LEFT, -15, -15);
        lv_obj_set_style_bg_color(win_content_typeface, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        lv_obj_set_style_border_width(win_content_typeface, 2, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_border_color(win_content_typeface, lv_color_hex(0xcccccc), LV_STATE_DEFAULT); /* 设置边框颜色 */
        lv_obj_clear_flag(win_content_typeface, LV_OBJ_FLAG_SCROLLABLE);
        lv_obj_set_style_radius(win_content_typeface, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_pad_all(win_content_typeface, 0, LV_STATE_DEFAULT);

        // LV_#if 0IMG_DECLARE(Slider_base_color);
        // lv_obj_t* Slider_base_color_img = lv_img_create(lv_scr_act());
       //  lv_img_set_src(Slider_base_color_img, &Slider_base_color);
       //  lv_obj_align(Slider_base_color_img, LV_ALIGN_TOP_LEFT, 0, 183);

        typeface_slider_bg = lv_obj_create(lv_scr_act());
        lv_obj_set_size(typeface_slider_bg, 20, 224);
        lv_obj_align(typeface_slider_bg, LV_ALIGN_TOP_LEFT, 460, 24);
        lv_obj_set_style_border_width(typeface_slider_bg, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_border_color(typeface_slider_bg, lv_color_hex(0xaaaaaa), LV_STATE_DEFAULT); /* 设置边框颜色 */
        lv_obj_set_style_radius(typeface_slider_bg, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_color(typeface_slider_bg, lv_color_hex(0xaaaaaa), LV_STATE_DEFAULT);

        //左滑块停止
        LV_IMG_DECLARE(left_stop_typeface);
        left_stop_img_typeface = lv_img_create(lv_scr_act());
        lv_img_set_src(left_stop_img_typeface, &left_stop_typeface);
        lv_obj_align(left_stop_img_typeface, LV_ALIGN_TOP_LEFT, 460, 228);

        slider_show_typeface();

        //右滑块停止
        LV_IMG_DECLARE(right_stop_typeface);
        right_stop_img_typeface = lv_img_create(lv_scr_act());
        lv_img_set_src(right_stop_img_typeface, &right_stop_typeface);
        lv_obj_align(right_stop_img_typeface, LV_ALIGN_TOP_LEFT, 460, 24);


        for (i = 0; i < TYPEFACE_NUMBER; i++)
        {
            typeface_obj[i].obj_typeface_btn = lv_btn_create(win_content_typeface);
            lv_obj_set_size(typeface_obj[i].obj_typeface_btn, size_wide, size_high);
            lv_obj_align(typeface_obj[i].obj_typeface_btn, LV_ALIGN_TOP_LEFT, (i % 5 + 1) * 5 + (i % 5) * size_wide, (i / 5 + 1) * 5 + i / 5 * size_high);
            lv_obj_set_style_border_width(typeface_obj[i].obj_typeface_btn, 1, LV_PART_MAIN); /* 设置边框宽度 */
            lv_obj_set_style_border_color(typeface_obj[i].obj_typeface_btn, lv_color_hex(0x000000), LV_PART_MAIN); /* 设置边框颜色 */
            lv_obj_set_style_radius(typeface_obj[i].obj_typeface_btn, 0, LV_PART_MAIN); /* 设置圆角 */
            lv_obj_set_style_bg_color(typeface_obj[i].obj_typeface_btn, lv_color_hex(0xffffff), LV_PART_MAIN);
            lv_obj_set_style_shadow_width(typeface_obj[i].obj_typeface_btn, 0, LV_PART_MAIN);
            lv_obj_add_event_cb(typeface_obj[i].obj_typeface_btn, button_typeface_event_cb, LV_EVENT_ALL, NULL);

            LV_FONT_DECLARE(heiFont16_1);
            typeface_obj[i].obj_typeface_label = lv_label_create(typeface_obj[i].obj_typeface_btn);
            lv_obj_set_style_text_font(typeface_obj[i].obj_typeface_label, &heiFont16_1, LV_STATE_DEFAULT);
            lv_label_set_text(typeface_obj[i].obj_typeface_label, typeface_name[i]);
            lv_obj_center(typeface_obj[i].obj_typeface_label);
            lv_obj_set_style_text_color(typeface_obj[i].obj_typeface_label, lv_color_hex(0x000000), LV_STATE_DEFAULT);
        }

        LV_FONT_DECLARE(heiFont16_1);
        label_typeface_return = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_typeface_return, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_typeface_return, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_typeface_return,  "返回");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_typeface_return, "Return");
        }
        lv_obj_align(label_typeface_return, LV_ALIGN_TOP_LEFT, 140, 252);

        LV_IMG_DECLARE(get_back);
        btn_typeface_return = lv_imgbtn_create(lv_scr_act());
        lv_imgbtn_set_src(btn_typeface_return, LV_IMGBTN_STATE_RELEASED, NULL, &get_back, NULL);
        lv_obj_set_size(btn_typeface_return, get_back.header.w, get_back.header.h);
        lv_obj_align(btn_typeface_return, LV_ALIGN_TOP_LEFT, 180, 250);
        lv_obj_add_event_cb(btn_typeface_return, button_addition_count_typeface_return_event_cb, LV_EVENT_CLICKED, NULL);


        LV_IMG_DECLARE(confirm);
        btn_typeface_confirm = lv_imgbtn_create(lv_scr_act());
        lv_imgbtn_set_src(btn_typeface_confirm, LV_IMGBTN_STATE_RELEASED, NULL, &confirm, NULL);
        lv_obj_set_size(btn_typeface_confirm, get_back.header.w, get_back.header.h);
        lv_obj_align(btn_typeface_confirm, LV_ALIGN_TOP_LEFT, 250, 250);
        lv_obj_add_event_cb(btn_typeface_confirm, button_addition_count_typeface_confirm_event_cb, LV_EVENT_CLICKED, NULL);

        LV_FONT_DECLARE(heiFont16_1);
        label_typeface_confirm = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_typeface_confirm, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_typeface_confirm, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_typeface_confirm,  "确定");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_typeface_confirm, "Confirm");
        }
        lv_obj_align(label_typeface_confirm, LV_ALIGN_TOP_LEFT, 277, 252);
    }
}




static void button_addition_count_size_confirm_event_cb(lv_event_t* e)
{
    lv_event_code_t code;
    int i=0;
    char temp_str[12] = { 0 };
    code = lv_event_get_code(e);
    if (code == LV_EVENT_CLICKED)
    {
        printf("button_addition_count_size_confirm_event_cb\n");
        buzzer_enable = 1;
        const char* pwd_txt = lv_textarea_get_text(pwd_text_area);
        if ((pwd_txt != NULL))
        {
            i = atoi(pwd_txt);
            if (i > 200)
            {
                i = 200;
            }
        }

        sprintf(temp_str, "%d", i);
        lv_label_set_text(label_btn_addition_count_size, temp_str);

       
        lv_obj_del(typeface_head_bg);
        lv_obj_del(label_typeface_head);
        lv_obj_del(typeface_slider_bg);
        lv_obj_del(pwd_text_area);
        lv_obj_del(pwd_keyboard);

        lv_obj_del(label_typeface_return);
        lv_obj_del(btn_typeface_return);
        lv_obj_del(btn_typeface_confirm);
        lv_obj_del(label_typeface_confirm);
    }
}



static void btn_addition_count_size_event_cb(lv_event_t* e)
{
    lv_event_code_t code;

    code = lv_event_get_code(e);

    if (code == LV_EVENT_CLICKED)
    {
        printf("btn_addition_count_size_event_cb\n");

        buzzer_enable = 1;

        typeface_head_bg = lv_obj_create(lv_scr_act());
        lv_obj_set_size(typeface_head_bg, 480, 24);
        lv_obj_align(typeface_head_bg, LV_ALIGN_TOP_LEFT, 0, 0);
        lv_obj_set_style_border_width(typeface_head_bg, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_border_color(typeface_head_bg, lv_color_hex(0x9bcd9b), LV_STATE_DEFAULT); /* 设置边框颜色 */
        lv_obj_set_style_radius(typeface_head_bg, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_color(typeface_head_bg, lv_color_hex(0x1fadd3), LV_STATE_DEFAULT);

        LV_FONT_DECLARE(heiFont16_1);
        label_typeface_head = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_typeface_head, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_typeface_head, lv_color_hex(0xFFFFFF), LV_STATE_DEFAULT);
        lv_obj_align(label_typeface_head, LV_ALIGN_TOP_LEFT, 200, 4);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_typeface_head,  "字号");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_typeface_head, "Size");
        }
        typeface_slider_bg = lv_obj_create(lv_scr_act());
        lv_obj_set_size(typeface_slider_bg, 480, 224);
        lv_obj_align(typeface_slider_bg, LV_ALIGN_TOP_LEFT, 0, 24);
        lv_obj_set_style_border_width(typeface_slider_bg, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_border_color(typeface_slider_bg, lv_color_hex(0xaaaaaa), LV_STATE_DEFAULT); /* 设置边框颜色 */
        lv_obj_set_style_radius(typeface_slider_bg, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_color(typeface_slider_bg, lv_color_hex(0xaaaaaa), LV_STATE_DEFAULT);

        //数字键盘
        pwd_text_area = lv_textarea_create(lv_scr_act());
        if (pwd_text_area == NULL)
        {
            printf("[%s:%d] create pwd_text_area obj failed\n", __FUNCTION__, __LINE__);
            return;
        }

        // 密码框样式
        static lv_style_t pwd_text_style;
        lv_style_init(&pwd_text_style); // 初始化样式
        lv_style_set_radius(&pwd_text_style, 0); // 设置样式的圆角弧度
        lv_style_set_border_width(&pwd_text_style, 1); // 设置边框宽度
        lv_style_set_pad_all(&pwd_text_style, 0); // 设置样式的内部填充
        lv_style_set_text_font(&pwd_text_style, &lv_font_montserrat_18); //设置字体
        //lv_textarea_set_password_mode(pwd_text_area, true); // 文本区域开启密码模式
        lv_textarea_set_max_length(pwd_text_area, 3); // 设置可输入的文本的最大长度
        lv_obj_add_style(pwd_text_area, &pwd_text_style, 0); // 给btn_label添加样式
        lv_obj_set_size(pwd_text_area, 480, 50); // 设置对象大小
        lv_textarea_set_text(pwd_text_area, ""); // 文本框置空
        lv_obj_align(pwd_text_area, LV_ALIGN_TOP_LEFT, 0, 24);

        // 基于键盘背景对象创建密码校验提示标签
        hint_label = lv_label_create(lv_scr_act());
        if (hint_label == NULL)
        {
            printf("[%s:%d] create hint_label obj failed\n", __FUNCTION__, __LINE__);
            return;
        }

        // 密码提示文本样式
        static lv_style_t hint_label_style;
        lv_style_init(&hint_label_style); // 初始化样式
        lv_style_set_radius(&hint_label_style, 0); // 设置样式的圆角弧度
        lv_style_set_border_width(&hint_label_style, 0); //设置边框宽度
        lv_style_set_text_color(&hint_label_style, lv_palette_main(LV_PALETTE_RED));  // 字体颜色设置为红色
        lv_style_set_text_font(&hint_label_style, &lv_font_montserrat_12); //设置字体
        lv_label_set_long_mode(hint_label, LV_LABEL_LONG_SCROLL_CIRCULAR); // 长文本循环滚动
        lv_obj_add_style(hint_label, &hint_label_style, 0); // 给btn_label添加样式
        lv_obj_align(hint_label, LV_ALIGN_TOP_MID, 0, 110); // 顶部居中显示
        lv_label_set_text(hint_label, ""); // 设置文本内容

        // 基于键盘背景对象创建键盘对象
        pwd_keyboard = lv_keyboard_create(lv_scr_act());
        if (pwd_keyboard == NULL)
        {
            printf("[%s:%d] create pwd_keyboard obj failed\n", __FUNCTION__, __LINE__);
            return;
        }

        //键盘样式
        static lv_style_t pwd_kb_style;
        lv_style_init(&pwd_kb_style); // 初始化样式
        lv_style_set_radius(&pwd_kb_style, 5); // 设置样式的圆角弧度
        lv_style_set_border_width(&pwd_kb_style, 0); //设置边框宽度
        lv_style_set_bg_color(&pwd_kb_style, lv_color_hex(0xF98E2D));
        lv_style_set_text_opa(&pwd_kb_style, LV_OPA_COVER);
        lv_style_set_text_font(&pwd_kb_style, &lv_font_montserrat_20); //设置字体
        lv_obj_set_size(pwd_keyboard, 480, 174); //设置键盘大小
        lv_keyboard_set_mode(pwd_keyboard, LV_KEYBOARD_MODE_NUMBER_2); //设置键盘模式为数字键盘
        lv_keyboard_set_map(pwd_keyboard, LV_KEYBOARD_MODE_NUMBER_2, keyboard_map, keyboard_ctrl); // 设置键盘映射
        lv_keyboard_set_textarea(pwd_keyboard, pwd_text_area); // 键盘对象和文本框绑定
        lv_obj_add_style(pwd_keyboard, &pwd_kb_style, 0); // 添加样式
        lv_obj_align(pwd_keyboard, LV_ALIGN_TOP_LEFT, 0, 74);


        LV_FONT_DECLARE(heiFont16_1);
        label_typeface_return = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_typeface_return, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_typeface_return, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_typeface_return,  "返回");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_typeface_return, "Return");
        }
        lv_obj_align(label_typeface_return, LV_ALIGN_TOP_LEFT, 140, 252);

        LV_IMG_DECLARE(get_back);
        btn_typeface_return = lv_imgbtn_create(lv_scr_act());
        lv_imgbtn_set_src(btn_typeface_return, LV_IMGBTN_STATE_RELEASED, NULL, &get_back, NULL);
        lv_obj_set_size(btn_typeface_return, get_back.header.w, get_back.header.h);
        lv_obj_align(btn_typeface_return, LV_ALIGN_TOP_LEFT, 180, 250);
        lv_obj_add_event_cb(btn_typeface_return, button_work_space_return_event_cb, LV_EVENT_CLICKED, NULL);


        LV_IMG_DECLARE(confirm);
        btn_typeface_confirm = lv_imgbtn_create(lv_scr_act());
        lv_imgbtn_set_src(btn_typeface_confirm, LV_IMGBTN_STATE_RELEASED, NULL, &confirm, NULL);
        lv_obj_set_size(btn_typeface_confirm, get_back.header.w, get_back.header.h);
        lv_obj_align(btn_typeface_confirm, LV_ALIGN_TOP_LEFT, 250, 250);
        lv_obj_add_event_cb(btn_typeface_confirm, button_addition_count_size_confirm_event_cb, LV_EVENT_CLICKED, NULL);

        LV_FONT_DECLARE(heiFont16_1);
        label_typeface_confirm = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_typeface_confirm, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_typeface_confirm, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_typeface_confirm,  "确定");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_typeface_confirm, "Confirm");
        }
        lv_obj_align(label_typeface_confirm, LV_ALIGN_TOP_LEFT, 277, 252);
    }
}



static void btn_addition_count_space_confirm_event_cb(lv_event_t* e)
{
    lv_event_code_t code;
    int i=0;
    char temp_str[12] = { 0 };
    code = lv_event_get_code(e);
    if (code == LV_EVENT_CLICKED)
    {
        printf("btn_addition_count_space_confirm_event_cb\n");
        buzzer_enable = 1;
        const char* pwd_txt = lv_textarea_get_text(pwd_text_area);
        if ((pwd_txt != NULL))
        {
            i = atoi(pwd_txt);
            if (i > 100)
            {
                i = 100;
            }
        }

        sprintf(temp_str, "%d", i);
        lv_label_set_text(label_btn_addition_count_space, temp_str);

    
        lv_obj_del(typeface_head_bg);
        lv_obj_del(label_typeface_head);
        lv_obj_del(typeface_slider_bg);
        lv_obj_del(pwd_text_area);
        lv_obj_del(pwd_keyboard);

        lv_obj_del(label_typeface_return);
        lv_obj_del(btn_typeface_return);
        lv_obj_del(btn_typeface_confirm);
        lv_obj_del(label_typeface_confirm);
    }
}




static void btn_addition_count_space_return_event_cb(lv_event_t* e)
{
    lv_event_code_t code;
    code = lv_event_get_code(e);
    if (code == LV_EVENT_CLICKED)
    {
        printf("btn_addition_count_space_return_event_cb\n");
        buzzer_enable = 1;

        lv_obj_del(typeface_head_bg);
        lv_obj_del(label_typeface_head);
        lv_obj_del(typeface_slider_bg);
        lv_obj_del(pwd_text_area);
        lv_obj_del(pwd_keyboard);

        lv_obj_del(label_typeface_return);
        lv_obj_del(btn_typeface_return);
        lv_obj_del(btn_typeface_confirm);
        lv_obj_del(label_typeface_confirm);
    }
}




static void btn_addition_count_space_event_cb(lv_event_t* e)
{
    lv_event_code_t code;

    code = lv_event_get_code(e);

    if (code == LV_EVENT_CLICKED)
    {
        printf("btn_addition_count_space_event_cb\n");
        buzzer_enable = 1;
        typeface_head_bg = lv_obj_create(lv_scr_act());
        lv_obj_set_size(typeface_head_bg, 480, 24);
        lv_obj_align(typeface_head_bg, LV_ALIGN_TOP_LEFT, 0, 0);
        lv_obj_set_style_border_width(typeface_head_bg, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_border_color(typeface_head_bg, lv_color_hex(0x9bcd9b), LV_STATE_DEFAULT); /* 设置边框颜色 */
        lv_obj_set_style_radius(typeface_head_bg, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_color(typeface_head_bg, lv_color_hex(0x1fadd3), LV_STATE_DEFAULT);

        LV_FONT_DECLARE(heiFont16_1);
        label_typeface_head = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_typeface_head, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_typeface_head, lv_color_hex(0xFFFFFF), LV_STATE_DEFAULT);
        lv_obj_align(label_typeface_head, LV_ALIGN_TOP_LEFT, 200, 4);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_typeface_head,  "间距");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_typeface_head, "Space");
        }

        typeface_slider_bg = lv_obj_create(lv_scr_act());
        lv_obj_set_size(typeface_slider_bg, 480, 224);
        lv_obj_align(typeface_slider_bg, LV_ALIGN_TOP_LEFT, 0, 24);
        lv_obj_set_style_border_width(typeface_slider_bg, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_border_color(typeface_slider_bg, lv_color_hex(0xaaaaaa), LV_STATE_DEFAULT); /* 设置边框颜色 */
        lv_obj_set_style_radius(typeface_slider_bg, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_color(typeface_slider_bg, lv_color_hex(0xaaaaaa), LV_STATE_DEFAULT);

        //数字键盘
        pwd_text_area = lv_textarea_create(lv_scr_act());
        if (pwd_text_area == NULL)
        {
            printf("[%s:%d] create pwd_text_area obj failed\n", __FUNCTION__, __LINE__);
            return;
        }

        // 密码框样式
        static lv_style_t pwd_text_style;
        lv_style_init(&pwd_text_style); // 初始化样式
        lv_style_set_radius(&pwd_text_style, 0); // 设置样式的圆角弧度
        lv_style_set_border_width(&pwd_text_style, 1); // 设置边框宽度
        lv_style_set_pad_all(&pwd_text_style, 0); // 设置样式的内部填充
        lv_style_set_text_font(&pwd_text_style, &lv_font_montserrat_18); //设置字体
        //lv_textarea_set_password_mode(pwd_text_area, true); // 文本区域开启密码模式
        lv_textarea_set_max_length(pwd_text_area, 3); // 设置可输入的文本的最大长度
        lv_obj_add_style(pwd_text_area, &pwd_text_style, 0); // 给btn_label添加样式
        lv_obj_set_size(pwd_text_area, 480, 50); // 设置对象大小
        lv_textarea_set_text(pwd_text_area, ""); // 文本框置空
        lv_obj_align(pwd_text_area, LV_ALIGN_TOP_LEFT, 0, 24);

        // 基于键盘背景对象创建密码校验提示标签
        hint_label = lv_label_create(lv_scr_act());
        if (hint_label == NULL)
        {
            printf("[%s:%d] create hint_label obj failed\n", __FUNCTION__, __LINE__);
            return;
        }

        // 密码提示文本样式
        static lv_style_t hint_label_style;
        lv_style_init(&hint_label_style); // 初始化样式
        lv_style_set_radius(&hint_label_style, 0); // 设置样式的圆角弧度
        lv_style_set_border_width(&hint_label_style, 0); //设置边框宽度
        lv_style_set_text_color(&hint_label_style, lv_palette_main(LV_PALETTE_RED));  // 字体颜色设置为红色
        lv_style_set_text_font(&hint_label_style, &lv_font_montserrat_12); //设置字体
        lv_label_set_long_mode(hint_label, LV_LABEL_LONG_SCROLL_CIRCULAR); // 长文本循环滚动
        lv_obj_add_style(hint_label, &hint_label_style, 0); // 给btn_label添加样式
        lv_obj_align(hint_label, LV_ALIGN_TOP_MID, 0, 110); // 顶部居中显示
        lv_label_set_text(hint_label, ""); // 设置文本内容

        // 基于键盘背景对象创建键盘对象
        pwd_keyboard = lv_keyboard_create(lv_scr_act());
        if (pwd_keyboard == NULL)
        {
            printf("[%s:%d] create pwd_keyboard obj failed\n", __FUNCTION__, __LINE__);
            return;
        }

        //键盘样式
        static lv_style_t pwd_kb_style;
        lv_style_init(&pwd_kb_style); // 初始化样式
        lv_style_set_radius(&pwd_kb_style, 5); // 设置样式的圆角弧度
        lv_style_set_border_width(&pwd_kb_style, 0); //设置边框宽度
        lv_style_set_bg_color(&pwd_kb_style, lv_color_hex(0xF98E2D));
        lv_style_set_text_opa(&pwd_kb_style, LV_OPA_COVER);
        lv_style_set_text_font(&pwd_kb_style, &lv_font_montserrat_20); //设置字体
        lv_obj_set_size(pwd_keyboard, 480, 174); //设置键盘大小
        lv_keyboard_set_mode(pwd_keyboard, LV_KEYBOARD_MODE_NUMBER_2); //设置键盘模式为数字键盘
        lv_keyboard_set_map(pwd_keyboard, LV_KEYBOARD_MODE_NUMBER_2, keyboard_map, keyboard_ctrl); // 设置键盘映射
        lv_keyboard_set_textarea(pwd_keyboard, pwd_text_area); // 键盘对象和文本框绑定
        lv_obj_add_style(pwd_keyboard, &pwd_kb_style, 0); // 添加样式
        lv_obj_align(pwd_keyboard, LV_ALIGN_TOP_LEFT, 0, 74);


        LV_FONT_DECLARE(heiFont16_1);
        label_typeface_return = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_typeface_return, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_typeface_return, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_typeface_return,  "返回");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_typeface_return, "Return");
        }
        lv_obj_align(label_typeface_return, LV_ALIGN_TOP_LEFT, 140, 252);

        LV_IMG_DECLARE(get_back);
        btn_typeface_return = lv_imgbtn_create(lv_scr_act());
        lv_imgbtn_set_src(btn_typeface_return, LV_IMGBTN_STATE_RELEASED, NULL, &get_back, NULL);
        lv_obj_set_size(btn_typeface_return, get_back.header.w, get_back.header.h);
        lv_obj_align(btn_typeface_return, LV_ALIGN_TOP_LEFT, 180, 250);
        lv_obj_add_event_cb(btn_typeface_return, btn_addition_count_space_return_event_cb, LV_EVENT_CLICKED, NULL);


        LV_IMG_DECLARE(confirm);
        btn_typeface_confirm = lv_imgbtn_create(lv_scr_act());
        lv_imgbtn_set_src(btn_typeface_confirm, LV_IMGBTN_STATE_RELEASED, NULL, &confirm, NULL);
        lv_obj_set_size(btn_typeface_confirm, get_back.header.w, get_back.header.h);
        lv_obj_align(btn_typeface_confirm, LV_ALIGN_TOP_LEFT, 250, 250);
        lv_obj_add_event_cb(btn_typeface_confirm, btn_addition_count_space_confirm_event_cb, LV_EVENT_CLICKED, NULL);

        LV_FONT_DECLARE(heiFont16_1);
        label_typeface_confirm = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_typeface_confirm, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_typeface_confirm, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_typeface_confirm,  "确定");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_typeface_confirm, "Confirm");
        }
        lv_obj_align(label_typeface_confirm, LV_ALIGN_TOP_LEFT, 277, 252);
    }
}


static void dropdown_addition_count_lead_zero_event_handler(lv_event_t* e)
{
    lv_event_code_t code = lv_event_get_code(e);
    lv_obj_t* obj = lv_event_get_target(e);
    if (code == LV_EVENT_VALUE_CHANGED)
    {
        char buf[32];
        buzzer_enable = 1;
        lv_dropdown_get_selected_str(obj, buf, sizeof(buf));
        printf("Option: %s", buf);

        btn_addition_count_updata();
    }
}


static void button_count_current_value_confirm_event_cb(lv_event_t* e)
{
    lv_event_code_t code;
    int i=0;
    char temp_str[12] = { 0 };
    code = lv_event_get_code(e);
    if (code == LV_EVENT_CLICKED)
    {
        printf("button_word_space_confirm_event_cb\n");
        buzzer_enable = 1;
        const char* pwd_txt = lv_textarea_get_text(pwd_text_area);
        if ((pwd_txt != NULL))
        {
            i = atoi(pwd_txt);
            if (i > 999999999)
            {
                i = 999999999;
            }
        }

        sprintf(temp_str, "%d", i);
        lv_label_set_text(label_btn_addition_count_current_value, temp_str);
        lv_label_set_text(label_addition_count_preview, temp_str);

      
        lv_obj_del(typeface_head_bg);
        lv_obj_del(label_typeface_head);
        lv_obj_del(typeface_slider_bg);
        lv_obj_del(pwd_text_area);
        lv_obj_del(pwd_keyboard);

        lv_obj_del(label_typeface_return);
        lv_obj_del(btn_typeface_return);
        lv_obj_del(btn_typeface_confirm);
        lv_obj_del(label_typeface_confirm);

        btn_addition_count_updata();
    }
}

static void button_count_current_value_return_event_cb(lv_event_t* e)
{
    lv_event_code_t code;

    code = lv_event_get_code(e);
    if (code == LV_EVENT_CLICKED)
    {
        printf("button_count_current_value_return_event_cb\n");
        buzzer_enable = 1;

        lv_obj_del(typeface_head_bg);
        lv_obj_del(label_typeface_head);
        lv_obj_del(typeface_slider_bg);
        lv_obj_del(pwd_text_area);
        lv_obj_del(pwd_keyboard);

        lv_obj_del(label_typeface_return);
        lv_obj_del(btn_typeface_return);
        lv_obj_del(btn_typeface_confirm);
        lv_obj_del(label_typeface_confirm);
    }
}



static void btn_addition_count_current_value_event_cb(lv_event_t* e)
{
    lv_event_code_t code;

    code = lv_event_get_code(e);

    if (code == LV_EVENT_CLICKED)
    {
        printf("btn_addition_count_current_value_event_cb\n");
        buzzer_enable = 1;
        typeface_head_bg = lv_obj_create(lv_scr_act());
        lv_obj_set_size(typeface_head_bg, 480, 24);
        lv_obj_align(typeface_head_bg, LV_ALIGN_TOP_LEFT, 0, 0);
        lv_obj_set_style_border_width(typeface_head_bg, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_border_color(typeface_head_bg, lv_color_hex(0x9bcd9b), LV_STATE_DEFAULT); /* 设置边框颜色 */
        lv_obj_set_style_radius(typeface_head_bg, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_color(typeface_head_bg, lv_color_hex(0x1fadd3), LV_STATE_DEFAULT);

        LV_FONT_DECLARE(heiFont16_1);
        label_typeface_head = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_typeface_head, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_typeface_head, lv_color_hex(0xFFFFFF), LV_STATE_DEFAULT);
        lv_obj_align(label_typeface_head, LV_ALIGN_TOP_LEFT, 200, 4);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_typeface_head,  "当前值");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_typeface_head, "Current value");
        }

        
        typeface_slider_bg = lv_obj_create(lv_scr_act());
        lv_obj_set_size(typeface_slider_bg, 480, 224);
        lv_obj_align(typeface_slider_bg, LV_ALIGN_TOP_LEFT, 0, 24);
        lv_obj_set_style_border_width(typeface_slider_bg, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_border_color(typeface_slider_bg, lv_color_hex(0xaaaaaa), LV_STATE_DEFAULT); /* 设置边框颜色 */
        lv_obj_set_style_radius(typeface_slider_bg, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_color(typeface_slider_bg, lv_color_hex(0xaaaaaa), LV_STATE_DEFAULT);

        //数字键盘
        pwd_text_area = lv_textarea_create(lv_scr_act());
        if (pwd_text_area == NULL)
        {
            printf("[%s:%d] create pwd_text_area obj failed\n", __FUNCTION__, __LINE__);
            return;
        }

        // 密码框样式
        static lv_style_t pwd_text_style;
        lv_style_init(&pwd_text_style); // 初始化样式
        lv_style_set_radius(&pwd_text_style, 0); // 设置样式的圆角弧度
        lv_style_set_border_width(&pwd_text_style, 1); // 设置边框宽度
        lv_style_set_pad_all(&pwd_text_style, 0); // 设置样式的内部填充
        lv_style_set_text_font(&pwd_text_style, &lv_font_montserrat_18); //设置字体
        //lv_textarea_set_password_mode(pwd_text_area, true); // 文本区域开启密码模式
        lv_textarea_set_max_length(pwd_text_area, 9); // 设置可输入的文本的最大长度
        lv_obj_add_style(pwd_text_area, &pwd_text_style, 0); // 给btn_label添加样式
        lv_obj_set_size(pwd_text_area, 480, 50); // 设置对象大小
        lv_textarea_set_text(pwd_text_area, ""); // 文本框置空
        lv_obj_align(pwd_text_area, LV_ALIGN_TOP_LEFT, 0, 24);

        // 基于键盘背景对象创建密码校验提示标签
        hint_label = lv_label_create(lv_scr_act());
        if (hint_label == NULL)
        {
            printf("[%s:%d] create hint_label obj failed\n", __FUNCTION__, __LINE__);
            return;
        }

        // 密码提示文本样式
        static lv_style_t hint_label_style;
        lv_style_init(&hint_label_style); // 初始化样式
        lv_style_set_radius(&hint_label_style, 0); // 设置样式的圆角弧度
        lv_style_set_border_width(&hint_label_style, 0); //设置边框宽度
        lv_style_set_text_color(&hint_label_style, lv_palette_main(LV_PALETTE_RED));  // 字体颜色设置为红色
        lv_style_set_text_font(&hint_label_style, &lv_font_montserrat_12); //设置字体
        lv_label_set_long_mode(hint_label, LV_LABEL_LONG_SCROLL_CIRCULAR); // 长文本循环滚动
        lv_obj_add_style(hint_label, &hint_label_style, 0); // 给btn_label添加样式
        lv_obj_align(hint_label, LV_ALIGN_TOP_MID, 0, 110); // 顶部居中显示
        lv_label_set_text(hint_label, ""); // 设置文本内容

        // 基于键盘背景对象创建键盘对象
        pwd_keyboard = lv_keyboard_create(lv_scr_act());
        if (pwd_keyboard == NULL)
        {
            printf("[%s:%d] create pwd_keyboard obj failed\n", __FUNCTION__, __LINE__);
            return;
        }

        //键盘样式
        static lv_style_t pwd_kb_style;
        lv_style_init(&pwd_kb_style); // 初始化样式
        lv_style_set_radius(&pwd_kb_style, 5); // 设置样式的圆角弧度
        lv_style_set_border_width(&pwd_kb_style, 0); //设置边框宽度
        lv_style_set_bg_color(&pwd_kb_style, lv_color_hex(0xF98E2D));
        lv_style_set_text_opa(&pwd_kb_style, LV_OPA_COVER);
        lv_style_set_text_font(&pwd_kb_style, &lv_font_montserrat_20); //设置字体
        lv_obj_set_size(pwd_keyboard, 480, 174); //设置键盘大小
        lv_keyboard_set_mode(pwd_keyboard, LV_KEYBOARD_MODE_NUMBER_2); //设置键盘模式为数字键盘
        lv_keyboard_set_map(pwd_keyboard, LV_KEYBOARD_MODE_NUMBER_2, keyboard_map, keyboard_ctrl); // 设置键盘映射
        lv_keyboard_set_textarea(pwd_keyboard, pwd_text_area); // 键盘对象和文本框绑定
        lv_obj_add_style(pwd_keyboard, &pwd_kb_style, 0); // 添加样式
        lv_obj_align(pwd_keyboard, LV_ALIGN_TOP_LEFT, 0, 74);


        LV_FONT_DECLARE(heiFont16_1);
        label_typeface_return = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_typeface_return, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_typeface_return, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_typeface_return,  "返回");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_typeface_return, "Return");
        }
        lv_obj_align(label_typeface_return, LV_ALIGN_TOP_LEFT, 140, 252);

        LV_IMG_DECLARE(get_back);
        btn_typeface_return = lv_imgbtn_create(lv_scr_act());
        lv_imgbtn_set_src(btn_typeface_return, LV_IMGBTN_STATE_RELEASED, NULL, &get_back, NULL);
        lv_obj_set_size(btn_typeface_return, get_back.header.w, get_back.header.h);
        lv_obj_align(btn_typeface_return, LV_ALIGN_TOP_LEFT, 180, 250);
        lv_obj_add_event_cb(btn_typeface_return, button_count_current_value_return_event_cb, LV_EVENT_CLICKED, NULL);


        LV_IMG_DECLARE(confirm);
        btn_typeface_confirm = lv_imgbtn_create(lv_scr_act());
        lv_imgbtn_set_src(btn_typeface_confirm, LV_IMGBTN_STATE_RELEASED, NULL, &confirm, NULL);
        lv_obj_set_size(btn_typeface_confirm, get_back.header.w, get_back.header.h);
        lv_obj_align(btn_typeface_confirm, LV_ALIGN_TOP_LEFT, 250, 250);
        lv_obj_add_event_cb(btn_typeface_confirm, button_count_current_value_confirm_event_cb, LV_EVENT_CLICKED, NULL);

        LV_FONT_DECLARE(heiFont16_1);
        label_typeface_confirm = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_typeface_confirm, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_typeface_confirm, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_typeface_confirm,  "确定");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_typeface_confirm, "Confirm");
        }
        lv_obj_align(label_typeface_confirm, LV_ALIGN_TOP_LEFT, 277, 252);
    }
}


static void button_addition_count_minimum_confirm_event_cb(lv_event_t* e)
{
    lv_event_code_t code;
    int i=0;
    char temp_str[12] = { 0 };
    code = lv_event_get_code(e);
    if (code == LV_EVENT_CLICKED)
    {
        printf("button_word_space_confirm_event_cb\n");
        buzzer_enable = 1;
        const char* pwd_txt = lv_textarea_get_text(pwd_text_area);
        if ((pwd_txt != NULL))
        {
            i = atoi(pwd_txt);
            if (i > 999999999)
            {
                i = 999999999;
            }
        }

        sprintf(temp_str, "%d", i);
        lv_label_set_text(label_btn_addition_count_minimum, temp_str);   
        lv_obj_del(typeface_head_bg);
        lv_obj_del(label_typeface_head);
        lv_obj_del(typeface_slider_bg);
        lv_obj_del(pwd_text_area);
        lv_obj_del(pwd_keyboard);

        lv_obj_del(label_typeface_return);
        lv_obj_del(btn_typeface_return);
        lv_obj_del(btn_typeface_confirm);
        lv_obj_del(label_typeface_confirm);
    }
}


static void button_addition_count_minimum_return_event_cb(lv_event_t* e)
{
    lv_event_code_t code;
    code = lv_event_get_code(e);
    if (code == LV_EVENT_CLICKED)
    {
        printf("button_addition_count_minimum_return_event_cb\n");
        buzzer_enable = 1;

        lv_obj_del(typeface_head_bg);
        lv_obj_del(label_typeface_head);
        lv_obj_del(typeface_slider_bg);
        lv_obj_del(pwd_text_area);
        lv_obj_del(pwd_keyboard);

        lv_obj_del(label_typeface_return);
        lv_obj_del(btn_typeface_return);
        lv_obj_del(btn_typeface_confirm);
        lv_obj_del(label_typeface_confirm);
    }
}



static void btn_addition_count_minimum_event_cb(lv_event_t* e)
{
    lv_event_code_t code;

    code = lv_event_get_code(e);

    if (code == LV_EVENT_CLICKED)
    {
        printf("btn_addition_count_minimum_event_cb\n");
        buzzer_enable = 1;
        typeface_head_bg = lv_obj_create(lv_scr_act());
        lv_obj_set_size(typeface_head_bg, 480, 24);
        lv_obj_align(typeface_head_bg, LV_ALIGN_TOP_LEFT, 0, 0);
        lv_obj_set_style_border_width(typeface_head_bg, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_border_color(typeface_head_bg, lv_color_hex(0x9bcd9b), LV_STATE_DEFAULT); /* 设置边框颜色 */
        lv_obj_set_style_radius(typeface_head_bg, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_color(typeface_head_bg, lv_color_hex(0x1fadd3), LV_STATE_DEFAULT);

        LV_FONT_DECLARE(heiFont16_1);
        label_typeface_head = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_typeface_head, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_typeface_head, lv_color_hex(0xFFFFFF), LV_STATE_DEFAULT);
        lv_obj_align(label_typeface_head, LV_ALIGN_TOP_LEFT, 200, 4);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_typeface_head, "最小值");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_typeface_head, "Minimum");
        }
        
        typeface_slider_bg = lv_obj_create(lv_scr_act());
        lv_obj_set_size(typeface_slider_bg, 480, 224);
        lv_obj_align(typeface_slider_bg, LV_ALIGN_TOP_LEFT, 0, 24);
        lv_obj_set_style_border_width(typeface_slider_bg, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_border_color(typeface_slider_bg, lv_color_hex(0xaaaaaa), LV_STATE_DEFAULT); /* 设置边框颜色 */
        lv_obj_set_style_radius(typeface_slider_bg, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_color(typeface_slider_bg, lv_color_hex(0xaaaaaa), LV_STATE_DEFAULT);

        //数字键盘
        pwd_text_area = lv_textarea_create(lv_scr_act());
        if (pwd_text_area == NULL)
        {
            printf("[%s:%d] create pwd_text_area obj failed\n", __FUNCTION__, __LINE__);
            return;
        }

        // 密码框样式
        static lv_style_t pwd_text_style;
        lv_style_init(&pwd_text_style); // 初始化样式
        lv_style_set_radius(&pwd_text_style, 0); // 设置样式的圆角弧度
        lv_style_set_border_width(&pwd_text_style, 1); // 设置边框宽度
        lv_style_set_pad_all(&pwd_text_style, 0); // 设置样式的内部填充
        lv_style_set_text_font(&pwd_text_style, &lv_font_montserrat_18); //设置字体
        //lv_textarea_set_password_mode(pwd_text_area, true); // 文本区域开启密码模式
        lv_textarea_set_max_length(pwd_text_area, 9); // 设置可输入的文本的最大长度
        lv_obj_add_style(pwd_text_area, &pwd_text_style, 0); // 给btn_label添加样式
        lv_obj_set_size(pwd_text_area, 480, 50); // 设置对象大小
        lv_textarea_set_text(pwd_text_area, ""); // 文本框置空
        lv_obj_align(pwd_text_area, LV_ALIGN_TOP_LEFT, 0, 24);

        // 基于键盘背景对象创建密码校验提示标签
        hint_label = lv_label_create(lv_scr_act());
        if (hint_label == NULL)
        {
            printf("[%s:%d] create hint_label obj failed\n", __FUNCTION__, __LINE__);
            return;
        }

        // 密码提示文本样式
        static lv_style_t hint_label_style;
        lv_style_init(&hint_label_style); // 初始化样式
        lv_style_set_radius(&hint_label_style, 0); // 设置样式的圆角弧度
        lv_style_set_border_width(&hint_label_style, 0); //设置边框宽度
        lv_style_set_text_color(&hint_label_style, lv_palette_main(LV_PALETTE_RED));  // 字体颜色设置为红色
        lv_style_set_text_font(&hint_label_style, &lv_font_montserrat_12); //设置字体
        lv_label_set_long_mode(hint_label, LV_LABEL_LONG_SCROLL_CIRCULAR); // 长文本循环滚动
        lv_obj_add_style(hint_label, &hint_label_style, 0); // 给btn_label添加样式
        lv_obj_align(hint_label, LV_ALIGN_TOP_MID, 0, 110); // 顶部居中显示
        lv_label_set_text(hint_label, ""); // 设置文本内容

        // 基于键盘背景对象创建键盘对象
        pwd_keyboard = lv_keyboard_create(lv_scr_act());
        if (pwd_keyboard == NULL)
        {
            printf("[%s:%d] create pwd_keyboard obj failed\n", __FUNCTION__, __LINE__);
            return;
        }

        //键盘样式
        static lv_style_t pwd_kb_style;
        lv_style_init(&pwd_kb_style); // 初始化样式
        lv_style_set_radius(&pwd_kb_style, 5); // 设置样式的圆角弧度
        lv_style_set_border_width(&pwd_kb_style, 0); //设置边框宽度
        lv_style_set_bg_color(&pwd_kb_style, lv_color_hex(0xF98E2D));
        lv_style_set_text_opa(&pwd_kb_style, LV_OPA_COVER);
        lv_style_set_text_font(&pwd_kb_style, &lv_font_montserrat_20); //设置字体
        lv_obj_set_size(pwd_keyboard, 480, 174); //设置键盘大小
        lv_keyboard_set_mode(pwd_keyboard, LV_KEYBOARD_MODE_NUMBER_2); //设置键盘模式为数字键盘
        lv_keyboard_set_map(pwd_keyboard, LV_KEYBOARD_MODE_NUMBER_2, keyboard_map, keyboard_ctrl); // 设置键盘映射
        lv_keyboard_set_textarea(pwd_keyboard, pwd_text_area); // 键盘对象和文本框绑定
        lv_obj_add_style(pwd_keyboard, &pwd_kb_style, 0); // 添加样式
        lv_obj_align(pwd_keyboard, LV_ALIGN_TOP_LEFT, 0, 74);


        LV_FONT_DECLARE(heiFont16_1);
        label_typeface_return = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_typeface_return, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_typeface_return, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_typeface_return, "返回");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_typeface_return, "Return");
        }
        lv_obj_align(label_typeface_return, LV_ALIGN_TOP_LEFT, 140, 252);

        LV_IMG_DECLARE(get_back);
        btn_typeface_return = lv_imgbtn_create(lv_scr_act());
        lv_imgbtn_set_src(btn_typeface_return, LV_IMGBTN_STATE_RELEASED, NULL, &get_back, NULL);
        lv_obj_set_size(btn_typeface_return, get_back.header.w, get_back.header.h);
        lv_obj_align(btn_typeface_return, LV_ALIGN_TOP_LEFT, 180, 250);
        lv_obj_add_event_cb(btn_typeface_return, button_addition_count_minimum_return_event_cb, LV_EVENT_CLICKED, NULL);


        LV_IMG_DECLARE(confirm);
        btn_typeface_confirm = lv_imgbtn_create(lv_scr_act());
        lv_imgbtn_set_src(btn_typeface_confirm, LV_IMGBTN_STATE_RELEASED, NULL, &confirm, NULL);
        lv_obj_set_size(btn_typeface_confirm, get_back.header.w, get_back.header.h);
        lv_obj_align(btn_typeface_confirm, LV_ALIGN_TOP_LEFT, 250, 250);
        lv_obj_add_event_cb(btn_typeface_confirm, button_addition_count_minimum_confirm_event_cb, LV_EVENT_CLICKED, NULL);

        LV_FONT_DECLARE(heiFont16_1);
        label_typeface_confirm = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_typeface_confirm, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_typeface_confirm, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_typeface_confirm, "确定");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_typeface_confirm, "Confirm");
        }
        lv_obj_align(label_typeface_confirm, LV_ALIGN_TOP_LEFT, 277, 252);
    }
}


static void btn_addition_count_maximum_confirm_event_cb(lv_event_t* e)
{
    lv_event_code_t code;
    int i=0;
    char temp_str[12] = { 0 };
    code = lv_event_get_code(e);
    if (code == LV_EVENT_CLICKED)
    {
        printf("btn_addition_count_maximum_confirm_event_cb\n");
        buzzer_enable = 1;
        const char* pwd_txt = lv_textarea_get_text(pwd_text_area);
        if ((pwd_txt != NULL))
        {
            i = atoi(pwd_txt);
            if (i > 999999999)
            {
                i = 999999999;
            }
        }

        sprintf(temp_str, "%d", i);
        lv_label_set_text(label_btn_addition_count_maximum, temp_str);
        lv_obj_del(typeface_head_bg);
        lv_obj_del(label_typeface_head);
        lv_obj_del(typeface_slider_bg);
        lv_obj_del(pwd_text_area);
        lv_obj_del(pwd_keyboard);

        lv_obj_del(label_typeface_return);
        lv_obj_del(btn_typeface_return);
        lv_obj_del(btn_typeface_confirm);
        lv_obj_del(label_typeface_confirm);

        btn_addition_count_updata();
    }
}



static void btn_addition_count_maximum_return_event_cb(lv_event_t* e)
{
    lv_event_code_t code;

    code = lv_event_get_code(e);
    if (code == LV_EVENT_CLICKED)
    {
        printf("btn_addition_count_maximum_return_event_cb\n");
        buzzer_enable = 1;

        lv_obj_del(typeface_head_bg);
        lv_obj_del(label_typeface_head);
        lv_obj_del(typeface_slider_bg);
        lv_obj_del(pwd_text_area);
        lv_obj_del(pwd_keyboard);

        lv_obj_del(label_typeface_return);
        lv_obj_del(btn_typeface_return);
        lv_obj_del(btn_typeface_confirm);
        lv_obj_del(label_typeface_confirm);
    }
}




static void btn_addition_count_maximum_event_cb(lv_event_t* e)
{
    lv_event_code_t code;

    code = lv_event_get_code(e);

    if (code == LV_EVENT_CLICKED)
    {
        printf("btn_addition_count_maximum_event_cb\n");
        buzzer_enable = 1;

        typeface_head_bg = lv_obj_create(lv_scr_act());
        lv_obj_set_size(typeface_head_bg, 480, 24);
        lv_obj_align(typeface_head_bg, LV_ALIGN_TOP_LEFT, 0, 0);
        lv_obj_set_style_border_width(typeface_head_bg, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_border_color(typeface_head_bg, lv_color_hex(0x9bcd9b), LV_STATE_DEFAULT); /* 设置边框颜色 */
        lv_obj_set_style_radius(typeface_head_bg, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_color(typeface_head_bg, lv_color_hex(0x1fadd3), LV_STATE_DEFAULT);

        LV_FONT_DECLARE(heiFont16_1);
        label_typeface_head = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_typeface_head, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_typeface_head, lv_color_hex(0xFFFFFF), LV_STATE_DEFAULT);
        lv_obj_align(label_typeface_head, LV_ALIGN_TOP_LEFT, 200, 4);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_typeface_head,  "最大值");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_typeface_head, "Maximum");
        }

        typeface_slider_bg = lv_obj_create(lv_scr_act());
        lv_obj_set_size(typeface_slider_bg, 480, 224);
        lv_obj_align(typeface_slider_bg, LV_ALIGN_TOP_LEFT, 0, 24);
        lv_obj_set_style_border_width(typeface_slider_bg, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_border_color(typeface_slider_bg, lv_color_hex(0xaaaaaa), LV_STATE_DEFAULT); /* 设置边框颜色 */
        lv_obj_set_style_radius(typeface_slider_bg, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_color(typeface_slider_bg, lv_color_hex(0xaaaaaa), LV_STATE_DEFAULT);

        //数字键盘
        pwd_text_area = lv_textarea_create(lv_scr_act());
        if (pwd_text_area == NULL)
        {
            printf("[%s:%d] create pwd_text_area obj failed\n", __FUNCTION__, __LINE__);
            return;
        }

        // 密码框样式
        static lv_style_t pwd_text_style;
        lv_style_init(&pwd_text_style); // 初始化样式
        lv_style_set_radius(&pwd_text_style, 0); // 设置样式的圆角弧度
        lv_style_set_border_width(&pwd_text_style, 1); // 设置边框宽度
        lv_style_set_pad_all(&pwd_text_style, 0); // 设置样式的内部填充
        lv_style_set_text_font(&pwd_text_style, &lv_font_montserrat_18); //设置字体
        //lv_textarea_set_password_mode(pwd_text_area, true); // 文本区域开启密码模式
        lv_textarea_set_max_length(pwd_text_area, 9); // 设置可输入的文本的最大长度
        lv_obj_add_style(pwd_text_area, &pwd_text_style, 0); // 给btn_label添加样式
        lv_obj_set_size(pwd_text_area, 480, 50); // 设置对象大小
        lv_textarea_set_text(pwd_text_area, ""); // 文本框置空
        lv_obj_align(pwd_text_area, LV_ALIGN_TOP_LEFT, 0, 24);

        // 基于键盘背景对象创建密码校验提示标签
        hint_label = lv_label_create(lv_scr_act());
        if (hint_label == NULL)
        {
            printf("[%s:%d] create hint_label obj failed\n", __FUNCTION__, __LINE__);
            return;
        }

        // 密码提示文本样式
        static lv_style_t hint_label_style;
        lv_style_init(&hint_label_style); // 初始化样式
        lv_style_set_radius(&hint_label_style, 0); // 设置样式的圆角弧度
        lv_style_set_border_width(&hint_label_style, 0); //设置边框宽度
        lv_style_set_text_color(&hint_label_style, lv_palette_main(LV_PALETTE_RED));  // 字体颜色设置为红色
        lv_style_set_text_font(&hint_label_style, &lv_font_montserrat_12); //设置字体
        lv_label_set_long_mode(hint_label, LV_LABEL_LONG_SCROLL_CIRCULAR); // 长文本循环滚动
        lv_obj_add_style(hint_label, &hint_label_style, 0); // 给btn_label添加样式
        lv_obj_align(hint_label, LV_ALIGN_TOP_MID, 0, 110); // 顶部居中显示
        lv_label_set_text(hint_label, ""); // 设置文本内容

        // 基于键盘背景对象创建键盘对象
        pwd_keyboard = lv_keyboard_create(lv_scr_act());
        if (pwd_keyboard == NULL)
        {
            printf("[%s:%d] create pwd_keyboard obj failed\n", __FUNCTION__, __LINE__);
            return;
        }

        //键盘样式
        static lv_style_t pwd_kb_style;
        lv_style_init(&pwd_kb_style); // 初始化样式
        lv_style_set_radius(&pwd_kb_style, 5); // 设置样式的圆角弧度
        lv_style_set_border_width(&pwd_kb_style, 0); //设置边框宽度
        lv_style_set_bg_color(&pwd_kb_style, lv_color_hex(0xF98E2D));
        lv_style_set_text_opa(&pwd_kb_style, LV_OPA_COVER);
        lv_style_set_text_font(&pwd_kb_style, &lv_font_montserrat_20); //设置字体
        lv_obj_set_size(pwd_keyboard, 480, 174); //设置键盘大小
        lv_keyboard_set_mode(pwd_keyboard, LV_KEYBOARD_MODE_NUMBER_2); //设置键盘模式为数字键盘
        lv_keyboard_set_map(pwd_keyboard, LV_KEYBOARD_MODE_NUMBER_2, keyboard_map, keyboard_ctrl); // 设置键盘映射
        lv_keyboard_set_textarea(pwd_keyboard, pwd_text_area); // 键盘对象和文本框绑定
        lv_obj_add_style(pwd_keyboard, &pwd_kb_style, 0); // 添加样式
        lv_obj_align(pwd_keyboard, LV_ALIGN_TOP_LEFT, 0, 74);


        LV_FONT_DECLARE(heiFont16_1);
        label_typeface_return = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_typeface_return, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_typeface_return, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_typeface_return,  "返回");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_typeface_return, "Return");
        }  
        lv_obj_align(label_typeface_return, LV_ALIGN_TOP_LEFT, 140, 252);

        LV_IMG_DECLARE(get_back);
        btn_typeface_return = lv_imgbtn_create(lv_scr_act());
        lv_imgbtn_set_src(btn_typeface_return, LV_IMGBTN_STATE_RELEASED, NULL, &get_back, NULL);
        lv_obj_set_size(btn_typeface_return, get_back.header.w, get_back.header.h);
        lv_obj_align(btn_typeface_return, LV_ALIGN_TOP_LEFT, 180, 250);
        lv_obj_add_event_cb(btn_typeface_return, btn_addition_count_maximum_return_event_cb, LV_EVENT_CLICKED, NULL);


        LV_IMG_DECLARE(confirm);
        btn_typeface_confirm = lv_imgbtn_create(lv_scr_act());
        lv_imgbtn_set_src(btn_typeface_confirm, LV_IMGBTN_STATE_RELEASED, NULL, &confirm, NULL);
        lv_obj_set_size(btn_typeface_confirm, get_back.header.w, get_back.header.h);
        lv_obj_align(btn_typeface_confirm, LV_ALIGN_TOP_LEFT, 250, 250);
        lv_obj_add_event_cb(btn_typeface_confirm, btn_addition_count_maximum_confirm_event_cb, LV_EVENT_CLICKED, NULL);

        LV_FONT_DECLARE(heiFont16_1);
        label_typeface_confirm = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_typeface_confirm, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_typeface_confirm, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_typeface_confirm, "确定");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_typeface_confirm, "Confirm");
        }  
        lv_obj_align(label_typeface_confirm, LV_ALIGN_TOP_LEFT, 277, 252);
    }
}


static void  btn_addition_count_step_confirm_event_cb(lv_event_t* e)
{
    lv_event_code_t code;
    int i=0;
    char temp_str[12] = { 0 };
    code = lv_event_get_code(e);
    if (code == LV_EVENT_CLICKED)
    {
        printf("btn_addition_count_step_confirm_event_cb\n");
        buzzer_enable = 1;

        const char* pwd_txt = lv_textarea_get_text(pwd_text_area);
        if ((pwd_txt != NULL))
        {
            i = atoi(pwd_txt);
            if (i > 99999)
            {
                i = 99999;
            }
        }

        sprintf(temp_str, "%d", i);
        lv_label_set_text(label_btn_addition_count_step, temp_str);

        lv_obj_del(typeface_head_bg);
        lv_obj_del(label_typeface_head);
        lv_obj_del(typeface_slider_bg);
        lv_obj_del(pwd_text_area);
        lv_obj_del(pwd_keyboard);

        lv_obj_del(label_typeface_return);
        lv_obj_del(btn_typeface_return);
        lv_obj_del(btn_typeface_confirm);
        lv_obj_del(label_typeface_confirm);
    }
}


static void  btn_addition_count_step_return_event_cb(lv_event_t* e)
{
    lv_event_code_t code;
    code = lv_event_get_code(e);
    if (code == LV_EVENT_CLICKED)
    {
        printf("btn_addition_count_step_confirm_event_cb\n");
        buzzer_enable = 1;
        lv_obj_del(typeface_head_bg);
        lv_obj_del(label_typeface_head);
        lv_obj_del(typeface_slider_bg);
        lv_obj_del(pwd_text_area);
        lv_obj_del(pwd_keyboard);

        lv_obj_del(label_typeface_return);
        lv_obj_del(btn_typeface_return);
        lv_obj_del(btn_typeface_confirm);
        lv_obj_del(label_typeface_confirm);
    }
}


static void btn_addition_count_updata(void)
{
    //char temp_typeface[128] = { 0 };
    //int i = 0;
    //int word_space = 0;
    //int word_size = 0;
    //int x_size = 0;
    //int y_size = 0;
    //int win_content_child_num = 0;
    char tempString[32] = { 0 };
    unsigned int currentValue = 0;
    unsigned char leadZero = 0;
    unsigned int maxValue = 0;

    printf("btn_addition_count_updata\n");
   
    currentValue = atoi(lv_label_get_text(label_btn_addition_count_current_value));
    leadZero = lv_dropdown_get_selected(dropdown_addition_count_lead_zero);
    maxValue = atoi(lv_label_get_text(label_btn_addition_count_maximum));

    if (currentValue > maxValue)
    {
        currentValue = maxValue;
    }

    if (leadZero == 0)
    {
        formatNumberWithLeadingZeros(currentValue, maxValue, tempString);
    }
    else
    {
        sprintf(tempString, "%u", currentValue);
    }
    lv_label_set_text(label_addition_count_preview, tempString);
}

static void btn_addition_count_step_event_cb(lv_event_t* e)
{
    lv_event_code_t code;

    code = lv_event_get_code(e);

    if (code == LV_EVENT_CLICKED)
    {
        printf("btn_addition_count_step_event_cb\n");
        buzzer_enable = 1;
        typeface_head_bg = lv_obj_create(lv_scr_act());
        lv_obj_set_size(typeface_head_bg, 480, 24);
        lv_obj_align(typeface_head_bg, LV_ALIGN_TOP_LEFT, 0, 0);
        lv_obj_set_style_border_width(typeface_head_bg, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_border_color(typeface_head_bg, lv_color_hex(0x9bcd9b), LV_STATE_DEFAULT); /* 设置边框颜色 */
        lv_obj_set_style_radius(typeface_head_bg, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_color(typeface_head_bg, lv_color_hex(0x1fadd3), LV_STATE_DEFAULT);

        LV_FONT_DECLARE(heiFont16_1);
        label_typeface_head = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_typeface_head, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_typeface_head, lv_color_hex(0xFFFFFF), LV_STATE_DEFAULT);
        lv_obj_align(label_typeface_head, LV_ALIGN_TOP_LEFT, 200, 4);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_typeface_head,  "步进值");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_typeface_head, "Step");
        }

        typeface_slider_bg = lv_obj_create(lv_scr_act());
        lv_obj_set_size(typeface_slider_bg, 480, 224);
        lv_obj_align(typeface_slider_bg, LV_ALIGN_TOP_LEFT, 0, 24);
        lv_obj_set_style_border_width(typeface_slider_bg, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_border_color(typeface_slider_bg, lv_color_hex(0xaaaaaa), LV_STATE_DEFAULT); /* 设置边框颜色 */
        lv_obj_set_style_radius(typeface_slider_bg, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_color(typeface_slider_bg, lv_color_hex(0xaaaaaa), LV_STATE_DEFAULT);

        //数字键盘
        pwd_text_area = lv_textarea_create(lv_scr_act());
        if (pwd_text_area == NULL)
        {
            printf("[%s:%d] create pwd_text_area obj failed\n", __FUNCTION__, __LINE__);
            return;
        }

        // 密码框样式
        static lv_style_t pwd_text_style;
        lv_style_init(&pwd_text_style); // 初始化样式
        lv_style_set_radius(&pwd_text_style, 0); // 设置样式的圆角弧度
        lv_style_set_border_width(&pwd_text_style, 1); // 设置边框宽度
        lv_style_set_pad_all(&pwd_text_style, 0); // 设置样式的内部填充
        lv_style_set_text_font(&pwd_text_style, &lv_font_montserrat_18); //设置字体
        //lv_textarea_set_password_mode(pwd_text_area, true); // 文本区域开启密码模式
        lv_textarea_set_max_length(pwd_text_area, 5); // 设置可输入的文本的最大长度
        lv_obj_add_style(pwd_text_area, &pwd_text_style, 0); // 给btn_label添加样式
        lv_obj_set_size(pwd_text_area, 480, 50); // 设置对象大小
        lv_textarea_set_text(pwd_text_area, ""); // 文本框置空
        lv_obj_align(pwd_text_area, LV_ALIGN_TOP_LEFT, 0, 24);

        // 基于键盘背景对象创建密码校验提示标签
        hint_label = lv_label_create(lv_scr_act());
        if (hint_label == NULL)
        {
            printf("[%s:%d] create hint_label obj failed\n", __FUNCTION__, __LINE__);
            return;
        }

        // 密码提示文本样式
        static lv_style_t hint_label_style;
        lv_style_init(&hint_label_style); // 初始化样式
        lv_style_set_radius(&hint_label_style, 0); // 设置样式的圆角弧度
        lv_style_set_border_width(&hint_label_style, 0); //设置边框宽度
        lv_style_set_text_color(&hint_label_style, lv_palette_main(LV_PALETTE_RED));  // 字体颜色设置为红色
        lv_style_set_text_font(&hint_label_style, &lv_font_montserrat_12); //设置字体
        lv_label_set_long_mode(hint_label, LV_LABEL_LONG_SCROLL_CIRCULAR); // 长文本循环滚动
        lv_obj_add_style(hint_label, &hint_label_style, 0); // 给btn_label添加样式
        lv_obj_align(hint_label, LV_ALIGN_TOP_MID, 0, 110); // 顶部居中显示
        lv_label_set_text(hint_label, ""); // 设置文本内容

        // 基于键盘背景对象创建键盘对象
        pwd_keyboard = lv_keyboard_create(lv_scr_act());
        if (pwd_keyboard == NULL)
        {
            printf("[%s:%d] create pwd_keyboard obj failed\n", __FUNCTION__, __LINE__);
            return;
        }

        //键盘样式
        static lv_style_t pwd_kb_style;
        lv_style_init(&pwd_kb_style); // 初始化样式
        lv_style_set_radius(&pwd_kb_style, 5); // 设置样式的圆角弧度
        lv_style_set_border_width(&pwd_kb_style, 0); //设置边框宽度
        lv_style_set_bg_color(&pwd_kb_style, lv_color_hex(0xF98E2D));
        lv_style_set_text_opa(&pwd_kb_style, LV_OPA_COVER);
        lv_style_set_text_font(&pwd_kb_style, &lv_font_montserrat_20); //设置字体
        lv_obj_set_size(pwd_keyboard, 480, 174); //设置键盘大小
        lv_keyboard_set_mode(pwd_keyboard, LV_KEYBOARD_MODE_NUMBER_2); //设置键盘模式为数字键盘
        lv_keyboard_set_map(pwd_keyboard, LV_KEYBOARD_MODE_NUMBER_2, keyboard_map, keyboard_ctrl); // 设置键盘映射
        lv_keyboard_set_textarea(pwd_keyboard, pwd_text_area); // 键盘对象和文本框绑定
        lv_obj_add_style(pwd_keyboard, &pwd_kb_style, 0); // 添加样式
        lv_obj_align(pwd_keyboard, LV_ALIGN_TOP_LEFT, 0, 74);


        LV_FONT_DECLARE(heiFont16_1);
        label_typeface_return = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_typeface_return, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_typeface_return, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_typeface_return, "返回");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_typeface_return, "Return");
        }
        lv_obj_align(label_typeface_return, LV_ALIGN_TOP_LEFT, 140, 252);

        LV_IMG_DECLARE(get_back);
        btn_typeface_return = lv_imgbtn_create(lv_scr_act());
        lv_imgbtn_set_src(btn_typeface_return, LV_IMGBTN_STATE_RELEASED, NULL, &get_back, NULL);
        lv_obj_set_size(btn_typeface_return, get_back.header.w, get_back.header.h);
        lv_obj_align(btn_typeface_return, LV_ALIGN_TOP_LEFT, 180, 250);
        lv_obj_add_event_cb(btn_typeface_return, btn_addition_count_step_return_event_cb, LV_EVENT_CLICKED, NULL);


        LV_IMG_DECLARE(confirm);
        btn_typeface_confirm = lv_imgbtn_create(lv_scr_act());
        lv_imgbtn_set_src(btn_typeface_confirm, LV_IMGBTN_STATE_RELEASED, NULL, &confirm, NULL);
        lv_obj_set_size(btn_typeface_confirm, get_back.header.w, get_back.header.h);
        lv_obj_align(btn_typeface_confirm, LV_ALIGN_TOP_LEFT, 250, 250);
        lv_obj_add_event_cb(btn_typeface_confirm, btn_addition_count_step_confirm_event_cb, LV_EVENT_CLICKED, NULL);

        LV_FONT_DECLARE(heiFont16_1);
        label_typeface_confirm = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_typeface_confirm, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_typeface_confirm, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_typeface_confirm,  "确定");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_typeface_confirm, "Confirm");
        }
        lv_obj_align(label_typeface_confirm, LV_ALIGN_TOP_LEFT, 277, 252);
    }
}


static void btn_addition_count_confirm_event_cb(lv_event_t* e)
{
    lv_event_code_t code;
    code = lv_event_get_code(e);
    //char temp_typeface[128] = { 0 };
    int i = 0;
    int word_space = 0;
    int word_size = 0;
    //int x_size = 0;
    //int y_size = 0;
    int win_content_child_num = 0;
    char tempString[32] = { 0 };

    if (code == LV_EVENT_CLICKED)
    {
        printf("btn_addition_count_confirm_event_cb\n");
        win_content_child_num = lv_obj_get_child_cnt(win_content);
        printf("win_content_child_num=%u\n\r", win_content_child_num);

        if (win_content_child_num < NEW_TEXT_MAX_NUMBER)
        {
            //保存所有数据
            data_structure[win_content_child_num].data.count.law = lv_dropdown_get_selected(dropdown_addition_count_law);
            data_structure[win_content_child_num].data.count.repetition = atoi(lv_label_get_text(label_btn_addition_count_times_repetition));

            if(data_structure[win_content_child_num].data.count.repetition == 0)
            {
                data_structure[win_content_child_num].data.count.repetition = 1;
            }

            lv_obj_t* temp_obj = lv_obj_create(win_content);

            for (i = 0; i < TYPEFACE_NUMBER; i++)
            {
                if (strncmp(lv_label_get_text(label_btn_addition_count_typeface), typeface_name[i], strlen(lv_label_get_text(label_btn_addition_count_typeface))) == 0)
                {
                    break;
                }
            }

            printf("i=%d\n", i);

            //sprintf(temp_typeface, "/media/%s", typeface_buf[i]);
            data_structure[win_content_child_num].data.count.typeface = i;
            //printf("%s\n", temp_typeface);
            //data_structure[win_content_child_num].data.count.info.name = temp_typeface;
            word_size = atoi(lv_label_get_text(label_btn_addition_count_size));

            if (word_size < 12)
            {
                word_size = 12;
            }

            if (word_size > WORD_MAX_SIZE)
            {
                word_size = WORD_MAX_SIZE;
            }

            data_structure[win_content_child_num].data.count.info.weight = word_size;

            data_structure[win_content_child_num].data.count.info.style = FT_FONT_STYLE_NORMAL;

            //lv_ft_font_init(&data_structure[win_content_child_num].data.count.info);

            lv_font_t* temp_font = font_list_get(i, word_size, 0);

            //当前值
            data_structure[win_content_child_num].data.count.current_value = atoi(lv_label_get_text(label_btn_addition_count_current_value));
            //最小值
            data_structure[win_content_child_num].data.count.minimum = atoi(lv_label_get_text(label_btn_addition_count_minimum));
            //最大值
            data_structure[win_content_child_num].data.count.maximum = atoi(lv_label_get_text(label_btn_addition_count_maximum));
            //前置0
            data_structure[win_content_child_num].data.count.lead_zero = lv_dropdown_get_selected(dropdown_addition_count_lead_zero);
            //步进值
            data_structure[win_content_child_num].data.count.step = atoi(lv_label_get_text(label_btn_addition_count_step));

            printf("lead_zero=%d\n\r", data_structure[win_content_child_num].data.count.lead_zero);
            printf("law=%d\n\r", data_structure[win_content_child_num].data.count.law);

            //确定显示值的位数
            //递增
            if (data_structure[win_content_child_num].data.count.law == 0)
            {
                if (data_structure[win_content_child_num].data.count.current_value < data_structure[win_content_child_num].data.count.minimum)
                {
                    data_structure[win_content_child_num].data.count.current_value = data_structure[win_content_child_num].data.count.minimum;
                }
                else if(data_structure[win_content_child_num].data.count.current_value > data_structure[win_content_child_num].data.count.maximum)
                {
                    data_structure[win_content_child_num].data.count.current_value = data_structure[win_content_child_num].data.count.maximum;
                }

                if (data_structure[win_content_child_num].data.count.lead_zero == 0)
                {
                    formatNumberWithLeadingZeros(data_structure[win_content_child_num].data.count.current_value, data_structure[win_content_child_num].data.count.maximum, tempString);
                }
                else
                {
                    sprintf(tempString, "%d", data_structure[win_content_child_num].data.count.current_value);
                }
            }
            else
            {
                if (data_structure[win_content_child_num].data.count.current_value < data_structure[win_content_child_num].data.count.minimum)
                {
                    data_structure[win_content_child_num].data.count.current_value = data_structure[win_content_child_num].data.count.minimum;
                }
                else if (data_structure[win_content_child_num].data.count.current_value > data_structure[win_content_child_num].data.count.maximum)
                {
                    data_structure[win_content_child_num].data.count.current_value = data_structure[win_content_child_num].data.count.maximum;
                }

                if (data_structure[win_content_child_num].data.count.lead_zero == 0)
                {
                    formatNumberWithLeadingZeros(data_structure[win_content_child_num].data.count.current_value, data_structure[win_content_child_num].data.count.maximum, tempString);
                }
                else
                {
                    sprintf(tempString, "%d", data_structure[win_content_child_num].data.count.current_value);
                }       
            }

            printf("tempString=%s\n\r", tempString);

            word_space = atoi(lv_label_get_text(label_btn_addition_count_space));

            if (word_space < 0)
            {
                word_space = 0;
            }

            if (word_space > 100)
            {
                word_space = 100;
            }

            lv_point_t text_size;
            lv_txt_get_size(&text_size, tempString, temp_font, word_space, 0, LV_COORD_MAX, LV_TEXT_FLAG_NONE);

            lv_obj_set_style_bg_opa(temp_obj, LV_OPA_TRANSP, 0);
            lv_obj_set_style_border_width(temp_obj, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */

            lv_obj_add_event_cb(temp_obj, drag_event_handler, LV_EVENT_PRESSING, NULL);
            lv_obj_add_event_cb(temp_obj, drag_event_handler, LV_EVENT_FOCUSED, NULL);
            lv_obj_add_event_cb(temp_obj, drag_event_handler, LV_EVENT_DEFOCUSED, NULL);
            lv_obj_clear_flag(temp_obj, LV_OBJ_FLAG_SCROLLABLE);

            lv_style_init(&data_structure[win_content_child_num].data.count.style);
            lv_style_set_text_font(&data_structure[win_content_child_num].data.count.style, temp_font);

            printf("x=%u y=%u\n\r", text_size.x, text_size.y);

            lv_obj_set_size(temp_obj, text_size.x, text_size.y);

            //lv_obj_align(temp_obj, LV_ALIGN_TOP_LEFT, 30, 0);
            lv_obj_align(temp_obj, LV_ALIGN_TOP_LEFT, 30 + 20*win_content_child_num, 6*win_content_child_num);

            lv_style_set_text_letter_space(&data_structure[win_content_child_num].data.count.style, word_space);
            lv_obj_t* label1 = lv_label_create(temp_obj);
            lv_obj_add_style(label1, &data_structure[win_content_child_num].data.count.style, 0);
            lv_label_set_text(label1, tempString);
            lv_obj_center(label1);
            data_structure[win_content_child_num].data.count.size = word_size;
            data_structure[win_content_child_num].data.count.space = word_space;
            data_structure[win_content_child_num].type = TYPE_COUNT;
        }

        lv_obj_del(addition_count_head_bg);
        lv_obj_del(label_addition_count_head);
        lv_obj_del(img_addition_count_law);
        lv_obj_del(label_addition_count_law);
        lv_obj_del(dropdown_addition_count_law);
        lv_obj_del(img_addition_count_repetition);
        lv_obj_del(label_addition_count_times_repetition);
        lv_obj_del(label_btn_addition_count_times_repetition);
        lv_obj_del(btn_addition_count_times_repetition);
        lv_obj_del(img_addition_count_typeface);
        lv_obj_del(label_addition_count_typeface);
        lv_obj_del(label_btn_addition_count_typeface);
        lv_obj_del(btn_addition_count_typeface);
        lv_obj_del(img_addition_count_size);
        lv_obj_del(label_addition_count_size);
        lv_obj_del(label_btn_addition_count_size);
        lv_obj_del(btn_addition_count_size);
        lv_obj_del(img_addition_count_space);
        lv_obj_del(label_addition_count_space);
        lv_obj_del(label_btn_addition_count_space);
        lv_obj_del(btn_addition_count_space);
        lv_obj_del(img_addition_count_lead_zero);
        lv_obj_del(label_addition_count_lead_zero);
        lv_obj_del(dropdown_addition_count_lead_zero);
        lv_obj_del(img_addition_count_current_value);
        lv_obj_del(label_addition_count_current_value);
        lv_obj_del(label_btn_addition_count_current_value);
        lv_obj_del(btn_addition_count_current_value);
        lv_obj_del(img_addition_count_minimum);
        lv_obj_del(label_addition_count_minimum);
        lv_obj_del(label_btn_addition_count_minimum);
        lv_obj_del(btn_addition_count_minimum);
        lv_obj_del(img_addition_count_maximum);
        lv_obj_del(label_addition_count_maximum);
        lv_obj_del(label_btn_addition_count_maximum);
        lv_obj_del(btn_addition_count_maximum);
        lv_obj_del(img_addition_count_step);
        lv_obj_del(label_addition_count_step);
        lv_obj_del(label_btn_addition_count_step);
        lv_obj_del(btn_addition_count_step);
        lv_obj_del(obj_addition_count_middle_bg);
        lv_obj_del(label_addition_count_preview);
        lv_obj_del(obj_addition_count_middle_bg_1);

        lv_obj_del(obj_addition_count_bottom_bg);
        lv_obj_del(label_addition_count_return);
        lv_obj_del(imgbtn_addition_count_return);
        lv_obj_del(imgbtn_addition_count_confirm);
        lv_obj_del(label_addition_count_confirm);

        //删除添加界面
        lv_obj_del(img_addition_bg);
        lv_obj_del(btn_addition_text);
        lv_obj_del(label_btn_addition_text);
        lv_obj_del(btn_addition_date);
        lv_obj_del(label_btn_addition_date);
        lv_obj_del(btn_addition_picture);
        lv_obj_del(label_btn_addition_picture);
        lv_obj_del(btn_addition_QR_code);
        lv_obj_del(label_btn_addition_QR_code);
        lv_obj_del(btn_addition_bar_code);
        lv_obj_del(label_btn_addition_bar_code);
        lv_obj_del(btn_addition_count);
        lv_obj_del(label_btn_addition_count);
        lv_obj_del(btn_addition_subsection);
        lv_obj_del(label_btn_addition_subsection);
        lv_obj_del(btn_addition_symbol);
        lv_obj_del(label_btn_addition_symbol);
        lv_obj_del(btn_addition_icon);
        lv_obj_del(label_btn_addition_icon);
        lv_obj_del(btn_addition_more_functions);
        lv_obj_del(label_btn_addition_more_functions);
        lv_obj_del(btn_addition_return);
    }
}


static void btn_addition_count_return_event_cb(lv_event_t* e)
{
    lv_event_code_t code;
    code = lv_event_get_code(e);

    if (code == LV_EVENT_CLICKED)
    {
        printf("btn_addition_count_return_event_cb\n");
        buzzer_enable = 1;

        lv_obj_del(addition_count_head_bg);
        lv_obj_del(label_addition_count_head);
        lv_obj_del(img_addition_count_law);
        lv_obj_del(label_addition_count_law);
        lv_obj_del(dropdown_addition_count_law);
        lv_obj_del(img_addition_count_repetition);
        lv_obj_del(label_addition_count_times_repetition);
        lv_obj_del(label_btn_addition_count_times_repetition);
        lv_obj_del(btn_addition_count_times_repetition);
        lv_obj_del(img_addition_count_typeface);
        lv_obj_del(label_addition_count_typeface);
        lv_obj_del(label_btn_addition_count_typeface);
        lv_obj_del(btn_addition_count_typeface);
        lv_obj_del(img_addition_count_size);
        lv_obj_del(label_addition_count_size);
        lv_obj_del(label_btn_addition_count_size);
        lv_obj_del(btn_addition_count_size);
        lv_obj_del(img_addition_count_space);
        lv_obj_del(label_addition_count_space);
        lv_obj_del(label_btn_addition_count_space);
        lv_obj_del(btn_addition_count_space);
        lv_obj_del(img_addition_count_lead_zero);
        lv_obj_del(label_addition_count_lead_zero);
        lv_obj_del(dropdown_addition_count_lead_zero);
        lv_obj_del(img_addition_count_current_value);
        lv_obj_del(label_addition_count_current_value);
        lv_obj_del(label_btn_addition_count_current_value);
        lv_obj_del(btn_addition_count_current_value);
        lv_obj_del(img_addition_count_minimum);
        lv_obj_del(label_addition_count_minimum);
        lv_obj_del(label_btn_addition_count_minimum);
        lv_obj_del(btn_addition_count_minimum);
        lv_obj_del(img_addition_count_maximum);
        lv_obj_del(label_addition_count_maximum);
        lv_obj_del(label_btn_addition_count_maximum);
        lv_obj_del(btn_addition_count_maximum);
        lv_obj_del(img_addition_count_step);
        lv_obj_del(label_addition_count_step);
        lv_obj_del(label_btn_addition_count_step);
        lv_obj_del(btn_addition_count_step);
        lv_obj_del(obj_addition_count_middle_bg);
        lv_obj_del(label_addition_count_preview);
        lv_obj_del(obj_addition_count_middle_bg_1);

        lv_obj_del(obj_addition_count_bottom_bg);
        lv_obj_del(label_addition_count_return);
        lv_obj_del(imgbtn_addition_count_return);
        lv_obj_del(imgbtn_addition_count_confirm);
        lv_obj_del(label_addition_count_confirm);

        //删除添加界面
        lv_obj_del(img_addition_bg);
        lv_obj_del(btn_addition_text);
        lv_obj_del(label_btn_addition_text);
        lv_obj_del(btn_addition_date);
        lv_obj_del(label_btn_addition_date);
        lv_obj_del(btn_addition_picture);
        lv_obj_del(label_btn_addition_picture);
        lv_obj_del(btn_addition_QR_code);
        lv_obj_del(label_btn_addition_QR_code);
        lv_obj_del(btn_addition_bar_code);
        lv_obj_del(label_btn_addition_bar_code);
        lv_obj_del(btn_addition_count);
        lv_obj_del(label_btn_addition_count);
        lv_obj_del(btn_addition_subsection);
        lv_obj_del(label_btn_addition_subsection);
        lv_obj_del(btn_addition_symbol);
        lv_obj_del(label_btn_addition_symbol);
        lv_obj_del(btn_addition_icon);
        lv_obj_del(label_btn_addition_icon);
        lv_obj_del(btn_addition_more_functions);
        lv_obj_del(label_btn_addition_more_functions);
        lv_obj_del(btn_addition_return);
    }
}


/*
2,20,70,12    160,20,230,12         318,20,390,12
2,70,70,62    160,70,230,62         318,70,390,62
              160,120,230,112       318,120,390,112
              160,170,230,162       318,170,390,162
*/
static void btn_addition_count_event_cb(lv_event_t* e)
{
    lv_event_code_t code;
    char* opts_addition_count_law;
    char* opts_addition_count_lead_zero;
    //int temp_space = 5;

    code = lv_event_get_code(e);

    if ((code == LV_EVENT_CLICKED) && (print_status == 0))
    {
        printf("btn_addition_count_event_cb\n");
        buzzer_enable = 1;
        addition_count_head_bg = lv_obj_create(lv_scr_act());
        lv_obj_set_size(addition_count_head_bg, 480, 24);
        lv_obj_align(addition_count_head_bg, LV_ALIGN_TOP_LEFT, 0, 0);
        lv_obj_set_style_border_width(addition_count_head_bg, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_radius(addition_count_head_bg, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_color(addition_count_head_bg, lv_color_hex(0x28536a), LV_STATE_DEFAULT);
        lv_obj_remove_style(addition_count_head_bg, 0, LV_PART_SCROLLBAR);


        LV_FONT_DECLARE(heiFont16_1);
        label_addition_count_head = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_addition_count_head, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_addition_count_head, lv_color_hex(0xFFFFFF), LV_STATE_DEFAULT);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_addition_count_head,  "计数");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_addition_count_head, "Count");
        }
        lv_obj_align(label_addition_count_head, LV_ALIGN_TOP_LEFT, 200, 4);


        obj_addition_count_middle_bg = lv_obj_create(lv_scr_act());
        lv_obj_set_size(obj_addition_count_middle_bg, 480, 224);
        lv_obj_align(obj_addition_count_middle_bg, LV_ALIGN_TOP_LEFT, 0, 24);
        lv_obj_set_style_border_width(obj_addition_count_middle_bg, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_radius(obj_addition_count_middle_bg, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_color(obj_addition_count_middle_bg, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        lv_obj_set_style_pad_all(obj_addition_count_middle_bg, 0, LV_STATE_DEFAULT);


        obj_addition_count_middle_bg_1 = lv_obj_create(lv_scr_act());
        lv_obj_set_size(obj_addition_count_middle_bg_1, 480, 40);
        lv_obj_align(obj_addition_count_middle_bg_1, LV_ALIGN_TOP_LEFT, 0, 24);
        lv_obj_set_style_border_width(obj_addition_count_middle_bg_1, 2, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_border_color(obj_addition_count_middle_bg_1, lv_color_hex(0x000000), LV_STATE_DEFAULT); /* 设置边框颜色 */
        lv_obj_set_style_radius(obj_addition_count_middle_bg_1, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_color(obj_addition_count_middle_bg_1, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        lv_obj_set_style_pad_all(obj_addition_count_middle_bg_1, 0, LV_STATE_DEFAULT);


        LV_FONT_DECLARE(heiFont16_1);
        label_addition_count_preview = lv_label_create(obj_addition_count_middle_bg_1);
        lv_obj_set_style_text_font(label_addition_count_preview, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_addition_count_preview, lv_color_hex(0x000000), LV_STATE_DEFAULT);
        lv_label_set_text(label_addition_count_preview, "");
        lv_obj_set_style_border_width(label_addition_count_preview, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_border_color(label_addition_count_preview, lv_color_hex(0x000000), LV_STATE_DEFAULT); /* 设置边框颜色 */
        lv_obj_set_style_border_opa(label_addition_count_preview, 100, LV_STATE_DEFAULT); /* 设置边框透明度 */
        //lv_obj_set_size(label_addition_count_preview, 480, 40);
        lv_obj_align(label_addition_count_preview, LV_ALIGN_CENTER, 0, 0);


        LV_IMG_DECLARE(law);
        img_addition_count_law = lv_img_create(obj_addition_count_middle_bg);
        lv_img_set_src(img_addition_count_law, &law);
        lv_obj_align(img_addition_count_law, LV_ALIGN_TOP_LEFT, 15, 48);

        LV_FONT_DECLARE(heiFont16_1);
        label_addition_count_law = lv_label_create(obj_addition_count_middle_bg);
        lv_obj_set_style_text_font(label_addition_count_law, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_addition_count_law, lv_color_hex(0x000000), LV_STATE_DEFAULT);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_addition_count_law,  "规律");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_addition_count_law, "Law");
        } 
        lv_obj_align(label_addition_count_law, LV_ALIGN_TOP_LEFT, 50, 54);

        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            opts_addition_count_law = "递增\n递减";
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            opts_addition_count_law = "Increase\nDecrease";
        }
        else
        {
            opts_addition_count_law = "递增\n递减";
        } 
        dropdown_addition_count_law = lv_dropdown_create(obj_addition_count_middle_bg);
        lv_obj_set_style_border_width(dropdown_addition_count_law, 1, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_radius(dropdown_addition_count_law, 10, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_border_color(dropdown_addition_count_law, lv_color_hex(0x000000), LV_STATE_DEFAULT); /* 设置边框颜色 */
        lv_dropdown_set_options_static(dropdown_addition_count_law, opts_addition_count_law);
        lv_obj_align(dropdown_addition_count_law, LV_ALIGN_TOP_LEFT, 115, 44);
        lv_obj_set_style_width(dropdown_addition_count_law, 110, LV_STATE_DEFAULT);
        LV_FONT_DECLARE(heiFont14);
        lv_obj_set_style_text_font(dropdown_addition_count_law, &heiFont14, LV_STATE_DEFAULT);
        lv_obj_set_style_height(dropdown_addition_count_law, 33, LV_STATE_DEFAULT);
        lv_obj_t* opts_addition_count_law_list = lv_dropdown_get_list(dropdown_addition_count_law);
        lv_obj_set_style_text_font(opts_addition_count_law_list, &heiFont14, 0);   // 设置新的字体
        LV_IMG_DECLARE(dropdown);
        lv_dropdown_set_symbol(dropdown_addition_count_law, &dropdown);
        lv_obj_add_event_cb(dropdown_addition_count_law, dropdown_addition_count_law_event_handler, LV_EVENT_ALL, NULL);

        LV_IMG_DECLARE(repetition);
        img_addition_count_repetition = lv_img_create(obj_addition_count_middle_bg);
        lv_img_set_src(img_addition_count_repetition, &repetition);
        lv_obj_align(img_addition_count_repetition, LV_ALIGN_TOP_LEFT, 15, 83);

        LV_FONT_DECLARE(heiFont16_1);
        label_addition_count_times_repetition = lv_label_create(obj_addition_count_middle_bg);
        lv_obj_set_style_text_font(label_addition_count_times_repetition, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_addition_count_times_repetition, lv_color_hex(0x000000), LV_STATE_DEFAULT);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_addition_count_times_repetition,  "重复");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_addition_count_times_repetition, "Repetition");
        }
        lv_obj_align(label_addition_count_times_repetition, LV_ALIGN_TOP_LEFT, 50, 89);

        LV_FONT_DECLARE(heiFont16_1);
        btn_addition_count_times_repetition = lv_btn_create(obj_addition_count_middle_bg);
        lv_obj_set_size(btn_addition_count_times_repetition, 110, 30);
        lv_obj_align(btn_addition_count_times_repetition, LV_ALIGN_TOP_LEFT, 115, 81);
        lv_obj_set_style_border_width(btn_addition_count_times_repetition, 1, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_radius(btn_addition_count_times_repetition, 10, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_color(btn_addition_count_times_repetition, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        label_btn_addition_count_times_repetition = lv_label_create(btn_addition_count_times_repetition);
        lv_obj_set_style_text_font(label_btn_addition_count_times_repetition, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_btn_addition_count_times_repetition, lv_color_hex(0x1C1C1C), LV_STATE_DEFAULT);
        lv_label_set_text(label_btn_addition_count_times_repetition, "1");
        lv_obj_align(label_btn_addition_count_times_repetition, LV_ALIGN_CENTER, 0, 0);
        lv_obj_set_style_border_width(label_btn_addition_count_times_repetition, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_border_color(label_btn_addition_count_times_repetition, lv_color_hex(0x8a8a8a), LV_STATE_DEFAULT); /* 设置边框颜色 */
        lv_obj_set_style_border_opa(label_btn_addition_count_times_repetition, 100, LV_STATE_DEFAULT); /* 设置边框透明度 */
        lv_obj_set_style_radius(label_btn_addition_count_times_repetition, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_opa(label_btn_addition_count_times_repetition, LV_OPA_COVER, LV_PART_MAIN);
        lv_obj_set_style_bg_color(label_btn_addition_count_times_repetition, lv_color_hex(0xffffff), LV_PART_MAIN);
        lv_obj_add_event_cb(btn_addition_count_times_repetition, btn_addition_count_times_repetition_mode_event_cb, LV_EVENT_CLICKED, NULL);


        LV_IMG_DECLARE(typeface);
        img_addition_count_typeface = lv_img_create(obj_addition_count_middle_bg);
        lv_img_set_src(img_addition_count_typeface, &typeface);
        lv_obj_align(img_addition_count_typeface, LV_ALIGN_TOP_LEFT, 15, 119);


        LV_FONT_DECLARE(heiFont16_1);
        label_addition_count_typeface = lv_label_create(obj_addition_count_middle_bg);
        lv_obj_set_style_text_font(label_addition_count_typeface, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_addition_count_typeface, lv_color_hex(0x000000), LV_STATE_DEFAULT);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_addition_count_typeface,  "字体");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_addition_count_typeface, "Typeface");
        }
        lv_obj_align(label_addition_count_typeface, LV_ALIGN_TOP_LEFT, 50, 124);


        LV_FONT_DECLARE(heiFont16_1);
        btn_addition_count_typeface = lv_btn_create(obj_addition_count_middle_bg);
        lv_obj_set_size(btn_addition_count_typeface, 110, 30);
        lv_obj_align(btn_addition_count_typeface, LV_ALIGN_TOP_LEFT, 115, 116);
        lv_obj_set_style_border_width(btn_addition_count_typeface, 1, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_radius(btn_addition_count_typeface, 10, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_color(btn_addition_count_typeface, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        label_btn_addition_count_typeface = lv_label_create(btn_addition_count_typeface);
        lv_obj_set_style_text_font(label_btn_addition_count_typeface, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_btn_addition_count_typeface, lv_color_hex(0x1C1C1C), LV_STATE_DEFAULT);
        lv_label_set_text(label_btn_addition_count_typeface, "常用宋体");
        lv_obj_align(label_btn_addition_count_typeface, LV_ALIGN_CENTER, 0, 0);
        lv_obj_set_style_border_width(label_btn_addition_count_typeface, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_border_color(label_btn_addition_count_typeface, lv_color_hex(0x8a8a8a), LV_STATE_DEFAULT); /* 设置边框颜色 */
        lv_obj_set_style_border_opa(label_btn_addition_count_typeface, 100, LV_STATE_DEFAULT); /* 设置边框透明度 */
        lv_obj_set_style_radius(label_btn_addition_count_typeface, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_opa(label_btn_addition_count_typeface, LV_OPA_COVER, LV_PART_MAIN);
        lv_obj_set_style_bg_color(label_btn_addition_count_typeface, lv_color_hex(0xffffff), LV_PART_MAIN);
        lv_obj_add_event_cb(btn_addition_count_typeface, btn_addition_count_typeface_event_cb, LV_EVENT_CLICKED, NULL);


        LV_IMG_DECLARE(word_size);
        img_addition_count_size = lv_img_create(obj_addition_count_middle_bg);
        lv_img_set_src(img_addition_count_size, &word_size);
        lv_obj_align(img_addition_count_size, LV_ALIGN_TOP_LEFT, 15, 154);


        LV_FONT_DECLARE(heiFont16_1);
        label_addition_count_size = lv_label_create(obj_addition_count_middle_bg);
        lv_obj_set_style_text_font(label_addition_count_size, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_addition_count_size, lv_color_hex(0x000000), LV_STATE_DEFAULT);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_addition_count_size, "字号");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_addition_count_size, "Size");
        }
        lv_obj_align(label_addition_count_size, LV_ALIGN_TOP_LEFT, 50, 159);

        LV_FONT_DECLARE(heiFont16_1);
        btn_addition_count_size = lv_btn_create(obj_addition_count_middle_bg);
        lv_obj_set_size(btn_addition_count_size, 110, 30);
        lv_obj_align(btn_addition_count_size, LV_ALIGN_TOP_LEFT, 115, 151);
        lv_obj_set_style_border_width(btn_addition_count_size, 1, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_radius(btn_addition_count_size, 10, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_color(btn_addition_count_size, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        label_btn_addition_count_size = lv_label_create(btn_addition_count_size);
        lv_obj_set_style_text_font(label_btn_addition_count_size, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_btn_addition_count_size, lv_color_hex(0x1C1C1C), LV_STATE_DEFAULT);
        lv_label_set_text(label_btn_addition_count_size, "48");
        lv_obj_align(label_btn_addition_count_size, LV_ALIGN_CENTER, 0, 0);
        lv_obj_set_style_border_width(label_btn_addition_count_size, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_border_color(label_btn_addition_count_size, lv_color_hex(0x8a8a8a), LV_STATE_DEFAULT); /* 设置边框颜色 */
        lv_obj_set_style_border_opa(label_btn_addition_count_size, 100, LV_STATE_DEFAULT); /* 设置边框透明度 */
        lv_obj_set_style_radius(label_btn_addition_count_size, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_opa(label_btn_addition_count_size, LV_OPA_COVER, LV_PART_MAIN);
        lv_obj_set_style_bg_color(label_btn_addition_count_size, lv_color_hex(0xffffff), LV_PART_MAIN);
        lv_obj_add_event_cb(btn_addition_count_size, btn_addition_count_size_event_cb, LV_EVENT_CLICKED, NULL);



        LV_IMG_DECLARE(word_space);
        img_addition_count_space = lv_img_create(obj_addition_count_middle_bg);
        lv_img_set_src(img_addition_count_space, &word_space);
        lv_obj_align(img_addition_count_space, LV_ALIGN_TOP_LEFT, 15, 188);


        LV_FONT_DECLARE(heiFont16_1);
        label_addition_count_space = lv_label_create(obj_addition_count_middle_bg);
        lv_obj_set_style_text_font(label_addition_count_space, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_addition_count_space, lv_color_hex(0x000000), LV_STATE_DEFAULT);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_addition_count_space, "间距");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_addition_count_space, "Space");
        }
        lv_obj_align(label_addition_count_space, LV_ALIGN_TOP_LEFT, 50, 194);


        LV_FONT_DECLARE(heiFont16_1);
        btn_addition_count_space = lv_btn_create(obj_addition_count_middle_bg);
        lv_obj_set_size(btn_addition_count_space, 110, 30);
        lv_obj_align(btn_addition_count_space, LV_ALIGN_TOP_LEFT, 115, 186);
        lv_obj_set_style_border_width(btn_addition_count_space, 1, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_radius(btn_addition_count_space, 10, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_color(btn_addition_count_space, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        label_btn_addition_count_space = lv_label_create(btn_addition_count_space);
        lv_obj_set_style_text_font(label_btn_addition_count_space, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_btn_addition_count_space, lv_color_hex(0x1C1C1C), LV_STATE_DEFAULT);
        lv_label_set_text(label_btn_addition_count_space, "000");
        lv_obj_align(label_btn_addition_count_space, LV_ALIGN_CENTER, 0, 0);
        lv_obj_set_style_border_width(label_btn_addition_count_space, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_border_color(label_btn_addition_count_space, lv_color_hex(0x8a8a8a), LV_STATE_DEFAULT); /* 设置边框颜色 */
        lv_obj_set_style_border_opa(label_btn_addition_count_space, 100, LV_STATE_DEFAULT); /* 设置边框透明度 */
        lv_obj_set_style_radius(label_btn_addition_count_space, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_opa(label_btn_addition_count_space, LV_OPA_COVER, LV_PART_MAIN);
        lv_obj_set_style_bg_color(label_btn_addition_count_space, lv_color_hex(0xffffff), LV_PART_MAIN);
        lv_obj_add_event_cb(btn_addition_count_space, btn_addition_count_space_event_cb, LV_EVENT_CLICKED, NULL);


        LV_IMG_DECLARE(lead_zero);
        img_addition_count_lead_zero = lv_img_create(obj_addition_count_middle_bg);
        lv_img_set_src(img_addition_count_lead_zero, &lead_zero);
        lv_obj_align(img_addition_count_lead_zero, LV_ALIGN_TOP_LEFT, 255, 48);

        LV_FONT_DECLARE(heiFont16_1);
        label_addition_count_lead_zero = lv_label_create(obj_addition_count_middle_bg);
        lv_obj_set_style_text_font(label_addition_count_lead_zero, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_addition_count_lead_zero, lv_color_hex(0x000000), LV_STATE_DEFAULT);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_addition_count_lead_zero,  "前置零");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_addition_count_lead_zero, "Lead zero");
        }
        lv_obj_align(label_addition_count_lead_zero, LV_ALIGN_TOP_LEFT, 290, 54);


        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            opts_addition_count_lead_zero = "显示\n隐藏";
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            opts_addition_count_lead_zero = "Show\nHide";
        }
        else
        {
            opts_addition_count_lead_zero = "显示\n隐藏";
        }

        //static const char* opts_addition_count_lead_zero = "显示\n隐藏";
        dropdown_addition_count_lead_zero = lv_dropdown_create(obj_addition_count_middle_bg);
        lv_obj_set_style_border_width(dropdown_addition_count_lead_zero, 1, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_radius(dropdown_addition_count_lead_zero, 10, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_border_color(dropdown_addition_count_lead_zero, lv_color_hex(0x000000), LV_STATE_DEFAULT); /* 设置边框颜色 */
        lv_dropdown_set_options_static(dropdown_addition_count_lead_zero, opts_addition_count_lead_zero);
        lv_obj_align(dropdown_addition_count_lead_zero, LV_ALIGN_TOP_LEFT, 355, 44);
        lv_obj_set_style_width(dropdown_addition_count_lead_zero, 110, LV_STATE_DEFAULT);
        LV_FONT_DECLARE(heiFont14);
        lv_obj_set_style_text_font(dropdown_addition_count_lead_zero, &heiFont14, LV_STATE_DEFAULT);
        lv_obj_set_style_height(dropdown_addition_count_lead_zero, 33, LV_STATE_DEFAULT);
        lv_obj_t* opts_addition_count_lead_zero_list = lv_dropdown_get_list(dropdown_addition_count_lead_zero);
        lv_obj_set_style_text_font(opts_addition_count_lead_zero_list, &heiFont14, 0);   // 设置新的字体
        LV_IMG_DECLARE(dropdown);
        lv_dropdown_set_symbol(dropdown_addition_count_lead_zero, &dropdown);
        lv_obj_add_event_cb(dropdown_addition_count_lead_zero, dropdown_addition_count_lead_zero_event_handler, LV_EVENT_ALL, NULL);



        LV_IMG_DECLARE(current_value);
        img_addition_count_current_value = lv_img_create(obj_addition_count_middle_bg);
        lv_img_set_src(img_addition_count_current_value, &current_value);
        lv_obj_align(img_addition_count_current_value, LV_ALIGN_TOP_LEFT, 255, 83);


        LV_FONT_DECLARE(heiFont16_1);
        label_addition_count_current_value = lv_label_create(obj_addition_count_middle_bg);
        lv_obj_set_style_text_font(label_addition_count_current_value, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_addition_count_current_value, lv_color_hex(0x000000), LV_STATE_DEFAULT);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_addition_count_current_value, "当前值");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_addition_count_current_value, "Current value");
        }
        lv_obj_align(label_addition_count_current_value, LV_ALIGN_TOP_LEFT, 290, 89);

        LV_FONT_DECLARE(heiFont16_1);
        btn_addition_count_current_value = lv_btn_create(obj_addition_count_middle_bg);
        lv_obj_set_size(btn_addition_count_current_value, 110, 30);
        lv_obj_align(btn_addition_count_current_value, LV_ALIGN_TOP_LEFT, 355, 81);
        lv_obj_set_style_border_width(btn_addition_count_current_value, 1, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_radius(btn_addition_count_current_value, 10, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_color(btn_addition_count_current_value, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        label_btn_addition_count_current_value = lv_label_create(btn_addition_count_current_value);
        lv_obj_set_style_text_font(label_btn_addition_count_current_value, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_btn_addition_count_current_value, lv_color_hex(0x1C1C1C), LV_STATE_DEFAULT);
        lv_label_set_text(label_btn_addition_count_current_value, "0");
        lv_obj_align(label_btn_addition_count_current_value, LV_ALIGN_CENTER, 0, 0);
        lv_obj_set_style_border_width(label_btn_addition_count_current_value, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_border_color(label_btn_addition_count_current_value, lv_color_hex(0x8a8a8a), LV_STATE_DEFAULT); /* 设置边框颜色 */
        lv_obj_set_style_border_opa(label_btn_addition_count_current_value, 100, LV_STATE_DEFAULT); /* 设置边框透明度 */
        lv_obj_set_style_radius(label_btn_addition_count_current_value, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_opa(label_btn_addition_count_current_value, LV_OPA_COVER, LV_PART_MAIN);
        lv_obj_set_style_bg_color(label_btn_addition_count_current_value, lv_color_hex(0xffffff), LV_PART_MAIN);
        lv_obj_add_event_cb(btn_addition_count_current_value, btn_addition_count_current_value_event_cb, LV_EVENT_CLICKED, NULL);


        LV_IMG_DECLARE(minimum);
        img_addition_count_minimum = lv_img_create(obj_addition_count_middle_bg);
        lv_img_set_src(img_addition_count_minimum, &minimum);
        lv_obj_align(img_addition_count_minimum, LV_ALIGN_TOP_LEFT, 255, 119);


        LV_FONT_DECLARE(heiFont16_1);
        label_addition_count_minimum = lv_label_create(obj_addition_count_middle_bg);
        lv_obj_set_style_text_font(label_addition_count_minimum, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_addition_count_minimum, lv_color_hex(0x000000), LV_STATE_DEFAULT);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_addition_count_minimum, "最小值");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_addition_count_minimum, "Minimum");
        }
        lv_obj_align(label_addition_count_minimum, LV_ALIGN_TOP_LEFT, 290, 124);

        LV_FONT_DECLARE(heiFont16_1);
        btn_addition_count_minimum = lv_btn_create(obj_addition_count_middle_bg);
        lv_obj_set_size(btn_addition_count_minimum, 110, 30);
        lv_obj_align(btn_addition_count_minimum, LV_ALIGN_TOP_LEFT, 355, 116);
        lv_obj_set_style_border_width(btn_addition_count_minimum, 1, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_radius(btn_addition_count_minimum, 10, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_color(btn_addition_count_minimum, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        label_btn_addition_count_minimum = lv_label_create(btn_addition_count_minimum);
        lv_obj_set_style_text_font(label_btn_addition_count_minimum, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_btn_addition_count_minimum, lv_color_hex(0x1C1C1C), LV_STATE_DEFAULT);
        lv_label_set_text(label_btn_addition_count_minimum, "0");
        lv_obj_align(label_btn_addition_count_minimum, LV_ALIGN_CENTER, 0, 0);
        lv_obj_set_style_border_width(label_btn_addition_count_minimum, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_border_color(label_btn_addition_count_minimum, lv_color_hex(0x8a8a8a), LV_STATE_DEFAULT); /* 设置边框颜色 */
        lv_obj_set_style_border_opa(label_btn_addition_count_minimum, 100, LV_STATE_DEFAULT); /* 设置边框透明度 */
        lv_obj_set_style_radius(label_btn_addition_count_minimum, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_opa(label_btn_addition_count_minimum, LV_OPA_COVER, LV_PART_MAIN);
        lv_obj_set_style_bg_color(label_btn_addition_count_minimum, lv_color_hex(0xffffff), LV_PART_MAIN);
        lv_obj_add_event_cb(btn_addition_count_minimum, btn_addition_count_minimum_event_cb, LV_EVENT_CLICKED, NULL);


        LV_IMG_DECLARE(maximum);
        img_addition_count_maximum = lv_img_create(obj_addition_count_middle_bg);
        lv_img_set_src(img_addition_count_maximum, &maximum);
        lv_obj_align(img_addition_count_maximum, LV_ALIGN_TOP_LEFT, 255, 153);


        LV_FONT_DECLARE(heiFont16_1);
        label_addition_count_maximum = lv_label_create(obj_addition_count_middle_bg);
        lv_obj_set_style_text_font(label_addition_count_maximum, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_addition_count_maximum, lv_color_hex(0x000000), LV_STATE_DEFAULT);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_addition_count_maximum, "最大值");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_addition_count_maximum, "Maximum");
        }
        lv_obj_align(label_addition_count_maximum, LV_ALIGN_TOP_LEFT, 290, 159);


        LV_FONT_DECLARE(heiFont16_1);
        btn_addition_count_maximum = lv_btn_create(obj_addition_count_middle_bg);
        lv_obj_set_size(btn_addition_count_maximum, 110, 30);
        lv_obj_align(btn_addition_count_maximum, LV_ALIGN_TOP_LEFT, 355, 151);
        lv_obj_set_style_border_width(btn_addition_count_maximum, 1, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_radius(btn_addition_count_maximum, 10, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_color(btn_addition_count_maximum, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        label_btn_addition_count_maximum = lv_label_create(btn_addition_count_maximum);
        lv_obj_set_style_text_font(label_btn_addition_count_maximum, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_btn_addition_count_maximum, lv_color_hex(0x1C1C1C), LV_STATE_DEFAULT);
        lv_label_set_text(label_btn_addition_count_maximum, "999999999");
        lv_obj_align(label_btn_addition_count_maximum, LV_ALIGN_CENTER, 0, 0);
        lv_obj_set_style_border_width(label_btn_addition_count_maximum, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_border_color(label_btn_addition_count_maximum, lv_color_hex(0x8a8a8a), LV_STATE_DEFAULT); /* 设置边框颜色 */
        lv_obj_set_style_border_opa(label_btn_addition_count_maximum, 100, LV_STATE_DEFAULT); /* 设置边框透明度 */
        lv_obj_set_style_radius(label_btn_addition_count_maximum, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_opa(label_btn_addition_count_maximum, LV_OPA_COVER, LV_PART_MAIN);
        lv_obj_set_style_bg_color(label_btn_addition_count_maximum, lv_color_hex(0xffffff), LV_PART_MAIN);
        lv_obj_add_event_cb(btn_addition_count_maximum, btn_addition_count_maximum_event_cb, LV_EVENT_CLICKED, NULL);



        LV_IMG_DECLARE(step);
        img_addition_count_step = lv_img_create(obj_addition_count_middle_bg);
        lv_img_set_src(img_addition_count_step, &step);
        lv_obj_align(img_addition_count_step, LV_ALIGN_TOP_LEFT, 255, 188);

        LV_FONT_DECLARE(heiFont16_1);
        label_addition_count_step = lv_label_create(obj_addition_count_middle_bg);
        lv_obj_set_style_text_font(label_addition_count_step, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_addition_count_step, lv_color_hex(0x000000), LV_STATE_DEFAULT);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_addition_count_step, "步进值");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_addition_count_step, "Step");
        }
        lv_obj_align(label_addition_count_step, LV_ALIGN_TOP_LEFT, 290, 194);

        LV_FONT_DECLARE(heiFont16_1);
        btn_addition_count_step = lv_btn_create(obj_addition_count_middle_bg);
        lv_obj_set_size(btn_addition_count_step, 110, 30);
        lv_obj_align(btn_addition_count_step, LV_ALIGN_TOP_LEFT, 355, 186);
        lv_obj_set_style_border_width(btn_addition_count_step, 1, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_radius(btn_addition_count_step, 10, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_color(btn_addition_count_step, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        label_btn_addition_count_step = lv_label_create(btn_addition_count_step);
        lv_obj_set_style_text_font(label_btn_addition_count_step, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_btn_addition_count_step, lv_color_hex(0x1C1C1C), LV_STATE_DEFAULT);
        lv_label_set_text(label_btn_addition_count_step, "1");
        lv_obj_align(label_btn_addition_count_step, LV_ALIGN_CENTER, 0, 0);
        lv_obj_set_style_border_width(label_btn_addition_count_step, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_border_color(label_btn_addition_count_step, lv_color_hex(0x8a8a8a), LV_STATE_DEFAULT); /* 设置边框颜色 */
        lv_obj_set_style_border_opa(label_btn_addition_count_step, 100, LV_STATE_DEFAULT); /* 设置边框透明度 */
        lv_obj_set_style_radius(label_btn_addition_count_step, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_opa(label_btn_addition_count_step, LV_OPA_COVER, LV_PART_MAIN);
        lv_obj_set_style_bg_color(label_btn_addition_count_step, lv_color_hex(0xffffff), LV_PART_MAIN);
        lv_obj_add_event_cb(btn_addition_count_step, btn_addition_count_step_event_cb, LV_EVENT_CLICKED, NULL);



        obj_addition_count_bottom_bg = lv_obj_create(lv_scr_act());
        lv_obj_set_size(obj_addition_count_bottom_bg, 480, 24);
        lv_obj_align(obj_addition_count_bottom_bg, LV_ALIGN_TOP_LEFT, 0, 248);
        lv_obj_set_style_border_width(obj_addition_count_bottom_bg, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_radius(obj_addition_count_bottom_bg, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_color(obj_addition_count_bottom_bg, lv_color_hex(0x28536a), LV_STATE_DEFAULT);
        lv_obj_remove_style(obj_addition_count_bottom_bg, 0, LV_PART_SCROLLBAR);


        LV_FONT_DECLARE(heiFont16_1);
        label_addition_count_return = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_addition_count_return, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_addition_count_return, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_addition_count_return, "返回");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_addition_count_return, "Return");
        }
        lv_obj_align(label_addition_count_return, LV_ALIGN_TOP_LEFT, 140, 252);


        LV_IMG_DECLARE(get_back);
        imgbtn_addition_count_return = lv_imgbtn_create(lv_scr_act());
        lv_imgbtn_set_src(imgbtn_addition_count_return, LV_IMGBTN_STATE_RELEASED, NULL, &get_back, NULL);
        lv_obj_set_size(imgbtn_addition_count_return, get_back.header.w, get_back.header.h);
        lv_obj_align(imgbtn_addition_count_return, LV_ALIGN_TOP_LEFT, 180, 250);
        lv_obj_add_event_cb(imgbtn_addition_count_return, btn_addition_count_return_event_cb, LV_EVENT_CLICKED, NULL);

        LV_IMG_DECLARE(confirm);
        imgbtn_addition_count_confirm = lv_imgbtn_create(lv_scr_act());
        lv_imgbtn_set_src(imgbtn_addition_count_confirm, LV_IMGBTN_STATE_RELEASED, NULL, &confirm, NULL);
        lv_obj_set_size(imgbtn_addition_count_confirm, get_back.header.w, get_back.header.h);
        lv_obj_align(imgbtn_addition_count_confirm, LV_ALIGN_TOP_LEFT, 250, 250);
        lv_obj_add_event_cb(imgbtn_addition_count_confirm, btn_addition_count_confirm_event_cb, LV_EVENT_CLICKED, NULL);

        LV_FONT_DECLARE(heiFont16_1);
        label_addition_count_confirm = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_addition_count_confirm, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_addition_count_confirm, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_addition_count_confirm, "确定");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_addition_count_confirm, "Confirm");
        }
        lv_obj_align(label_addition_count_confirm, LV_ALIGN_TOP_LEFT, 277, 252);

        btn_addition_count_updata();
    }
}


static void btn_addition_subsection_event_cb(lv_event_t* e)
{
    unsigned char break_num = 0;
    unsigned char i;
    lv_event_code_t code;

    code = lv_event_get_code(e);

    unsigned char win_content_child_num;

    if ((code == LV_EVENT_CLICKED) && (print_status == 0))
    {
        printf("btn_addition_subsection_event_cb\n");

        win_content_child_num = lv_obj_get_child_cnt(win_content);

        for (i = 0; i < win_content_child_num; i++)
        {
            if (data_structure[i].type == TYPE_BREAK)
            {
                break_num++;
            }
        }

        printf("win_content_child_num=%u\n\r", win_content_child_num);

        if((win_content_child_num < NEW_TEXT_MAX_NUMBER)&&(break_num < BREAK_MAX_NUMBER))
        {
            lv_obj_t* temp_obj = lv_obj_create(win_content);

            data_structure[win_content_child_num].type = TYPE_BREAK;

            lv_obj_set_style_bg_opa(temp_obj, LV_OPA_COVER, 0);
            //lv_obj_set_style_bg_color(temp_obj, lv_color_hex(0xFF6A6A), LV_STATE_DEFAULT);
            lv_obj_set_style_bg_color(temp_obj, lv_color_hex(0x000000), LV_STATE_DEFAULT);
            lv_obj_set_style_border_width(temp_obj, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */

            lv_obj_add_event_cb(temp_obj, drag_event_handler, LV_EVENT_PRESSING, NULL);
            lv_obj_add_event_cb(temp_obj, drag_event_handler, LV_EVENT_FOCUSED, NULL);
            lv_obj_add_event_cb(temp_obj, drag_event_handler, LV_EVENT_DEFOCUSED, NULL);
            lv_obj_clear_flag(temp_obj, LV_OBJ_FLAG_SCROLLABLE);

            lv_obj_set_size(temp_obj, 5, 150);

            //lv_obj_align(temp_obj, LV_ALIGN_TOP_LEFT, 30, 0);

            lv_obj_align(temp_obj, LV_ALIGN_TOP_LEFT, 30 + 20*win_content_child_num, 0);
        }

        //删除添加界面
        lv_obj_del(img_addition_bg);
        lv_obj_del(btn_addition_text);
        lv_obj_del(label_btn_addition_text);
        lv_obj_del(btn_addition_date);
        lv_obj_del(label_btn_addition_date);
        lv_obj_del(btn_addition_picture);
        lv_obj_del(label_btn_addition_picture);
        lv_obj_del(btn_addition_QR_code);
        lv_obj_del(label_btn_addition_QR_code);
        lv_obj_del(btn_addition_bar_code);
        lv_obj_del(label_btn_addition_bar_code);
        lv_obj_del(btn_addition_count);
        lv_obj_del(label_btn_addition_count);
        lv_obj_del(btn_addition_subsection);
        lv_obj_del(label_btn_addition_subsection);
        lv_obj_del(btn_addition_symbol);
        lv_obj_del(label_btn_addition_symbol);
        lv_obj_del(btn_addition_icon);
        lv_obj_del(label_btn_addition_icon);
        lv_obj_del(btn_addition_more_functions);
        lv_obj_del(label_btn_addition_more_functions);
        lv_obj_del(btn_addition_return);
    }
    
}


static void btn_addition_symbol_one_event_cb(lv_event_t* e)
{
    lv_event_code_t code;
    int i;
    lv_obj_t* obj = lv_event_get_target(e);
    code = lv_event_get_code(e);
    if (code == LV_EVENT_FOCUSED)
    {
        //printf("btn_addition_symbol_one_event_cb LV_EVENT_FOCUSED\n");
        buzzer_enable = 1;
        lv_obj_t* label = lv_obj_get_child(obj, 0);
        for (i = 0; i < SYMBOL_NUMBER; i++)
        {
            if (strncmp(lv_label_get_text(label), g_addition_symbol[i], strlen(lv_label_get_text(label))) == 0)
            {
                break;
            }
        }
        g_symbol_flag = i;

        printf("g_symbol_flag=%d\n\r", g_symbol_flag);

        lv_obj_set_style_border_color(obj, lv_color_hex(0x00FF7F), LV_PART_MAIN); /* 设置边框颜色 */
    }
    else if (code == LV_EVENT_DEFOCUSED)
    {
        printf("btn_addition_symbol_one_event_cb LV_EVENT_DEFOCUSED\n");
        //lv_obj_set_style_bg_color(obj, lv_color_hex(0xffffff), LV_PART_MAIN);

        lv_obj_set_style_border_color(obj, lv_color_hex(0x000000), LV_PART_MAIN); /* 设置边框颜色 */
    }
}


static void btn_addition_symbol_confirm_event_cb(lv_event_t* e)
{
    lv_event_code_t code;
    int i;
    int win_content_child_num;
    char temp_typeface[128] = { 0 };
    code = lv_event_get_code(e);
    if (code == LV_EVENT_CLICKED)
    {
        printf("btn_addition_symbol_confirm_event_cb\n");

        win_content_child_num = lv_obj_get_child_cnt(win_content);

        printf("win_content_child_num=%u\n\r", win_content_child_num);

        if (win_content_child_num < NEW_TEXT_MAX_NUMBER)
        {
            lv_obj_t* temp_obj = lv_obj_create(win_content);

            sprintf(temp_typeface, "/media/%s", typeface_buf[0]);
            data_structure[win_content_child_num].data.word.typeface = 0;
            //info.name = "./lvgl/src/extra/libs/freetype/arial.ttf";
            //info.name = "./lvgl/src/extra/libs/freetype/simsun.ttc";
            //sprintf(temp_typeface, "./lvgl/src/extra/libs/freetype/%s", typeface_buf[SOURCE_HAN_SERIF_CN_REGULAR_1]);
            printf("%s\n", temp_typeface);

            data_structure[win_content_child_num].data.word.info.name = temp_typeface;
            data_structure[win_content_child_num].data.word.info.weight = 48;
            data_structure[win_content_child_num].data.word.info.style = FT_FONT_STYLE_NORMAL;
            lv_ft_font_init(&data_structure[win_content_child_num].data.word.info);

            lv_point_t text_size;
            lv_txt_get_size(&text_size, g_addition_symbol[g_symbol_flag], data_structure[win_content_child_num].data.word.info.font, 0, 0, LV_COORD_MAX, LV_TEXT_FLAG_NONE);
            
            lv_obj_set_style_bg_opa(temp_obj, LV_OPA_TRANSP, 0);
            lv_obj_set_style_border_width(temp_obj, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */

            lv_obj_add_event_cb(temp_obj, drag_event_handler, LV_EVENT_PRESSING, NULL);
            lv_obj_add_event_cb(temp_obj, drag_event_handler, LV_EVENT_FOCUSED, NULL);
            lv_obj_add_event_cb(temp_obj, drag_event_handler, LV_EVENT_DEFOCUSED, NULL);
            lv_obj_clear_flag(temp_obj, LV_OBJ_FLAG_SCROLLABLE);     

            lv_style_init(&data_structure[win_content_child_num].data.word.style);
            lv_style_set_text_font(&data_structure[win_content_child_num].data.word.style, data_structure[win_content_child_num].data.word.info.font);

            lv_obj_set_size(temp_obj, text_size.x, text_size.y);     

            //lv_obj_align(temp_obj, LV_ALIGN_TOP_LEFT, 30, 0); 
            lv_obj_align(temp_obj, LV_ALIGN_TOP_LEFT, 30 + 20*win_content_child_num, 6*win_content_child_num);

            lv_obj_t* label1 = lv_label_create(temp_obj);
            lv_obj_add_style(label1, &data_structure[win_content_child_num].data.word.style, 0);
            lv_label_set_text(label1, g_addition_symbol[g_symbol_flag]);
            lv_obj_center(label1);
     
            //strncpy(data_structure[win_content_child_num].data.word.text, g_addition_symbol[g_symbol_flag], strlen(g_addition_symbol[g_symbol_flag])+1);
            snprintf(data_structure[win_content_child_num].data.word.text, sizeof(data_structure[win_content_child_num].data.word.text),"%s", g_addition_symbol[g_symbol_flag]);
          
            data_structure[win_content_child_num].data.word.size = 48;
            printf("text=%s\n\r", data_structure[win_content_child_num].data.word.text);
            data_structure[win_content_child_num].type = TYPE_SYMBOL;
    
        }

        for (i = 0; i < SYMBOL_NUMBER; i++)
        {
            lv_obj_del(typeface_obj[i].obj_typeface_label);
            lv_obj_del(typeface_obj[i].obj_typeface_btn);
        }    

        lv_obj_del(win_content_typeface);
        lv_obj_del(win_obj_typeface);
        lv_obj_del(file_management_head_bg);
        lv_obj_del(label_file_management);
        lv_obj_del(keyboard_bg);
        lv_obj_del(label_typeface_return);
        lv_obj_del(label_typeface_confirm);
        lv_obj_del(btn_typeface_return);
        lv_obj_del(btn_typeface_confirm); 

        //删除添加界面
        lv_obj_del(img_addition_bg);
        lv_obj_del(btn_addition_text);
        lv_obj_del(label_btn_addition_text);
        lv_obj_del(btn_addition_date);
        lv_obj_del(label_btn_addition_date);
        lv_obj_del(btn_addition_picture);
        lv_obj_del(label_btn_addition_picture);
        lv_obj_del(btn_addition_QR_code);
        lv_obj_del(label_btn_addition_QR_code);
        lv_obj_del(btn_addition_bar_code);
        lv_obj_del(label_btn_addition_bar_code);
        lv_obj_del(btn_addition_count);
        lv_obj_del(label_btn_addition_count);
        lv_obj_del(btn_addition_subsection);
        lv_obj_del(label_btn_addition_subsection);
        lv_obj_del(btn_addition_symbol);
        lv_obj_del(label_btn_addition_symbol);
        lv_obj_del(btn_addition_icon);
        lv_obj_del(label_btn_addition_icon);
        lv_obj_del(btn_addition_more_functions);
        lv_obj_del(label_btn_addition_more_functions);
        lv_obj_del(btn_addition_return);  
    }
}



static void btn_addition_symbol_return_event_cb(lv_event_t* e)
{
    lv_event_code_t code;
    int i;
    //int win_content_child_num;
    //char temp_typeface[128] = { 0 };
    code = lv_event_get_code(e);
    if (code == LV_EVENT_CLICKED)
    {
        printf("btn_addition_symbol_return_event_cb\n");
        buzzer_enable = 1;

        for (i = 0; i < SYMBOL_NUMBER; i++)
        {
            lv_obj_del(typeface_obj[i].obj_typeface_label);
            lv_obj_del(typeface_obj[i].obj_typeface_btn);
        }    

        lv_obj_del(win_content_typeface);
        lv_obj_del(win_obj_typeface);
        lv_obj_del(file_management_head_bg);
        lv_obj_del(label_file_management);
        lv_obj_del(keyboard_bg);
        lv_obj_del(label_typeface_return);
        lv_obj_del(label_typeface_confirm);
        lv_obj_del(btn_typeface_return);
        lv_obj_del(btn_typeface_confirm); 

        //删除添加界面
        lv_obj_del(img_addition_bg);
        lv_obj_del(btn_addition_text);
        lv_obj_del(label_btn_addition_text);
        lv_obj_del(btn_addition_date);
        lv_obj_del(label_btn_addition_date);
        lv_obj_del(btn_addition_picture);
        lv_obj_del(label_btn_addition_picture);
        lv_obj_del(btn_addition_QR_code);
        lv_obj_del(label_btn_addition_QR_code);
        lv_obj_del(btn_addition_bar_code);
        lv_obj_del(label_btn_addition_bar_code);
        lv_obj_del(btn_addition_count);
        lv_obj_del(label_btn_addition_count);
        lv_obj_del(btn_addition_subsection);
        lv_obj_del(label_btn_addition_subsection);
        lv_obj_del(btn_addition_symbol);
        lv_obj_del(label_btn_addition_symbol);
        lv_obj_del(btn_addition_icon);
        lv_obj_del(label_btn_addition_icon);
        lv_obj_del(btn_addition_more_functions);
        lv_obj_del(label_btn_addition_more_functions);
        lv_obj_del(btn_addition_return);  
    }
}


static void btn_addition_symbol_event_cb(lv_event_t* e)
{
    lv_event_code_t code;
    //int len = 0;
    int i;
    //int offset_address = 6;
    //int line_num = 8;
    int size_wide = 22;
    int size_high = 24;
    //char temp[4]={0};

    code = lv_event_get_code(e);

    if ((code == LV_EVENT_CLICKED) && (print_status == 0))
    {
        printf("btn_addition_symbol_event_cb\n");
        buzzer_enable = 1;
        file_management_head_bg = lv_obj_create(lv_scr_act());
        lv_obj_set_size(file_management_head_bg, 480, 24);
        lv_obj_align(file_management_head_bg, LV_ALIGN_TOP_LEFT, 0, 0);
        lv_obj_set_style_border_width(file_management_head_bg, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_radius(file_management_head_bg, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_color(file_management_head_bg, lv_color_hex(0x28536a), LV_STATE_DEFAULT);
        lv_obj_remove_style(file_management_head_bg, 0, LV_PART_SCROLLBAR);

        LV_FONT_DECLARE(heiFont16_1);
        label_file_management = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_file_management, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_file_management, lv_color_hex(0xFFFFFF), LV_STATE_DEFAULT);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_file_management,  "符号");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_file_management, "Symbol");
        }
        lv_obj_align(label_file_management, LV_ALIGN_TOP_LEFT, 200, 4);


        win_obj_typeface = lv_obj_create(lv_scr_act());
        lv_obj_align(win_obj_typeface, LV_ALIGN_TOP_LEFT, 0, 24);
        lv_obj_set_size(win_obj_typeface, 480, 224);
        lv_obj_set_style_bg_color(win_obj_typeface, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        lv_obj_set_style_bg_opa(win_obj_typeface, LV_OPA_COVER, LV_STATE_DEFAULT);
        lv_obj_set_style_border_width(win_obj_typeface, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_border_color(win_obj_typeface, lv_color_hex(0xcccccc), LV_STATE_DEFAULT); /* 设置边框颜色 */
        lv_obj_clear_flag(win_obj_typeface, LV_OBJ_FLAG_SCROLLABLE);
        lv_obj_set_style_radius(win_obj_typeface, 0, LV_STATE_DEFAULT); /* 设置圆角 */


        win_content_typeface = lv_obj_create(win_obj_typeface);
        lv_obj_set_size(win_content_typeface, 480, 224);
        lv_obj_align(win_content_typeface, LV_ALIGN_TOP_LEFT, -15, -15);
        lv_obj_set_style_bg_color(win_content_typeface, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        lv_obj_set_style_border_width(win_content_typeface, 2, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_border_color(win_content_typeface, lv_color_hex(0xcccccc), LV_STATE_DEFAULT); /* 设置边框颜色 */
        lv_obj_clear_flag(win_content_typeface, LV_OBJ_FLAG_SCROLLABLE);
        lv_obj_set_style_radius(win_content_typeface, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_pad_all(win_content_typeface, 0, LV_STATE_DEFAULT);

        for (i = 0; i < SYMBOL_NUMBER; i++)
        {
            typeface_obj[i].obj_typeface_btn = lv_btn_create(win_content_typeface);
            lv_obj_set_size(typeface_obj[i].obj_typeface_btn, size_wide, size_high);
            lv_obj_align(typeface_obj[i].obj_typeface_btn, LV_ALIGN_TOP_LEFT, (i % 17 + 1) * 5 + (i % 17) * size_wide + 5, (i / 17 + 1) * 6 + i / 17 * size_high);
            lv_obj_set_style_border_width(typeface_obj[i].obj_typeface_btn, 1, LV_PART_MAIN); /* 设置边框宽度 */
            lv_obj_set_style_border_color(typeface_obj[i].obj_typeface_btn, lv_color_hex(0x000000), LV_PART_MAIN); /* 设置边框颜色 */
            lv_obj_set_style_radius(typeface_obj[i].obj_typeface_btn, 0, LV_PART_MAIN); /* 设置圆角 */
            lv_obj_set_style_bg_color(typeface_obj[i].obj_typeface_btn, lv_color_hex(0xffffff), LV_PART_MAIN);
            lv_obj_set_style_shadow_width(typeface_obj[i].obj_typeface_btn, 0, LV_PART_MAIN);
            lv_obj_add_event_cb(typeface_obj[i].obj_typeface_btn, btn_addition_symbol_one_event_cb, LV_EVENT_ALL, NULL);

            LV_FONT_DECLARE(heiFont8);
            typeface_obj[i].obj_typeface_label = lv_label_create(typeface_obj[i].obj_typeface_btn);
            lv_obj_set_style_text_font(typeface_obj[i].obj_typeface_label, &heiFont8, LV_STATE_DEFAULT);
            lv_obj_set_style_text_color(typeface_obj[i].obj_typeface_label, lv_color_hex(0x000000), LV_STATE_DEFAULT);
            //sprintf(temp,"%s",g_addition_symbol[i]);
            lv_label_set_text(typeface_obj[i].obj_typeface_label, g_addition_symbol[i]);
            lv_obj_align(typeface_obj[i].obj_typeface_label, LV_ALIGN_CENTER, 0, 0);
        }


        keyboard_bg = lv_obj_create(lv_scr_act());
        lv_obj_set_size(keyboard_bg, 480, 24);
        lv_obj_align(keyboard_bg, LV_ALIGN_TOP_LEFT, 0, 248);
        lv_obj_set_style_border_width(keyboard_bg, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_radius(keyboard_bg, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_color(keyboard_bg, lv_color_hex(0x28536a), LV_STATE_DEFAULT);
        lv_obj_remove_style(keyboard_bg, 0, LV_PART_SCROLLBAR);


        LV_FONT_DECLARE(heiFont16_1);
        label_typeface_return = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_typeface_return, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_typeface_return, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_typeface_return,  "返回");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_typeface_return, "Return");
        }
        lv_obj_align(label_typeface_return, LV_ALIGN_TOP_LEFT, 140, 252);

        LV_IMG_DECLARE(get_back);
        btn_typeface_return = lv_imgbtn_create(lv_scr_act());
        lv_imgbtn_set_src(btn_typeface_return, LV_IMGBTN_STATE_RELEASED, NULL, &get_back, NULL);
        lv_obj_set_size(btn_typeface_return, get_back.header.w, get_back.header.h);
        lv_obj_align(btn_typeface_return, LV_ALIGN_TOP_LEFT, 180, 250);
        lv_obj_add_event_cb(btn_typeface_return, btn_addition_symbol_return_event_cb, LV_EVENT_CLICKED, NULL);


        LV_IMG_DECLARE(confirm);
        btn_typeface_confirm = lv_imgbtn_create(lv_scr_act());
        lv_imgbtn_set_src(btn_typeface_confirm, LV_IMGBTN_STATE_RELEASED, NULL, &confirm, NULL);
        lv_obj_set_size(btn_typeface_confirm, get_back.header.w, get_back.header.h);
        lv_obj_align(btn_typeface_confirm, LV_ALIGN_TOP_LEFT, 250, 250);
        lv_obj_add_event_cb(btn_typeface_confirm, btn_addition_symbol_confirm_event_cb, LV_EVENT_CLICKED, NULL);

        LV_FONT_DECLARE(heiFont16_1);
        label_typeface_confirm = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_typeface_confirm, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_typeface_confirm, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_typeface_confirm,  "确定");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_typeface_confirm, "Confirm");
        }
        lv_obj_align(label_typeface_confirm, LV_ALIGN_TOP_LEFT, 277, 252);
    }
}


static void button_icon_confirm_event_cb(lv_event_t* e)
{
    lv_event_code_t code;
    int i, win_content_child_num;
    code = lv_event_get_code(e);
    if (code == LV_EVENT_CLICKED)
    {
        printf("button_icon_confirm_event_cb\n\r");
        buzzer_enable = 1;

        win_content_child_num = lv_obj_get_child_cnt(win_content);

        printf("win_content_child_num=%u\n\r", win_content_child_num);

        if(win_content_child_num < NEW_TEXT_MAX_NUMBER)
        {
            lv_obj_t* temp_obj = lv_obj_create(win_content);

            lv_obj_set_style_bg_opa(temp_obj, LV_OPA_TRANSP, 0);
            lv_obj_set_style_border_width(temp_obj, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */

            lv_obj_add_event_cb(temp_obj, drag_event_handler, LV_EVENT_PRESSING, NULL);
            lv_obj_add_event_cb(temp_obj, drag_event_handler, LV_EVENT_FOCUSED, NULL);
            lv_obj_add_event_cb(temp_obj, drag_event_handler, LV_EVENT_DEFOCUSED, NULL);
            lv_obj_clear_flag(temp_obj, LV_OBJ_FLAG_SCROLLABLE);

            lv_obj_t* img = lv_img_create(temp_obj);
            lv_img_set_src(img, &icon_buf[g_icon_type]);
            printf("w=%d\n\r", icon_buf[g_icon_type].header.w);
            printf("h=%d\n\r", icon_buf[g_icon_type].header.h);
            lv_obj_set_size(temp_obj, icon_buf[g_icon_type].header.w, icon_buf[g_icon_type].header.h);
            //lv_obj_align(temp_obj, LV_ALIGN_TOP_LEFT, 30, 0);
            lv_obj_align(temp_obj, LV_ALIGN_TOP_LEFT, 30 + 20*win_content_child_num, 6*win_content_child_num);
            lv_obj_center(img);
            data_structure[win_content_child_num].data.icon.type = g_icon_type;
            data_structure[win_content_child_num].data.icon.size = 256;
            data_structure[win_content_child_num].type = TYPE_ICON;
        }

        lv_obj_del(file_management_head_bg);
        lv_obj_del(label_file_management);

        for (i = 0; i < 98; i++)
        {
            lv_obj_del(lv_obj_get_child(typeface_obj[i].obj_typeface_btn, 0));
            lv_obj_del(typeface_obj[i].obj_typeface_btn);
        }

        lv_obj_del(win_content_typeface);
        lv_obj_del(win_obj_typeface);
        lv_obj_del(typeface_slider_bg);
        lv_obj_del(left_stop_img_typeface);
        lv_obj_del(slider_typeface);
        lv_obj_del(right_stop_img_typeface);
        lv_obj_del(keyboard_bg);
        lv_obj_del(label_typeface_return);
        lv_obj_del(btn_typeface_return);
        lv_obj_del(btn_typeface_confirm);
        lv_obj_del(label_typeface_confirm);

        //删除添加界面
        lv_obj_del(img_addition_bg);
        lv_obj_del(btn_addition_text);
        lv_obj_del(label_btn_addition_text);
        lv_obj_del(btn_addition_date);
        lv_obj_del(label_btn_addition_date);
        lv_obj_del(btn_addition_picture);
        lv_obj_del(label_btn_addition_picture);
        lv_obj_del(btn_addition_QR_code);
        lv_obj_del(label_btn_addition_QR_code);
        lv_obj_del(btn_addition_bar_code);
        lv_obj_del(label_btn_addition_bar_code);
        lv_obj_del(btn_addition_count);
        lv_obj_del(label_btn_addition_count);
        lv_obj_del(btn_addition_subsection);
        lv_obj_del(label_btn_addition_subsection);
        lv_obj_del(btn_addition_symbol);
        lv_obj_del(label_btn_addition_symbol);
        lv_obj_del(btn_addition_icon);
        lv_obj_del(label_btn_addition_icon);
        lv_obj_del(btn_addition_more_functions);
        lv_obj_del(label_btn_addition_more_functions);
        lv_obj_del(btn_addition_return);
    }
}





static void button_icon_event_cb(lv_event_t* e)
{
    lv_event_code_t code;
    //int i;
    lv_obj_t* obj = lv_event_get_target(e);
    code = lv_event_get_code(e);
    if (code == LV_EVENT_FOCUSED)
    {
        printf("button_icon_event_cb LV_EVENT_FOCUSED\n");
        buzzer_enable = 1;
        lv_obj_set_style_border_width(obj, 2, LV_PART_MAIN); /* 设置边框宽度 */

        g_icon_type = lv_obj_get_index(obj);

        printf("g_icon_type=%d\n\r", g_icon_type);
    }
    else if (code == LV_EVENT_DEFOCUSED)
    {
        printf("button_icon_event_cb LV_EVENT_DEFOCUSED\n");
        lv_obj_set_style_border_width(obj, 0, LV_PART_MAIN); /* 设置边框宽度 */
    }
}


static void button_icon_return_event_cb(lv_event_t* e)
{
    lv_event_code_t code;
    int i;
    code = lv_event_get_code(e);
    if (code == LV_EVENT_CLICKED)
    {
        printf("button_icon_confirm_event_cb\n\r");
        buzzer_enable = 1;

        lv_obj_del(file_management_head_bg);
        lv_obj_del(label_file_management);

        for (i = 0; i < 98; i++)
        {
            lv_obj_del(lv_obj_get_child(typeface_obj[i].obj_typeface_btn, 0));
            lv_obj_del(typeface_obj[i].obj_typeface_btn);
        }

        lv_obj_del(win_content_typeface);
        lv_obj_del(win_obj_typeface);
        lv_obj_del(typeface_slider_bg);
        lv_obj_del(left_stop_img_typeface);
        lv_obj_del(slider_typeface);
        lv_obj_del(right_stop_img_typeface);
        lv_obj_del(keyboard_bg);
        lv_obj_del(label_typeface_return);
        lv_obj_del(btn_typeface_return);
        lv_obj_del(btn_typeface_confirm);
        lv_obj_del(label_typeface_confirm);

        //删除添加界面
        lv_obj_del(img_addition_bg);
        lv_obj_del(btn_addition_text);
        lv_obj_del(label_btn_addition_text);
        lv_obj_del(btn_addition_date);
        lv_obj_del(label_btn_addition_date);
        lv_obj_del(btn_addition_picture);
        lv_obj_del(label_btn_addition_picture);
        lv_obj_del(btn_addition_QR_code);
        lv_obj_del(label_btn_addition_QR_code);
        lv_obj_del(btn_addition_bar_code);
        lv_obj_del(label_btn_addition_bar_code);
        lv_obj_del(btn_addition_count);
        lv_obj_del(label_btn_addition_count);
        lv_obj_del(btn_addition_subsection);
        lv_obj_del(label_btn_addition_subsection);
        lv_obj_del(btn_addition_symbol);
        lv_obj_del(label_btn_addition_symbol);
        lv_obj_del(btn_addition_icon);
        lv_obj_del(label_btn_addition_icon);
        lv_obj_del(btn_addition_more_functions);
        lv_obj_del(label_btn_addition_more_functions);
        lv_obj_del(btn_addition_return);
    }
}



static void icon_slider_event_cb(lv_event_t* e)
{
    lv_obj_t* target = lv_event_get_target(e); /* 获取触发源 */
    lv_event_code_t code = lv_event_get_code(e); /* 获取事件类型 */
    int32_t temp;
    static int32_t temp_last = 0;
    int x_data = 0;
    if ((code == LV_EVENT_VALUE_CHANGED) && (print_status == 0))
    {
        temp = lv_slider_get_value(target);
        printf("temp1=%d\n", temp);

        x_data = (temp - 100)*59/8;

        if (temp_last != temp)
        {
            lv_obj_set_pos(win_content_typeface, -16, x_data -16);//Limit drag boundaries 
        }
        temp_last = temp;
    }
}


void slider_show_icon()
{
    static const lv_style_prop_t props[] = { LV_STYLE_BG_COLOR,0 };  //设置位置参数
    static lv_style_transition_dsc_t transition_dsc;               //设置转换变量
    lv_style_transition_dsc_init(&transition_dsc, props, lv_anim_path_linear, 200, 0, NULL); //初始化转换

    static lv_style_t style_main;                                  //创建样式
    static lv_style_t style_indicator;                             //创建样式
    static lv_style_t style_knob;                                  //创建样式
    static lv_style_t style_pressed_color;                         //创建样式
    lv_style_init(&style_main);                                    //初始化样式
    lv_style_set_bg_opa(&style_main, LV_OPA_TRANSP);                 //设置背景透明度
    lv_style_set_bg_color(&style_main, lv_color_hex3(0xffffff));        //设置背景颜色
    lv_style_set_size_A(&style_main, 20, 142);
    lv_style_set_pad_ver(&style_main, 0);                          //设置上下边距
    lv_style_init(&style_indicator);                               //初始化样式
    lv_style_set_bg_opa(&style_indicator, LV_OPA_TRANSP);            //设置背景透明度
    lv_style_set_bg_color(&style_indicator, lv_color_hex3(0xffffff));//设置背景颜色
    lv_style_set_transition(&style_indicator, &transition_dsc);     //设置转化

    LV_IMG_DECLARE(img_slider_typeface);

    lv_style_init(&style_knob);                                    //初始化样式
    lv_style_set_bg_opa(&style_knob, LV_OPA_TRANSP);                 //设置背景透明度
    lv_style_set_bg_img_src(&style_knob, &img_slider_typeface);
    lv_style_set_border_color(&style_knob, lv_palette_darken(LV_PALETTE_GREY, 3));//设置边框背景颜色
    lv_style_set_border_width(&style_knob, 0);                      //设置边框宽度
    lv_style_set_pad_all(&style_knob, 20);                           //设置边距
    lv_style_set_size_A(&style_knob, 20, 10);
    lv_style_set_transition(&style_knob, &transition_dsc);          //设置转化

    lv_style_init(&style_pressed_color);                           //初始化样式
    lv_style_set_bg_color(&style_pressed_color, lv_color_hex3(0xAAAAAA));//设置背景颜色

    slider_typeface = lv_slider_create(lv_scr_act());            //创建滑块
    lv_obj_remove_style_all(slider_typeface);                               //移除所有样式

    lv_obj_add_style(slider_typeface, &style_main, LV_PART_MAIN);             //添加样式
    lv_obj_add_style(slider_typeface, &style_indicator, LV_PART_INDICATOR);   //添加样式 指示器
    lv_obj_add_style(slider_typeface, &style_pressed_color, LV_PART_INDICATOR | LV_STATE_PRESSED); //添加样式 指示器 按压状态
    lv_obj_add_style(slider_typeface, &style_knob, LV_PART_KNOB);             //添加样式 圆头
    lv_obj_add_style(slider_typeface, &style_pressed_color, LV_PART_KNOB | LV_STATE_PRESSED);      //添加样式 圆头 按压状态
    lv_obj_align(slider_typeface, LV_ALIGN_TOP_LEFT, 460, 65);
    //lv_obj_center(slider);                                         //居中显示
    lv_obj_add_event_cb(slider_typeface, icon_slider_event_cb, LV_EVENT_VALUE_CHANGED, NULL);
    lv_slider_set_value(slider_typeface, 100, LV_ANIM_ON);
}


static void btn_addition_icon_event_cb(lv_event_t* e)
{
    lv_event_code_t code;
    //int len = 0;
    int i;
    //int offset_address = 6;
    //int line_num = 8;
    int size_wide = 50;
    int size_high = 67;

    code = lv_event_get_code(e);

    if ((code == LV_EVENT_CLICKED) && (print_status == 0))
    {
        printf("btn_addition_icon_event_cb\n");
        buzzer_enable = 1;

        //显示图标50*67
        file_management_head_bg = lv_obj_create(lv_scr_act());
        lv_obj_set_size(file_management_head_bg, 480, 24);
        lv_obj_align(file_management_head_bg, LV_ALIGN_TOP_LEFT, 0, 0);
        lv_obj_set_style_border_width(file_management_head_bg, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_radius(file_management_head_bg, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_color(file_management_head_bg, lv_color_hex(0x28536a), LV_STATE_DEFAULT);
        lv_obj_remove_style(file_management_head_bg, 0, LV_PART_SCROLLBAR);


        LV_FONT_DECLARE(heiFont16_1);
        label_file_management = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_file_management, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_file_management, lv_color_hex(0xFFFFFF), LV_STATE_DEFAULT);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_file_management,  "标识");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_file_management, "Icon");
        }
        lv_obj_align(label_file_management, LV_ALIGN_TOP_LEFT, 200, 4);


        win_obj_typeface = lv_obj_create(lv_scr_act());
        lv_obj_align(win_obj_typeface, LV_ALIGN_TOP_LEFT, 0, 24);
        lv_obj_set_size(win_obj_typeface, 480, 224);
        lv_obj_set_style_bg_color(win_obj_typeface, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        lv_obj_set_style_bg_opa(win_obj_typeface, LV_OPA_COVER, LV_STATE_DEFAULT);
        lv_obj_set_style_border_width(win_obj_typeface, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_border_color(win_obj_typeface, lv_color_hex(0xcccccc), LV_STATE_DEFAULT); /* 设置边框颜色 */
        lv_obj_clear_flag(win_obj_typeface, LV_OBJ_FLAG_SCROLLABLE);
        lv_obj_set_style_radius(win_obj_typeface, 0, LV_STATE_DEFAULT); /* 设置圆角 */


        win_content_typeface = lv_obj_create(win_obj_typeface);
        lv_obj_set_size(win_content_typeface, 460, 960);
        lv_obj_align(win_content_typeface, LV_ALIGN_TOP_LEFT, -15, -15);
        lv_obj_set_style_bg_color(win_content_typeface, lv_color_hex(0x00F5FF), LV_STATE_DEFAULT);
        lv_obj_set_style_border_width(win_content_typeface, 2, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_border_color(win_content_typeface, lv_color_hex(0xcccccc), LV_STATE_DEFAULT); /* 设置边框颜色 */
        lv_obj_clear_flag(win_content_typeface, LV_OBJ_FLAG_SCROLLABLE);
        lv_obj_set_style_radius(win_content_typeface, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_pad_all(win_content_typeface, 0, LV_STATE_DEFAULT);


        typeface_slider_bg = lv_obj_create(lv_scr_act());
        lv_obj_set_size(typeface_slider_bg, 20, 224);
        lv_obj_align(typeface_slider_bg, LV_ALIGN_TOP_LEFT, 460, 24);
        lv_obj_set_style_border_width(typeface_slider_bg, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_border_color(typeface_slider_bg, lv_color_hex(0xaaaaaa), LV_STATE_DEFAULT); /* 设置边框颜色 */
        lv_obj_set_style_radius(typeface_slider_bg, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_color(typeface_slider_bg, lv_color_hex(0xaaaaaa), LV_STATE_DEFAULT);

        //左滑块停止
        LV_IMG_DECLARE(left_stop_typeface);
        left_stop_img_typeface = lv_img_create(lv_scr_act());
        lv_img_set_src(left_stop_img_typeface, &left_stop_typeface);
        lv_obj_align(left_stop_img_typeface, LV_ALIGN_TOP_LEFT, 460, 228);

        slider_show_icon();

        //右滑块停止
        LV_IMG_DECLARE(right_stop_typeface);
        right_stop_img_typeface = lv_img_create(lv_scr_act());
        lv_img_set_src(right_stop_img_typeface, &right_stop_typeface);
        lv_obj_align(right_stop_img_typeface, LV_ALIGN_TOP_LEFT, 460, 24);


        for (i = 0; i < 98; i++)
        {
            typeface_obj[i].obj_typeface_btn = lv_btn_create(win_content_typeface);
            lv_obj_set_size(typeface_obj[i].obj_typeface_btn, size_wide, size_high);
            lv_obj_align(typeface_obj[i].obj_typeface_btn, LV_ALIGN_TOP_LEFT, (i % 8 + 1) * 6 + (i % 8) * size_wide, (i / 8 + 1) * 6 + i / 8 * size_high);
            lv_obj_set_style_border_width(typeface_obj[i].obj_typeface_btn, 0, LV_PART_MAIN); /* 设置边框宽度 */
            lv_obj_set_style_border_color(typeface_obj[i].obj_typeface_btn, lv_color_hex(0xff0000), LV_PART_MAIN); /* 设置边框颜色 */
            lv_obj_set_style_radius(typeface_obj[i].obj_typeface_btn, 5, LV_PART_MAIN); /* 设置圆角 */
            lv_obj_set_style_bg_color(typeface_obj[i].obj_typeface_btn, lv_color_hex(0xffffff), LV_PART_MAIN);
            lv_obj_set_style_shadow_width(typeface_obj[i].obj_typeface_btn, 0, LV_PART_MAIN);
            lv_obj_add_event_cb(typeface_obj[i].obj_typeface_btn, button_icon_event_cb, LV_EVENT_ALL, NULL);


            //LV_IMG_DECLARE(upward);
            lv_obj_t* img = lv_img_create(typeface_obj[i].obj_typeface_btn);
            //lv_img_set_src(img, &upward);
            if (i < 98)
            {
                lv_img_set_src(img, &icon_buf[i]);
            }
            else
            {
                lv_img_set_src(img, &icon_buf[0]);
            }

            if (i == 2)
            {
                lv_img_set_zoom(img, 80);
            }
            else if (i == 6)
            {
                lv_img_set_zoom(img, 80);
            }
            else if (i == 9)
            {
                lv_img_set_zoom(img, 30);
            }
            else if (i == 11)
            {
                lv_img_set_zoom(img, 80);
            }
            else if (i == 15)
            {
                lv_img_set_zoom(img, 80);
            }
            else if (i == 19)
            {
                lv_img_set_zoom(img, 80);
            }
            else if (i == 23)
            {
                lv_img_set_zoom(img, 80);
            }
            else if (i == 27)
            {
                lv_img_set_zoom(img, 80);
            }
            else if (i == 31)
            {
                lv_img_set_zoom(img, 80);
            }
            else if (i == 35)
            {
                lv_img_set_zoom(img, 80);
            }
            else if((i > 36)&&(i < 44))
            {
                lv_img_set_zoom(img, 80);
            }
            else if (i == 45)
            {
                lv_img_set_zoom(img, 70);
            }
            else if ((i > 45) && (i < 50))
            {
                lv_img_set_zoom(img, 80);
            }
            else if (i == 57)
            {
                lv_img_set_zoom(img, 70);
            }
            else if (i == 59)
            {
                lv_img_set_zoom(img, 70);
            }
            else if (i == 60)
            {
                lv_img_set_zoom(img, 40);
            }
            else if (i == 61)
            {
                lv_img_set_zoom(img, 80);
            }
            else if (i == 62)
            {
                lv_img_set_zoom(img, 80);
            }
            else if (i == 63)
            {
                lv_img_set_zoom(img, 60);
            }
            else if (i == 64)
            {
                lv_img_set_zoom(img, 60);
            }
            else if (i == 65)
            {
                lv_img_set_zoom(img, 80);
            }
            else if (i == 66)
            {
                lv_img_set_zoom(img, 70);
            }
            else if (i == 67)
            {
                lv_img_set_zoom(img, 55);
            }
            else if (i == 68)
            {
                lv_img_set_zoom(img, 25);
            }
            else if (i == 69)
            {
                lv_img_set_zoom(img, 50);
            }
            else if (i == 70)
            {
                lv_img_set_zoom(img, 85);
            }
            else if (i == 71)
            {
                lv_img_set_zoom(img, 80);
            }
            else if (i == 72)
            {
                lv_img_set_zoom(img, 70);
            }
            else if (i == 73)
            {
                lv_img_set_zoom(img, 70);
            }
            else if (i == 74)
            {
                lv_img_set_zoom(img, 70);
            }
            else if (i == 75)
            {
                lv_img_set_zoom(img, 50);
            }
            else if (i == 76)
            {
                lv_img_set_zoom(img, 70);
            }
            else if (i == 77)
            {
                lv_img_set_zoom(img, 70);
            }
            else if (i == 78)
            {
                lv_img_set_zoom(img, 70);
            }
            else if (i == 80)
            {
                lv_img_set_zoom(img, 60);
            }
            else if (i == 81)
            {
                lv_img_set_zoom(img, 45);
            }
            else if (i == 82)
            {
                lv_img_set_zoom(img, 45);
            }
            else if (i == 83)
            {
                lv_img_set_zoom(img, 60);
            }
            else if (i == 84)
            {
                lv_img_set_zoom(img, 60);
            }
            else if (i == 85)
            {
                lv_img_set_zoom(img, 70);
            }
            else if (i == 86)
            {
                lv_img_set_zoom(img, 70);
            }
            else if (i == 87)
            {
                lv_img_set_zoom(img, 55);
            }
            else if (i == 88)
            {
                lv_img_set_zoom(img, 35);
            }
            else if (i == 89)
            {
                lv_img_set_zoom(img, 80);
            }
            else if (i == 90)
            {
                lv_img_set_zoom(img, 65);
            }
            else if (i == 91)
            {
                lv_img_set_zoom(img, 70);
            }
            else if (i == 92)
            {
                lv_img_set_zoom(img, 70);
            }
            else if (i == 93)
            {
                lv_img_set_zoom(img, 80);
            }
            else if (i == 94)
            {
                lv_img_set_zoom(img, 80);
            }
            else if (i == 95)
            {
                lv_img_set_zoom(img, 80);
            }
            else if (i == 96)
            {
                lv_img_set_zoom(img, 80);
            }
            else if (i == 97)
            {
                lv_img_set_zoom(img, 80);
            }
            else
            {
                lv_img_set_zoom(img, 100);
            }
            lv_obj_align(img, LV_ALIGN_CENTER, 0, 0);
        }


        keyboard_bg = lv_obj_create(lv_scr_act());
        lv_obj_set_size(keyboard_bg, 480, 24);
        lv_obj_align(keyboard_bg, LV_ALIGN_TOP_LEFT, 0, 248);
        lv_obj_set_style_border_width(keyboard_bg, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_radius(keyboard_bg, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_color(keyboard_bg, lv_color_hex(0x28536a), LV_STATE_DEFAULT);
        lv_obj_remove_style(keyboard_bg, 0, LV_PART_SCROLLBAR);


        LV_FONT_DECLARE(heiFont16_1);
        label_typeface_return = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_typeface_return, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_typeface_return, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_typeface_return,  "返回");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_typeface_return, "Return");
        }
        lv_obj_align(label_typeface_return, LV_ALIGN_TOP_LEFT, 140, 252);

        LV_IMG_DECLARE(get_back);
        btn_typeface_return = lv_imgbtn_create(lv_scr_act());
        lv_imgbtn_set_src(btn_typeface_return, LV_IMGBTN_STATE_RELEASED, NULL, &get_back, NULL);
        lv_obj_set_size(btn_typeface_return, get_back.header.w, get_back.header.h);
        lv_obj_align(btn_typeface_return, LV_ALIGN_TOP_LEFT, 180, 250);
        lv_obj_add_event_cb(btn_typeface_return, button_icon_return_event_cb, LV_EVENT_CLICKED, NULL);


        LV_IMG_DECLARE(confirm);
        btn_typeface_confirm = lv_imgbtn_create(lv_scr_act());
        lv_imgbtn_set_src(btn_typeface_confirm, LV_IMGBTN_STATE_RELEASED, NULL, &confirm, NULL);
        lv_obj_set_size(btn_typeface_confirm, get_back.header.w, get_back.header.h);
        lv_obj_align(btn_typeface_confirm, LV_ALIGN_TOP_LEFT, 250, 250);
        lv_obj_add_event_cb(btn_typeface_confirm, button_icon_confirm_event_cb, LV_EVENT_CLICKED, NULL);

        LV_FONT_DECLARE(heiFont16_1);
        label_typeface_confirm = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_typeface_confirm, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_typeface_confirm, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_typeface_confirm,  "确定");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_typeface_confirm, "Confirm");
        }
        lv_obj_align(label_typeface_confirm, LV_ALIGN_TOP_LEFT, 277, 252);
    }
}


static void btn_addition_more_functions_event_cb(lv_event_t* e)
{
    lv_event_code_t code;

    code = lv_event_get_code(e);

    if ((code == LV_EVENT_CLICKED) && (print_status == 0))
    {
        printf("btn_addition_more_functions_event_cb\n");
    }
}

static void imgbtn_addition_return_event_cb(lv_event_t* e)
{
    lv_event_code_t code;
    code = lv_event_get_code(e);
    if (code == LV_EVENT_CLICKED)
    {
        printf("imgbtn_addition_return_event_cb\n");
        buzzer_enable = 1;

        lv_obj_del(img_addition_bg);
        lv_obj_del(btn_addition_text);
        lv_obj_del(label_btn_addition_text);
        lv_obj_del(btn_addition_date);
        lv_obj_del(label_btn_addition_date);
        lv_obj_del(btn_addition_picture);
        lv_obj_del(label_btn_addition_picture);
        lv_obj_del(btn_addition_QR_code);
        lv_obj_del(label_btn_addition_QR_code);
        lv_obj_del(btn_addition_bar_code);
        lv_obj_del(label_btn_addition_bar_code);
        lv_obj_del(btn_addition_count);
        lv_obj_del(label_btn_addition_count);
        lv_obj_del(btn_addition_subsection);
        lv_obj_del(label_btn_addition_subsection);
        lv_obj_del(btn_addition_symbol);
        lv_obj_del(label_btn_addition_symbol);
        lv_obj_del(btn_addition_icon);
        lv_obj_del(label_btn_addition_icon);
        lv_obj_del(btn_addition_more_functions);
        lv_obj_del(label_btn_addition_more_functions);
        lv_obj_del(btn_addition_return);
    }
}
#if 0
static void imgbtn_addition_confirm_event_cb(lv_event_t* e)
{
    lv_event_code_t code;
    code = lv_event_get_code(e);
    char temp_typeface[128] = { 0 };
    int i = 0;
    int word_space = 0;
    int word_size = 0;
    int x_size = 0;
    //int y_size = 0;
    int win_content_child_num = 0;


   // char tempString[128] = { 0 };
    if (code == LV_EVENT_CLICKED)
    {
        printf("\nbutton_file_management_confirm_event_cb\n");

        int len = strlen(lv_label_get_text(label_file_management_label)) + 1;
        printf("len=%u\n\r", len);

        win_content_child_num = lv_obj_get_child_cnt(win_content);

        if ((len > 1) && (win_content_child_num < NEW_TEXT_MAX_NUMBER))
        {
            lv_obj_t* temp_obj = lv_obj_create(win_content);

            for (i = 0; i < TYPEFACE_NUMBER; i++)
            {
                if (strncmp(lv_label_get_text(label_file_management_typeface_label), typeface_name[i], strlen(lv_label_get_text(label_file_management_typeface_label))) == 0)
                {
                    break;
                }
            }

            sprintf(temp_typeface, "/media/%s", typeface_buf[i]);
            data_structure[win_content_child_num].data.word.typeface = i;

            //info.name = "./lvgl/src/extra/libs/freetype/arial.ttf";
            //info.name = "./lvgl/src/extra/libs/freetype/simsun.ttc";
            //sprintf(temp_typeface, "./lvgl/src/extra/libs/freetype/%s", typeface_buf[SOURCE_HAN_SERIF_CN_REGULAR_1]);
            printf("%s\n", temp_typeface);

            data_structure[win_content_child_num].data.word.info.name = temp_typeface;

            word_size = atoi(lv_label_get_text(label_file_management_word_size_label));

            if (word_size < 12)
            {
                word_size = 12;
            }

            if (word_size > 200)
            {
                word_size = 200;
            }

            data_structure[win_content_child_num].data.word.info.weight = word_size;

            data_structure[win_content_child_num].data.word.info.style = FT_FONT_STYLE_NORMAL;

            if (lv_obj_has_state(sw_management_line_italic, LV_STATE_CHECKED) == 1)
            {
                data_structure[win_content_child_num].data.word.info.style |= FT_FONT_STYLE_ITALIC;
            }

            if (lv_obj_has_state(sw_file_management_bold, LV_STATE_CHECKED) == 1)
            {
                data_structure[win_content_child_num].data.word.info.style |= FT_FONT_STYLE_BOLD;
            }

            lv_ft_font_init(&data_structure[win_content_child_num].data.word.info);

            lv_point_t text_size;
            lv_txt_get_size(&text_size, lv_label_get_text(label_file_management_label), data_structure[win_content_child_num].data.word.info.font, 0, 0, LV_COORD_MAX, LV_TEXT_FLAG_NONE);


            lv_obj_set_style_bg_opa(temp_obj, LV_OPA_TRANSP, 0);
            lv_obj_set_style_border_width(temp_obj, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */

            lv_obj_add_event_cb(temp_obj, drag_event_handler, LV_EVENT_PRESSING, NULL);
            lv_obj_add_event_cb(temp_obj, drag_event_handler, LV_EVENT_FOCUSED, NULL);
            lv_obj_add_event_cb(temp_obj, drag_event_handler, LV_EVENT_DEFOCUSED, NULL);
            lv_obj_clear_flag(temp_obj, LV_OBJ_FLAG_SCROLLABLE);

            lv_style_init(&data_structure[win_content_child_num].data.word.style);
            lv_style_set_text_font(&data_structure[win_content_child_num].data.word.style, data_structure[win_content_child_num].data.word.info.font);

            word_space = atoi(lv_label_get_text(label_file_management_word_space_label));

            if (word_space < 0)
            {
                word_space = 0;
            }

            if (word_space > 100)
            {
                word_space = 100;
            }
            printf("x=%u y=%u\n\r", text_size.x, text_size.y);

            x_size = text_size.x + text_size.x / text_size.y * word_space * 2;

            printf("x_size=%d\n\r", x_size);

            lv_obj_set_size(temp_obj, x_size, text_size.y);

            lv_style_set_text_letter_space(&data_structure[win_content_child_num].data.word.style, word_space);
            lv_obj_t* label1 = lv_label_create(temp_obj);
            lv_obj_add_style(label1, &data_structure[win_content_child_num].data.word.style, 0);
            lv_label_set_text(label1, lv_label_get_text(label_file_management_label));
            lv_obj_center(label1);
            strncpy(data_structure[win_content_child_num].data.word.text, lv_label_get_text(label_file_management_label), len);
            data_structure[win_content_child_num].data.word.size = word_size;
            data_structure[win_content_child_num].data.word.space = word_space;
            data_structure[win_content_child_num].data.word.italic_bold = data_structure[win_content_child_num].data.word.info.style;
            printf("italic_bold=%d\n\r", data_structure[win_content_child_num].data.word.italic_bold);
            printf("text=%s\n\r", data_structure[win_content_child_num].data.word.text);
        }

        lv_obj_del(file_management_win);
        lv_obj_del(file_management_head_bg);
        lv_obj_del(label_file_management_total_output);
        lv_obj_del(label_file_management);
        lv_obj_del(label_file_management_date);
        lv_obj_del(label_file_management_time);
        lv_obj_del(img_file_management_battery_level);
        lv_obj_del(label_file_management_label);
        lv_obj_del(file_management_middle_bg);
        lv_obj_del(img_file_management_text);
        lv_obj_del(label_file_management_text);
        lv_obj_del(label_file_management_text_label);

        lv_obj_del(img_file_management_typeface);
        lv_obj_del(label_file_management_typeface);
        lv_obj_del(label_file_management_typeface_label);
        lv_obj_del(img_file_management_word_space);
        lv_obj_del(label_file_management_word_space);
        lv_obj_del(label_file_management_word_space_label);
        lv_obj_del(img_file_management_word_size);
        lv_obj_del(label_file_management_word_size);
        lv_obj_del(label_file_management_word_size_label);
        lv_obj_del(img_file_management_spin);
        lv_obj_del(label_file_management_spin);
        lv_obj_del(label_file_management_spin_label);
        lv_obj_del(img_file_management_width);
        lv_obj_del(label_file_management_width);
        lv_obj_del(label_file_management_width_label);
        lv_obj_del(img_file_management_bold);
        lv_obj_del(label_file_management_bold);
        lv_obj_del(sw_file_management_bold);
        lv_obj_del(img_management_line_italic);
        lv_obj_del(label_management_line_italic);
        lv_obj_del(sw_management_line_italic);
        lv_obj_del(file_management_bottom_bg);
        lv_obj_del(label_file_management_return);
        lv_obj_del(imgbtn_file_management_get_back);
        lv_obj_del(imgbtn_file_management_confirm);
        lv_obj_del(label_file_management_confirm);
        lv_obj_del(btn_file_management_text);
        lv_obj_del(btn_file_management_typeface);
        lv_obj_del(btn_file_management_word_space_label);
        lv_obj_del(btn_file_management_word_size_label);
    }
}
#endif


static void button_time_keyboard_confirm_event_cb(lv_event_t* e)
{
    lv_event_code_t code;
    int i;
    code = lv_event_get_code(e);
    if (code == LV_EVENT_CLICKED)
    {
        printf("button_time_keyboard_confirm_event_cb\n");
        //获取输入框数据给到文本显示框
        lv_label_set_text(label_btn_label_addition_time, lv_textarea_get_text(textarea_text_keyboard));
        lv_label_set_text(label_addition_date_middle, lv_textarea_get_text(textarea_text_keyboard));
        lv_obj_del(textarea_bg_keyboard);
        lv_obj_del(pinyin_ime);
        lv_obj_del(textarea_text_keyboard);
        lv_obj_del(keyboard_bg);
        lv_obj_del(label_keyboard_confirm);
        lv_obj_del(btn_keyboard_confirm);
        lv_obj_del(label_keyboard_return);
        lv_obj_del(btn_keyboard_return);

        lv_obj_del(obj_addition_date_text_head_bg);
        lv_obj_del(label_addition_date_text_head);

        for (i = 0; i < TIME_TYPE_NUMBER; i++)
        {
            lv_obj_del(date_type_obj[i].obj_date_label);
            lv_obj_del(date_type_obj[i].obj_date_btn);
        }

        lv_obj_del(obj_addition_date_text_middle_bg);

        lv_obj_del(label_addition_date_text_return);
        lv_obj_del(btn_addition_date_text_return);
        lv_obj_del(btn_addition_date_confirm);
        lv_obj_del(label_addition_date_confirm);

        date_or_time_flag = 1;
        g_time_type = 5;
    }
}


static void button_time_keyboard_return_event_cb(lv_event_t* e)
{
    lv_event_code_t code;
    int i;
    code = lv_event_get_code(e);
    if (code == LV_EVENT_CLICKED)
    {
        printf("button_time_keyboard_return_event_cb\n");
        lv_obj_del(textarea_bg_keyboard);
        lv_obj_del(pinyin_ime);
        lv_obj_del(textarea_text_keyboard);
        lv_obj_del(keyboard_bg);
        lv_obj_del(label_keyboard_confirm);
        lv_obj_del(btn_keyboard_confirm);
        lv_obj_del(label_keyboard_return);
        lv_obj_del(btn_keyboard_return);

        lv_obj_del(obj_addition_date_text_head_bg);
        lv_obj_del(label_addition_date_text_head);

        for (i = 0; i < TIME_TYPE_NUMBER; i++)
        {
            lv_obj_del(date_type_obj[i].obj_date_label);
            lv_obj_del(date_type_obj[i].obj_date_btn);
        }

        lv_obj_del(obj_addition_date_text_middle_bg);

        lv_obj_del(label_addition_date_text_return);
        lv_obj_del(btn_addition_date_text_return);
        lv_obj_del(btn_addition_date_confirm);
        lv_obj_del(label_addition_date_confirm);
    }
}



static void button_date_keyboard_confirm_event_cb(lv_event_t* e)
{
    lv_event_code_t code;
    int i;
    code = lv_event_get_code(e);
    if (code == LV_EVENT_CLICKED)
    {
        printf("button_date_keyboard_confirm_event_cb\n");
        //获取输入框数据给到文本显示框
        lv_label_set_text(label_btn_addition_date_text, lv_textarea_get_text(textarea_text_keyboard));
        lv_label_set_text(label_addition_date_middle, lv_textarea_get_text(textarea_text_keyboard));
        lv_obj_del(textarea_bg_keyboard);
        lv_obj_del(pinyin_ime);
        lv_obj_del(textarea_text_keyboard);
        lv_obj_del(keyboard_bg);
        lv_obj_del(label_keyboard_confirm);
        lv_obj_del(btn_keyboard_confirm);
        lv_obj_del(label_keyboard_return);
        lv_obj_del(btn_keyboard_return);


        lv_obj_del(obj_addition_date_text_head_bg);
        lv_obj_del(label_addition_date_text_head);

        for (i = 0; i < DATA_TYPE_NUMBER; i++)
        {
            lv_obj_del(date_type_obj[i].obj_date_label);
            lv_obj_del(date_type_obj[i].obj_date_btn);
        }

        lv_obj_del(obj_addition_date_text_middle_bg);

        lv_obj_del(label_addition_date_text_return);
        lv_obj_del(btn_addition_date_text_return);
        lv_obj_del(btn_addition_date_confirm);
        lv_obj_del(label_addition_date_confirm);

        date_or_time_flag = 0;
        g_date_type = 14;
    }
}



static void button_date_validity_return_event_cb(lv_event_t* e)
{
    lv_event_code_t code;
    code = lv_event_get_code(e);
    if (code == LV_EVENT_CLICKED)
    {
        printf("button_date_validity_return_event_cb\n");
        buzzer_enable = 1;
        lv_obj_del(label_system_date_confirm);
        lv_obj_del(btn_system_date_confirm);
        lv_obj_del(btn_system_date_return);
        lv_obj_del(label_system_date_return);
        lv_obj_del(system_date_bottom_bg);
        lv_obj_del(system_date_roller_day);
        lv_obj_del(system_date_roller_month);
        lv_obj_del(system_date_roller_year);
        lv_obj_del(label_system_date_day_middle);
        lv_obj_del(label_system_date_month_middle);
        lv_obj_del(label_system_date_year_middle);
        lv_obj_del(system_date_middle_bg);
        lv_obj_del(label_system_date_head);
        lv_obj_del(system_date_head_bg);
    }
}



// 判断是否为闰年
bool isLeapYear(int year) {
    return (year % 4 == 0 && year % 100 != 0) || (year % 400 == 0);
}

// 获取指定年月的天数
int daysInMonth(int year, int month) {
    static const int days[12] = {31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31};
    if (month == 2 && isLeapYear(year)) {
        return 29;
    }
    return days[month - 1];
}

// 计算有效期后的日期
void calculateExpiryDate(int startYear, int startMonth, int startDay,
                         int validYears, int validMonths, int validDays,
                         int *endYear, int *endMonth, int *endDay) {
    // 初始化结果为起始日期
    *endYear = startYear;
    *endMonth = startMonth;
    *endDay = startDay;

    // 加上年
    *endYear += validYears;

    // 加上月
    *endMonth += validMonths;
    while (*endMonth > 12) {
        *endMonth -= 12;
        (*endYear)++;
    }

    // 加上天
    *endDay += validDays;
    while (*endDay > daysInMonth(*endYear, *endMonth)) {
        *endDay -= daysInMonth(*endYear, *endMonth);
        (*endMonth)++;
        if (*endMonth > 12) {
            *endMonth = 1;
            (*endYear)++;
        }
    }
}

#if 0
int main() {
    int startYear = 2025, startMonth = 8, startDay = 26;
    int validYears = 1, validMonths = 6, validDays = 31;
    int endYear, endMonth, endDay;

    calculateExpiryDate(startYear, startMonth, startDay,
                        validYears, validMonths, validDays,
                        &endYear, &endMonth, &endDay);

    printf("起始日期: %d年%d月%d日\n", startYear, startMonth, startDay);
    printf("有效期: %d年%d个月%d天\n", validYears, validMonths, validDays);
    printf("到期日期: %d年%d月%d日\n", endYear, endMonth, endDay);

    return 0;
}
#endif


static void btn_date_validity_confirm_event_cb(lv_event_t* e)
{
    lv_event_code_t code;
    int now_year = g_system_time[0] + 2000;
    int now_month = g_system_time[1];
    int now_day = g_system_time[2];
    int end_year = 0;
    int end_month = 0;
    int end_day = 0;  
    char temp_str[20] = { 0 };
    int i = 0;
    code = lv_event_get_code(e);
    if (code == LV_EVENT_CLICKED)
    {
        printf("btn_date_validity_confirm_event_cb\n");
        buzzer_enable = 1;

        memset(temp_str,0,sizeof(temp_str));
        lv_roller_get_selected_str(system_date_roller_year,temp_str,sizeof(temp_str));
        validity_date.year = atoi(temp_str)%100;	
        memset(temp_str,0,sizeof(temp_str));
        lv_roller_get_selected_str(system_date_roller_month,temp_str,sizeof(temp_str));
        validity_date.month = atoi(temp_str);	
        memset(temp_str,0,sizeof(temp_str));
        lv_roller_get_selected_str(system_date_roller_day,temp_str,sizeof(temp_str));
        validity_date.day = atoi(temp_str);

        if((validity_date.year != 0)||(validity_date.month != 0)||(validity_date.day != 0))
        {
            validity_date.flag = 1;

            calculateExpiryDate(now_year,now_month,now_day,validity_date.year,validity_date.month,validity_date.day,&end_year,&end_month,&end_day);

            now_year = end_year;
            now_month = end_month;
            now_day = end_day;

            for (i = 0; i < DATA_TYPE_NUMBER - 1; i++)
            {
                switch (i)
                {
                    case 0:
                        sprintf(temp_str, "%04d/%02d/%02d", now_year, now_month, now_day);
                        break;
                    case 1:
                        sprintf(temp_str, "%02d/%02d/%02d", now_year%100, now_month, now_day);
                        break;
                    case 2:
                        sprintf(temp_str, "%04d-%02d-%02d", now_year, now_month, now_day);
                        break;
                    case 3:
                        sprintf(temp_str, "%02d-%02d-%02d", now_year%100, now_month, now_day);
                        break;
                    case 4:
                        sprintf(temp_str, "%04d.%02d.%02d", now_year, now_month, now_day);
                        break;
                    case 5:
                        sprintf(temp_str, "%02d.%02d.%02d", now_year%100, now_month, now_day);
                        break;
                    case 6:
                        sprintf(temp_str, "%02d/%02d/%04d", now_day, now_month, now_year);
                        break;
                    case 7:
                        sprintf(temp_str, "%02d/%02d/%02d", now_day, now_month, now_year%100);
                        break;
                    case 8:
                        sprintf(temp_str, "%02d-%02d-%04d", now_day, now_month, now_year);
                        break;
                    case 9:
                        sprintf(temp_str, "%02d-%02d-%02d", now_day, now_month, now_year%100);
                        break;
                    case 10:
                        sprintf(temp_str, "%02d.%02d.%04d", now_day, now_month, now_year);
                        break;
                    case 11:
                        sprintf(temp_str, "%02d.%02d.%02d", now_day, now_month, now_year%100);
                        break;
                    case 12:
                        sprintf(temp_str, "%04d年%02d月%02d日", now_year, now_month, now_day);
                        break;
                    case 13:
                        sprintf(temp_str, "%02d年%02d月%02d日", now_year%100, now_month, now_day);
                        break;

                }

                lv_label_set_text(date_type_obj[i].obj_date_label, temp_str);
            }

        }

        lv_obj_del(label_system_date_confirm);
        lv_obj_del(btn_system_date_confirm);
        lv_obj_del(btn_system_date_return);
        lv_obj_del(label_system_date_return);
        lv_obj_del(system_date_bottom_bg);
        lv_obj_del(system_date_roller_day);
        lv_obj_del(system_date_roller_month);
        lv_obj_del(system_date_roller_year);
        lv_obj_del(label_system_date_day_middle);
        lv_obj_del(label_system_date_month_middle);
        lv_obj_del(label_system_date_year_middle);
        lv_obj_del(system_date_middle_bg);
        lv_obj_del(label_system_date_head);
        lv_obj_del(system_date_head_bg);       
    }
}



static void button_date_type_event_cb(lv_event_t* e)
{
    lv_event_code_t code;
    lv_obj_t* obj = lv_event_get_target(e);
    code = lv_event_get_code(e);
    if (code == LV_EVENT_FOCUSED)
    {
        printf("button_date_type_event_cb LV_EVENT_FOCUSED\n");
        buzzer_enable = 1;
        printf("g_date_type=%d\n", lv_obj_get_index(obj));
        g_date_type = lv_obj_get_index(obj);
        lv_obj_set_style_bg_color(obj, lv_color_hex(0x00ff00), LV_PART_MAIN);
    }
    else if (code == LV_EVENT_DEFOCUSED)
    {
        printf("button_date_type_event_cb LV_EVENT_DEFOCUSED\n");
        lv_obj_set_style_bg_color(obj, lv_color_hex(0xffffff), LV_PART_MAIN);
    }
    else if (code == LV_EVENT_CLICKED)
    {
        if (lv_obj_get_index(obj) == 14)
        {
            static lv_style_t style_sel;
            lv_style_init(&style_sel);
            lv_style_set_text_font(&style_sel, &lv_font_montserrat_20);

            system_date_head_bg = lv_obj_create(lv_scr_act());
            lv_obj_set_size(system_date_head_bg, 480, 24);
            lv_obj_align(system_date_head_bg, LV_ALIGN_TOP_LEFT, 0, 0);
            lv_obj_set_style_border_width(system_date_head_bg, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
            lv_obj_set_style_border_color(system_date_head_bg, lv_color_hex(0x9bcd9b), LV_STATE_DEFAULT); /* 设置边框颜色 */
            lv_obj_set_style_radius(system_date_head_bg, 0, LV_STATE_DEFAULT); /* 设置圆角 */
            lv_obj_set_style_bg_color(system_date_head_bg, lv_color_hex(0x1fadd3), LV_STATE_DEFAULT);

            LV_FONT_DECLARE(heiFont16_1);
            label_system_date_head = lv_label_create(lv_scr_act());
            lv_obj_set_style_text_font(label_system_date_head, &heiFont16_1, LV_STATE_DEFAULT);
            lv_obj_set_style_text_color(label_system_date_head, lv_color_hex(0xFFFFFF), LV_STATE_DEFAULT);
            lv_obj_align(label_system_date_head, LV_ALIGN_TOP_LEFT, 200, 4);
            lv_label_set_text(label_system_date_head, "有效期");

            system_date_middle_bg = lv_obj_create(lv_scr_act());
            lv_obj_set_size(system_date_middle_bg, 480, 224);
            lv_obj_align(system_date_middle_bg, LV_ALIGN_TOP_LEFT, 0, 24);
            lv_obj_set_style_border_width(system_date_middle_bg, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
            lv_obj_set_style_border_color(system_date_middle_bg, lv_color_hex(0xaaaaa), LV_STATE_DEFAULT); /* 设置边框颜色 */
            lv_obj_set_style_radius(system_date_middle_bg, 0, LV_STATE_DEFAULT); /* 设置圆角 */
            lv_obj_set_style_bg_color(system_date_middle_bg, lv_color_hex(0xffffff), LV_STATE_DEFAULT);


            LV_FONT_DECLARE(heiFont16_1);
            label_system_date_year_middle = lv_label_create(system_date_middle_bg);
            lv_obj_set_style_text_font(label_system_date_year_middle, &heiFont16_1, LV_STATE_DEFAULT);
            lv_obj_set_style_text_color(label_system_date_year_middle, lv_color_hex(0x000000), LV_STATE_DEFAULT);
            lv_obj_align(label_system_date_year_middle, LV_ALIGN_TOP_LEFT, 105, 5);
            lv_label_set_text(label_system_date_year_middle, "年");


            LV_FONT_DECLARE(heiFont16_1);
            label_system_date_month_middle = lv_label_create(system_date_middle_bg);
            lv_obj_set_style_text_font(label_system_date_month_middle, &heiFont16_1, LV_STATE_DEFAULT);
            lv_obj_set_style_text_color(label_system_date_month_middle, lv_color_hex(0x000000), LV_STATE_DEFAULT);
            lv_obj_align(label_system_date_month_middle, LV_ALIGN_TOP_LEFT, 205, 5);
            lv_label_set_text(label_system_date_month_middle, "月");

            LV_FONT_DECLARE(heiFont16_1);
            label_system_date_day_middle = lv_label_create(system_date_middle_bg);
            lv_obj_set_style_text_font(label_system_date_day_middle, &heiFont16_1, LV_STATE_DEFAULT);
            lv_obj_set_style_text_color(label_system_date_day_middle, lv_color_hex(0x000000), LV_STATE_DEFAULT);
            lv_obj_align(label_system_date_day_middle, LV_ALIGN_TOP_LEFT, 305, 5);
            lv_label_set_text(label_system_date_day_middle, "日");


            system_date_roller_year = lv_roller_create(system_date_middle_bg);
            lv_roller_set_options(system_date_roller_year,
                "0\n"
                "1\n"
                "2\n"
                "3\n"
                "4\n"
                "5\n"
                "6\n"
                "7\n"
                "8\n"
                "9\n"
                "10",
                LV_ROLLER_MODE_INFINITE);

            lv_roller_set_visible_row_count(system_date_roller_year, 5);
            lv_obj_align(system_date_roller_year, LV_ALIGN_TOP_LEFT, 85, 25);
            lv_obj_set_style_width(system_date_roller_year, 60, LV_STATE_DEFAULT);
            lv_obj_add_style(system_date_roller_year, &style_sel, LV_PART_SELECTED);

            if(flag_modification_or_addition == 1)
            {
                lv_roller_set_selected(system_date_roller_year, data_structure[g_modification_id].data.date_time.year, LV_ANIM_ON);
            }
            else
            {
                lv_roller_set_selected(system_date_roller_year, 0, LV_ANIM_ON);
            }

            system_date_roller_month = lv_roller_create(system_date_middle_bg);
            lv_roller_set_options(system_date_roller_month,
                "0\n"
                "1\n"
                "2\n"
                "3\n"
                "4\n"
                "5\n"
                "6\n"
                "7\n"
                "8\n"
                "9\n"
                "10\n"
                "11\n"
                "12",
                LV_ROLLER_MODE_INFINITE);
            lv_obj_set_style_width(system_date_roller_month, 60, LV_STATE_DEFAULT);
            lv_roller_set_visible_row_count(system_date_roller_month, 5);
            lv_obj_align(system_date_roller_month, LV_ALIGN_TOP_LEFT, 185, 25);
            lv_obj_add_style(system_date_roller_month, &style_sel, LV_PART_SELECTED);


            if(flag_modification_or_addition == 1)
            {
                lv_roller_set_selected(system_date_roller_month, data_structure[g_modification_id].data.date_time.month, LV_ANIM_ON);
            }
            else
            {
                lv_roller_set_selected(system_date_roller_month, 0, LV_ANIM_ON);
            }


            system_date_roller_day = lv_roller_create(system_date_middle_bg);
            lv_roller_set_options(system_date_roller_day,
                "0\n"
                "1\n"
                "2\n"
                "3\n"
                "4\n"
                "5\n"
                "6\n"
                "7\n"
                "8\n"
                "9\n"
                "10\n"
                "11\n"
                "12\n"
                "13\n"
                "14\n"
                "15\n"
                "16\n"
                "17\n"
                "18\n"
                "19\n"
                "20\n"
                "21\n"
                "22\n"
                "23\n"
                "24\n"
                "25\n"
                "26\n"
                "27\n"
                "28\n"
                "29\n"
                "30\n"
                "31",
                LV_ROLLER_MODE_INFINITE);
            lv_obj_set_style_width(system_date_roller_day, 60, LV_STATE_DEFAULT);
            lv_roller_set_visible_row_count(system_date_roller_day, 5);
            lv_obj_align(system_date_roller_day, LV_ALIGN_TOP_LEFT, 285, 25);
            lv_obj_add_style(system_date_roller_day, &style_sel, LV_PART_SELECTED);


            if(flag_modification_or_addition == 1)
            {
                lv_roller_set_selected(system_date_roller_day, data_structure[g_modification_id].data.date_time.day, LV_ANIM_ON);
            }
            else
            {
                lv_roller_set_selected(system_date_roller_day, 0, LV_ANIM_ON);
            }

            system_date_bottom_bg = lv_obj_create(lv_scr_act());
            lv_obj_set_size(system_date_bottom_bg, 480, 24);
            lv_obj_align(system_date_bottom_bg, LV_ALIGN_TOP_LEFT, 0, 248);
            lv_obj_set_style_border_width(system_date_bottom_bg, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
            lv_obj_set_style_radius(system_date_bottom_bg, 0, LV_STATE_DEFAULT); /* 设置圆角 */
            lv_obj_set_style_bg_color(system_date_bottom_bg, lv_color_hex(0x28536a), LV_STATE_DEFAULT);
            lv_obj_remove_style(system_date_bottom_bg, 0, LV_PART_SCROLLBAR);


            LV_FONT_DECLARE(heiFont16_1);
            label_system_date_return = lv_label_create(lv_scr_act());
            lv_obj_set_style_text_font(label_system_date_return, &heiFont16_1, LV_STATE_DEFAULT);
            lv_obj_set_style_text_color(label_system_date_return, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
            lv_label_set_text(label_system_date_return, "返回");
            lv_obj_align(label_system_date_return, LV_ALIGN_TOP_LEFT, 140, 252);

            LV_IMG_DECLARE(get_back);
            btn_system_date_return = lv_imgbtn_create(lv_scr_act());
            lv_imgbtn_set_src(btn_system_date_return, LV_IMGBTN_STATE_RELEASED, NULL, &get_back, NULL);
            lv_obj_set_size(btn_system_date_return, get_back.header.w, get_back.header.h);
            lv_obj_align(btn_system_date_return, LV_ALIGN_TOP_LEFT, 180, 250);
            lv_obj_add_event_cb(btn_system_date_return, button_date_validity_return_event_cb, LV_EVENT_CLICKED, NULL);


            LV_IMG_DECLARE(confirm);
            btn_system_date_confirm = lv_imgbtn_create(lv_scr_act());
            lv_imgbtn_set_src(btn_system_date_confirm, LV_IMGBTN_STATE_RELEASED, NULL, &confirm, NULL);
            lv_obj_set_size(btn_system_date_confirm, get_back.header.w, get_back.header.h);
            lv_obj_align(btn_system_date_confirm, LV_ALIGN_TOP_LEFT, 270, 250);
            lv_obj_add_event_cb(btn_system_date_confirm, btn_date_validity_confirm_event_cb, LV_EVENT_CLICKED, NULL);

            LV_FONT_DECLARE(heiFont16_1);
            label_system_date_confirm = lv_label_create(lv_scr_act());
            lv_obj_set_style_text_font(label_system_date_confirm, &heiFont16_1, LV_STATE_DEFAULT);
            lv_obj_set_style_text_color(label_system_date_confirm, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
            lv_label_set_text(label_system_date_confirm, "确定");
            lv_obj_align(label_system_date_confirm, LV_ALIGN_TOP_LEFT, 300, 252);
        }
    }
}



static void button_date_confirm_event_cb(lv_event_t* e)
{
    lv_event_code_t code;
    int i;
    code = lv_event_get_code(e);
    if (code == LV_EVENT_CLICKED)
    {
        printf("button_date_confirm_event_cb\n");
        buzzer_enable = 1;
        //获取输入框数据给到文本显示框
        lv_label_set_text(label_addition_date_middle, lv_label_get_text(date_type_obj[g_date_type].obj_date_label));
        lv_label_set_text(label_btn_addition_date_text, lv_label_get_text(date_type_obj[g_date_type].obj_date_label));

        if(validity_date.flag == 1)
        {
            date_or_time_flag = 2;
        }
        else
        {
            date_or_time_flag = 0;
        }

        lv_obj_del(obj_addition_date_text_head_bg);
        lv_obj_del(label_addition_date_text_head);

        for (i = 0; i < DATA_TYPE_NUMBER; i++)
        {
            lv_obj_del(date_type_obj[i].obj_date_label);
            lv_obj_del(date_type_obj[i].obj_date_btn);
        }

        lv_obj_del(obj_addition_date_text_middle_bg);

        lv_obj_del(label_addition_date_text_return);
        lv_obj_del(btn_addition_date_text_return);
        lv_obj_del(btn_addition_date_confirm);
        lv_obj_del(label_addition_date_confirm);
    }
}


static void button_date_return_event_cb(lv_event_t* e)
{
    lv_event_code_t code;
    int i;
    code = lv_event_get_code(e);
    if (code == LV_EVENT_CLICKED)
    {
        printf("button_date_return_event_cb\n");
        buzzer_enable = 1;

        lv_obj_del(obj_addition_date_text_head_bg);
        lv_obj_del(label_addition_date_text_head);

        for (i = 0; i < DATA_TYPE_NUMBER; i++)
        {
            lv_obj_del(date_type_obj[i].obj_date_label);
            lv_obj_del(date_type_obj[i].obj_date_btn);
        }

        lv_obj_del(obj_addition_date_text_middle_bg);

        lv_obj_del(label_addition_date_text_return);
        lv_obj_del(btn_addition_date_text_return);
        lv_obj_del(btn_addition_date_confirm);
        lv_obj_del(label_addition_date_confirm);
    }
}


static void btn_addition_date_text_event_cb(lv_event_t* e)
{
    lv_event_code_t code;
    code = lv_event_get_code(e);
    //int len = 0;
    int i = 0;
    int now_year = g_system_time[0] + 2000;
    int now_month = g_system_time[1];
    int now_day = g_system_time[2];
    int size_wide = 108;
    int size_high = 40;
    char temp_str[20] = { 0 };
    int end_year = 0;
    int end_month = 0;
    int end_day = 0;

    if (code == LV_EVENT_CLICKED)
    {
        printf("btn_addition_date_text_event_cb\n");

        buzzer_enable = 1;

        memset(&validity_date,0,sizeof(validity_date));

        obj_addition_date_text_head_bg = lv_obj_create(lv_scr_act());
        lv_obj_set_size(obj_addition_date_text_head_bg, 480, 24);
        lv_obj_align(obj_addition_date_text_head_bg, LV_ALIGN_TOP_LEFT, 0, 0);
        lv_obj_set_style_border_width(obj_addition_date_text_head_bg, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_border_color(obj_addition_date_text_head_bg, lv_color_hex(0x9bcd9b), LV_STATE_DEFAULT); /* 设置边框颜色 */
        lv_obj_set_style_radius(obj_addition_date_text_head_bg, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_color(obj_addition_date_text_head_bg, lv_color_hex(0x1fadd3), LV_STATE_DEFAULT);

        LV_FONT_DECLARE(heiFont16_1);
        label_addition_date_text_head = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_addition_date_text_head, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_addition_date_text_head, lv_color_hex(0xFFFFFF), LV_STATE_DEFAULT);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_addition_date_text_head,  "日期");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_addition_date_text_head, "Date");
        }
        lv_obj_align(label_addition_date_text_head, LV_ALIGN_TOP_LEFT, 200, 4);

        obj_addition_date_text_middle_bg = lv_obj_create(lv_scr_act());
        lv_obj_align(obj_addition_date_text_middle_bg, LV_ALIGN_TOP_LEFT, 0, 24);
        lv_obj_set_size(obj_addition_date_text_middle_bg, 480, 224);
        lv_obj_set_style_bg_color(obj_addition_date_text_middle_bg, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        lv_obj_set_style_bg_opa(obj_addition_date_text_middle_bg, LV_OPA_COVER, LV_STATE_DEFAULT);
        lv_obj_set_style_border_width(obj_addition_date_text_middle_bg, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_border_color(obj_addition_date_text_middle_bg, lv_color_hex(0xcccccc), LV_STATE_DEFAULT); /* 设置边框颜色 */
        lv_obj_clear_flag(obj_addition_date_text_middle_bg, LV_OBJ_FLAG_SCROLLABLE);
        lv_obj_set_style_radius(obj_addition_date_text_middle_bg, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_pad_all(obj_addition_date_text_middle_bg, 0, LV_STATE_DEFAULT);

        for (i = 0; i < DATA_TYPE_NUMBER; i++)
        {
            date_type_obj[i].obj_date_btn = lv_btn_create(obj_addition_date_text_middle_bg);
            lv_obj_set_size(date_type_obj[i].obj_date_btn, size_wide, size_high);
            lv_obj_align(date_type_obj[i].obj_date_btn, LV_ALIGN_TOP_LEFT, (i % 4 + 1) * 9 + (i % 4) * size_wide, (i / 4 + 1) * 10 + i / 4 * size_high);
            lv_obj_set_style_border_width(date_type_obj[i].obj_date_btn, 1, LV_PART_MAIN); /* 设置边框宽度 */
            lv_obj_set_style_border_color(date_type_obj[i].obj_date_btn, lv_color_hex(0x000000), LV_PART_MAIN); /* 设置边框颜色 */
            lv_obj_set_style_radius(date_type_obj[i].obj_date_btn, 10, LV_PART_MAIN); /* 设置圆角 */
            lv_obj_set_style_bg_color(date_type_obj[i].obj_date_btn, lv_color_hex(0xffffff), LV_PART_MAIN);
            lv_obj_set_style_shadow_width(date_type_obj[i].obj_date_btn, 0, LV_PART_MAIN);
            lv_obj_add_event_cb(date_type_obj[i].obj_date_btn, button_date_type_event_cb, LV_EVENT_ALL, NULL);

            LV_FONT_DECLARE(heiFont16_1);
            date_type_obj[i].obj_date_label = lv_label_create(date_type_obj[i].obj_date_btn);
            lv_obj_set_style_text_font(date_type_obj[i].obj_date_label, &heiFont16_1, LV_STATE_DEFAULT);

            if(flag_modification_or_addition == 1)
            {
                if(data_structure[g_modification_id].data.date_time.date_or_time == 2)
                {
                    calculateExpiryDate(now_year,now_month,now_day,data_structure[g_modification_id].data.date_time.year,data_structure[g_modification_id].data.date_time.month,data_structure[g_modification_id].data.date_time.day,&end_year,&end_month,&end_day);
                    now_year = end_year;
                    now_month = end_month;
                    now_day = end_day;
                }

                switch (i)
                {
                    case 0:
                        sprintf(temp_str, "%04d/%02d/%02d", now_year, now_month, now_day);
                        break;
                    case 1:
                        sprintf(temp_str, "%02d/%02d/%02d", now_year%100, now_month, now_day);
                        break;
                    case 2:
                        sprintf(temp_str, "%04d-%02d-%02d", now_year, now_month, now_day);
                        break;
                    case 3:
                        sprintf(temp_str, "%02d-%02d-%02d", now_year%100, now_month, now_day);
                        break;
                    case 4:
                        sprintf(temp_str, "%04d.%02d.%02d", now_year, now_month, now_day);
                        break;
                    case 5:
                        sprintf(temp_str, "%02d.%02d.%02d", now_year%100, now_month, now_day);
                        break;
                    case 6:
                        sprintf(temp_str, "%02d/%02d/%04d", now_day, now_month, now_year);
                        break;
                    case 7:
                        sprintf(temp_str, "%02d/%02d/%02d", now_day, now_month, now_year%100);
                        break;
                    case 8:
                        sprintf(temp_str, "%02d-%02d-%04d", now_day, now_month, now_year);
                        break;
                    case 9:
                        sprintf(temp_str, "%02d-%02d-%02d", now_day, now_month, now_year%100);
                        break;
                    case 10:
                        sprintf(temp_str, "%02d.%02d.%04d", now_day, now_month, now_year);
                        break;
                    case 11:
                        sprintf(temp_str, "%02d.%02d.%02d", now_day, now_month, now_year%100);
                        break;
                    case 12:
                        sprintf(temp_str, "%04d年%02d月%02d日", now_year, now_month, now_day);
                        break;
                    case 13:
                        sprintf(temp_str, "%02d年%02d月%02d日", now_year%100, now_month, now_day);
                        break;
                    case 14:
                        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
                        {
                            sprintf(temp_str, "有效期");
                        }
                        else if(system_data.system.language == LANGUAGE_ENGLISH)
                        {
                            sprintf(temp_str, "Validity");
                        }
                        break;
                    case 15:
                        sprintf(temp_str, "延期");
                        break;

                }
            }
            else
            {
                switch (i)
                {
                    case 0:
                        sprintf(temp_str, "%04d/%02d/%02d", now_year, now_month, now_day);
                        break;
                    case 1:
                        sprintf(temp_str, "%02d/%02d/%02d", now_year%100, now_month, now_day);
                        break;
                    case 2:
                        sprintf(temp_str, "%04d-%02d-%02d", now_year, now_month, now_day);
                        break;
                    case 3:
                        sprintf(temp_str, "%02d-%02d-%02d", now_year%100, now_month, now_day);
                        break;
                    case 4:
                        sprintf(temp_str, "%04d.%02d.%02d", now_year, now_month, now_day);
                        break;
                    case 5:
                        sprintf(temp_str, "%02d.%02d.%02d", now_year%100, now_month, now_day);
                        break;
                    case 6:
                        sprintf(temp_str, "%02d/%02d/%04d", now_day, now_month, now_year);
                        break;
                    case 7:
                        sprintf(temp_str, "%02d/%02d/%02d", now_day, now_month, now_year%100);
                        break;
                    case 8:
                        sprintf(temp_str, "%02d-%02d-%04d", now_day, now_month, now_year);
                        break;
                    case 9:
                        sprintf(temp_str, "%02d-%02d-%02d", now_day, now_month, now_year%100);
                        break;
                    case 10:
                        sprintf(temp_str, "%02d.%02d.%04d", now_day, now_month, now_year);
                        break;
                    case 11:
                        sprintf(temp_str, "%02d.%02d.%02d", now_day, now_month, now_year%100);
                        break;
                    case 12:
                        sprintf(temp_str, "%04d年%02d月%02d日", now_year, now_month, now_day);
                        break;
                    case 13:
                        sprintf(temp_str, "%02d年%02d月%02d日", now_year%100, now_month, now_day);
                        break;
                    case 14:
                        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
                        {
                            sprintf(temp_str, "有效期");
                        }
                        else if(system_data.system.language == LANGUAGE_ENGLISH)
                        {
                            sprintf(temp_str, "Validity");
                        }
                        break;
                    case 15:
                        sprintf(temp_str, "延期");
                        break;

                }
            }

            lv_label_set_text(date_type_obj[i].obj_date_label, temp_str);
            lv_obj_center(date_type_obj[i].obj_date_label);
            lv_obj_set_style_text_color(date_type_obj[i].obj_date_label, lv_color_hex(0x000000), LV_STATE_DEFAULT);
        }
       


        LV_FONT_DECLARE(heiFont16_1);
        label_addition_date_text_return = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_addition_date_text_return, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_addition_date_text_return, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_addition_date_text_return, "返回");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_addition_date_text_return, "Return");
        }
        lv_obj_align(label_addition_date_text_return, LV_ALIGN_TOP_LEFT, 140, 252);

        LV_IMG_DECLARE(get_back);
        btn_addition_date_text_return = lv_imgbtn_create(lv_scr_act());
        lv_imgbtn_set_src(btn_addition_date_text_return, LV_IMGBTN_STATE_RELEASED, NULL, &get_back, NULL);
        lv_obj_set_size(btn_addition_date_text_return, get_back.header.w, get_back.header.h);
        lv_obj_align(btn_addition_date_text_return, LV_ALIGN_TOP_LEFT, 180, 250);
        lv_obj_add_event_cb(btn_addition_date_text_return, button_date_return_event_cb, LV_EVENT_CLICKED, NULL);

        LV_IMG_DECLARE(confirm);
        btn_addition_date_confirm = lv_imgbtn_create(lv_scr_act());
        lv_imgbtn_set_src(btn_addition_date_confirm, LV_IMGBTN_STATE_RELEASED, NULL, &confirm, NULL);
        lv_obj_set_size(btn_addition_date_confirm, get_back.header.w, get_back.header.h);
        lv_obj_align(btn_addition_date_confirm, LV_ALIGN_TOP_LEFT, 250, 250);
        lv_obj_add_event_cb(btn_addition_date_confirm, button_date_confirm_event_cb, LV_EVENT_CLICKED, NULL);

        LV_FONT_DECLARE(heiFont16_1);
        label_addition_date_confirm = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_addition_date_confirm, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_addition_date_confirm, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_addition_date_confirm, "确定");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_addition_date_confirm, "Confirm");
        }
        lv_obj_align(label_addition_date_confirm, LV_ALIGN_TOP_LEFT, 277, 252);
    }
}


static void button_time_return_event_cb(lv_event_t* e)
{
    lv_event_code_t code;
    int i;
    code = lv_event_get_code(e);
    if (code == LV_EVENT_CLICKED)
    {
        printf("button_time_return_event_cb\n");

        buzzer_enable = 1;

        lv_obj_del(obj_addition_date_text_head_bg);
        lv_obj_del(label_addition_date_text_head);

        for (i = 0; i < TIME_TYPE_NUMBER; i++)
        {
            lv_obj_del(date_type_obj[i].obj_date_label);
            lv_obj_del(date_type_obj[i].obj_date_btn);
        }

        lv_obj_del(obj_addition_date_text_middle_bg);

        lv_obj_del(label_addition_date_text_return);
        lv_obj_del(btn_addition_date_text_return);
        lv_obj_del(btn_addition_date_confirm);
        lv_obj_del(label_addition_date_confirm);
    }
}



static void button_time_confirm_event_cb(lv_event_t* e)
{
    lv_event_code_t code;
    int i;
    code = lv_event_get_code(e);
    if (code == LV_EVENT_CLICKED)
    {
        printf("button_time_confirm_event_cb\n");

        buzzer_enable = 1;

        //获取输入框数据给到文本显示框
        lv_label_set_text(label_addition_date_middle, lv_label_get_text(date_type_obj[g_time_type].obj_date_label));
        lv_label_set_text(label_btn_label_addition_time, lv_label_get_text(date_type_obj[g_time_type].obj_date_label));

        date_or_time_flag = 1;

        lv_obj_del(obj_addition_date_text_head_bg);
        lv_obj_del(label_addition_date_text_head);

        for (i = 0; i < TIME_TYPE_NUMBER; i++)
        {
            lv_obj_del(date_type_obj[i].obj_date_label);
            lv_obj_del(date_type_obj[i].obj_date_btn);
        }

        lv_obj_del(obj_addition_date_text_middle_bg);

        lv_obj_del(label_addition_date_text_return);
        lv_obj_del(btn_addition_date_text_return);
        lv_obj_del(btn_addition_date_confirm);
        lv_obj_del(label_addition_date_confirm);
    }
}


static void button_time_type_event_cb(lv_event_t* e)
{
    lv_event_code_t code;
    lv_obj_t* obj = lv_event_get_target(e);
    code = lv_event_get_code(e);
    if (code == LV_EVENT_FOCUSED)
    {
        printf("button_time_type_event_cb LV_EVENT_FOCUSED\n");
        buzzer_enable = 1;
        printf("g_date_type=%d\n", lv_obj_get_index(obj));
        g_time_type = lv_obj_get_index(obj);
        lv_obj_set_style_bg_color(obj, lv_color_hex(0x00ff00), LV_PART_MAIN);
    }
    else if (code == LV_EVENT_DEFOCUSED)
    {
        printf("button_time_type_event_cb LV_EVENT_DEFOCUSED\n");
        lv_obj_set_style_bg_color(obj, lv_color_hex(0xffffff), LV_PART_MAIN);
    }
    else if (code == LV_EVENT_CLICKED)
    {
        if (lv_obj_get_index(obj) == 5)
        {
            //键盘界面
            textarea_bg_keyboard = lv_obj_create(lv_scr_act());

            /* 设置大小 */
            lv_obj_set_size(textarea_bg_keyboard, 480, 272);
            lv_obj_align(textarea_bg_keyboard, LV_ALIGN_TOP_LEFT, 0, 0);
            lv_obj_set_style_border_width(textarea_bg_keyboard, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
            lv_obj_set_style_border_color(textarea_bg_keyboard, lv_color_hex(0x9bcd9b), LV_STATE_DEFAULT); /* 设置边框颜色 */
            //lv_obj_set_style_border_opa(file_management_win, 100, LV_STATE_DEFAULT); /* 设置边框透明度 */
            lv_obj_set_style_radius(textarea_bg_keyboard, 0, LV_STATE_DEFAULT); /* 设置圆角 */
            lv_obj_set_style_bg_color(textarea_bg_keyboard, lv_color_hex(0x1fadd3), LV_STATE_DEFAULT);

            //输入框+键盘
            LV_FONT_DECLARE(heiFont16_1);
            pinyin_ime = lv_ime_pinyin_create(lv_scr_act());
            lv_obj_set_style_text_font(pinyin_ime, &heiFont16_1, 0);
            //lv_obj_set_style_text_font(pinyin_ime, &lv_font_simsun_16_cjk, 0);
            //lv_ime_pinyin_set_dict(pinyin_ime, your_dict); // Use a custom dictionary. If it is not set, the built-in dictionary will be used.

            textarea_text_keyboard = lv_textarea_create(lv_scr_act());
            //lv_textarea_set_one_line(textarea_text_keyboard, true);
            lv_obj_set_size(textarea_text_keyboard, 480, 95);
            lv_obj_set_style_text_font(textarea_text_keyboard, &heiFont16_1, 0);
            lv_obj_align(textarea_text_keyboard, LV_ALIGN_TOP_LEFT, 0, 0);
            lv_textarea_set_max_length(textarea_text_keyboard, 100);
            lv_textarea_set_placeholder_text(textarea_text_keyboard, "Smart printer");
            //lv_obj_add_event_cb(textarea_text_keyboard, textarea_text_event_cb, LV_EVENT_ALL, NULL);
            lv_obj_set_style_border_width(textarea_text_keyboard, 1, LV_STATE_DEFAULT); /* 设置边框宽度 */
            lv_obj_set_style_border_color(textarea_text_keyboard, lv_color_hex(0xAAAAAA), LV_STATE_DEFAULT); /* 设置边框颜色 */
            lv_obj_set_style_border_opa(textarea_text_keyboard, 100, LV_STATE_DEFAULT); /* 设置边框透明度 */
            lv_obj_set_style_radius(textarea_text_keyboard, 0, LV_STATE_DEFAULT); /* 设置圆角 */


            /*Create a keyboard and add it to ime_pinyin*/
            text_edit_keyboard = lv_keyboard_create(lv_scr_act());
            lv_ime_pinyin_set_keyboard(pinyin_ime, text_edit_keyboard);
            lv_keyboard_set_textarea(text_edit_keyboard, textarea_text_keyboard);
            //lv_obj_set_style_bg_color(text_edit_keyboard, lv_color_hex(0xff4040), LV_PART_MAIN);
            lv_obj_set_style_bg_color(text_edit_keyboard, lv_color_hex(0x1fadd3), LV_PART_MAIN);
            lv_obj_add_event_cb(textarea_text_keyboard, textarea_text_event_cb, LV_EVENT_ALL, text_edit_keyboard);
            lv_obj_align(text_edit_keyboard, LV_ALIGN_TOP_LEFT, 0, 115);
            lv_obj_set_size(text_edit_keyboard, 480, 133);

            /*Get the cand_panel, and adjust its size and position*/
            keyboard_cand_panel = lv_ime_pinyin_get_cand_panel(pinyin_ime);
            lv_obj_set_size(keyboard_cand_panel, LV_PCT(100), LV_PCT(10));
            lv_obj_align_to(keyboard_cand_panel, text_edit_keyboard, LV_ALIGN_OUT_TOP_MID, 0, 5);
            lv_obj_set_style_bg_color(keyboard_cand_panel, lv_color_hex(0x8B1A1A), LV_PART_MAIN);
            lv_obj_set_style_text_font(keyboard_cand_panel, &heiFont16_1, 0);

            keyboard_bg = lv_obj_create(lv_scr_act());
            lv_obj_set_size(keyboard_bg, 480, 24);
            lv_obj_align(keyboard_bg, LV_ALIGN_TOP_LEFT, 0, 248);
            lv_obj_set_style_border_width(keyboard_bg, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
            lv_obj_set_style_radius(keyboard_bg, 0, LV_STATE_DEFAULT); /* 设置圆角 */
            lv_obj_set_style_bg_color(keyboard_bg, lv_color_hex(0x28536a), LV_STATE_DEFAULT);
            lv_obj_remove_style(keyboard_bg, 0, LV_PART_SCROLLBAR);


            LV_FONT_DECLARE(heiFont16_1);
            label_keyboard_return = lv_label_create(lv_scr_act());
            lv_obj_set_style_text_font(label_keyboard_return, &heiFont16_1, LV_STATE_DEFAULT);
            lv_obj_set_style_text_color(label_keyboard_return, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
            lv_label_set_text(label_keyboard_return, "返回");
            lv_obj_align(label_keyboard_return, LV_ALIGN_TOP_LEFT, 140, 252);

            LV_IMG_DECLARE(get_back);
            btn_keyboard_return = lv_imgbtn_create(lv_scr_act());
            lv_imgbtn_set_src(btn_keyboard_return, LV_IMGBTN_STATE_RELEASED, NULL, &get_back, NULL);
            lv_obj_set_size(btn_keyboard_return, get_back.header.w, get_back.header.h);
            lv_obj_align(btn_keyboard_return, LV_ALIGN_TOP_LEFT, 180, 250);
            lv_obj_add_event_cb(btn_keyboard_return, button_time_keyboard_return_event_cb, LV_EVENT_CLICKED, NULL);

            LV_IMG_DECLARE(confirm);
            btn_keyboard_confirm = lv_imgbtn_create(lv_scr_act());
            lv_imgbtn_set_src(btn_keyboard_confirm, LV_IMGBTN_STATE_RELEASED, NULL, &confirm, NULL);
            lv_obj_set_size(btn_keyboard_confirm, get_back.header.w, get_back.header.h);
            lv_obj_align(btn_keyboard_confirm, LV_ALIGN_TOP_LEFT, 250, 250);
            lv_obj_add_event_cb(btn_keyboard_confirm, button_time_keyboard_confirm_event_cb, LV_EVENT_CLICKED, NULL);

            LV_FONT_DECLARE(heiFont16_1);
            label_keyboard_confirm = lv_label_create(lv_scr_act());
            lv_obj_set_style_text_font(label_keyboard_confirm, &heiFont16_1, LV_STATE_DEFAULT);
            lv_obj_set_style_text_color(label_keyboard_confirm, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
            lv_label_set_text(label_keyboard_confirm, "确定");
            lv_obj_align(label_keyboard_confirm, LV_ALIGN_TOP_LEFT, 277, 252);
        }
    }
}




static void btn_addition_time_event_cb(lv_event_t* e)
{
    lv_event_code_t code;
    code = lv_event_get_code(e);
    //int len = 0;
    int i = 0;
    int now_hour = g_system_time[3];
    int now_minute = g_system_time[4];
    int now_second = g_system_time[5];
    int size_wide = 108;
    int size_high = 40;
    char temp_str[20] = { 0 };

    if (code == LV_EVENT_CLICKED)
    {
        printf("btn_addition_time_event_cb\n");

        buzzer_enable = 1;

        obj_addition_date_text_head_bg = lv_obj_create(lv_scr_act());
        lv_obj_set_size(obj_addition_date_text_head_bg, 480, 24);
        lv_obj_align(obj_addition_date_text_head_bg, LV_ALIGN_TOP_LEFT, 0, 0);
        lv_obj_set_style_border_width(obj_addition_date_text_head_bg, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_border_color(obj_addition_date_text_head_bg, lv_color_hex(0x9bcd9b), LV_STATE_DEFAULT); /* 设置边框颜色 */
        lv_obj_set_style_radius(obj_addition_date_text_head_bg, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_color(obj_addition_date_text_head_bg, lv_color_hex(0x1fadd3), LV_STATE_DEFAULT);

        LV_FONT_DECLARE(heiFont16_1);
        label_addition_date_text_head = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_addition_date_text_head, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_addition_date_text_head, lv_color_hex(0xFFFFFF), LV_STATE_DEFAULT);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_addition_date_text_head, "时间");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_addition_date_text_head, "Time");
        }
        lv_obj_align(label_addition_date_text_head, LV_ALIGN_TOP_LEFT, 200, 4);

        obj_addition_date_text_middle_bg = lv_obj_create(lv_scr_act());
        lv_obj_align(obj_addition_date_text_middle_bg, LV_ALIGN_TOP_LEFT, 0, 24);
        lv_obj_set_size(obj_addition_date_text_middle_bg, 480, 224);
        lv_obj_set_style_bg_color(obj_addition_date_text_middle_bg, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        lv_obj_set_style_bg_opa(obj_addition_date_text_middle_bg, LV_OPA_COVER, LV_STATE_DEFAULT);
        lv_obj_set_style_border_width(obj_addition_date_text_middle_bg, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_border_color(obj_addition_date_text_middle_bg, lv_color_hex(0xcccccc), LV_STATE_DEFAULT); /* 设置边框颜色 */
        lv_obj_clear_flag(obj_addition_date_text_middle_bg, LV_OBJ_FLAG_SCROLLABLE);
        lv_obj_set_style_radius(obj_addition_date_text_middle_bg, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_pad_all(obj_addition_date_text_middle_bg, 0, LV_STATE_DEFAULT);

        for (i = 0; i < TIME_TYPE_NUMBER; i++)
        {
            date_type_obj[i].obj_date_btn = lv_btn_create(obj_addition_date_text_middle_bg);
            lv_obj_set_size(date_type_obj[i].obj_date_btn, size_wide, size_high);
            lv_obj_align(date_type_obj[i].obj_date_btn, LV_ALIGN_TOP_LEFT, (i % 4 + 1) * 9 + (i % 4) * size_wide, (i / 4 + 1) * 10 + i / 4 * size_high);
            lv_obj_set_style_border_width(date_type_obj[i].obj_date_btn, 1, LV_PART_MAIN); /* 设置边框宽度 */
            lv_obj_set_style_border_color(date_type_obj[i].obj_date_btn, lv_color_hex(0x000000), LV_PART_MAIN); /* 设置边框颜色 */
            lv_obj_set_style_radius(date_type_obj[i].obj_date_btn, 10, LV_PART_MAIN); /* 设置圆角 */
            lv_obj_set_style_bg_color(date_type_obj[i].obj_date_btn, lv_color_hex(0xffffff), LV_PART_MAIN);
            lv_obj_set_style_shadow_width(date_type_obj[i].obj_date_btn, 0, LV_PART_MAIN);
            lv_obj_add_event_cb(date_type_obj[i].obj_date_btn, button_time_type_event_cb, LV_EVENT_ALL, NULL);

            LV_FONT_DECLARE(heiFont16_1);
            date_type_obj[i].obj_date_label = lv_label_create(date_type_obj[i].obj_date_btn);
            lv_obj_set_style_text_font(date_type_obj[i].obj_date_label, &heiFont16_1, LV_STATE_DEFAULT);
            switch (i)
            {
                case 0:
                    sprintf(temp_str, "%02d:%02d:%02d", now_hour, now_minute, now_second);
                    break;
                case 1:
                    sprintf(temp_str, "%02d:%02d", now_hour, now_minute);
                    break;
                case 2:
                    if (now_hour > 12)
                    {
                        sprintf(temp_str, "%02d:%02d:%02d PM", now_hour - 12, now_minute, now_second);
                    }
                    else
                    {
                        sprintf(temp_str, "%02d:%02d:%02d AM", now_hour, now_minute, now_second);
                    }
                    break;
                case 3:
                    if (now_hour > 12)
                    {
                        sprintf(temp_str, "%02d:%02d PM", now_hour - 12, now_minute);
                    }
                    else
                    {
                        sprintf(temp_str, "%02d:%02d AM", now_hour, now_minute);
                    }
                    break;
                case 4:
                    sprintf(temp_str, "%02d时%02d分%02d秒", now_hour, now_minute, now_second);
                    break;
                case 5:
                    if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
                    {
                        sprintf(temp_str, "自定义");
                    }
                    else if(system_data.system.language == LANGUAGE_ENGLISH)
                    {
                        sprintf(temp_str, "Custom");
                    }
                    break;
                case 6:
                    sprintf(temp_str, "延期");
                    break;
            }

            lv_label_set_text(date_type_obj[i].obj_date_label, temp_str);
            lv_obj_center(date_type_obj[i].obj_date_label);
            lv_obj_set_style_text_color(date_type_obj[i].obj_date_label, lv_color_hex(0x000000), LV_STATE_DEFAULT);
        }



        LV_FONT_DECLARE(heiFont16_1);
        label_addition_date_text_return = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_addition_date_text_return, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_addition_date_text_return, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        lv_label_set_text(label_addition_date_text_return, "返回");
        lv_obj_align(label_addition_date_text_return, LV_ALIGN_TOP_LEFT, 140, 252);

        LV_IMG_DECLARE(get_back);
        btn_addition_date_text_return = lv_imgbtn_create(lv_scr_act());
        lv_imgbtn_set_src(btn_addition_date_text_return, LV_IMGBTN_STATE_RELEASED, NULL, &get_back, NULL);
        lv_obj_set_size(btn_addition_date_text_return, get_back.header.w, get_back.header.h);
        lv_obj_align(btn_addition_date_text_return, LV_ALIGN_TOP_LEFT, 180, 250);
        lv_obj_add_event_cb(btn_addition_date_text_return, button_time_return_event_cb, LV_EVENT_CLICKED, NULL);

        LV_IMG_DECLARE(confirm);
        btn_addition_date_confirm = lv_imgbtn_create(lv_scr_act());
        lv_imgbtn_set_src(btn_addition_date_confirm, LV_IMGBTN_STATE_RELEASED, NULL, &confirm, NULL);
        lv_obj_set_size(btn_addition_date_confirm, get_back.header.w, get_back.header.h);
        lv_obj_align(btn_addition_date_confirm, LV_ALIGN_TOP_LEFT, 250, 250);
        lv_obj_add_event_cb(btn_addition_date_confirm, button_time_confirm_event_cb, LV_EVENT_CLICKED, NULL);

        LV_FONT_DECLARE(heiFont16_1);
        label_addition_date_confirm = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_addition_date_confirm, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_addition_date_confirm, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        lv_label_set_text(label_addition_date_confirm, "确定");
        lv_obj_align(label_addition_date_confirm, LV_ALIGN_TOP_LEFT, 277, 252);
    }
}


static void btn_addition_date_time_spin_confirm_event_cb(lv_event_t* e)
{
    lv_event_code_t code;
    int i=0;
    char temp_str[12] = { 0 };
    code = lv_event_get_code(e);
    if (code == LV_EVENT_CLICKED)
    {
        printf("btn_addition_text_spin_confirm_event_cb\n");
        buzzer_enable = 1;
        const char* pwd_txt = lv_textarea_get_text(pwd_text_area);
        if ((pwd_txt != NULL))
        {
            i = atoi(pwd_txt);
            if (i > 360)
            {
                i = 360;
            }
            else if (i < 0)
            {
                i = 0;
            }
        }

        sprintf(temp_str, "%d", i);
        lv_label_set_text(label_btn_addition_date_spin, temp_str);

        lv_obj_del(typeface_head_bg);
        lv_obj_del(label_typeface_head);
        lv_obj_del(typeface_slider_bg);
        lv_obj_del(pwd_text_area);
        lv_obj_del(pwd_keyboard);

        lv_obj_del(label_typeface_return);
        lv_obj_del(btn_typeface_return);
        lv_obj_del(btn_typeface_confirm);
        lv_obj_del(label_typeface_confirm);

    }
}


static void btn_addition_date_time_spin_return_event_cb(lv_event_t* e)
{
    lv_event_code_t code;
    code = lv_event_get_code(e);
    if (code == LV_EVENT_CLICKED)
    {
        printf("btn_addition_date_time_spin_return_event_cb\n");
        buzzer_enable = 1;

        lv_obj_del(typeface_head_bg);
        lv_obj_del(label_typeface_head);
        lv_obj_del(typeface_slider_bg);
        lv_obj_del(pwd_text_area);
        lv_obj_del(pwd_keyboard);

        lv_obj_del(label_typeface_return);
        lv_obj_del(btn_typeface_return);
        lv_obj_del(btn_typeface_confirm);
        lv_obj_del(label_typeface_confirm);

    }
}


static void btn_addition_date_spin_event_cb(lv_event_t* e)
{
    lv_event_code_t code;

    code = lv_event_get_code(e);
    //int len = 0;
    //int i;
    //int offset_x;
    //int offset_y;
    //int line_num = 5;
    //int size_wide = 85;
    //int size_high = 24;
    //lv_obj_t* obj = lv_event_get_target(e);

    if (code == LV_EVENT_CLICKED)
    {
        printf("[%s:%d] btn_addition_date_spin_event_cb\n", __FUNCTION__, __LINE__);
        buzzer_enable = 1;
        typeface_head_bg = lv_obj_create(lv_scr_act());
        lv_obj_set_size(typeface_head_bg, 480, 24);
        lv_obj_align(typeface_head_bg, LV_ALIGN_TOP_LEFT, 0, 0);
        lv_obj_set_style_border_width(typeface_head_bg, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_border_color(typeface_head_bg, lv_color_hex(0x9bcd9b), LV_STATE_DEFAULT); /* 设置边框颜色 */
        lv_obj_set_style_radius(typeface_head_bg, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_color(typeface_head_bg, lv_color_hex(0x1fadd3), LV_STATE_DEFAULT);

        LV_FONT_DECLARE(heiFont16_1);
        label_typeface_head = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_typeface_head, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_typeface_head, lv_color_hex(0xFFFFFF), LV_STATE_DEFAULT);
        lv_obj_align(label_typeface_head, LV_ALIGN_TOP_LEFT, 200, 4);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_typeface_head,  "旋转");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_typeface_head, "Spin");
        }

        typeface_slider_bg = lv_obj_create(lv_scr_act());
        lv_obj_set_size(typeface_slider_bg, 480, 224);
        lv_obj_align(typeface_slider_bg, LV_ALIGN_TOP_LEFT, 0, 24);
        lv_obj_set_style_border_width(typeface_slider_bg, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_border_color(typeface_slider_bg, lv_color_hex(0xaaaaaa), LV_STATE_DEFAULT); /* 设置边框颜色 */
        lv_obj_set_style_radius(typeface_slider_bg, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_color(typeface_slider_bg, lv_color_hex(0xaaaaaa), LV_STATE_DEFAULT);

        //数字键盘
        pwd_text_area = lv_textarea_create(lv_scr_act());
        if (pwd_text_area == NULL)
        {
            printf("[%s:%d] create pwd_text_area obj failed\n", __FUNCTION__, __LINE__);
            return;
        }

        // 密码框样式
        static lv_style_t pwd_text_style;
        lv_style_init(&pwd_text_style); // 初始化样式
        lv_style_set_radius(&pwd_text_style, 0); // 设置样式的圆角弧度
        lv_style_set_border_width(&pwd_text_style, 1); // 设置边框宽度
        lv_style_set_pad_all(&pwd_text_style, 0); // 设置样式的内部填充
        lv_style_set_text_font(&pwd_text_style, &lv_font_montserrat_18); //设置字体
        //lv_textarea_set_password_mode(pwd_text_area, true); // 文本区域开启密码模式
        lv_textarea_set_max_length(pwd_text_area, 3); // 设置可输入的文本的最大长度
        lv_obj_add_style(pwd_text_area, &pwd_text_style, 0); // 给btn_label添加样式
        lv_obj_set_size(pwd_text_area, 480, 50); // 设置对象大小
        lv_textarea_set_text(pwd_text_area, ""); // 文本框置空
        lv_obj_align(pwd_text_area, LV_ALIGN_TOP_LEFT, 0, 24);

        // 基于键盘背景对象创建密码校验提示标签
        hint_label = lv_label_create(lv_scr_act());
        if (hint_label == NULL)
        {
            printf("[%s:%d] create hint_label obj failed\n", __FUNCTION__, __LINE__);
            return;
        }

        // 密码提示文本样式
        static lv_style_t hint_label_style;
        lv_style_init(&hint_label_style); // 初始化样式
        lv_style_set_radius(&hint_label_style, 0); // 设置样式的圆角弧度
        lv_style_set_border_width(&hint_label_style, 0); //设置边框宽度
        lv_style_set_text_color(&hint_label_style, lv_palette_main(LV_PALETTE_RED));  // 字体颜色设置为红色
        lv_style_set_text_font(&hint_label_style, &lv_font_montserrat_12); //设置字体
        lv_label_set_long_mode(hint_label, LV_LABEL_LONG_SCROLL_CIRCULAR); // 长文本循环滚动
        lv_obj_add_style(hint_label, &hint_label_style, 0); // 给btn_label添加样式
        lv_obj_align(hint_label, LV_ALIGN_TOP_MID, 0, 110); // 顶部居中显示
        lv_label_set_text(hint_label, ""); // 设置文本内容

        // 基于键盘背景对象创建键盘对象
        pwd_keyboard = lv_keyboard_create(lv_scr_act());
        if (pwd_keyboard == NULL)
        {
            printf("[%s:%d] create pwd_keyboard obj failed\n", __FUNCTION__, __LINE__);
            return;
        }

        //键盘样式
        static lv_style_t pwd_kb_style;
        lv_style_init(&pwd_kb_style); // 初始化样式
        lv_style_set_radius(&pwd_kb_style, 5); // 设置样式的圆角弧度
        lv_style_set_border_width(&pwd_kb_style, 0); //设置边框宽度
        lv_style_set_bg_color(&pwd_kb_style, lv_color_hex(0xF98E2D));
        lv_style_set_text_opa(&pwd_kb_style, LV_OPA_COVER);
        lv_style_set_text_font(&pwd_kb_style, &lv_font_montserrat_20); //设置字体
        lv_obj_set_size(pwd_keyboard, 480, 174); //设置键盘大小
        lv_keyboard_set_mode(pwd_keyboard, LV_KEYBOARD_MODE_NUMBER_2); //设置键盘模式为数字键盘
        lv_keyboard_set_map(pwd_keyboard, LV_KEYBOARD_MODE_NUMBER_2, keyboard_map, keyboard_ctrl); // 设置键盘映射
        lv_keyboard_set_textarea(pwd_keyboard, pwd_text_area); // 键盘对象和文本框绑定
        lv_obj_add_style(pwd_keyboard, &pwd_kb_style, 0); // 添加样式
        lv_obj_align(pwd_keyboard, LV_ALIGN_TOP_LEFT, 0, 74);


        LV_FONT_DECLARE(heiFont16_1);
        label_typeface_return = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_typeface_return, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_typeface_return, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_typeface_return, "返回");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_typeface_return, "Return");
        }
        lv_obj_align(label_typeface_return, LV_ALIGN_TOP_LEFT, 140, 252);

        LV_IMG_DECLARE(get_back);
        btn_typeface_return = lv_imgbtn_create(lv_scr_act());
        lv_imgbtn_set_src(btn_typeface_return, LV_IMGBTN_STATE_RELEASED, NULL, &get_back, NULL);
        lv_obj_set_size(btn_typeface_return, get_back.header.w, get_back.header.h);
        lv_obj_align(btn_typeface_return, LV_ALIGN_TOP_LEFT, 180, 250);
        lv_obj_add_event_cb(btn_typeface_return, btn_addition_date_time_spin_return_event_cb, LV_EVENT_CLICKED, NULL);


        LV_IMG_DECLARE(confirm);
        btn_typeface_confirm = lv_imgbtn_create(lv_scr_act());
        lv_imgbtn_set_src(btn_typeface_confirm, LV_IMGBTN_STATE_RELEASED, NULL, &confirm, NULL);
        lv_obj_set_size(btn_typeface_confirm, get_back.header.w, get_back.header.h);
        lv_obj_align(btn_typeface_confirm, LV_ALIGN_TOP_LEFT, 250, 250);
        lv_obj_add_event_cb(btn_typeface_confirm, btn_addition_date_time_spin_confirm_event_cb, LV_EVENT_CLICKED, NULL);

        LV_FONT_DECLARE(heiFont16_1);
        label_typeface_confirm = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_typeface_confirm, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_typeface_confirm, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_typeface_confirm, "确定");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_typeface_confirm, "Confirm");
        }
        lv_obj_align(label_typeface_confirm, LV_ALIGN_TOP_LEFT, 277, 252);
    }
}


static void button_date_time_typeface_confirm_event_cb(lv_event_t* e)
{
    lv_event_code_t code;
    int i;
    code = lv_event_get_code(e);
    if (code == LV_EVENT_CLICKED)
    {
        lv_label_set_text(label_btn_addition_date_typeface, typeface_name[g_typeface]);

        printf("button_typeface_confirm_event_cb\n");
        lv_obj_del(typeface_head_bg);
        lv_obj_del(label_typeface_return);
        lv_obj_del(btn_typeface_return);
        lv_obj_del(btn_typeface_confirm);
        lv_obj_del(label_typeface_confirm);
        lv_obj_del(label_typeface_head);

        for (i = 0; i < TYPEFACE_NUMBER; i++)
        {
            lv_obj_del(typeface_obj[i].obj_typeface_label);
            lv_obj_del(typeface_obj[i].obj_typeface_btn);
        }

        lv_obj_del(win_content_typeface);
        lv_obj_del(win_obj_typeface);
        lv_obj_del(left_stop_img_typeface);
        lv_obj_del(right_stop_img_typeface);
        lv_obj_del(typeface_slider_bg);
        lv_obj_del(slider_typeface);
    }
}


static void btn_date_time_typeface_event_cb(lv_event_t* e)
{
    lv_event_code_t code;

    code = lv_event_get_code(e);
    int i;
    int size_wide = 85;
    int size_high = 24;

    if (code == LV_EVENT_CLICKED)
    {
        printf("btn_file_management_typeface_event_cb\n");

        buzzer_enable = 1;

        typeface_head_bg = lv_obj_create(lv_scr_act());
        lv_obj_set_size(typeface_head_bg, 480, 24);
        lv_obj_align(typeface_head_bg, LV_ALIGN_TOP_LEFT, 0, 0);
        lv_obj_set_style_border_width(typeface_head_bg, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_border_color(typeface_head_bg, lv_color_hex(0x9bcd9b), LV_STATE_DEFAULT); /* 设置边框颜色 */
        lv_obj_set_style_radius(typeface_head_bg, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_color(typeface_head_bg, lv_color_hex(0x1fadd3), LV_STATE_DEFAULT);

        LV_FONT_DECLARE(heiFont16_1);
        label_typeface_head = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_typeface_head, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_typeface_head, lv_color_hex(0xFFFFFF), LV_STATE_DEFAULT);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_typeface_head,  "字体");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_typeface_head, "Typeface");
        }
        lv_obj_align(label_typeface_head, LV_ALIGN_TOP_LEFT, 200, 4);

        win_obj_typeface = lv_obj_create(lv_scr_act());
        lv_obj_align(win_obj_typeface, LV_ALIGN_TOP_LEFT, 0, 24);
        lv_obj_set_size(win_obj_typeface, 480, 224);
        lv_obj_set_style_bg_color(win_obj_typeface, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        lv_obj_set_style_bg_opa(win_obj_typeface, LV_OPA_COVER, LV_STATE_DEFAULT);
        lv_obj_set_style_border_width(win_obj_typeface, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_border_color(win_obj_typeface, lv_color_hex(0xcccccc), LV_STATE_DEFAULT); /* 设置边框颜色 */
        lv_obj_clear_flag(win_obj_typeface, LV_OBJ_FLAG_SCROLLABLE);
        lv_obj_set_style_radius(win_obj_typeface, 0, LV_STATE_DEFAULT); /* 设置圆角 */

        win_content_typeface = lv_obj_create(win_obj_typeface);
        lv_obj_set_size(win_content_typeface, 460, 500);
        lv_obj_align(win_content_typeface, LV_ALIGN_TOP_LEFT, -15, -15);
        lv_obj_set_style_bg_color(win_content_typeface, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        lv_obj_set_style_border_width(win_content_typeface, 2, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_border_color(win_content_typeface, lv_color_hex(0xcccccc), LV_STATE_DEFAULT); /* 设置边框颜色 */
        lv_obj_clear_flag(win_content_typeface, LV_OBJ_FLAG_SCROLLABLE);
        lv_obj_set_style_radius(win_content_typeface, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_pad_all(win_content_typeface, 0, LV_STATE_DEFAULT);

        // LV_#if 0IMG_DECLARE(Slider_base_color);
        // lv_obj_t* Slider_base_color_img = lv_img_create(lv_scr_act());
       //  lv_img_set_src(Slider_base_color_img, &Slider_base_color);
       //  lv_obj_align(Slider_base_color_img, LV_ALIGN_TOP_LEFT, 0, 183);

        typeface_slider_bg = lv_obj_create(lv_scr_act());
        lv_obj_set_size(typeface_slider_bg, 20, 224);
        lv_obj_align(typeface_slider_bg, LV_ALIGN_TOP_LEFT, 460, 24);
        lv_obj_set_style_border_width(typeface_slider_bg, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_border_color(typeface_slider_bg, lv_color_hex(0xaaaaaa), LV_STATE_DEFAULT); /* 设置边框颜色 */
        lv_obj_set_style_radius(typeface_slider_bg, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_color(typeface_slider_bg, lv_color_hex(0xaaaaaa), LV_STATE_DEFAULT);

        //左滑块停止
        LV_IMG_DECLARE(left_stop_typeface);
        left_stop_img_typeface = lv_img_create(lv_scr_act());
        lv_img_set_src(left_stop_img_typeface, &left_stop_typeface);
        lv_obj_align(left_stop_img_typeface, LV_ALIGN_TOP_LEFT, 460, 228);

        slider_show_typeface();

        //右滑块停止
        LV_IMG_DECLARE(right_stop_typeface);
        right_stop_img_typeface = lv_img_create(lv_scr_act());
        lv_img_set_src(right_stop_img_typeface, &right_stop_typeface);
        lv_obj_align(right_stop_img_typeface, LV_ALIGN_TOP_LEFT, 460, 24);


        for (i = 0; i < TYPEFACE_NUMBER; i++)
        {
            typeface_obj[i].obj_typeface_btn = lv_btn_create(win_content_typeface);
            lv_obj_set_size(typeface_obj[i].obj_typeface_btn, size_wide, size_high);
            lv_obj_align(typeface_obj[i].obj_typeface_btn, LV_ALIGN_TOP_LEFT, (i % 5 + 1) * 5 + (i % 5) * size_wide, (i / 5 + 1) * 5 + i / 5 * size_high);
            lv_obj_set_style_border_width(typeface_obj[i].obj_typeface_btn, 1, LV_PART_MAIN); /* 设置边框宽度 */
            lv_obj_set_style_border_color(typeface_obj[i].obj_typeface_btn, lv_color_hex(0x000000), LV_PART_MAIN); /* 设置边框颜色 */
            lv_obj_set_style_radius(typeface_obj[i].obj_typeface_btn, 0, LV_PART_MAIN); /* 设置圆角 */
            lv_obj_set_style_bg_color(typeface_obj[i].obj_typeface_btn, lv_color_hex(0xffffff), LV_PART_MAIN);
            lv_obj_set_style_shadow_width(typeface_obj[i].obj_typeface_btn, 0, LV_PART_MAIN);
            lv_obj_add_event_cb(typeface_obj[i].obj_typeface_btn, button_typeface_event_cb, LV_EVENT_ALL, NULL);

            LV_FONT_DECLARE(heiFont16_1);
            typeface_obj[i].obj_typeface_label = lv_label_create(typeface_obj[i].obj_typeface_btn);
            lv_obj_set_style_text_font(typeface_obj[i].obj_typeface_label, &heiFont16_1, LV_STATE_DEFAULT);
            lv_label_set_text(typeface_obj[i].obj_typeface_label, typeface_name[i]);
            lv_obj_center(typeface_obj[i].obj_typeface_label);
            lv_obj_set_style_text_color(typeface_obj[i].obj_typeface_label, lv_color_hex(0x000000), LV_STATE_DEFAULT);
        }

        LV_FONT_DECLARE(heiFont16_1);
        label_typeface_return = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_typeface_return, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_typeface_return, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_typeface_return,  "返回");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_typeface_return, "Return");
        }
        lv_obj_align(label_typeface_return, LV_ALIGN_TOP_LEFT, 140, 252);

        LV_IMG_DECLARE(get_back);
        btn_typeface_return = lv_imgbtn_create(lv_scr_act());
        lv_imgbtn_set_src(btn_typeface_return, LV_IMGBTN_STATE_RELEASED, NULL, &get_back, NULL);
        lv_obj_set_size(btn_typeface_return, get_back.header.w, get_back.header.h);
        lv_obj_align(btn_typeface_return, LV_ALIGN_TOP_LEFT, 180, 250);
        lv_obj_add_event_cb(btn_typeface_return, button_typeface_return_event_cb, LV_EVENT_CLICKED, NULL);


        LV_IMG_DECLARE(confirm);
        btn_typeface_confirm = lv_imgbtn_create(lv_scr_act());
        lv_imgbtn_set_src(btn_typeface_confirm, LV_IMGBTN_STATE_RELEASED, NULL, &confirm, NULL);
        lv_obj_set_size(btn_typeface_confirm, get_back.header.w, get_back.header.h);
        lv_obj_align(btn_typeface_confirm, LV_ALIGN_TOP_LEFT, 250, 250);
        lv_obj_add_event_cb(btn_typeface_confirm, button_date_time_typeface_confirm_event_cb, LV_EVENT_CLICKED, NULL);

        LV_FONT_DECLARE(heiFont16_1);
        label_typeface_confirm = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_typeface_confirm, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_typeface_confirm, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_typeface_confirm,  "确定");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_typeface_confirm, "Confirm");
        }
        lv_obj_align(label_typeface_confirm, LV_ALIGN_TOP_LEFT, 277, 252);
    }
}



static void button_date_time_word_size_confirm_event_cb(lv_event_t* e)
{
    lv_event_code_t code;
    int i=0;
    char temp_str[12] = { 0 };
    code = lv_event_get_code(e);
    if (code == LV_EVENT_CLICKED)
    {
        printf("button_word_space_confirm_event_cb\n");

        const char* pwd_txt = lv_textarea_get_text(pwd_text_area);
        if ((pwd_txt != NULL))
        {
            i = atoi(pwd_txt);
            if (i > 200)
            {
                i = 200;
            }
        }

        sprintf(temp_str, "%d", i);
        lv_label_set_text(label_btn_addition_date_word_size, temp_str);

        lv_obj_del(typeface_head_bg);
        lv_obj_del(label_typeface_head);
        lv_obj_del(typeface_slider_bg);
        lv_obj_del(pwd_text_area);
        lv_obj_del(pwd_keyboard);

        lv_obj_del(label_typeface_return);
        lv_obj_del(btn_typeface_return);
        lv_obj_del(btn_typeface_confirm);
        lv_obj_del(label_typeface_confirm);
    }
}



static void btn_date_time_word_size_event_cb(lv_event_t* e)
{
    lv_event_code_t code;

    code = lv_event_get_code(e);

    if (code == LV_EVENT_CLICKED)
    {
        printf("[%s:%d]btn_date_time_word_size_event_cb\n", __FUNCTION__, __LINE__);
        buzzer_enable = 1;
        typeface_head_bg = lv_obj_create(lv_scr_act());
        lv_obj_set_size(typeface_head_bg, 480, 24);
        lv_obj_align(typeface_head_bg, LV_ALIGN_TOP_LEFT, 0, 0);
        lv_obj_set_style_border_width(typeface_head_bg, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_border_color(typeface_head_bg, lv_color_hex(0x9bcd9b), LV_STATE_DEFAULT); /* 设置边框颜色 */
        lv_obj_set_style_radius(typeface_head_bg, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_color(typeface_head_bg, lv_color_hex(0x1fadd3), LV_STATE_DEFAULT);

        LV_FONT_DECLARE(heiFont16_1);
        label_typeface_head = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_typeface_head, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_typeface_head, lv_color_hex(0xFFFFFF), LV_STATE_DEFAULT);
        lv_obj_align(label_typeface_head, LV_ALIGN_TOP_LEFT, 200, 4);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_typeface_head,  "字号");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_typeface_head, "Size");
        }
        typeface_slider_bg = lv_obj_create(lv_scr_act());
        lv_obj_set_size(typeface_slider_bg, 480, 224);
        lv_obj_align(typeface_slider_bg, LV_ALIGN_TOP_LEFT, 0, 24);
        lv_obj_set_style_border_width(typeface_slider_bg, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_border_color(typeface_slider_bg, lv_color_hex(0xaaaaaa), LV_STATE_DEFAULT); /* 设置边框颜色 */
        lv_obj_set_style_radius(typeface_slider_bg, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_color(typeface_slider_bg, lv_color_hex(0xaaaaaa), LV_STATE_DEFAULT);

        //数字键盘
        pwd_text_area = lv_textarea_create(lv_scr_act());
        if (pwd_text_area == NULL)
        {
            printf("[%s:%d] create pwd_text_area obj failed\n", __FUNCTION__, __LINE__);
            return;
        }

        // 密码框样式
        static lv_style_t pwd_text_style;
        lv_style_init(&pwd_text_style); // 初始化样式
        lv_style_set_radius(&pwd_text_style, 0); // 设置样式的圆角弧度
        lv_style_set_border_width(&pwd_text_style, 1); // 设置边框宽度
        lv_style_set_pad_all(&pwd_text_style, 0); // 设置样式的内部填充
        lv_style_set_text_font(&pwd_text_style, &lv_font_montserrat_18); //设置字体
        //lv_textarea_set_password_mode(pwd_text_area, true); // 文本区域开启密码模式
        lv_textarea_set_max_length(pwd_text_area, 3); // 设置可输入的文本的最大长度
        lv_obj_add_style(pwd_text_area, &pwd_text_style, 0); // 给btn_label添加样式
        lv_obj_set_size(pwd_text_area, 480, 50); // 设置对象大小
        lv_textarea_set_text(pwd_text_area, ""); // 文本框置空
        lv_obj_align(pwd_text_area, LV_ALIGN_TOP_LEFT, 0, 24);

        // 基于键盘背景对象创建密码校验提示标签
        hint_label = lv_label_create(lv_scr_act());
        if (hint_label == NULL)
        {
            printf("[%s:%d] create hint_label obj failed\n", __FUNCTION__, __LINE__);
            return;
        }

        // 密码提示文本样式
        static lv_style_t hint_label_style;
        lv_style_init(&hint_label_style); // 初始化样式
        lv_style_set_radius(&hint_label_style, 0); // 设置样式的圆角弧度
        lv_style_set_border_width(&hint_label_style, 0); //设置边框宽度
        lv_style_set_text_color(&hint_label_style, lv_palette_main(LV_PALETTE_RED));  // 字体颜色设置为红色
        lv_style_set_text_font(&hint_label_style, &lv_font_montserrat_12); //设置字体
        lv_label_set_long_mode(hint_label, LV_LABEL_LONG_SCROLL_CIRCULAR); // 长文本循环滚动
        lv_obj_add_style(hint_label, &hint_label_style, 0); // 给btn_label添加样式
        lv_obj_align(hint_label, LV_ALIGN_TOP_MID, 0, 110); // 顶部居中显示
        lv_label_set_text(hint_label, ""); // 设置文本内容

        // 基于键盘背景对象创建键盘对象
        pwd_keyboard = lv_keyboard_create(lv_scr_act());
        if (pwd_keyboard == NULL)
        {
            printf("[%s:%d] create pwd_keyboard obj failed\n", __FUNCTION__, __LINE__);
            return;
        }

        //键盘样式
        static lv_style_t pwd_kb_style;
        lv_style_init(&pwd_kb_style); // 初始化样式
        lv_style_set_radius(&pwd_kb_style, 5); // 设置样式的圆角弧度
        lv_style_set_border_width(&pwd_kb_style, 0); //设置边框宽度
        lv_style_set_bg_color(&pwd_kb_style, lv_color_hex(0xF98E2D));
        lv_style_set_text_opa(&pwd_kb_style, LV_OPA_COVER);
        lv_style_set_text_font(&pwd_kb_style, &lv_font_montserrat_20); //设置字体
        lv_obj_set_size(pwd_keyboard, 480, 174); //设置键盘大小
        lv_keyboard_set_mode(pwd_keyboard, LV_KEYBOARD_MODE_NUMBER_2); //设置键盘模式为数字键盘
        lv_keyboard_set_map(pwd_keyboard, LV_KEYBOARD_MODE_NUMBER_2, keyboard_map, keyboard_ctrl); // 设置键盘映射
        lv_keyboard_set_textarea(pwd_keyboard, pwd_text_area); // 键盘对象和文本框绑定
        lv_obj_add_style(pwd_keyboard, &pwd_kb_style, 0); // 添加样式
        lv_obj_align(pwd_keyboard, LV_ALIGN_TOP_LEFT, 0, 74);


        LV_FONT_DECLARE(heiFont16_1);
        label_typeface_return = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_typeface_return, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_typeface_return, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_typeface_return,  "返回");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_typeface_return, "Return");
        }
        lv_obj_align(label_typeface_return, LV_ALIGN_TOP_LEFT, 140, 252);

        LV_IMG_DECLARE(get_back);
        btn_typeface_return = lv_imgbtn_create(lv_scr_act());
        lv_imgbtn_set_src(btn_typeface_return, LV_IMGBTN_STATE_RELEASED, NULL, &get_back, NULL);
        lv_obj_set_size(btn_typeface_return, get_back.header.w, get_back.header.h);
        lv_obj_align(btn_typeface_return, LV_ALIGN_TOP_LEFT, 180, 250);
        lv_obj_add_event_cb(btn_typeface_return, button_work_size_return_event_cb, LV_EVENT_CLICKED, NULL);


        LV_IMG_DECLARE(confirm);
        btn_typeface_confirm = lv_imgbtn_create(lv_scr_act());
        lv_imgbtn_set_src(btn_typeface_confirm, LV_IMGBTN_STATE_RELEASED, NULL, &confirm, NULL);
        lv_obj_set_size(btn_typeface_confirm, get_back.header.w, get_back.header.h);
        lv_obj_align(btn_typeface_confirm, LV_ALIGN_TOP_LEFT, 250, 250);
        lv_obj_add_event_cb(btn_typeface_confirm, button_date_time_word_size_confirm_event_cb, LV_EVENT_CLICKED, NULL);

        LV_FONT_DECLARE(heiFont16_1);
        label_typeface_confirm = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_typeface_confirm, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_typeface_confirm, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_typeface_confirm,  "确定");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_typeface_confirm, "Confirm");
        }
        lv_obj_align(label_typeface_confirm, LV_ALIGN_TOP_LEFT, 277, 252);
    }
}



static void button_date_time_word_space_confirm_event_cb(lv_event_t* e)
{
    lv_event_code_t code;
    int i=0;
    char temp_str[12] = { 0 };
    code = lv_event_get_code(e);
    if (code == LV_EVENT_CLICKED)
    {
        printf("button_word_space_confirm_event_cb\n");
        buzzer_enable = 1;
        const char* pwd_txt = lv_textarea_get_text(pwd_text_area);
        if ((pwd_txt != NULL))
        {
            i = atoi(pwd_txt);
            if (i > 150)
            {
                i = 150;
            }
        }

        sprintf(temp_str, "%d", i);
        lv_label_set_text(label_btn_addition_date_word_space, temp_str);
        lv_obj_del(typeface_head_bg);
        lv_obj_del(label_typeface_head);
        lv_obj_del(typeface_slider_bg);
        lv_obj_del(pwd_text_area);
        lv_obj_del(pwd_keyboard);

        lv_obj_del(label_typeface_return);
        lv_obj_del(btn_typeface_return);
        lv_obj_del(btn_typeface_confirm);
        lv_obj_del(label_typeface_confirm);
    }
}


static void button_date_time_word_space_return_event_cb(lv_event_t* e)
{
    lv_event_code_t code;
    code = lv_event_get_code(e);
    if (code == LV_EVENT_CLICKED)
    {
        printf("button_word_space_confirm_event_cb\n");
        buzzer_enable = 1;
        lv_obj_del(typeface_head_bg);
        lv_obj_del(label_typeface_head);
        lv_obj_del(typeface_slider_bg);
        lv_obj_del(pwd_text_area);
        lv_obj_del(pwd_keyboard);

        lv_obj_del(label_typeface_return);
        lv_obj_del(btn_typeface_return);
        lv_obj_del(btn_typeface_confirm);
        lv_obj_del(label_typeface_confirm);
    }
}


static void btn_date_time_word_space_event_cb(lv_event_t* e)
{
    lv_event_code_t code;

    code = lv_event_get_code(e);

    if (code == LV_EVENT_CLICKED)
    {
        printf("[%s:%d]btn_date_time_word_space_event_cb\n", __FUNCTION__, __LINE__);
        buzzer_enable = 1;
        typeface_head_bg = lv_obj_create(lv_scr_act());
        lv_obj_set_size(typeface_head_bg, 480, 24);
        lv_obj_align(typeface_head_bg, LV_ALIGN_TOP_LEFT, 0, 0);
        lv_obj_set_style_border_width(typeface_head_bg, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_border_color(typeface_head_bg, lv_color_hex(0x9bcd9b), LV_STATE_DEFAULT); /* 设置边框颜色 */
        lv_obj_set_style_radius(typeface_head_bg, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_color(typeface_head_bg, lv_color_hex(0x1fadd3), LV_STATE_DEFAULT);

        LV_FONT_DECLARE(heiFont16_1);
        label_typeface_head = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_typeface_head, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_typeface_head, lv_color_hex(0xFFFFFF), LV_STATE_DEFAULT);
        lv_obj_align(label_typeface_head, LV_ALIGN_TOP_LEFT, 200, 4);

        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_typeface_head,  "间距");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_typeface_head, "Space");
        }
        typeface_slider_bg = lv_obj_create(lv_scr_act());
        lv_obj_set_size(typeface_slider_bg, 480, 224);
        lv_obj_align(typeface_slider_bg, LV_ALIGN_TOP_LEFT, 0, 24);
        lv_obj_set_style_border_width(typeface_slider_bg, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_border_color(typeface_slider_bg, lv_color_hex(0xaaaaaa), LV_STATE_DEFAULT); /* 设置边框颜色 */
        lv_obj_set_style_radius(typeface_slider_bg, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_color(typeface_slider_bg, lv_color_hex(0xaaaaaa), LV_STATE_DEFAULT);

        //数字键盘
        pwd_text_area = lv_textarea_create(lv_scr_act());
        if (pwd_text_area == NULL)
        {
            printf("[%s:%d] create pwd_text_area obj failed\n", __FUNCTION__, __LINE__);
            return;
        }

        // 密码框样式
        static lv_style_t pwd_text_style;
        lv_style_init(&pwd_text_style); // 初始化样式
        lv_style_set_radius(&pwd_text_style, 0); // 设置样式的圆角弧度
        lv_style_set_border_width(&pwd_text_style, 1); // 设置边框宽度
        lv_style_set_pad_all(&pwd_text_style, 0); // 设置样式的内部填充
        lv_style_set_text_font(&pwd_text_style, &lv_font_montserrat_18); //设置字体
        //lv_textarea_set_password_mode(pwd_text_area, true); // 文本区域开启密码模式
        lv_textarea_set_max_length(pwd_text_area, 3); // 设置可输入的文本的最大长度
        lv_obj_add_style(pwd_text_area, &pwd_text_style, 0); // 给btn_label添加样式
        lv_obj_set_size(pwd_text_area, 480, 50); // 设置对象大小
        lv_textarea_set_text(pwd_text_area, ""); // 文本框置空
        lv_obj_align(pwd_text_area, LV_ALIGN_TOP_LEFT, 0, 24);

        // 基于键盘背景对象创建密码校验提示标签
        hint_label = lv_label_create(lv_scr_act());
        if (hint_label == NULL)
        {
            printf("[%s:%d] create hint_label obj failed\n", __FUNCTION__, __LINE__);
            return;
        }

        // 密码提示文本样式
        static lv_style_t hint_label_style;
        lv_style_init(&hint_label_style); // 初始化样式
        lv_style_set_radius(&hint_label_style, 0); // 设置样式的圆角弧度
        lv_style_set_border_width(&hint_label_style, 0); //设置边框宽度
        lv_style_set_text_color(&hint_label_style, lv_palette_main(LV_PALETTE_RED));  // 字体颜色设置为红色
        lv_style_set_text_font(&hint_label_style, &lv_font_montserrat_12); //设置字体
        lv_label_set_long_mode(hint_label, LV_LABEL_LONG_SCROLL_CIRCULAR); // 长文本循环滚动
        lv_obj_add_style(hint_label, &hint_label_style, 0); // 给btn_label添加样式
        lv_obj_align(hint_label, LV_ALIGN_TOP_MID, 0, 110); // 顶部居中显示
        lv_label_set_text(hint_label, ""); // 设置文本内容

        // 基于键盘背景对象创建键盘对象
        pwd_keyboard = lv_keyboard_create(lv_scr_act());
        if (pwd_keyboard == NULL)
        {
            printf("[%s:%d] create pwd_keyboard obj failed\n", __FUNCTION__, __LINE__);
            return;
        }

        //键盘样式
        static lv_style_t pwd_kb_style;
        lv_style_init(&pwd_kb_style); // 初始化样式
        lv_style_set_radius(&pwd_kb_style, 5); // 设置样式的圆角弧度
        lv_style_set_border_width(&pwd_kb_style, 0); //设置边框宽度
        lv_style_set_bg_color(&pwd_kb_style, lv_color_hex(0xF98E2D));
        lv_style_set_text_opa(&pwd_kb_style, LV_OPA_COVER);
        lv_style_set_text_font(&pwd_kb_style, &lv_font_montserrat_20); //设置字体
        lv_obj_set_size(pwd_keyboard, 480, 174); //设置键盘大小
        lv_keyboard_set_mode(pwd_keyboard, LV_KEYBOARD_MODE_NUMBER_2); //设置键盘模式为数字键盘
        lv_keyboard_set_map(pwd_keyboard, LV_KEYBOARD_MODE_NUMBER_2, keyboard_map, keyboard_ctrl); // 设置键盘映射
        lv_keyboard_set_textarea(pwd_keyboard, pwd_text_area); // 键盘对象和文本框绑定
        lv_obj_add_style(pwd_keyboard, &pwd_kb_style, 0); // 添加样式
        lv_obj_align(pwd_keyboard, LV_ALIGN_TOP_LEFT, 0, 74);


        LV_FONT_DECLARE(heiFont16_1);
        label_typeface_return = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_typeface_return, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_typeface_return, lv_color_hex(0xffffff), LV_STATE_DEFAULT);

        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_typeface_return,  "返回");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_typeface_return, "Return");
        }
        lv_obj_align(label_typeface_return, LV_ALIGN_TOP_LEFT, 140, 252);

        LV_IMG_DECLARE(get_back);
        btn_typeface_return = lv_imgbtn_create(lv_scr_act());
        lv_imgbtn_set_src(btn_typeface_return, LV_IMGBTN_STATE_RELEASED, NULL, &get_back, NULL);
        lv_obj_set_size(btn_typeface_return, get_back.header.w, get_back.header.h);
        lv_obj_align(btn_typeface_return, LV_ALIGN_TOP_LEFT, 180, 250);
        lv_obj_add_event_cb(btn_typeface_return, button_date_time_word_space_return_event_cb, LV_EVENT_CLICKED, NULL);


        LV_IMG_DECLARE(confirm);
        btn_typeface_confirm = lv_imgbtn_create(lv_scr_act());
        lv_imgbtn_set_src(btn_typeface_confirm, LV_IMGBTN_STATE_RELEASED, NULL, &confirm, NULL);
        lv_obj_set_size(btn_typeface_confirm, get_back.header.w, get_back.header.h);
        lv_obj_align(btn_typeface_confirm, LV_ALIGN_TOP_LEFT, 250, 250);
        lv_obj_add_event_cb(btn_typeface_confirm, button_date_time_word_space_confirm_event_cb, LV_EVENT_CLICKED, NULL);

        LV_FONT_DECLARE(heiFont16_1);
        label_typeface_confirm = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_typeface_confirm, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_typeface_confirm, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_typeface_confirm,  "确定");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_typeface_confirm, "Confirm");
        }
        lv_obj_align(label_typeface_confirm, LV_ALIGN_TOP_LEFT, 277, 252);
    }
}




//文本界面，默认字体，思源1
//新建的时候，先收集数据
//再依次更新
static void button_date_time_confirm_event_cb(lv_event_t* e)
{
    lv_event_code_t code;
    code = lv_event_get_code(e);
    //char temp_typeface[128] = { 0 };
    int i = 0;
    int word_space = 0;
    int word_size = 0;
    //int x_size = 0;
    //int y_size = 0;
    int win_content_child_num = 0;
    //char tempString[128] = { 0 };

    if (code == LV_EVENT_CLICKED)
    {
        printf("button_date_time_confirm_event_cb\n");

         buzzer_enable = 1;

        int len = strlen(lv_label_get_text(label_addition_date_middle)) + 1;
        printf("len=%u\n\r", len);

        win_content_child_num = lv_obj_get_child_cnt(win_content);

        printf("win_content_child_num=%u\n\r", win_content_child_num);

        if ((len > 1) && (win_content_child_num < NEW_TEXT_MAX_NUMBER))
        {
            lv_obj_t* temp_obj = lv_obj_create(win_content);

            for (i = 0; i < TYPEFACE_NUMBER; i++)
            {
                if (strncmp(lv_label_get_text(label_btn_addition_date_typeface), typeface_name[i], strlen(lv_label_get_text(label_btn_addition_date_typeface))) == 0)
                {
                    break;
                }
            }

            printf("i=%d\n\r",i);

            //sprintf(temp_typeface, "/media/%s", typeface_buf[i]);
            data_structure[win_content_child_num].data.date_time.typeface = i;

            //info.name = "./lvgl/src/extra/libs/freetype/arial.ttf";
            //info.name = "./lvgl/src/extra/libs/freetype/simsun.ttc";
            //sprintf(temp_typeface, "./lvgl/src/extra/libs/freetype/%s", typeface_buf[SOURCE_HAN_SERIF_CN_REGULAR_1]);
            //printf("%s\n", temp_typeface);
            //data_structure[win_content_child_num].data.date_time.info.name = temp_typeface;

            word_size = atoi(lv_label_get_text(label_btn_addition_date_word_size));

            if (word_size < 12)
            {
                word_size = 12;
            }

            if (word_size > WORD_MAX_SIZE)
            {
                word_size = WORD_MAX_SIZE;
            }

            data_structure[win_content_child_num].data.date_time.info.weight = word_size;

            data_structure[win_content_child_num].data.date_time.spin = atoi(lv_label_get_text(label_btn_addition_date_spin));

            data_structure[win_content_child_num].data.date_time.info.style = FT_FONT_STYLE_NORMAL;

            if (lv_obj_has_state(sw_addition_date_italic, LV_STATE_CHECKED) == 1)
            {
                data_structure[win_content_child_num].data.date_time.info.style |= FT_FONT_STYLE_ITALIC;
            }

            if (lv_obj_has_state(sw_addition_date_bold, LV_STATE_CHECKED) == 1)
            {
                data_structure[win_content_child_num].data.date_time.info.style |= FT_FONT_STYLE_BOLD;
            }

            word_space = atoi(lv_label_get_text(label_btn_addition_date_word_space));

            if (word_space < 0)
            {
                word_space = 0;
            }

            if (word_space > 100)
            {
                word_space = 100;
            }

            //lv_ft_font_init(&data_structure[win_content_child_num].data.date_time.info);
            //lv_point_t text_size;
            //lv_txt_get_size(&text_size, lv_label_get_text(label_addition_date_middle), data_structure[win_content_child_num].data.date_time.info.font, 0, 0, LV_COORD_MAX, LV_TEXT_FLAG_NONE);
            lv_font_t* temp_font = font_list_get(i, word_size, data_structure[win_content_child_num].data.date_time.info.style);
            lv_point_t text_size;
            lv_txt_get_size(&text_size, lv_label_get_text(label_addition_date_middle), temp_font, word_space, 0, LV_COORD_MAX, LV_TEXT_FLAG_NONE);

            lv_obj_set_style_bg_opa(temp_obj, LV_OPA_TRANSP, 0);
            lv_obj_set_style_border_width(temp_obj, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */

            lv_obj_add_event_cb(temp_obj, drag_event_handler, LV_EVENT_PRESSING, NULL);
            lv_obj_add_event_cb(temp_obj, drag_event_handler, LV_EVENT_FOCUSED, NULL);
            lv_obj_add_event_cb(temp_obj, drag_event_handler, LV_EVENT_DEFOCUSED, NULL);
            lv_obj_clear_flag(temp_obj, LV_OBJ_FLAG_SCROLLABLE);

            lv_style_init(&data_structure[win_content_child_num].data.date_time.style);
            lv_style_set_text_font(&data_structure[win_content_child_num].data.date_time.style, temp_font);

            printf("x=%u y=%u\n\r", text_size.x, text_size.y);

            lv_obj_set_size(temp_obj, text_size.x, text_size.y);
            lv_obj_set_style_transform_angle(temp_obj, data_structure[win_content_child_num].data.date_time.spin * 10, 0);
#if 0
            if (data_structure[win_content_child_num].data.date_time.spin != 0)
            {
                lv_obj_align(temp_obj, LV_ALIGN_TOP_LEFT, 200, 70);
            }
            else
            {
                lv_obj_align(temp_obj, LV_ALIGN_TOP_LEFT, 30, 0);
            }
#endif

            lv_obj_align(temp_obj, LV_ALIGN_TOP_LEFT, 30 + 20*win_content_child_num, 6*win_content_child_num);

            lv_style_set_text_letter_space(&data_structure[win_content_child_num].data.date_time.style, word_space);
            lv_obj_t* label1 = lv_label_create(temp_obj);
            lv_obj_add_style(label1, &data_structure[win_content_child_num].data.date_time.style, 0);
            lv_label_set_text(label1, lv_label_get_text(label_addition_date_middle));
            lv_obj_center(label1);
            strncpy(data_structure[win_content_child_num].data.date_time.text, lv_label_get_text(label_addition_date_middle), len);
            data_structure[win_content_child_num].data.date_time.size = word_size;
            data_structure[win_content_child_num].data.date_time.space = word_space;
            data_structure[win_content_child_num].data.date_time.italic_bold = data_structure[win_content_child_num].data.date_time.info.style;
            printf("italic_bold=%d\n\r", data_structure[win_content_child_num].data.date_time.italic_bold);
            printf("text=%s\n\r", data_structure[win_content_child_num].data.date_time.text);
            data_structure[win_content_child_num].data.date_time.date_or_time = date_or_time_flag;

            if(date_or_time_flag == 0)
            {
                data_structure[win_content_child_num].data.date_time.date_or_time_type = g_date_type;
            }
            else if(date_or_time_flag == 2)
            {
                 data_structure[win_content_child_num].data.date_time.date_or_time_type = g_date_type;
                 data_structure[win_content_child_num].data.date_time.year = validity_date.year;
                 data_structure[win_content_child_num].data.date_time.month = validity_date.month;
                 data_structure[win_content_child_num].data.date_time.day = validity_date.day;
            }
            else
            {
                data_structure[win_content_child_num].data.date_time.date_or_time_type = g_time_type;
            }
                      
            data_structure[win_content_child_num].type = TYPE_DATE;
        }
        else
        {

        }
        
        lv_obj_del(label_addition_date_time_confirm);
        lv_obj_del(imgbtn_addition_date_time_confirm);
        lv_obj_del(imgbtn_addition_date_time_return);
        lv_obj_del(label_addition_date_time_return);
        lv_obj_del(addition_date_bottom_bg);
        lv_obj_del(sw_addition_date_italic);
        lv_obj_del(label_addition_date_italic);
        lv_obj_del(img_addition_date_italic);
        lv_obj_del(sw_addition_date_bold);
        lv_obj_del(label_addition_date_bold);
        lv_obj_del(img_btn_addition_date_bold);
        lv_obj_del(label_btn_addition_date_spin);
        lv_obj_del(btn_addition_date_spin);
        lv_obj_del(label_addition_date_spin);
        lv_obj_del(img_addition_date_spin);

        lv_obj_del(label_btn_addition_date_word_space);
        lv_obj_del(btn_addition_date_word_space);
        lv_obj_del(label_addition_date_word_space);
        lv_obj_del(img_addition_date_word_space);
        lv_obj_del(label_btn_addition_date_word_size);
        lv_obj_del(btn_addition_date_word_size);
        lv_obj_del(label_addition_date_word_size);
        lv_obj_del(img_addition_date_word_size);
        lv_obj_del(label_btn_addition_date_typeface);
        lv_obj_del(btn_addition_date_typeface);
        lv_obj_del(label_addition_date_typeface);
        lv_obj_del(img_addition_date_typeface);
        lv_obj_del(label_btn_label_addition_time);
        lv_obj_del(btn_label_addition_time);
        lv_obj_del(label_addition_time);
        lv_obj_del(img_addition_time);
        lv_obj_del(label_btn_addition_date_text);
        lv_obj_del(btn_addition_date_text);
        lv_obj_del(label_addition_date_text);
        lv_obj_del(img_addition_date_text);
        lv_obj_del(addition_date_middle_bg);
        lv_obj_del(label_addition_date_middle_bg);
        lv_obj_del(label_addition_date_middle);
        lv_obj_del(label_addition_date_head);
        lv_obj_del(addition_date_head_bg);


        //删除添加界面
        lv_obj_del(img_addition_bg);
        lv_obj_del(btn_addition_text);
        lv_obj_del(label_btn_addition_text);
        lv_obj_del(btn_addition_date);
        lv_obj_del(label_btn_addition_date);
        lv_obj_del(btn_addition_picture);
        lv_obj_del(label_btn_addition_picture);
        lv_obj_del(btn_addition_QR_code);
        lv_obj_del(label_btn_addition_QR_code);
        lv_obj_del(btn_addition_bar_code);
        lv_obj_del(label_btn_addition_bar_code);
        lv_obj_del(btn_addition_count);
        lv_obj_del(label_btn_addition_count);
        lv_obj_del(btn_addition_subsection);
        lv_obj_del(label_btn_addition_subsection);
        lv_obj_del(btn_addition_symbol);
        lv_obj_del(label_btn_addition_symbol);
        lv_obj_del(btn_addition_icon);
        lv_obj_del(label_btn_addition_icon);
        lv_obj_del(btn_addition_more_functions);
        lv_obj_del(label_btn_addition_more_functions);
        lv_obj_del(btn_addition_return);
    }
}


static void button_date_time_return_event_cb(lv_event_t* e)
{
    lv_event_code_t code;
    code = lv_event_get_code(e);

    if (code == LV_EVENT_CLICKED)
    {
        printf("button_date_time_return_event_cb\n");

        buzzer_enable = 1;

        lv_obj_del(label_addition_date_time_confirm);
        lv_obj_del(imgbtn_addition_date_time_confirm);
        lv_obj_del(imgbtn_addition_date_time_return);
        lv_obj_del(label_addition_date_time_return);
        lv_obj_del(addition_date_bottom_bg);
        lv_obj_del(sw_addition_date_italic);
        lv_obj_del(label_addition_date_italic);
        lv_obj_del(img_addition_date_italic);
        lv_obj_del(sw_addition_date_bold);
        lv_obj_del(label_addition_date_bold);
        lv_obj_del(img_btn_addition_date_bold);
        lv_obj_del(label_btn_addition_date_spin);
        lv_obj_del(btn_addition_date_spin);
        lv_obj_del(label_addition_date_spin);
        lv_obj_del(img_addition_date_spin);

        lv_obj_del(label_btn_addition_date_word_space);
        lv_obj_del(btn_addition_date_word_space);
        lv_obj_del(label_addition_date_word_space);
        lv_obj_del(img_addition_date_word_space);
        lv_obj_del(label_btn_addition_date_word_size);
        lv_obj_del(btn_addition_date_word_size);
        lv_obj_del(label_addition_date_word_size);
        lv_obj_del(img_addition_date_word_size);
        lv_obj_del(label_btn_addition_date_typeface);
        lv_obj_del(btn_addition_date_typeface);
        lv_obj_del(label_addition_date_typeface);
        lv_obj_del(img_addition_date_typeface);
        lv_obj_del(label_btn_label_addition_time);
        lv_obj_del(btn_label_addition_time);
        lv_obj_del(label_addition_time);
        lv_obj_del(img_addition_time);
        lv_obj_del(label_btn_addition_date_text);
        lv_obj_del(btn_addition_date_text);
        lv_obj_del(label_addition_date_text);
        lv_obj_del(img_addition_date_text);
        lv_obj_del(addition_date_middle_bg);
        lv_obj_del(label_addition_date_middle_bg);
        lv_obj_del(label_addition_date_middle);
        lv_obj_del(label_addition_date_head);
        lv_obj_del(addition_date_head_bg);


        //删除添加界面
        lv_obj_del(img_addition_bg);
        lv_obj_del(btn_addition_text);
        lv_obj_del(label_btn_addition_text);
        lv_obj_del(btn_addition_date);
        lv_obj_del(label_btn_addition_date);
        lv_obj_del(btn_addition_picture);
        lv_obj_del(label_btn_addition_picture);
        lv_obj_del(btn_addition_QR_code);
        lv_obj_del(label_btn_addition_QR_code);
        lv_obj_del(btn_addition_bar_code);
        lv_obj_del(label_btn_addition_bar_code);
        lv_obj_del(btn_addition_count);
        lv_obj_del(label_btn_addition_count);
        lv_obj_del(btn_addition_subsection);
        lv_obj_del(label_btn_addition_subsection);
        lv_obj_del(btn_addition_symbol);
        lv_obj_del(label_btn_addition_symbol);
        lv_obj_del(btn_addition_icon);
        lv_obj_del(label_btn_addition_icon);
        lv_obj_del(btn_addition_more_functions);
        lv_obj_del(label_btn_addition_more_functions);
        lv_obj_del(btn_addition_return);
    }
}


/*
10,134,45,139,95,136    250,134,285,139,338,136
10,162,45,167,95,164
10,190,45,195,95,192
*/

static void button_addition_date_event_cb(lv_event_t* e)
{
    lv_event_code_t code;
    //int now_year = 2025;
    //int now_month = 1;
    //int now_day = 10;
    char temp_str[20] = { 0 };

    code = lv_event_get_code(e);

    if ((code == LV_EVENT_CLICKED) && (print_status == 0))
    {
        printf("addition text\n");
        buzzer_enable = 1;

        flag_modification_or_addition = 0;

        addition_date_head_bg = lv_obj_create(lv_scr_act());
        lv_obj_set_size(addition_date_head_bg, 480, 24);
        lv_obj_align(addition_date_head_bg, LV_ALIGN_TOP_LEFT, 0, 0);
        lv_obj_set_style_border_width(addition_date_head_bg, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_radius(addition_date_head_bg, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_color(addition_date_head_bg, lv_color_hex(0x28536a), LV_STATE_DEFAULT);
        lv_obj_remove_style(addition_date_head_bg, 0, LV_PART_SCROLLBAR);


        LV_FONT_DECLARE(heiFont16_1);
        label_addition_date_head = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_addition_date_head, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_addition_date_head, lv_color_hex(0xFFFFFF), LV_STATE_DEFAULT);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_addition_date_head, "日期和时间");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_addition_date_head, "Date & Time");
        }
        lv_obj_align(label_addition_date_head, LV_ALIGN_TOP_LEFT, 200, 4);


        label_addition_date_middle_bg = lv_obj_create(lv_scr_act());
        lv_obj_set_size(label_addition_date_middle_bg, 480, 140);
        lv_obj_align(label_addition_date_middle_bg, LV_ALIGN_TOP_LEFT, 0, 24);
        lv_obj_set_style_border_width(label_addition_date_middle_bg, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_radius(label_addition_date_middle_bg, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_color(label_addition_date_middle_bg, lv_color_hex(0xffffff), LV_STATE_DEFAULT);


        LV_FONT_DECLARE(heiFont16_1);
        label_addition_date_middle = lv_label_create(lv_scr_act());
        lv_obj_set_width(label_addition_date_middle, 480);
        lv_obj_set_height(label_addition_date_middle, 108);
        lv_obj_set_style_text_font(label_addition_date_middle, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_addition_date_middle, lv_color_hex(0x000000), LV_STATE_DEFAULT);
        sprintf(temp_str, "%04d/%02d/%02d", g_system_time[0] + 2000, g_system_time[1],  g_system_time[2]);
        lv_label_set_text(label_addition_date_middle, temp_str);
        lv_obj_set_style_bg_color(label_addition_date_middle, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        lv_obj_align(label_addition_date_middle, LV_ALIGN_TOP_LEFT, 0, 24);


        addition_date_middle_bg = lv_obj_create(lv_scr_act());
        lv_obj_set_size(addition_date_middle_bg, 480, 140);
        lv_obj_align(addition_date_middle_bg, LV_ALIGN_TOP_LEFT, 0, 132);
        lv_obj_set_style_border_width(addition_date_middle_bg, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_radius(addition_date_middle_bg, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_color(addition_date_middle_bg, lv_color_hex(0x1fadd3), LV_STATE_DEFAULT);

        LV_IMG_DECLARE(date);
        img_addition_date_text = lv_img_create(lv_scr_act());
        lv_img_set_src(img_addition_date_text, &date);
        lv_obj_align(img_addition_date_text, LV_ALIGN_TOP_LEFT, 10, 134);

        LV_FONT_DECLARE(heiFont16_1);
        label_addition_date_text = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_addition_date_text, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_addition_date_text, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_addition_date_text, "日期");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_addition_date_text, "Date");
        }
        lv_obj_align(label_addition_date_text, LV_ALIGN_TOP_LEFT, 45, 139);

        LV_FONT_DECLARE(heiFont16_1);
        btn_addition_date_text = lv_btn_create(lv_scr_act());
        lv_obj_set_size(btn_addition_date_text, 125, 24);
        lv_obj_align(btn_addition_date_text, LV_ALIGN_TOP_LEFT, 95, 136);
        lv_obj_set_style_border_width(btn_addition_date_text, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_radius(btn_addition_date_text, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_color(btn_addition_date_text, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        label_btn_addition_date_text = lv_label_create(btn_addition_date_text);
        lv_obj_set_style_text_font(label_btn_addition_date_text, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_btn_addition_date_text, lv_color_hex(0x1C1C1C), LV_STATE_DEFAULT);
        //sprintf(temp_str, "%04d/%02d/%02d", g_system_time[0] + 2000, g_system_time[1],  g_system_time[2]);
        lv_label_set_text(label_btn_addition_date_text, temp_str);
        lv_obj_align(label_btn_addition_date_text, LV_ALIGN_CENTER, 0, 0);
        lv_obj_set_style_border_width(label_btn_addition_date_text, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_border_color(label_btn_addition_date_text, lv_color_hex(0x8a8a8a), LV_STATE_DEFAULT); /* 设置边框颜色 */
        lv_obj_set_style_border_opa(label_btn_addition_date_text, 100, LV_STATE_DEFAULT); /* 设置边框透明度 */
        lv_obj_set_style_radius(label_btn_addition_date_text, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_opa(label_btn_addition_date_text, LV_OPA_COVER, LV_PART_MAIN);
        lv_obj_set_style_bg_color(label_btn_addition_date_text, lv_color_hex(0xffffff), LV_PART_MAIN);
        lv_obj_add_event_cb(btn_addition_date_text, btn_addition_date_text_event_cb, LV_EVENT_CLICKED, NULL);


        LV_IMG_DECLARE(typeface);
        img_addition_date_typeface = lv_img_create(lv_scr_act());
        lv_img_set_src(img_addition_date_typeface, &typeface);
        lv_obj_align(img_addition_date_typeface, LV_ALIGN_TOP_LEFT, 10, 162);

        LV_FONT_DECLARE(heiFont16_1);
        label_addition_date_typeface = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_addition_date_typeface, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_addition_date_typeface, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_addition_date_typeface, "字体");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_addition_date_typeface, "Typeface");
        }
        lv_obj_align(label_addition_date_typeface, LV_ALIGN_TOP_LEFT, 45, 167);

        LV_FONT_DECLARE(heiFont16_1);
        btn_addition_date_typeface = lv_btn_create(lv_scr_act());
        lv_obj_set_size(btn_addition_date_typeface, 125, 24);
        lv_obj_align(btn_addition_date_typeface, LV_ALIGN_TOP_LEFT, 95, 164);
        lv_obj_set_style_border_width(btn_addition_date_typeface, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_radius(btn_addition_date_typeface, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_color(btn_addition_date_typeface, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        label_btn_addition_date_typeface = lv_label_create(btn_addition_date_typeface);
        lv_obj_set_style_text_font(label_btn_addition_date_typeface, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_btn_addition_date_typeface, lv_color_hex(0x1C1C1C), LV_STATE_DEFAULT);
        //k = lv_obj_get_index(temp_focused_obj);
        //lv_label_set_text(label_file_management_typeface_label, typeface_name[new_text.text_content[k].typeface]);
        //printf("typeface=%d\n\r", new_text.text_content[k].typeface);
        lv_label_set_text(label_btn_addition_date_typeface,"常用宋体");
        lv_obj_align(label_btn_addition_date_typeface, LV_ALIGN_CENTER, 0, 0);
        lv_obj_set_style_border_width(label_btn_addition_date_typeface, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_border_color(label_btn_addition_date_typeface, lv_color_hex(0x8a8a8a), LV_STATE_DEFAULT); /* 设置边框颜色 */
        lv_obj_set_style_border_opa(label_btn_addition_date_typeface, 100, LV_STATE_DEFAULT); /* 设置边框透明度 */
        lv_obj_set_style_radius(label_btn_addition_date_typeface, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_opa(label_btn_addition_date_typeface, LV_OPA_COVER, LV_PART_MAIN);
        lv_obj_set_style_bg_color(label_btn_addition_date_typeface, lv_color_hex(0xffffff), LV_PART_MAIN);
        lv_obj_add_event_cb(btn_addition_date_typeface, btn_date_time_typeface_event_cb, LV_EVENT_CLICKED, NULL);


        LV_IMG_DECLARE(word_size);
        img_addition_date_word_size = lv_img_create(lv_scr_act());
        lv_img_set_src(img_addition_date_word_size, &word_size);
        lv_obj_align(img_addition_date_word_size, LV_ALIGN_TOP_LEFT, 10, 190);

        LV_FONT_DECLARE(heiFont16_1);
        label_addition_date_word_size = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_addition_date_word_size, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_addition_date_word_size, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_addition_date_word_size, "字号");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_addition_date_word_size, "Size");
        }
        lv_obj_align(label_addition_date_word_size, LV_ALIGN_TOP_LEFT, 45, 195);


        LV_FONT_DECLARE(heiFont16_1);
        btn_addition_date_word_size = lv_btn_create(lv_scr_act());
        lv_obj_set_size(btn_addition_date_word_size, 125, 24);
        lv_obj_align(btn_addition_date_word_size, LV_ALIGN_TOP_LEFT, 95, 192);
        lv_obj_set_style_border_width(btn_addition_date_word_size, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_radius(btn_addition_date_word_size, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_color(btn_addition_date_word_size, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        label_btn_addition_date_word_size = lv_label_create(btn_addition_date_word_size);
        lv_obj_set_style_text_font(label_btn_addition_date_word_size, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_btn_addition_date_word_size, lv_color_hex(0x1C1C1C), LV_STATE_DEFAULT);
        lv_label_set_text(label_btn_addition_date_word_size, "48");
        lv_obj_align(label_btn_addition_date_word_size, LV_ALIGN_CENTER, 0, 0);
        lv_obj_set_style_border_width(label_btn_addition_date_word_size, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_border_color(label_btn_addition_date_word_size, lv_color_hex(0x8a8a8a), LV_STATE_DEFAULT); /* 设置边框颜色 */
        lv_obj_set_style_border_opa(label_btn_addition_date_word_size, 100, LV_STATE_DEFAULT); /* 设置边框透明度 */
        lv_obj_set_style_radius(label_btn_addition_date_word_size, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_opa(label_btn_addition_date_word_size, LV_OPA_COVER, LV_PART_MAIN);
        lv_obj_set_style_bg_color(label_btn_addition_date_word_size, lv_color_hex(0xffffff), LV_PART_MAIN);
        lv_obj_add_event_cb(btn_addition_date_word_size, btn_date_time_word_size_event_cb, LV_EVENT_CLICKED, NULL);


        LV_IMG_DECLARE(italic);
        img_addition_date_italic = lv_img_create(lv_scr_act());
        lv_img_set_src(img_addition_date_italic, &italic);
        lv_obj_align(img_addition_date_italic, LV_ALIGN_TOP_LEFT, 10, 218);

        LV_FONT_DECLARE(heiFont16_1);
        label_addition_date_italic = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_addition_date_italic, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_addition_date_italic, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_addition_date_italic, "斜体");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_addition_date_italic, "Italic");
        }
        lv_obj_align(label_addition_date_italic, LV_ALIGN_TOP_LEFT, 45, 223);

        sw_addition_date_italic = lv_switch_create(lv_scr_act());
        lv_obj_set_pos(sw_addition_date_italic, 95, 220);
        lv_obj_set_width(sw_addition_date_italic, 48);
        lv_obj_set_height(sw_addition_date_italic, 23);
        lv_obj_set_style_bg_color(sw_addition_date_italic, lv_color_hex(0x00ff00), LV_STATE_CHECKED | LV_PART_INDICATOR);
        lv_obj_add_event_cb(sw_addition_date_italic, sw_addition_bold_event_cb, LV_EVENT_CLICKED, NULL);


        LV_IMG_DECLARE(date_time);
        img_addition_time = lv_img_create(lv_scr_act());
        lv_img_set_src(img_addition_time, &date_time);
        lv_obj_align(img_addition_time, LV_ALIGN_TOP_LEFT, 250, 134);

        LV_FONT_DECLARE(heiFont16_1);
        label_addition_time = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_addition_time, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_addition_time, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_addition_time, "时间");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_addition_time, "Time");
        }
        lv_obj_align(label_addition_time, LV_ALIGN_TOP_LEFT, 285, 139);


        LV_FONT_DECLARE(heiFont16_1);
        btn_label_addition_time = lv_btn_create(lv_scr_act());
        lv_obj_set_size(btn_label_addition_time, 125, 24);
        lv_obj_align(btn_label_addition_time, LV_ALIGN_TOP_LEFT, 338, 136);
        lv_obj_set_style_border_width(btn_label_addition_time, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_radius(btn_label_addition_time, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_color(btn_label_addition_time, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        label_btn_label_addition_time = lv_label_create(btn_label_addition_time);
        lv_obj_set_style_text_font(label_btn_label_addition_time, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_btn_label_addition_time, lv_color_hex(0x1C1C1C), LV_STATE_DEFAULT);
        sprintf(temp_str, "%02d:%02d:%02d", g_system_time[3], g_system_time[4], g_system_time[5]);
        lv_label_set_text(label_btn_label_addition_time, temp_str);
        lv_obj_align(label_btn_label_addition_time, LV_ALIGN_CENTER, 0, 0);
        lv_obj_set_style_border_width(label_btn_label_addition_time, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_border_color(label_btn_label_addition_time, lv_color_hex(0x8a8a8a), LV_STATE_DEFAULT); /* 设置边框颜色 */
        lv_obj_set_style_border_opa(label_btn_label_addition_time, 100, LV_STATE_DEFAULT); /* 设置边框透明度 */
        lv_obj_set_style_radius(label_btn_label_addition_time, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_opa(label_btn_label_addition_time, LV_OPA_COVER, LV_PART_MAIN);
        lv_obj_set_style_bg_color(label_btn_label_addition_time, lv_color_hex(0xffffff), LV_PART_MAIN);
        lv_obj_add_event_cb(btn_label_addition_time, btn_addition_time_event_cb, LV_EVENT_CLICKED, NULL);



        LV_IMG_DECLARE(word_space);
        img_addition_date_word_space = lv_img_create(lv_scr_act());
        lv_img_set_src(img_addition_date_word_space, &word_space);
        lv_obj_align(img_addition_date_word_space, LV_ALIGN_TOP_LEFT, 250, 162);

        LV_FONT_DECLARE(heiFont16_1);
        label_addition_date_word_space = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_addition_date_word_space, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_addition_date_word_space, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_addition_date_word_space, "间距");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_addition_date_word_space, "Space");
        }
        lv_obj_align(label_addition_date_word_space, LV_ALIGN_TOP_LEFT, 285, 167);


        LV_FONT_DECLARE(heiFont16_1);
        btn_addition_date_word_space = lv_btn_create(lv_scr_act());
        lv_obj_set_size(btn_addition_date_word_space, 125, 24);
        lv_obj_align(btn_addition_date_word_space, LV_ALIGN_TOP_LEFT, 338, 164);
        lv_obj_set_style_border_width(btn_addition_date_word_space, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_radius(btn_addition_date_word_space, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_color(btn_addition_date_word_space, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        label_btn_addition_date_word_space = lv_label_create(btn_addition_date_word_space);
        lv_obj_set_style_text_font(label_btn_addition_date_word_space, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_btn_addition_date_word_space, lv_color_hex(0x1C1C1C), LV_STATE_DEFAULT);
        lv_label_set_text(label_btn_addition_date_word_space, "000");
        lv_obj_align(label_btn_addition_date_word_space, LV_ALIGN_CENTER, 0, 0);
        lv_obj_set_style_border_width(label_btn_addition_date_word_space, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_border_color(label_btn_addition_date_word_space, lv_color_hex(0x8a8a8a), LV_STATE_DEFAULT); /* 设置边框颜色 */
        lv_obj_set_style_border_opa(label_btn_addition_date_word_space, 100, LV_STATE_DEFAULT); /* 设置边框透明度 */
        lv_obj_set_style_radius(label_btn_addition_date_word_space, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_opa(label_btn_addition_date_word_space, LV_OPA_COVER, LV_PART_MAIN);
        lv_obj_set_style_bg_color(label_btn_addition_date_word_space, lv_color_hex(0xffffff), LV_PART_MAIN);
        lv_obj_add_event_cb(btn_addition_date_word_space, btn_date_time_word_space_event_cb, LV_EVENT_CLICKED, NULL);



        LV_IMG_DECLARE(spin);
        img_addition_date_spin = lv_img_create(lv_scr_act());
        lv_img_set_src(img_addition_date_spin, &spin);
        lv_obj_align(img_addition_date_spin, LV_ALIGN_TOP_LEFT, 250, 190);

        LV_FONT_DECLARE(heiFont16_1);
        label_addition_date_spin = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_addition_date_spin, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_addition_date_spin, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_addition_date_spin, "旋转");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_addition_date_spin, "Spin");
        }
        lv_obj_align(label_addition_date_spin, LV_ALIGN_TOP_LEFT, 285, 195);


        LV_FONT_DECLARE(heiFont16_1);
        btn_addition_date_spin = lv_btn_create(lv_scr_act());
        lv_obj_set_size(btn_addition_date_spin, 125, 24);
        lv_obj_align(btn_addition_date_spin, LV_ALIGN_TOP_LEFT, 338, 192);
        lv_obj_set_style_border_width(btn_addition_date_spin, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_radius(btn_addition_date_spin, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_color(btn_addition_date_spin, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        label_btn_addition_date_spin = lv_label_create(btn_addition_date_spin);
        lv_obj_set_style_text_font(label_btn_addition_date_spin, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_btn_addition_date_spin, lv_color_hex(0x1C1C1C), LV_STATE_DEFAULT);
        lv_label_set_text(label_btn_addition_date_spin, "0°");
        lv_obj_align(label_btn_addition_date_spin, LV_ALIGN_CENTER, 0, 0);
        lv_obj_set_style_border_width(label_btn_addition_date_spin, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_border_color(label_btn_addition_date_spin, lv_color_hex(0x8a8a8a), LV_STATE_DEFAULT); /* 设置边框颜色 */
        lv_obj_set_style_border_opa(label_btn_addition_date_spin, 100, LV_STATE_DEFAULT); /* 设置边框透明度 */
        lv_obj_set_style_radius(label_btn_addition_date_spin, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_opa(label_btn_addition_date_spin, LV_OPA_COVER, LV_PART_MAIN);
        lv_obj_set_style_bg_color(label_btn_addition_date_spin, lv_color_hex(0xffffff), LV_PART_MAIN);
        lv_obj_add_event_cb(btn_addition_date_spin, btn_addition_date_spin_event_cb, LV_EVENT_CLICKED, NULL);


        LV_IMG_DECLARE(bold);
        img_btn_addition_date_bold = lv_img_create(lv_scr_act());
        lv_img_set_src(img_btn_addition_date_bold, &bold);
        lv_obj_align(img_btn_addition_date_bold, LV_ALIGN_TOP_LEFT, 250, 218);

        LV_FONT_DECLARE(heiFont16_1);
        label_addition_date_bold = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_addition_date_bold, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_addition_date_bold, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_addition_date_bold, "粗体");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_addition_date_bold, "Bold");
        }
        lv_obj_align(label_addition_date_bold, LV_ALIGN_TOP_LEFT, 285, 223);

        sw_addition_date_bold = lv_switch_create(lv_scr_act());
        lv_obj_set_pos(sw_addition_date_bold, 343, 220);
        lv_obj_set_width(sw_addition_date_bold, 48);
        lv_obj_set_height(sw_addition_date_bold, 23);
        lv_obj_set_style_bg_color(sw_addition_date_bold, lv_color_hex(0x00ff00), LV_STATE_CHECKED | LV_PART_INDICATOR);
        lv_obj_add_event_cb(sw_addition_date_bold, sw_addition_bold_event_cb, LV_EVENT_CLICKED, NULL);


        addition_date_bottom_bg = lv_obj_create(lv_scr_act());
        lv_obj_set_size(addition_date_bottom_bg, 480, 24);
        lv_obj_align(addition_date_bottom_bg, LV_ALIGN_TOP_LEFT, 0, 248);
        lv_obj_set_style_border_width(addition_date_bottom_bg, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_radius(addition_date_bottom_bg, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_color(addition_date_bottom_bg, lv_color_hex(0x28536a), LV_STATE_DEFAULT);
        lv_obj_remove_style(addition_date_bottom_bg, 0, LV_PART_SCROLLBAR);


        LV_FONT_DECLARE(heiFont16_1);
        label_addition_date_time_return = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_addition_date_time_return, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_addition_date_time_return, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_addition_date_time_return, "返回");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_addition_date_time_return, "Return");
        }
        lv_obj_align(label_addition_date_time_return, LV_ALIGN_TOP_LEFT, 140, 252);


        LV_IMG_DECLARE(get_back);
        imgbtn_addition_date_time_return = lv_imgbtn_create(lv_scr_act());
        lv_imgbtn_set_src(imgbtn_addition_date_time_return, LV_IMGBTN_STATE_RELEASED, NULL, &get_back, NULL);
        lv_obj_set_size(imgbtn_addition_date_time_return, get_back.header.w, get_back.header.h);
        lv_obj_align(imgbtn_addition_date_time_return, LV_ALIGN_TOP_LEFT, 180, 250);
        lv_obj_add_event_cb(imgbtn_addition_date_time_return, button_date_time_return_event_cb, LV_EVENT_CLICKED, NULL);

        LV_IMG_DECLARE(confirm);
        imgbtn_addition_date_time_confirm = lv_imgbtn_create(lv_scr_act());
        lv_imgbtn_set_src(imgbtn_addition_date_time_confirm, LV_IMGBTN_STATE_RELEASED, NULL, &confirm, NULL);
        lv_obj_set_size(imgbtn_addition_date_time_confirm, get_back.header.w, get_back.header.h);
        lv_obj_align(imgbtn_addition_date_time_confirm, LV_ALIGN_TOP_LEFT, 250, 250);
        lv_obj_add_event_cb(imgbtn_addition_date_time_confirm, button_date_time_confirm_event_cb, LV_EVENT_CLICKED, NULL);

        LV_FONT_DECLARE(heiFont16_1);
        label_addition_date_time_confirm = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_addition_date_time_confirm, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_addition_date_time_confirm, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_addition_date_time_confirm, "确定");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_addition_date_time_confirm, "Confirm");
        }
        lv_obj_align(label_addition_date_time_confirm, LV_ALIGN_TOP_LEFT, 277, 252);
    }
}




static void btn_addition_picture_delete_event_cb(lv_event_t* e)
{
    lv_event_code_t code;

    char picture_name[128] = { 0 };

    code = lv_event_get_code(e);
    if (code == LV_EVENT_CLICKED)
    {
        printf("btn_addition_picture_delete_event_cb\n");

        buzzer_enable = 1;

        //删除选中的文件，重新新建表格
        sprintf(picture_name, "/mnt/%s.%s", lv_table_get_cell_value(table_addition_picture_1, g_row, 0), lv_table_get_cell_value(table_addition_picture_1, g_row, 1));
        if (unlink(picture_name) == -1)
        {
            perror("unlink");
        }

        // 获取表格的行数和列数
        uint16_t row_cnt = lv_table_get_row_cnt(table_addition_picture_1);
        uint16_t col_cnt = lv_table_get_col_cnt(table_addition_picture_1);

        // 将选中行下方的所有行上移
        for (uint16_t r = g_row; r < row_cnt - 1; r++)
        {
            for (uint16_t c = 0; c < col_cnt; c++)
            {
                const char* value = lv_table_get_cell_value(table_addition_picture_1, r + 1, c);
                lv_table_set_cell_value(table_addition_picture_1, r, c, value);
            }
        }

        // 删除最后一行
        lv_table_set_row_cnt(table_addition_picture_1, row_cnt - 1);

        // 刷新表格
        lv_obj_invalidate(table_addition_picture_1);  // 刷新表格，触发重绘
    }
}


#if 0
static void btn_addition_picture_open_event_cb(lv_event_t* e)
{
    lv_event_code_t code;
    int i;
    lv_obj_t* obj = lv_event_get_target(e);
    code = lv_event_get_code(e);
    if (code == LV_EVENT_FOCUSED)
    {
        printf("button_typeface_event_cb LV_EVENT_FOCUSED\n");
        buzzer_enable = 1;

        lv_obj_t* label = lv_obj_get_child(obj, 0);
        lv_obj_set_style_bg_color(obj, lv_color_hex(0x7FFFD4), LV_PART_MAIN);

        for (i = 0; i < TYPEFACE_NUMBER; i++)
        {
            if (strncmp(lv_label_get_text(label), typeface_name[i], strlen(lv_label_get_text(label))) == 0)
            {
                break;
            }
        }
        g_typeface = i;
        printf("g_typeface=%d\n", g_typeface);
    }
    else if (code == LV_EVENT_DEFOCUSED)
    {
        printf("button_typeface_event_cb LV_EVENT_DEFOCUSED\n");
        lv_obj_set_style_bg_color(obj, lv_color_hex(0xffffff), LV_PART_MAIN);
    }
}
#endif


// 检查文件是否为图片文件
static int is_image_file(const char *filename) 
{
    const char *ext = strrchr(filename, '.');
    if (ext != NULL) 
    {
#if 0
        if (strcmp(ext, ".jpg") == 0 || strcmp(ext, ".jpeg") == 0 ||
            strcmp(ext, ".png") == 0 || strcmp(ext, ".gif") == 0 ||
            strcmp(ext, ".bmp") == 0 || strcmp(ext, ".tiff") == 0) 
#endif
#if 0
        if (strcmp(ext, ".jpg") == 0 || strcmp(ext, ".jpeg") == 0 ||
            strcmp(ext, ".png") == 0 || strcmp(ext, ".gif") == 0 ||
            strcmp(ext, ".bmp") == 0) 
#endif
        if (strcmp(ext, ".bmp") == 0) 
        {
            return 1;
        }
    }
    return 0;
}


static int get_image_file_type(const char *filename) 
{
    const char *ext = strrchr(filename, '.');
    if (ext != NULL) 
    {
        if(strcmp(ext, ".jpg") == 0)
        {
            return 0;
        }
        else if(strcmp(ext, ".jpeg") == 0)
        {
            return 1;
        }
        else if(strcmp(ext, ".png") == 0)
        {
            return 2;
        }
        else if(strcmp(ext, ".gif") == 0)
        {
            return 3;
        }
        else if(strcmp(ext, ".bmp") == 0) 
        {
            return 4;
        }
    }
    return 0;
}

// 打印文件信息
static void print_file_info(const char *filename, const struct stat *file_stat) {
    printf("File: %s\n", filename);
    printf("Type: %s\n", is_image_file(filename) ? "Image" : "Other");
    printf("Size: %lld bytes\n", file_stat->st_size);
    printf("Created: %s", ctime(&file_stat->st_ctime));
    printf("\n");
}



static void picture_draw_event_cb(lv_event_t* e)
{
    lv_obj_draw_part_dsc_t* dsc = lv_event_get_draw_part_dsc(e);
    /*If the cells are drawn...*/
    if (dsc->part == LV_PART_ITEMS)
    {
        //printf("dsc->id=%d\n\r", dsc->id);
        if ((dsc->id / 3) == g_row)
        {
            dsc->rect_dsc->bg_color = lv_color_hex(0x00FF00);  // 绿色
            dsc->rect_dsc->bg_opa = LV_OPA_COVER;  // 完全不透明
        }
        else {
            dsc->rect_dsc->bg_color = lv_color_hex(0xFFFFFF);  // 白色
            dsc->rect_dsc->bg_opa = LV_OPA_COVER;  // 完全不透明
        }
    }
}

static void picture_change_event_cb(lv_event_t* e)
{
    lv_obj_t* obj = lv_event_get_target(e);
    uint16_t col;
    uint16_t row;
    char picture_name[128] = { 0 };

    lv_table_get_selected_cell(obj, &row, &col);
    printf("row=%d\n\r", row);

    buzzer_enable = 1;

    g_row = row;
    lv_obj_invalidate(obj);  // 刷新表格，触发重绘


    sprintf(picture_name,"A:/mnt/%s.%s", lv_table_get_cell_value(table_addition_picture_1, g_row, 0), lv_table_get_cell_value(table_addition_picture_1, g_row, 1));
    
    lv_img_set_src(picture_img, picture_name);
}







// 将文件大小转换为合适的单位（B/K/M/G），保留一位小数
static void size_to_human_readable(long size, char *output, size_t output_size) {
    const char *units[] = {"B", "K", "M", "G"};
    double size_converted = size;
    int unit_index = 0;

    // 自动选择合适的单位
    while (size_converted >= 1024 && unit_index < 3) {
        size_converted /= 1024;
        unit_index++;
    }

    // 格式化为字符串，保留一位小数
    snprintf(output, output_size, "%.1f%s", size_converted, units[unit_index]);
}


// 获取图片名称（去掉类型和点号）
static void get_image_name(const char *filename, char *output, size_t output_size) 
{
    // 查找最后一个点号的位置
    const char *dot = strrchr(filename, '.');

    if (dot != NULL) 
    {
        // 计算名称的长度
        size_t name_length = dot - filename;

        // 确保名称长度不超过输出缓冲区大小
        if (name_length < output_size) 
        {
            // 复制名称部分到输出缓冲区
            strncpy(output, filename, name_length);
            output[name_length] = '\0'; // 添加字符串结束符
        } 
        else 
        {
            // 如果名称过长，截断并添加结束符
            //strncpy(output, filename, output_size - 1);
            //output[output_size - 1] = '\0';
            snprintf(output,300,"%s",filename);
        }
    } 
    else 
    {
        // 如果没有点号，直接复制整个字符串
        //strncpy(output, filename, output_size - 1);
        //output[output_size - 1] = '\0';
        snprintf(output,300,"%s",filename);
        printf("get_image_name error\n\r");
    }
}






static void button_picture_search_keyboard_confirm_event_cb(lv_event_t* e)
{
    lv_event_code_t code;
    char file_name[100]={0};
    DIR *dir;
    struct dirent *entry;
    struct stat file_stat;
    char path[300];
    unsigned char picture_count = 0;
    int picture_type = 0;
    char created_time[20] ={0};
    //char size_str[20]; // 存储转换后的字符串
    char image_name[50]; // 存储提取的图片名称
    char file_name_short[100]={0};

    code = lv_event_get_code(e);
    int len = 0;
    if (code == LV_EVENT_CLICKED)
    {
        printf("button_picture_search_keyboard_confirm_event_cb\n");
        //获取输入框数据给到文本显示框
        lv_label_set_text(label_btn_addition_picture_search, lv_textarea_get_text(textarea_text_keyboard));
        len = strlen(lv_label_get_text(label_btn_addition_picture_search));
        printf("len=%d\n\r", len);
        lv_obj_del(textarea_bg_keyboard);
        lv_obj_del(pinyin_ime);
        lv_obj_del(textarea_text_keyboard);
        lv_obj_del(keyboard_bg);
        lv_obj_del(label_keyboard_confirm);
        lv_obj_del(btn_keyboard_confirm);
        lv_obj_del(label_keyboard_return);
        lv_obj_del(btn_keyboard_return);

        lv_obj_del(table_addition_picture_1);

        static lv_style_t table_cell_style1;
        lv_style_init(&table_cell_style1);
        lv_style_set_pad_all(&table_cell_style1, 2); // 设置所有方向的填充为5像素

        table_addition_picture_1 = lv_table_create(win_content_typeface);
        LV_FONT_DECLARE(heiFont16_1);
        lv_obj_add_style(table_addition_picture_1, &table_cell_style1, LV_PART_ITEMS); // 应用样式到表格的单元格部分
        lv_obj_align(table_addition_picture_1, LV_ALIGN_TOP_LEFT, 0, 0);
        lv_obj_set_style_text_font(table_addition_picture_1, &heiFont16_1, LV_STATE_DEFAULT);

        lv_table_set_col_width(table_addition_picture_1, 0, 160);
        lv_table_set_col_width(table_addition_picture_1, 1, 45);
        //lv_table_set_col_width(table_addition_picture_1, 2, 55);
        lv_table_set_col_width(table_addition_picture_1, 2, 89);

        //重新绘制表格
        if (len == 0)
        {
            //显示所有内容
            dir = opendir("/mnt");
            if (dir == NULL) 
            {
                perror("opendir");
                exit(EXIT_FAILURE);
            }

            while ((entry = readdir(dir)) != NULL) 
            {
                snprintf(path, sizeof(path), "/mnt/%s", entry->d_name);
                if ((stat(path, &file_stat) == -1)||(file_stat.st_size > 500 *1024))
                {
                    perror("stat");
                    continue;
                }

                if ((S_ISREG(file_stat.st_mode))&&(picture_count < USB_PICTURE_NUMBER))
                {  
                    // 只处理普通文件
                    if (is_image_file(entry->d_name)) 
                    {
                        print_file_info(entry->d_name, &file_stat);
                        get_image_name(entry->d_name, image_name, sizeof(image_name));
                        lv_table_set_cell_value(table_addition_picture_1, picture_count, 0, image_name);
                        picture_type = get_image_file_type(entry->d_name);
                        printf("picture_type=%d\n\r",picture_type);
                        switch(picture_type)
                        {
                            case 0:
                                lv_table_set_cell_value(table_addition_picture_1, picture_count, 1, "jpg");
                                break;
                            case 1:
                                lv_table_set_cell_value(table_addition_picture_1, picture_count, 1, "jpeg");
                                break;
                            case 2:
                                lv_table_set_cell_value(table_addition_picture_1, picture_count, 1, "png");
                                break;
                            case 3:
                                lv_table_set_cell_value(table_addition_picture_1, picture_count, 1, "gif");
                                break;
                            case 4:
                                lv_table_set_cell_value(table_addition_picture_1, picture_count, 1, "bmp");
                                break;
                        }
                        //size_to_human_readable(file_stat.st_size, size_str, sizeof(size_str));
                        //lv_table_set_cell_value(table_addition_picture_1, picture_count, 2, size_str);
                        format_time(ctime(&file_stat.st_ctime), created_time);
                        lv_table_set_cell_value(table_addition_picture, picture_count, 2, created_time);
                        memcpy(usb_picture,entry->d_name,strlen(entry->d_name) + 1);
                        picture_count++;
                    }
                }
            }

            closedir(dir);

            lv_obj_add_event_cb(table_addition_picture_1, picture_draw_event_cb, LV_EVENT_DRAW_PART_BEGIN, NULL);
            lv_obj_add_event_cb(table_addition_picture_1, picture_change_event_cb, LV_EVENT_PRESSED, NULL);

            printf("%s\n\r", lv_table_get_cell_value(table_addition_picture_1,0,0));
            sprintf(file_name,"A:/mnt/%s.%s", lv_table_get_cell_value(table_addition_picture_1, g_row, 0), lv_table_get_cell_value(table_addition_picture_1, g_row, 1));

            //显示图片
            picture_img = lv_img_create(obj_addition_picture_preview_bg);
            lv_img_set_src(picture_img, file_name);
        }
        else
        {
            //显示含有输入字符的内容
            strcpy(file_name_short,lv_label_get_text(label_btn_addition_picture_search));

            dir = opendir("/mnt");
            if (dir == NULL) 
            {
                perror("opendir");
                exit(EXIT_FAILURE);
            }

            while ((entry = readdir(dir)) != NULL) 
            {
                snprintf(path, sizeof(path), "/mnt/%s", entry->d_name);
                if ((stat(path, &file_stat) == -1)||(file_stat.st_size > 500 *1024))
                {
                    perror("stat");
                    continue;
                }

                if ((S_ISREG(file_stat.st_mode))&&(picture_count < USB_PICTURE_NUMBER)&&(isSubstring(entry->d_name,file_name_short)))
                {  
                    // 只处理普通文件
                    if (is_image_file(entry->d_name)) 
                    {
                        print_file_info(entry->d_name, &file_stat);
                        get_image_name(entry->d_name, image_name, sizeof(image_name));
                        lv_table_set_cell_value(table_addition_picture_1, picture_count, 0, image_name);
                        picture_type = get_image_file_type(entry->d_name);
                        printf("picture_type=%d\n\r",picture_type);
                        switch(picture_type)
                        {
                            case 0:
                                lv_table_set_cell_value(table_addition_picture_1, picture_count, 1, "jpg");
                                break;
                            case 1:
                                lv_table_set_cell_value(table_addition_picture_1, picture_count, 1, "jpeg");
                                break;
                            case 2:
                                lv_table_set_cell_value(table_addition_picture_1, picture_count, 1, "png");
                                break;
                            case 3:
                                lv_table_set_cell_value(table_addition_picture_1, picture_count, 1, "gif");
                                break;
                            case 4:
                                lv_table_set_cell_value(table_addition_picture_1, picture_count, 1, "bmp");
                                break;
                        }
                        //size_to_human_readable(file_stat.st_size, size_str, sizeof(size_str));
                        //lv_table_set_cell_value(table_addition_picture_1, picture_count, 2, size_str);
                        format_time(ctime(&file_stat.st_ctime), created_time);
                        lv_table_set_cell_value(table_addition_picture_1, picture_count, 2, created_time);
                        memcpy(usb_picture,entry->d_name,strlen(entry->d_name) + 1);
                        picture_count++;
                    }
                }
            }

            closedir(dir);

            lv_obj_add_event_cb(table_addition_picture_1, picture_draw_event_cb, LV_EVENT_DRAW_PART_BEGIN, NULL);
            lv_obj_add_event_cb(table_addition_picture_1, picture_change_event_cb, LV_EVENT_PRESSED, NULL);

            printf("%s\n\r", lv_table_get_cell_value(table_addition_picture_1,0,0));
            sprintf(file_name,"A:/mnt/%s.%s", lv_table_get_cell_value(table_addition_picture_1, g_row, 0), lv_table_get_cell_value(table_addition_picture_1, g_row, 1));

            //显示图片
            picture_img = lv_img_create(obj_addition_picture_preview_bg);
            lv_img_set_src(picture_img, file_name);
        }
    }
}


static void button_picture_search_keyboard_return_event_cb(lv_event_t* e)
{
    lv_event_code_t code;
    code = lv_event_get_code(e);

    if (code == LV_EVENT_CLICKED)
    {
        printf("button_picture_search_keyboard_return_event_cb\n");
        lv_obj_del(textarea_bg_keyboard);
        lv_obj_del(pinyin_ime);
        lv_obj_del(textarea_text_keyboard);
        lv_obj_del(keyboard_bg);
        lv_obj_del(label_keyboard_confirm);
        lv_obj_del(btn_keyboard_confirm);
        lv_obj_del(label_keyboard_return);
        lv_obj_del(btn_keyboard_return);
        lv_obj_del(table_addition_picture_1);
    }
}


static void btn_addition_picture_search_event_cb(lv_event_t* e)
{
     lv_event_code_t code;
    int len;
    code = lv_event_get_code(e);

    if (code == LV_EVENT_CLICKED)
    {
        printf("btn_addition_picture_search_event_cb\n\r");
        buzzer_enable = 1;
        textarea_bg_keyboard = lv_obj_create(lv_scr_act());
        /* 设置大小 */
        lv_obj_set_size(textarea_bg_keyboard, 480, 272);
        lv_obj_align(textarea_bg_keyboard, LV_ALIGN_TOP_LEFT, 0, 0);
        lv_obj_set_style_border_width(textarea_bg_keyboard, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_border_color(textarea_bg_keyboard, lv_color_hex(0x9bcd9b), LV_STATE_DEFAULT); /* 设置边框颜色 */
        //lv_obj_set_style_border_opa(file_management_win, 100, LV_STATE_DEFAULT); /* 设置边框透明度 */
        lv_obj_set_style_radius(textarea_bg_keyboard, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_color(textarea_bg_keyboard, lv_color_hex(0x1fadd3), LV_STATE_DEFAULT);

        //输入框+键盘
        LV_FONT_DECLARE(heiFont16_1);
        pinyin_ime = lv_ime_pinyin_create(lv_scr_act());
        lv_obj_set_style_text_font(pinyin_ime, &heiFont16_1, 0);
        //lv_obj_set_style_text_font(pinyin_ime, &lv_font_simsun_16_cjk, 0);
        //lv_ime_pinyin_set_dict(pinyin_ime, your_dict); // Use a custom dictionary. If it is not set, the built-in dictionary will be used.

        textarea_text_keyboard = lv_textarea_create(lv_scr_act());
        //lv_textarea_set_one_line(textarea_text_keyboard, true);
        lv_obj_set_size(textarea_text_keyboard, 480, 95);
        lv_obj_set_style_text_font(textarea_text_keyboard, &heiFont16_1, 0);
        lv_obj_align(textarea_text_keyboard, LV_ALIGN_TOP_LEFT, 0, 0);
        lv_textarea_set_max_length(textarea_text_keyboard, 100);
        //lv_textarea_set_placeholder_text(textarea_text_keyboard, "Smart printer");
        //lv_obj_add_event_cb(textarea_text_keyboard, textarea_text_event_cb, LV_EVENT_ALL, NULL);
        lv_obj_set_style_border_width(textarea_text_keyboard, 1, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_border_color(textarea_text_keyboard, lv_color_hex(0xAAAAAA), LV_STATE_DEFAULT); /* 设置边框颜色 */
        lv_obj_set_style_border_opa(textarea_text_keyboard, 100, LV_STATE_DEFAULT); /* 设置边框透明度 */
        lv_obj_set_style_radius(textarea_text_keyboard, 0, LV_STATE_DEFAULT); /* 设置圆角 */

        len = strlen(lv_label_get_text(label_btn_addition_picture_search));

        printf("len=%u\n\r", len);

        if (strlen(lv_label_get_text(label_btn_addition_picture_search)) != 0)
        {
            lv_textarea_set_text(textarea_text_keyboard, lv_label_get_text(label_btn_addition_picture_search));
        }

        /*Create a keyboard and add it to ime_pinyin*/
        text_edit_keyboard = lv_keyboard_create(lv_scr_act());
        lv_ime_pinyin_set_keyboard(pinyin_ime, text_edit_keyboard);
        lv_keyboard_set_textarea(text_edit_keyboard, textarea_text_keyboard);
        //lv_obj_set_style_bg_color(text_edit_keyboard, lv_color_hex(0xff4040), LV_PART_MAIN);
        lv_obj_set_style_bg_color(text_edit_keyboard, lv_color_hex(0x1fadd3), LV_PART_MAIN);
        lv_obj_add_event_cb(textarea_text_keyboard, textarea_text_event_cb, LV_EVENT_ALL, text_edit_keyboard);
        lv_obj_align(text_edit_keyboard, LV_ALIGN_TOP_LEFT, 0, 115);
        lv_obj_set_size(text_edit_keyboard, 480, 133);

        /*Get the cand_panel, and adjust its size and position*/
        keyboard_cand_panel = lv_ime_pinyin_get_cand_panel(pinyin_ime);
        lv_obj_set_size(keyboard_cand_panel, LV_PCT(100), LV_PCT(10));
        lv_obj_align_to(keyboard_cand_panel, text_edit_keyboard, LV_ALIGN_OUT_TOP_MID, 0, 5);
        lv_obj_set_style_bg_color(keyboard_cand_panel, lv_color_hex(0x8B1A1A), LV_PART_MAIN);
        lv_obj_set_style_text_font(keyboard_cand_panel, &heiFont16_1, 0);

        keyboard_bg = lv_obj_create(lv_scr_act());
        lv_obj_set_size(keyboard_bg, 480, 24);
        lv_obj_align(keyboard_bg, LV_ALIGN_TOP_LEFT, 0, 248);
        lv_obj_set_style_border_width(keyboard_bg, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_radius(keyboard_bg, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_color(keyboard_bg, lv_color_hex(0x28536a), LV_STATE_DEFAULT);
        lv_obj_remove_style(keyboard_bg, 0, LV_PART_SCROLLBAR);


        LV_FONT_DECLARE(heiFont16_1);
        label_keyboard_return = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_keyboard_return, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_keyboard_return, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_keyboard_return,  "返回");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_keyboard_return, "Return");
        }
        lv_obj_align(label_keyboard_return, LV_ALIGN_TOP_LEFT, 140, 252);

        LV_IMG_DECLARE(get_back);
        btn_keyboard_return = lv_imgbtn_create(lv_scr_act());
        lv_imgbtn_set_src(btn_keyboard_return, LV_IMGBTN_STATE_RELEASED, NULL, &get_back, NULL);
        lv_obj_set_size(btn_keyboard_return, get_back.header.w, get_back.header.h);
        lv_obj_align(btn_keyboard_return, LV_ALIGN_TOP_LEFT, 180, 250);
        lv_obj_add_event_cb(btn_keyboard_return, button_picture_search_keyboard_return_event_cb, LV_EVENT_CLICKED, NULL);

        LV_IMG_DECLARE(confirm);
        btn_keyboard_confirm = lv_imgbtn_create(lv_scr_act());
        lv_imgbtn_set_src(btn_keyboard_confirm, LV_IMGBTN_STATE_RELEASED, NULL, &confirm, NULL);
        lv_obj_set_size(btn_keyboard_confirm, get_back.header.w, get_back.header.h);
        lv_obj_align(btn_keyboard_confirm, LV_ALIGN_TOP_LEFT, 250, 250);
        lv_obj_add_event_cb(btn_keyboard_confirm, button_picture_search_keyboard_confirm_event_cb, LV_EVENT_CLICKED, NULL);

        LV_FONT_DECLARE(heiFont16_1);
        label_keyboard_confirm = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_keyboard_confirm, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_keyboard_confirm, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_keyboard_return, "确定");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_keyboard_return, "Confirm");
        }
        lv_obj_align(label_keyboard_confirm, LV_ALIGN_TOP_LEFT, 277, 252);
    }
}



static void imgbtn_addition_picture_return_event_cb(lv_event_t* e)
{
    lv_event_code_t code;
    code = lv_event_get_code(e);
    if (code == LV_EVENT_CLICKED)
    {
        printf("imgbtn_addition_picture_return_event_cb\n");

        buzzer_enable = 1;

        lv_obj_del(obj_addition_picture_head_bg);
        lv_obj_del(label_addition_picture_head);
        lv_obj_del(obj_addition_picture_preview_bg);
        lv_obj_del(obj_addition_picture_btn_bg);
        lv_obj_del(table_addition_picture);
        lv_obj_del(table_addition_picture_1);
        lv_obj_del(win_content_typeface);
        lv_obj_del(obj_addition_table_bg);
        lv_obj_del(typeface_slider_bg);
        lv_obj_del(left_stop_img_typeface);
        lv_obj_del(right_stop_img_typeface);
        lv_obj_del(btn_addition_picture_delete);
        lv_obj_del(btn_addition_picture_open);
        lv_obj_del(img_addition_picture_search);
        lv_obj_del(label_addition_picture_search);
        lv_obj_del(label_btn_addition_picture_search);
        lv_obj_del(btn_addition_picture_search);
        lv_obj_del(obj_addition_picture_bottom_bg);
        lv_obj_del(label_addition_picture_return);
        lv_obj_del(imgbtn_addition_picture_return);
        lv_obj_del(imgbtn_addition_picture_confirm);
        lv_obj_del(label_addition_picture_confirm);

        lv_obj_del(slider_typeface);


        //删除添加界面
        lv_obj_del(img_addition_bg);
        lv_obj_del(btn_addition_text);
        lv_obj_del(label_btn_addition_text);
        lv_obj_del(btn_addition_date);
        lv_obj_del(label_btn_addition_date);
        lv_obj_del(btn_addition_picture);
        lv_obj_del(label_btn_addition_picture);
        lv_obj_del(btn_addition_QR_code);
        lv_obj_del(label_btn_addition_QR_code);
        lv_obj_del(btn_addition_bar_code);
        lv_obj_del(label_btn_addition_bar_code);
        lv_obj_del(btn_addition_count);
        lv_obj_del(label_btn_addition_count);
        lv_obj_del(btn_addition_subsection);
        lv_obj_del(label_btn_addition_subsection);
        lv_obj_del(btn_addition_symbol);
        lv_obj_del(label_btn_addition_symbol);
        lv_obj_del(btn_addition_icon);
        lv_obj_del(label_btn_addition_icon);
        lv_obj_del(btn_addition_more_functions);
        lv_obj_del(label_btn_addition_more_functions);
        lv_obj_del(btn_addition_return);
    }
}


static void imgbtn_addition_picture_confirm_event_cb(lv_event_t* e)
{
    lv_event_code_t code;
    code = lv_event_get_code(e);
    int win_content_child_num = 0;
    char tempString[100] = { 0 };
    char picture_name[128] = { 0 };
    char picture_name_1[100] = { 0 };

    if (code == LV_EVENT_CLICKED)
    {
        printf("imgbtn_addition_picture_confirm_event_cb\n");

        buzzer_enable = 1;

        win_content_child_num = lv_obj_get_child_cnt(win_content);

        printf("win_content_child_num=%u\n\r", win_content_child_num);

        if(win_content_child_num < NEW_TEXT_MAX_NUMBER)
        {
            lv_obj_t* temp_obj = lv_obj_create(win_content);

            lv_obj_set_style_bg_opa(temp_obj, LV_OPA_TRANSP, 0);
            lv_obj_set_style_border_width(temp_obj, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */

            lv_obj_add_event_cb(temp_obj, drag_event_handler, LV_EVENT_PRESSING, NULL);
            lv_obj_add_event_cb(temp_obj, drag_event_handler, LV_EVENT_FOCUSED, NULL);
            lv_obj_add_event_cb(temp_obj, drag_event_handler, LV_EVENT_DEFOCUSED, NULL);
            lv_obj_clear_flag(temp_obj, LV_OBJ_FLAG_SCROLLABLE);

            // 假设你有一个图片对象
            lv_obj_t* img_obj = lv_img_create(temp_obj);
            sprintf(picture_name, "/mnt/%s.%s", lv_table_get_cell_value(table_addition_picture_1, g_row, 0), lv_table_get_cell_value(table_addition_picture_1, g_row, 1));
            
            memcpy(tempString,picture_name,sizeof(tempString));

            if(strcmp(lv_table_get_cell_value(table_addition_picture_1, g_row, 1),"png") != 0)
            {
                int width, height, channels;
                unsigned char *data = stbi_load(picture_name, &width, &height, &channels, 0);
                if (!data) 
                {
                    printf("错误：无法加载图片 %s\n", picture_name);
                }

                printf("图片加载成功：%dx%d，%d 通道\n", width, height, channels);

                sprintf(picture_name_1, "/media/qr_bar_bmp/%s.png", lv_table_get_cell_value(table_addition_picture_1, g_row, 0));

                printf("picture_name_1=%s\n\r",picture_name_1);
            
                // 步骤 2：将数据保存为 PNG
                int success = stbi_write_png(picture_name_1, width, height, channels, data, width * channels);
                if (!success) 
                {
                    printf("错误：保存 PNG 失败\n");
                } 
                else 
                {
                    printf("PNG 保存成功：%s\n", picture_name_1);
                }

                sprintf(picture_name, "A:%s", picture_name_1);

                stbi_image_free(data);
            }
            else
            {
                sprintf(picture_name, "A:%s", picture_name_1);
            }
            
            lv_img_set_src(img_obj, picture_name);
            lv_obj_center(img_obj);
            lv_img_header_t header;
            lv_res_t res = lv_img_decoder_get_info(picture_name, &header);  // 直接传入文件路径

            if (res == LV_RES_OK)
            {
                printf("PNG: %dx%d\n", header.w, header.h);
            }
            else
            {
                printf("lv_img_decoder_get_info error\n");
            }

            lv_obj_set_size(temp_obj, header.w, header.h);
            //lv_obj_align(temp_obj, LV_ALIGN_TOP_LEFT, 30, 0);

            lv_obj_align(temp_obj, LV_ALIGN_TOP_LEFT, 30 + 20*win_content_child_num, 6*win_content_child_num);

            sprintf(data_structure[win_content_child_num].data.picture.text_1,"%s", tempString);
            sprintf(data_structure[win_content_child_num].data.picture.text_2,"%s", picture_name_1);
            data_structure[win_content_child_num].type = TYPE_PITCTURE;

            data_structure[win_content_child_num].data.picture.size = 256;
        }

        lv_obj_del(obj_addition_picture_head_bg);
        lv_obj_del(label_addition_picture_head);
        lv_obj_del(obj_addition_picture_preview_bg);
        lv_obj_del(obj_addition_picture_btn_bg);
        lv_obj_del(table_addition_picture);
        lv_obj_del(table_addition_picture_1);
        lv_obj_del(win_content_typeface);
        lv_obj_del(obj_addition_table_bg);
        lv_obj_del(typeface_slider_bg);
        lv_obj_del(left_stop_img_typeface);
        lv_obj_del(right_stop_img_typeface);
        lv_obj_del(btn_addition_picture_delete);
        lv_obj_del(btn_addition_picture_open);
        lv_obj_del(img_addition_picture_search);
        lv_obj_del(label_addition_picture_search);
        lv_obj_del(label_btn_addition_picture_search);
        lv_obj_del(btn_addition_picture_search);
        lv_obj_del(obj_addition_picture_bottom_bg);
        lv_obj_del(label_addition_picture_return);
        lv_obj_del(imgbtn_addition_picture_return);
        lv_obj_del(imgbtn_addition_picture_confirm);
        lv_obj_del(label_addition_picture_confirm);

        lv_obj_del(slider_typeface);


        //删除添加界面
        lv_obj_del(img_addition_bg);
        lv_obj_del(btn_addition_text);
        lv_obj_del(label_btn_addition_text);
        lv_obj_del(btn_addition_date);
        lv_obj_del(label_btn_addition_date);
        lv_obj_del(btn_addition_picture);
        lv_obj_del(label_btn_addition_picture);
        lv_obj_del(btn_addition_QR_code);
        lv_obj_del(label_btn_addition_QR_code);
        lv_obj_del(btn_addition_bar_code);
        lv_obj_del(label_btn_addition_bar_code);
        lv_obj_del(btn_addition_count);
        lv_obj_del(label_btn_addition_count);
        lv_obj_del(btn_addition_subsection);
        lv_obj_del(label_btn_addition_subsection);
        lv_obj_del(btn_addition_symbol);
        lv_obj_del(label_btn_addition_symbol);
        lv_obj_del(btn_addition_icon);
        lv_obj_del(label_btn_addition_icon);
        lv_obj_del(btn_addition_more_functions);
        lv_obj_del(label_btn_addition_more_functions);
        lv_obj_del(btn_addition_return);
    }
}


static void picture_slider_event_cb(lv_event_t* e)
{
    lv_obj_t* target = lv_event_get_target(e); /* 获取触发源 */
    lv_event_code_t code = lv_event_get_code(e); /* 获取事件类型 */
    int32_t temp;
    static int32_t temp_last = 0;
    int x_data = 0;
    if ((code == LV_EVENT_VALUE_CHANGED) && (print_status == 0))
    {
        temp = lv_slider_get_value(target);
        printf("temp=%d\n", temp);

        x_data = (100 - temp)*6;

        if (temp_last != temp)
        {
            lv_obj_set_pos(win_content_typeface, -15,  -15 - x_data);//Limit drag boundaries 
        }
        temp_last = temp;
    }
}



static void slider_show_picture()
{
    static const lv_style_prop_t props[] = { LV_STYLE_BG_COLOR,0 };  //设置位置参数
    static lv_style_transition_dsc_t transition_dsc;               //设置转换变量
    lv_style_transition_dsc_init(&transition_dsc, props, lv_anim_path_linear, 200, 0, NULL); //初始化转换

    static lv_style_t style_main;                                  //创建样式
    static lv_style_t style_indicator;                             //创建样式
    static lv_style_t style_knob;                                  //创建样式
    static lv_style_t style_pressed_color;                         //创建样式
    lv_style_init(&style_main);                                    //初始化样式
    lv_style_set_bg_opa(&style_main, LV_OPA_TRANSP);                 //设置背景透明度
    lv_style_set_bg_color(&style_main, lv_color_hex3(0xffffff));        //设置背景颜色
    lv_style_set_size_A(&style_main, 20, 142);
    lv_style_set_pad_ver(&style_main, 0);                          //设置上下边距
    lv_style_init(&style_indicator);                               //初始化样式
    lv_style_set_bg_opa(&style_indicator, LV_OPA_TRANSP);            //设置背景透明度
    lv_style_set_bg_color(&style_indicator, lv_color_hex3(0xffffff));//设置背景颜色
    lv_style_set_transition(&style_indicator, &transition_dsc);     //设置转化

    LV_IMG_DECLARE(img_slider_typeface);

    lv_style_init(&style_knob);                                    //初始化样式
    lv_style_set_bg_opa(&style_knob, LV_OPA_TRANSP);                 //设置背景透明度
    lv_style_set_bg_img_src(&style_knob, &img_slider_typeface);
    lv_style_set_border_color(&style_knob, lv_palette_darken(LV_PALETTE_GREY, 3));//设置边框背景颜色
    lv_style_set_border_width(&style_knob, 0);                      //设置边框宽度
    lv_style_set_pad_all(&style_knob, 20);                           //设置边距
    lv_style_set_size_A(&style_knob, 20, 10);
    lv_style_set_transition(&style_knob, &transition_dsc);          //设置转化

    lv_style_init(&style_pressed_color);                           //初始化样式
    lv_style_set_bg_color(&style_pressed_color, lv_color_hex3(0xAAAAAA));//设置背景颜色

    slider_typeface = lv_slider_create(lv_scr_act());            //创建滑块
    lv_obj_remove_style_all(slider_typeface);                               //移除所有样式

    lv_obj_add_style(slider_typeface, &style_main, LV_PART_MAIN);             //添加样式
    lv_obj_add_style(slider_typeface, &style_indicator, LV_PART_INDICATOR);   //添加样式 指示器
    lv_obj_add_style(slider_typeface, &style_pressed_color, LV_PART_INDICATOR | LV_STATE_PRESSED); //添加样式 指示器 按压状态
    lv_obj_add_style(slider_typeface, &style_knob, LV_PART_KNOB);             //添加样式 圆头
    lv_obj_add_style(slider_typeface, &style_pressed_color, LV_PART_KNOB | LV_STATE_PRESSED);      //添加样式 圆头 按压状态
    lv_obj_align(slider_typeface, LV_ALIGN_TOP_LEFT, 460, 65);
    //lv_obj_center(slider);                                         //居中显示
    lv_obj_add_event_cb(slider_typeface, picture_slider_event_cb, LV_EVENT_VALUE_CHANGED, NULL);
    lv_slider_set_value(slider_typeface, 100, LV_ANIM_ON);
}



static void button_addition_picture_event_cb(lv_event_t* e)
{
    lv_event_code_t code;
    char file_name[100]={0};

    code = lv_event_get_code(e);

    if ((code == LV_EVENT_CLICKED) && (print_status == 0))
    {
        printf("button_addition_picture_event_cb\n");
        buzzer_enable = 1;
        obj_addition_picture_head_bg = lv_obj_create(lv_scr_act());
        lv_obj_set_size(obj_addition_picture_head_bg, 480, 24);
        lv_obj_align(obj_addition_picture_head_bg, LV_ALIGN_TOP_LEFT, 0, 0);
        lv_obj_set_style_border_width(obj_addition_picture_head_bg, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_radius(obj_addition_picture_head_bg, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_color(obj_addition_picture_head_bg, lv_color_hex(0x28536a), LV_STATE_DEFAULT);
        lv_obj_remove_style(obj_addition_picture_head_bg, 0, LV_PART_SCROLLBAR);


        LV_FONT_DECLARE(heiFont16_1);
        label_addition_picture_head = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_addition_picture_head, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_addition_picture_head, lv_color_hex(0xFFFFFF), LV_STATE_DEFAULT);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_addition_picture_head,  "图片");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_addition_picture_head, "Picture");
        }
        lv_obj_align(label_addition_picture_head, LV_ALIGN_TOP_LEFT, 200, 4);


        obj_addition_picture_preview_bg = lv_obj_create(lv_scr_act());
        lv_obj_set_size(obj_addition_picture_preview_bg, 160, 150);
        lv_obj_align(obj_addition_picture_preview_bg, LV_ALIGN_TOP_LEFT, 0, 24);
        lv_obj_set_style_border_width(obj_addition_picture_preview_bg, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_radius(obj_addition_picture_preview_bg, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_color(obj_addition_picture_preview_bg, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        lv_obj_remove_style(obj_addition_picture_preview_bg, 0, LV_PART_SCROLLBAR);


        obj_addition_picture_btn_bg = lv_obj_create(lv_scr_act());
        lv_obj_set_size(obj_addition_picture_btn_bg, 160, 97);
        lv_obj_align(obj_addition_picture_btn_bg, LV_ALIGN_TOP_LEFT, 0, 174);
        lv_obj_set_style_border_width(obj_addition_picture_btn_bg, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_radius(obj_addition_picture_btn_bg, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_color(obj_addition_picture_btn_bg, lv_color_hex(0x1fadd3), LV_STATE_DEFAULT);
        lv_obj_remove_style(obj_addition_picture_btn_bg, 0, LV_PART_SCROLLBAR);


        static lv_style_t table_cell_style;
        lv_style_init(&table_cell_style);
        lv_style_set_pad_all(&table_cell_style, 2); // 设置所有方向的填充为5像素


        table_addition_picture = lv_table_create(lv_scr_act());
        LV_FONT_DECLARE(heiFont16_1);
        lv_obj_add_style(table_addition_picture, &table_cell_style, LV_PART_ITEMS); // 应用样式到表格的单元格部分
        lv_obj_align(table_addition_picture, LV_ALIGN_TOP_LEFT, 160, 24);
        lv_obj_set_style_text_font(table_addition_picture, &heiFont16_1, LV_STATE_DEFAULT);

        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_table_set_cell_value(table_addition_picture, 0, 0, "名称");
            lv_table_set_cell_value(table_addition_picture, 0, 1, "类型");
            //lv_table_set_cell_value(table_addition_picture, 0, 2, "大小");
            lv_table_set_cell_value(table_addition_picture, 0, 2, "时间");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_table_set_cell_value(table_addition_picture, 0, 0, "Name");
            lv_table_set_cell_value(table_addition_picture, 0, 1, "Type");
            //lv_table_set_cell_value(table_addition_picture, 0, 2, "Size");
            lv_table_set_cell_value(table_addition_picture, 0, 2, "Time");
        }

        lv_table_set_col_width(table_addition_picture, 0, 166);
        lv_table_set_col_width(table_addition_picture, 1, 50);
        //lv_table_set_col_width(table_addition_picture, 2, 51);
        lv_table_set_col_width(table_addition_picture, 2, 81);


        obj_addition_table_bg = lv_obj_create(lv_scr_act());
        lv_obj_set_size(obj_addition_table_bg, 300, 202);
        lv_obj_align(obj_addition_table_bg, LV_ALIGN_TOP_LEFT, 160, 47);
        lv_obj_set_style_border_width(obj_addition_table_bg, 1, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_radius(obj_addition_table_bg, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_color(obj_addition_table_bg, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        lv_obj_remove_style(obj_addition_table_bg, 0, LV_PART_SCROLLBAR);

        win_content_typeface = lv_obj_create(obj_addition_table_bg);
        lv_obj_set_size(win_content_typeface, 300, 500);
        lv_obj_align(win_content_typeface, LV_ALIGN_TOP_LEFT, -16, -16);
        lv_obj_set_style_bg_color(win_content_typeface, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        lv_obj_set_style_border_width(win_content_typeface, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_border_color(win_content_typeface, lv_color_hex(0xcccccc), LV_STATE_DEFAULT); /* 设置边框颜色 */
        lv_obj_clear_flag(win_content_typeface, LV_OBJ_FLAG_SCROLLABLE);
        lv_obj_set_style_radius(win_content_typeface, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_pad_all(win_content_typeface, 0, LV_STATE_DEFAULT);


        table_addition_picture_1 = lv_table_create(win_content_typeface);
        LV_FONT_DECLARE(heiFont16_1);
        lv_obj_add_style(table_addition_picture_1, &table_cell_style, LV_PART_ITEMS); // 应用样式到表格的单元格部分
        lv_obj_align(table_addition_picture_1, LV_ALIGN_TOP_LEFT, 0, 0);
        lv_obj_set_style_text_font(table_addition_picture_1, &heiFont16_1, LV_STATE_DEFAULT);

        lv_table_set_col_width(table_addition_picture_1, 0, 160);
        lv_table_set_col_width(table_addition_picture_1, 1, 45);
        //lv_table_set_col_width(table_addition_picture_1, 2, 45);
        lv_table_set_col_width(table_addition_picture_1, 2, 89);


#if 0
        //PICTURE_DATA
        lv_fs_dir_t mysd_3;
        if (lv_fs_dir_open(&mysd_3, "/mnt") == LV_FS_RES_OK)
        {
            printf("lv_fs_dir_open ok\n");
         
            while (lv_fs_dir_read(&mysd_3, file_name) == LV_FS_RES_OK)
            {
                printf("%s\n", file_name);
            }
            lv_fs_dir_close(&mysd_3);
        }
        else
        {
            printf("lv_fs_dir_open error\n");
        }
#endif


        //list_directory_contents(D:/test_sd);
        DIR *dir;
        struct dirent *entry;
        struct stat file_stat;
        char path[300];
        unsigned char picture_count = 0;
        int picture_type = 0;
        char created_time[20] ={0};
        //char size_str[20]; // 存储转换后的字符串
        char image_name[50]; // 存储提取的图片名称



        dir = opendir("/mnt");
        if (dir == NULL) 
        {
            perror("opendir");
            exit(EXIT_FAILURE);
        }

        while ((entry = readdir(dir)) != NULL) 
        {
            snprintf(path, sizeof(path), "/mnt/%s", entry->d_name);
            if ((stat(path, &file_stat) == -1)||(file_stat.st_size > 500 *1024))
            {
                perror("stat");
                continue;
            }

            if ((S_ISREG(file_stat.st_mode))&&(picture_count < USB_PICTURE_NUMBER))
            {  
                // 只处理普通文件
                if (is_image_file(entry->d_name)) 
                {
                    print_file_info(entry->d_name, &file_stat);
                    get_image_name(entry->d_name, image_name, sizeof(image_name));
                    lv_table_set_cell_value(table_addition_picture_1, picture_count, 0, image_name);
                    picture_type = get_image_file_type(entry->d_name);
                    printf("picture_type=%d\n\r",picture_type);
                    switch(picture_type)
                    {
                        case 0:
                            lv_table_set_cell_value(table_addition_picture_1, picture_count, 1, "jpg");
                            break;
                        case 1:
                            lv_table_set_cell_value(table_addition_picture_1, picture_count, 1, "jpeg");
                            break;
                        case 2:
                            lv_table_set_cell_value(table_addition_picture_1, picture_count, 1, "png");
                            break;
                        case 3:
                            lv_table_set_cell_value(table_addition_picture_1, picture_count, 1, "gif");
                            break;
                        case 4:
                            lv_table_set_cell_value(table_addition_picture_1, picture_count, 1, "bmp");
                            break;
                    }
                    //size_to_human_readable(file_stat.st_size, size_str, sizeof(size_str));
                    //printf("size_str=%s\n\r",size_str);
                    //lv_table_set_cell_value(table_addition_picture_1, picture_count, 2, size_str);
                    format_time(ctime(&file_stat.st_ctime), created_time);
                    printf("created_time=%s\n\r",created_time);
                    lv_table_set_cell_value(table_addition_picture_1, picture_count, 2, created_time);
                    //memcpy(usb_picture,entry->d_name,strlen(entry->d_name) + 1);
                    picture_count++;
                }
            }
        }

        closedir(dir);

        printf("%s\n\r", lv_table_get_cell_value(table_addition_picture_1,0,0));
        sprintf(file_name,"A:/mnt/%s.%s", lv_table_get_cell_value(table_addition_picture_1, g_row, 0), lv_table_get_cell_value(table_addition_picture_1, g_row, 1));

        //显示图片
        picture_img = lv_img_create(obj_addition_picture_preview_bg);
        lv_img_set_src(picture_img, file_name);

        lv_obj_add_event_cb(table_addition_picture_1, picture_draw_event_cb, LV_EVENT_DRAW_PART_BEGIN, NULL);
        lv_obj_add_event_cb(table_addition_picture_1, picture_change_event_cb, LV_EVENT_PRESSED, NULL);


        typeface_slider_bg = lv_obj_create(lv_scr_act());
        lv_obj_set_size(typeface_slider_bg, 20, 224);
        lv_obj_align(typeface_slider_bg, LV_ALIGN_TOP_LEFT, 460, 24);
        lv_obj_set_style_border_width(typeface_slider_bg, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_border_color(typeface_slider_bg, lv_color_hex(0xaaaaaa), LV_STATE_DEFAULT); /* 设置边框颜色 */
        lv_obj_set_style_radius(typeface_slider_bg, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_color(typeface_slider_bg, lv_color_hex(0xaaaaaa), LV_STATE_DEFAULT);

        //左滑块停止
        LV_IMG_DECLARE(left_stop_typeface);
        left_stop_img_typeface = lv_img_create(lv_scr_act());
        lv_img_set_src(left_stop_img_typeface, &left_stop_typeface);
        lv_obj_align(left_stop_img_typeface, LV_ALIGN_TOP_LEFT, 460, 228);

        slider_show_picture();

        //右滑块停止
        LV_IMG_DECLARE(right_stop_typeface);
        right_stop_img_typeface = lv_img_create(lv_scr_act());
        lv_img_set_src(right_stop_img_typeface, &right_stop_typeface);
        lv_obj_align(right_stop_img_typeface, LV_ALIGN_TOP_LEFT, 460, 24);

        LV_IMG_DECLARE(picture_delete);
        btn_addition_picture_delete = lv_imgbtn_create(lv_scr_act());
        lv_imgbtn_set_src(btn_addition_picture_delete, LV_IMGBTN_STATE_RELEASED, NULL, &picture_delete, NULL);
        lv_obj_set_size(btn_addition_picture_delete, picture_delete.header.w, picture_delete.header.h);
        lv_obj_align(btn_addition_picture_delete, LV_ALIGN_TOP_LEFT, 10, 180);
        lv_obj_add_event_cb(btn_addition_picture_delete, btn_addition_picture_delete_event_cb, LV_EVENT_CLICKED, NULL);

        LV_IMG_DECLARE(open_25_1);
        btn_addition_picture_open = lv_imgbtn_create(lv_scr_act());
        lv_imgbtn_set_src(btn_addition_picture_open, LV_IMGBTN_STATE_RELEASED, NULL, &open_25_1, NULL);
        lv_obj_set_size(btn_addition_picture_open, open_25_1.header.w, open_25_1.header.h);
        lv_obj_align(btn_addition_picture_open, LV_ALIGN_TOP_LEFT, 90, 180);
        lv_obj_add_event_cb(btn_addition_picture_open, imgbtn_addition_picture_confirm_event_cb, LV_EVENT_CLICKED, NULL);


        LV_IMG_DECLARE(search);
        img_addition_picture_search = lv_img_create(lv_scr_act());
        lv_img_set_src(img_addition_picture_search, &search);
        lv_obj_align(img_addition_picture_search, LV_ALIGN_TOP_LEFT, 10, 218);

        LV_FONT_DECLARE(heiFont16_1);
        label_addition_picture_search = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_addition_picture_search, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_addition_picture_search, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_addition_picture_search,  "搜索");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_addition_picture_search, "Search");
        }
        lv_obj_align(label_addition_picture_search, LV_ALIGN_TOP_LEFT, 42, 222);


        LV_FONT_DECLARE(heiFont16_1);
        btn_addition_picture_search = lv_btn_create(lv_scr_act());
        lv_obj_set_size(btn_addition_picture_search, 70, 24);
        lv_obj_align(btn_addition_picture_search, LV_ALIGN_TOP_LEFT, 82, 218);
        lv_obj_set_style_border_width(btn_addition_picture_search, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_radius(btn_addition_picture_search, 10, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_color(btn_addition_picture_search, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        label_btn_addition_picture_search = lv_label_create(btn_addition_picture_search);
        lv_obj_set_style_text_font(label_btn_addition_picture_search, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_btn_addition_picture_search, lv_color_hex(0x1C1C1C), LV_STATE_DEFAULT);
        lv_label_set_text(label_btn_addition_picture_search, "");
        lv_obj_align(label_btn_addition_picture_search, LV_ALIGN_CENTER, 0, 0);
        lv_obj_set_style_border_width(label_btn_addition_picture_search, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_border_color(label_btn_addition_picture_search, lv_color_hex(0x8a8a8a), LV_STATE_DEFAULT); /* 设置边框颜色 */
        lv_obj_set_style_border_opa(label_btn_addition_picture_search, 100, LV_STATE_DEFAULT); /* 设置边框透明度 */
        lv_obj_set_style_radius(label_btn_addition_picture_search, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_opa(label_btn_addition_picture_search, LV_OPA_COVER, LV_PART_MAIN);
        lv_obj_set_style_bg_color(label_btn_addition_picture_search, lv_color_hex(0xffffff), LV_PART_MAIN);
        lv_obj_add_event_cb(btn_addition_picture_search, btn_addition_picture_search_event_cb, LV_EVENT_CLICKED, NULL);

        obj_addition_picture_bottom_bg = lv_obj_create(lv_scr_act());
        lv_obj_set_size(obj_addition_picture_bottom_bg, 480, 24);
        lv_obj_align(obj_addition_picture_bottom_bg, LV_ALIGN_TOP_LEFT, 0, 248);
        lv_obj_set_style_border_width(obj_addition_picture_bottom_bg, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_radius(obj_addition_picture_bottom_bg, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_color(obj_addition_picture_bottom_bg, lv_color_hex(0x28536a), LV_STATE_DEFAULT);
        lv_obj_remove_style(obj_addition_picture_bottom_bg, 0, LV_PART_SCROLLBAR);


        LV_FONT_DECLARE(heiFont16_1);
        label_addition_picture_return = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_addition_picture_return, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_addition_picture_return, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_addition_picture_return,  "返回");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_addition_picture_return, "Return");
        }
        lv_obj_align(label_addition_picture_return, LV_ALIGN_TOP_LEFT, 140, 252);


        LV_IMG_DECLARE(get_back);
        imgbtn_addition_picture_return = lv_imgbtn_create(lv_scr_act());
        lv_imgbtn_set_src(imgbtn_addition_picture_return, LV_IMGBTN_STATE_RELEASED, NULL, &get_back, NULL);
        lv_obj_set_size(imgbtn_addition_picture_return, get_back.header.w, get_back.header.h);
        lv_obj_align(imgbtn_addition_picture_return, LV_ALIGN_TOP_LEFT, 180, 250);
        lv_obj_add_event_cb(imgbtn_addition_picture_return, imgbtn_addition_picture_return_event_cb, LV_EVENT_CLICKED, NULL);

        LV_IMG_DECLARE(confirm);
        imgbtn_addition_picture_confirm = lv_imgbtn_create(lv_scr_act());
        lv_imgbtn_set_src(imgbtn_addition_picture_confirm, LV_IMGBTN_STATE_RELEASED, NULL, &confirm, NULL);
        lv_obj_set_size(imgbtn_addition_picture_confirm, get_back.header.w, get_back.header.h);
        lv_obj_align(imgbtn_addition_picture_confirm, LV_ALIGN_TOP_LEFT, 250, 250);
        lv_obj_add_event_cb(imgbtn_addition_picture_confirm, imgbtn_addition_picture_confirm_event_cb, LV_EVENT_CLICKED, NULL);

        LV_FONT_DECLARE(heiFont16_1);
        label_addition_picture_confirm = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_addition_picture_confirm, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_addition_picture_confirm, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_addition_picture_confirm,  "确定");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_addition_picture_confirm, "Confirm");
        }
        lv_obj_align(label_addition_picture_confirm, LV_ALIGN_TOP_LEFT, 277, 252);
    }
}

//预览更新函数
static void update_preview_QR_bar_code(void)
{
    int str_len = 0;
    //int width_len = 0;
    int height_len = 0;
    int width, height, channels;
    unsigned char* pdata = NULL;
    unsigned char* pnew_data = NULL;
     lv_obj_t* img = NULL;
     char bmp_name[64]={0};
    char bmp_name_1[100]={0};
    uint32_t child_count;
    unsigned char *data = NULL;
    int success;

    str_len = strlen(lv_label_get_text(label_btn_addition_QR_code_text));
    if (str_len == 0)
    {
        return;
    }

    printf("QR_or_bar_code_flag=%u\n\r",QR_or_bar_code_flag);
    printf("QR_code_type=%u\n\r",QR_code_type);
    printf("bar_code_type=%u\n\r",bar_code_type);
    printf("str_len=%u\n\r",str_len);

    if (QR_or_bar_code_flag == 0)
    {
        struct zint_symbol* my_symbol;
        my_symbol = ZBarcode_Create();
        switch (QR_code_type)
        {
            case 0:
            default:

                height_len = atoi(lv_label_get_text(label_btn_addition_QR_code_height));

                if (height_len > QR_BAR_MAX_HIGHT)
                {
                    height_len = QR_BAR_MAX_HIGHT;
                }
                else if (height_len < QR_BAR_MIN_HIGHT)
                {
                    height_len = QR_BAR_MIN_HIGHT;
                }

                printf("height_len=%u\n\r",height_len);

                my_symbol->symbology = BARCODE_QRCODE;
                my_symbol->scale = 1;
                my_symbol->option_1 = 2; //容错级别

                if(str_len < 20)
                {
                    my_symbol->option_2 = 1;
                }
                else if(str_len < 38)
                {
                    my_symbol->option_2 = 2;
                }
                else if(str_len < 61)
                {
                    my_symbol->option_2 = 3;
                }
                else if(str_len < 90)
                {
                    my_symbol->option_2 = 4;
                }
                else if(str_len < 122)
                {
                    my_symbol->option_2 = 5;
                }

#if 0
                if(lv_obj_has_state(sw_addition_QR_code_figure, LV_STATE_CHECKED) == 1)
                {
                    my_symbol->show_hrt = 1;
                    memcpy(my_symbol->text,lv_label_get_text(label_btn_addition_QR_code_text),strlen(lv_label_get_text(label_btn_addition_QR_code_text))+ 1);
                    //figure_borders |= 0x01;
                }
#endif

                if (lv_obj_has_state(sw_addition_QR_code_border, LV_STATE_CHECKED) == 1)
                {
                    my_symbol->output_options = BARCODE_BOX;
                    my_symbol->whitespace_width = 3;
                    my_symbol-> whitespace_height = 3; 
                    my_symbol-> border_width = 2;   /* Size of border in X-dimensions */
                    //figure_borders |= 0x02;
                }

                strcpy(my_symbol->outfile, "out.bmp");
                ZBarcode_Encode(my_symbol, (unsigned char *)lv_label_get_text(label_btn_addition_QR_code_text), 0);

                ZBarcode_Print(my_symbol, 0);
                //ZBarcode_Delete(my_symbol);

                pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                printf("width=%d\n\r", width);
                printf("height=%d\n\r", height);
                printf("channels=%d\n\r", channels);
    
                //my_symbol->scale = (float)((float)150.0*(float)height_len/(float)QR_BAR_MAX_HIGHT/(float)height);
                //my_symbol->scale = (float)height_len/2/(float)height;
                my_symbol->scale = (float)((float)90.0/(float)height);
                printf("scale=%f\n\r", (double)my_symbol->scale);

                strcpy(my_symbol->outfile, "out.bmp");
                ZBarcode_Encode(my_symbol, (unsigned char *)lv_label_get_text(label_btn_addition_QR_code_text), 0);

                ZBarcode_Print(my_symbol, 0);
                ZBarcode_Delete(my_symbol);
                stbi_image_free(pdata);
        
                pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                printf("width=%d\n\r", width);
                printf("height=%d\n\r", height);
                printf("channels=%d\n\r", channels);

                pnew_data = (unsigned char*)lv_mem_alloc(width * height * 4); // 为32位数据分配内存
                if (!pnew_data) 
                {
                    fprintf(stderr, "Memory allocation failed\n");
                    stbi_image_free(pdata);
                    return;
                }
                else
                {
                    printf("lv_mem_alloc ok\n\r");
                }

                for (int y = 0; y < height; y++) 
                {
                    for (int x = 0; x < width; x++) 
                    {
                        int index = y * width + x; // 计算当前像素在原始数据中的索引
                        unsigned char color = pdata[index]; // 获取当前像素的灰度值（0或255）
                        // 映射到RGBA值

                        if (color == 0)
                        {
                            pnew_data[index * 4 + 0] = 0; // R
                            pnew_data[index * 4 + 1] = 0; // G
                            pnew_data[index * 4 + 2] = 0; // B
                            pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                        }
                        else
                        {
                            pnew_data[index * 4 + 0] = 255; // R
                            pnew_data[index * 4 + 1] = 255; // G
                            pnew_data[index * 4 + 2] = 255; // B
                            pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                        }
                    }
                }

                sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.bmp",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                stbi_write_bmp(bmp_name, width, height, 4, pnew_data);
                // 使用data进行图像处理...
                lv_mem_free(pnew_data);
                stbi_image_free(pdata); // 释放内存

                child_count = lv_obj_get_child_cnt(addition_QR_code_middle_bg);
                if(child_count > 0)
                {
                    lv_obj_del(lv_obj_get_child(addition_QR_code_middle_bg,0));
                }

                //显示图像
                img = lv_img_create(addition_QR_code_middle_bg);
                sprintf(bmp_name_1,"A:%s",bmp_name);
                lv_img_set_src(img, bmp_name_1);
                lv_obj_center(img);

                break;
            case 1:
                my_symbol->symbology = BARCODE_PDF417;   
                height_len = atoi(lv_label_get_text(label_btn_addition_QR_code_height));

                if (height_len > QR_BAR_MAX_HIGHT)
                {
                    height_len = QR_BAR_MAX_HIGHT;
                }
                else if (height_len < QR_BAR_MIN_HIGHT)
                {
                    height_len = QR_BAR_MIN_HIGHT;
                }

                printf("height_len=%u\n\r",height_len);

                my_symbol->scale = 1;

                if (lv_obj_has_state(sw_addition_QR_code_border, LV_STATE_CHECKED) == 1)
                {
                    my_symbol->output_options = BARCODE_BOX;
                    my_symbol->whitespace_width = 3;
                    my_symbol-> whitespace_height = 3; 
                    my_symbol-> border_width = 2;   /* Size of border in X-dimensions */
                    //figure_borders |= 0x02;
                }

                strcpy(my_symbol->outfile, "out.bmp");
                ZBarcode_Encode(my_symbol, (unsigned char *)lv_label_get_text(label_btn_addition_QR_code_text), 0);

                ZBarcode_Print(my_symbol, 0);

                pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                printf("width=%d\n\r", width);
                printf("height=%d\n\r", height);
                printf("channels=%d\n\r", channels);
    
                //my_symbol->scale = (float)((float)150.0*(float)height_len/(float)QR_BAR_MAX_HIGHT/(float)height);
                my_symbol->scale = (float)90.0/(float)height;
                printf("scale=%f\n\r", (double)my_symbol->scale);

                strcpy(my_symbol->outfile, "out.bmp");
                ZBarcode_Encode(my_symbol, (unsigned char *)lv_label_get_text(label_btn_addition_QR_code_text), 0);

                ZBarcode_Print(my_symbol, 0);
                ZBarcode_Delete(my_symbol);
                stbi_image_free(pdata);
        
                pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                printf("width=%d\n\r", width);
                printf("height=%d\n\r", height);
                printf("channels=%d\n\r", channels);

                pnew_data = (unsigned char*)lv_mem_alloc(width * height * 4); // 为32位数据分配内存
                if (!pnew_data) 
                {
                    fprintf(stderr, "Memory allocation failed\n");
                    stbi_image_free(pdata);
                    return;
                }
                else
                {
                    printf("lv_mem_alloc ok\n\r");
                }

                for (int y = 0; y < height; y++) 
                {
                    for (int x = 0; x < width; x++) 
                    {
                        int index = y * width + x; // 计算当前像素在原始数据中的索引
                        unsigned char color = pdata[index]; // 获取当前像素的灰度值（0或255）
                        // 映射到RGBA值

                        if (color == 0)
                        {
                            pnew_data[index * 4 + 0] = 0; // R
                            pnew_data[index * 4 + 1] = 0; // G
                            pnew_data[index * 4 + 2] = 0; // B
                            pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                        }
                        else
                        {
                            pnew_data[index * 4 + 0] = 255; // R
                            pnew_data[index * 4 + 1] = 255; // G
                            pnew_data[index * 4 + 2] = 255; // B
                            pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                        }
                    }
                }

                sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.bmp",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                stbi_write_bmp(bmp_name, width, height, 4, pnew_data);
                // 使用data进行图像处理...
                lv_mem_free(pnew_data);
                stbi_image_free(pdata); // 释放内存

                child_count = lv_obj_get_child_cnt(addition_QR_code_middle_bg);
                if(child_count > 0)
                {
                    lv_obj_del(lv_obj_get_child(addition_QR_code_middle_bg,0));
                }

                //显示图像
                img = lv_img_create(addition_QR_code_middle_bg);
                sprintf(bmp_name_1,"A:%s",bmp_name);
                lv_img_set_src(img, bmp_name_1);
                lv_obj_center(img);
     
                break;
            case 2:
                my_symbol->symbology = BARCODE_DATAMATRIX;

                height_len = atoi(lv_label_get_text(label_btn_addition_QR_code_height));

                if (height_len > QR_BAR_MAX_HIGHT)
                {
                    height_len = QR_BAR_MAX_HIGHT;
                }
                else if (height_len < QR_BAR_MIN_HIGHT)
                {
                    height_len = QR_BAR_MIN_HIGHT;
                }

                printf("height_len=%u\n\r",height_len);

                my_symbol->scale = 1;

                if (lv_obj_has_state(sw_addition_QR_code_border, LV_STATE_CHECKED) == 1)
                {
                    my_symbol->output_options = BARCODE_BOX;
                    my_symbol->whitespace_width = 3;
                    my_symbol-> whitespace_height = 3; 
                    my_symbol-> border_width = 2;   /* Size of border in X-dimensions */
                    //figure_borders |= 0x02;
                }

                strcpy(my_symbol->outfile, "out.bmp");
                ZBarcode_Encode(my_symbol, (unsigned char *)lv_label_get_text(label_btn_addition_QR_code_text), 0);

                ZBarcode_Print(my_symbol, 0);

                pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                printf("width=%d\n\r", width);
                printf("height=%d\n\r", height);
                printf("channels=%d\n\r", channels);
    
                //my_symbol->scale = (float)((float)150.0*(float)height_len/(float)QR_BAR_MAX_HIGHT/(float)height);
                my_symbol->scale = (float)90.0/(float)height;
                printf("scale=%f\n\r", (double)my_symbol->scale);

                strcpy(my_symbol->outfile, "out.bmp");
                ZBarcode_Encode(my_symbol, (unsigned char *)lv_label_get_text(label_btn_addition_QR_code_text), 0);

                ZBarcode_Print(my_symbol, 0);
                ZBarcode_Delete(my_symbol);
                stbi_image_free(pdata);
        
                pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                printf("width=%d\n\r", width);
                printf("height=%d\n\r", height);
                printf("channels=%d\n\r", channels);

                pnew_data = (unsigned char*)lv_mem_alloc(width * height * 4); // 为32位数据分配内存
                if (!pnew_data) 
                {
                    fprintf(stderr, "Memory allocation failed\n");
                    stbi_image_free(pdata);
                    return;
                }
                else
                {
                    printf("lv_mem_alloc ok\n\r");
                }

                for (int y = 0; y < height; y++) 
                {
                    for (int x = 0; x < width; x++) 
                    {
                        int index = y * width + x; // 计算当前像素在原始数据中的索引
                        unsigned char color = pdata[index]; // 获取当前像素的灰度值（0或255）
                        // 映射到RGBA值

                        if (color == 0)
                        {
                            pnew_data[index * 4 + 0] = 0; // R
                            pnew_data[index * 4 + 1] = 0; // G
                            pnew_data[index * 4 + 2] = 0; // B
                            pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                        }
                        else
                        {
                            pnew_data[index * 4 + 0] = 255; // R
                            pnew_data[index * 4 + 1] = 255; // G
                            pnew_data[index * 4 + 2] = 255; // B
                            pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                        }
                    }
                }

                sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.bmp",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                stbi_write_bmp(bmp_name, width, height, 4, pnew_data);
                // 使用data进行图像处理...
                lv_mem_free(pnew_data);
                stbi_image_free(pdata); // 释放内存
                
                child_count = lv_obj_get_child_cnt(addition_QR_code_middle_bg);
                if(child_count > 0)
                {
                    lv_obj_del(lv_obj_get_child(addition_QR_code_middle_bg,0));
                }

                //显示图像
                img = lv_img_create(addition_QR_code_middle_bg);
                sprintf(bmp_name_1,"A:%s",bmp_name);
                lv_img_set_src(img, bmp_name_1);
                lv_obj_center(img);

                break;
            case 3:
                my_symbol->symbology = BARCODE_HANXIN;

                height_len = atoi(lv_label_get_text(label_btn_addition_QR_code_height));

                if (height_len > QR_BAR_MAX_HIGHT)
                {
                    height_len = QR_BAR_MAX_HIGHT;
                }
                else if (height_len < QR_BAR_MIN_HIGHT)
                {
                    height_len = QR_BAR_MIN_HIGHT;
                }

                printf("height_len=%u\n\r",height_len);

                my_symbol->scale = 1;

                if (lv_obj_has_state(sw_addition_QR_code_border, LV_STATE_CHECKED) == 1)
                {
                    my_symbol->output_options = BARCODE_BOX;
                    my_symbol->whitespace_width = 3;
                    my_symbol-> whitespace_height = 3; 
                    my_symbol-> border_width = 2;   /* Size of border in X-dimensions */
                    //figure_borders |= 0x02;
                }

                strcpy(my_symbol->outfile, "out.bmp");
                ZBarcode_Encode(my_symbol, (unsigned char *)lv_label_get_text(label_btn_addition_QR_code_text), 0);

                ZBarcode_Print(my_symbol, 0);

                pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                printf("width=%d\n\r", width);
                printf("height=%d\n\r", height);
                printf("channels=%d\n\r", channels);
    
                //my_symbol->scale = (float)((float)150.0*(float)height_len/(float)QR_BAR_MAX_HIGHT/(float)height);
                my_symbol->scale = (float)90.0/(float)height;
                printf("scale=%f\n\r", (double)my_symbol->scale);

                strcpy(my_symbol->outfile, "out.bmp");
                ZBarcode_Encode(my_symbol, (unsigned char *)lv_label_get_text(label_btn_addition_QR_code_text), 0);

                ZBarcode_Print(my_symbol, 0);
                ZBarcode_Delete(my_symbol);
                stbi_image_free(pdata);
        
                pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                printf("width=%d\n\r", width);
                printf("height=%d\n\r", height);
                printf("channels=%d\n\r", channels);

                pnew_data = (unsigned char*)lv_mem_alloc(width * height * 4); // 为32位数据分配内存
                if (!pnew_data) 
                {
                    fprintf(stderr, "Memory allocation failed\n");
                    stbi_image_free(pdata);
                    return;
                }
                else
                {
                    printf("lv_mem_alloc ok\n\r");
                }

                for (int y = 0; y < height; y++) 
                {
                    for (int x = 0; x < width; x++) 
                    {
                        int index = y * width + x; // 计算当前像素在原始数据中的索引
                        unsigned char color = pdata[index]; // 获取当前像素的灰度值（0或255）
                        // 映射到RGBA值

                        if (color == 0)
                        {
                            pnew_data[index * 4 + 0] = 0; // R
                            pnew_data[index * 4 + 1] = 0; // G
                            pnew_data[index * 4 + 2] = 0; // B
                            pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                        }
                        else
                        {
                            pnew_data[index * 4 + 0] = 255; // R
                            pnew_data[index * 4 + 1] = 255; // G
                            pnew_data[index * 4 + 2] = 255; // B
                            pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                        }
                    }
                }
#if 0
                stbi_write_bmp("QR_bar_code.bmp", width, height, 4, pnew_data);
                // 使用data进行图像处理...
                lv_mem_free(pnew_data);
                stbi_image_free(pdata); // 释放内存

                //显示图像
                img = lv_img_create(addition_QR_code_middle_bg);
                lv_img_set_src(img, "A:/root/QR_bar_code.bmp");
                lv_obj_center(img);   
#endif            

                sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.bmp",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                stbi_write_bmp(bmp_name, width, height, 4, pnew_data);
                // 使用data进行图像处理...
                lv_mem_free(pnew_data);
                stbi_image_free(pdata); // 释放内存

                child_count = lv_obj_get_child_cnt(addition_QR_code_middle_bg);
                if(child_count > 0)
                {
                    lv_obj_del(lv_obj_get_child(addition_QR_code_middle_bg,0));
                }

                //显示图像
                img = lv_img_create(addition_QR_code_middle_bg);
                sprintf(bmp_name_1,"A:%s",bmp_name);
                lv_img_set_src(img, bmp_name_1);
                lv_obj_center(img);
                break;
        }
    }
    else
    {
        struct zint_symbol* my_symbol;
        my_symbol = ZBarcode_Create();
        switch (bar_code_type)
        {
            case 0:
            default:

                my_symbol->symbology = BARCODE_CODE39;

                height_len = atoi(lv_label_get_text(label_btn_addition_QR_code_height));

                if (height_len > QR_BAR_MAX_HIGHT)
                {
                    height_len = QR_BAR_MAX_HIGHT;
                }
                else if (height_len < QR_BAR_MIN_HIGHT)
                {
                    height_len = QR_BAR_MIN_HIGHT;
                }

                printf("height_len=%u\n\r",height_len);

                my_symbol->scale = 1;


                if(lv_obj_has_state(sw_addition_QR_code_figure, LV_STATE_CHECKED) == 1)
                {
                    my_symbol->show_hrt = 1;
                    memcpy(my_symbol->text,lv_label_get_text(label_btn_addition_QR_code_text),strlen(lv_label_get_text(label_btn_addition_QR_code_text))+ 1);
                    //figure_borders |= 0x01;
                }
                else
                {
                    my_symbol->show_hrt = 0;
                }

                if (lv_obj_has_state(sw_addition_QR_code_border, LV_STATE_CHECKED) == 1)
                {
                    my_symbol->output_options = BARCODE_BOX;
                    my_symbol->whitespace_width = 3;
                    my_symbol-> whitespace_height = 3; 
                    my_symbol-> border_width = 2;   /* Size of border in X-dimensions */
                    //figure_borders |= 0x02;
                }


                strcpy(my_symbol->outfile, "out.bmp");
                ZBarcode_Encode(my_symbol, (unsigned char *)lv_label_get_text(label_btn_addition_QR_code_text), 0);

                ZBarcode_Print(my_symbol, 0);

                pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                printf("width=%d\n\r", width);
                printf("height=%d\n\r", height);
                printf("channels=%d\n\r", channels);
    
                //my_symbol->scale = (float)((float)150.0*(float)height_len/(float)QR_BAR_MAX_HIGHT/(float)height);
                //   my_symbol->scale = (float)height_len/2/(float)height;
                my_symbol->scale = (float)((float)90.0/(float)height);
                printf("scale=%f\n\r", (double)my_symbol->scale);

                strcpy(my_symbol->outfile, "out.bmp");
                ZBarcode_Encode(my_symbol, (unsigned char *)lv_label_get_text(label_btn_addition_QR_code_text), 0);

                ZBarcode_Print(my_symbol, 0);
                ZBarcode_Delete(my_symbol);
                stbi_image_free(pdata);
        
                pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                printf("width=%d\n\r", width);
                printf("height=%d\n\r", height);
                printf("channels=%d\n\r", channels);

                pnew_data = (unsigned char*)lv_mem_alloc(width * height * 4); // 为32位数据分配内存
                if (!pnew_data) 
                {
                    fprintf(stderr, "Memory allocation failed\n");
                    stbi_image_free(pdata);
                    return;
                }
                else
                {
                    printf("lv_mem_alloc ok\n\r");
                }

                for (int y = 0; y < height; y++) 
                {
                    for (int x = 0; x < width; x++) 
                    {
                        int index = y * width + x; // 计算当前像素在原始数据中的索引
                        unsigned char color = pdata[index]; // 获取当前像素的灰度值（0或255）
                        // 映射到RGBA值

                        if (color == 0)
                        {
                            pnew_data[index * 4 + 0] = 0; // R
                            pnew_data[index * 4 + 1] = 0; // G
                            pnew_data[index * 4 + 2] = 0; // B
                            pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                        }
                        else
                        {
                            pnew_data[index * 4 + 0] = 255; // R
                            pnew_data[index * 4 + 1] = 255; // G
                            pnew_data[index * 4 + 2] = 255; // B
                            pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                        }
                    }
                } 

                sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.bmp",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                stbi_write_bmp(bmp_name, width, height, 4, pnew_data);
                // 使用data进行图像处理...
                lv_mem_free(pnew_data);
                stbi_image_free(pdata); // 释放内存

                child_count = lv_obj_get_child_cnt(addition_QR_code_middle_bg);
                if(child_count > 0)
                {
                    lv_obj_del(lv_obj_get_child(addition_QR_code_middle_bg,0));
                }

                //显示图像
                img = lv_img_create(addition_QR_code_middle_bg);
                sprintf(bmp_name_1,"A:%s",bmp_name);
                lv_img_set_src(img, bmp_name_1);
                lv_obj_center(img);        

                break;
            case 1:
                my_symbol->symbology = BARCODE_CODE128;

                height_len = atoi(lv_label_get_text(label_btn_addition_QR_code_height));

                if (height_len > QR_BAR_MAX_HIGHT)
                {
                    height_len = QR_BAR_MAX_HIGHT;
                }
                else if (height_len < QR_BAR_MIN_HIGHT)
                {
                    height_len = QR_BAR_MIN_HIGHT;
                }

                printf("height_len=%u\n\r",height_len);

                my_symbol->scale = 1;


                if(lv_obj_has_state(sw_addition_QR_code_figure, LV_STATE_CHECKED) == 1)
                {
                    my_symbol->show_hrt = 1;
                    memcpy(my_symbol->text,lv_label_get_text(label_btn_addition_QR_code_text),strlen(lv_label_get_text(label_btn_addition_QR_code_text))+ 1);
                    //figure_borders |= 0x01;
                }
                else
                {
                    my_symbol->show_hrt = 0;
                }

                if (lv_obj_has_state(sw_addition_QR_code_border, LV_STATE_CHECKED) == 1)
                {
                    my_symbol->output_options = BARCODE_BOX;
                    my_symbol->whitespace_width = 3;
                    my_symbol-> whitespace_height = 3; 
                    my_symbol-> border_width = 2;   /* Size of border in X-dimensions */
                    //figure_borders |= 0x02;
                }

                strcpy(my_symbol->outfile, "out.bmp");
                ZBarcode_Encode(my_symbol, (unsigned char *)lv_label_get_text(label_btn_addition_QR_code_text), 0);

                ZBarcode_Print(my_symbol, 0);

                pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                printf("width=%d\n\r", width);
                printf("height=%d\n\r", height);
                printf("channels=%d\n\r", channels);
    
                my_symbol->scale = (float)((float)90.0/(float)height);
                 //   my_symbol->scale = (float)height_len/2/(float)height;
                printf("scale=%f\n\r", (double)my_symbol->scale);

                strcpy(my_symbol->outfile, "out.bmp");
                ZBarcode_Encode(my_symbol, (unsigned char *)lv_label_get_text(label_btn_addition_QR_code_text), 0);

                ZBarcode_Print(my_symbol, 0);
                ZBarcode_Delete(my_symbol);
                stbi_image_free(pdata);
        
                pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                printf("width=%d\n\r", width);
                printf("height=%d\n\r", height);
                printf("channels=%d\n\r", channels);

                pnew_data = (unsigned char*)lv_mem_alloc(width * height * 4); // 为32位数据分配内存
                if (!pnew_data) 
                {
                    fprintf(stderr, "Memory allocation failed\n");
                    stbi_image_free(pdata);
                    return;
                }
                else
                {
                    printf("lv_mem_alloc ok\n\r");
                }

                for (int y = 0; y < height; y++) 
                {
                    for (int x = 0; x < width; x++) 
                    {
                        int index = y * width + x; // 计算当前像素在原始数据中的索引
                        unsigned char color = pdata[index]; // 获取当前像素的灰度值（0或255）
                        // 映射到RGBA值

                        if (color == 0)
                        {
                            pnew_data[index * 4 + 0] = 0; // R
                            pnew_data[index * 4 + 1] = 0; // G
                            pnew_data[index * 4 + 2] = 0; // B
                            pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                        }
                        else
                        {
                            pnew_data[index * 4 + 0] = 255; // R
                            pnew_data[index * 4 + 1] = 255; // G
                            pnew_data[index * 4 + 2] = 255; // B
                            pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                        }
                    }
                }

                sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.bmp",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                stbi_write_bmp(bmp_name, width, height, 4, pnew_data);
                // 使用data进行图像处理...
                lv_mem_free(pnew_data);
                stbi_image_free(pdata); // 释放内存

                child_count = lv_obj_get_child_cnt(addition_QR_code_middle_bg);
                if(child_count > 0)
                {
                    lv_obj_del(lv_obj_get_child(addition_QR_code_middle_bg,0));
                }

                //显示图像
                img = lv_img_create(addition_QR_code_middle_bg);
                sprintf(bmp_name_1,"A:%s",bmp_name);
                lv_img_set_src(img, bmp_name_1);
                lv_obj_center(img);            

                break;
            case 2:
            case 3:
                my_symbol->symbology = BARCODE_EANX;

                height_len = atoi(lv_label_get_text(label_btn_addition_QR_code_height));

                if (height_len > QR_BAR_MAX_HIGHT)
                {
                    height_len = QR_BAR_MAX_HIGHT;
                }
                else if (height_len < QR_BAR_MIN_HIGHT)
                {
                    height_len = QR_BAR_MIN_HIGHT;
                }

                printf("height_len=%u\n\r",height_len);

                my_symbol->scale = 1;

                if(lv_obj_has_state(sw_addition_QR_code_figure, LV_STATE_CHECKED) == 1)
                {
                    my_symbol->show_hrt = 1;
                    memcpy(my_symbol->text,lv_label_get_text(label_btn_addition_QR_code_text),strlen(lv_label_get_text(label_btn_addition_QR_code_text))+ 1);
                }
                else
                {
                    my_symbol->show_hrt = 0;
                }

                if (lv_obj_has_state(sw_addition_QR_code_border, LV_STATE_CHECKED) == 1)
                {
                    my_symbol->output_options = BARCODE_BOX;
                    my_symbol->whitespace_width = 3;
                    my_symbol-> whitespace_height = 3; 
                    my_symbol-> border_width = 2;   /* Size of border in X-dimensions */
                }

                strcpy(my_symbol->outfile, "out.bmp");
                ZBarcode_Encode(my_symbol, (unsigned char *)lv_label_get_text(label_btn_addition_QR_code_text), 0);

                ZBarcode_Print(my_symbol, 0);

                pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                printf("width=%d\n\r", width);
                printf("height=%d\n\r", height);
                printf("channels=%d\n\r", channels);
    
                my_symbol->scale = (float)((float)90.0/(float)height);
                 //   my_symbol->scale = (float)height_len/2/(float)height;
                printf("scale=%f\n\r", (double)my_symbol->scale);

                strcpy(my_symbol->outfile, "out.bmp");
                ZBarcode_Encode(my_symbol, (unsigned char *)lv_label_get_text(label_btn_addition_QR_code_text), 0);

                ZBarcode_Print(my_symbol, 0);
                ZBarcode_Delete(my_symbol);
                stbi_image_free(pdata);
        
                pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                printf("width=%d\n\r", width);
                printf("height=%d\n\r", height);
                printf("channels=%d\n\r", channels);

                pnew_data = (unsigned char*)lv_mem_alloc(width * height * 4); // 为32位数据分配内存
                if (!pnew_data) 
                {
                    fprintf(stderr, "Memory allocation failed\n");
                    stbi_image_free(pdata);
                    return;
                }
                else
                {
                    printf("lv_mem_alloc ok\n\r");
                }

                for (int y = 0; y < height; y++) 
                {
                    for (int x = 0; x < width; x++) 
                    {
                        int index = y * width + x; // 计算当前像素在原始数据中的索引
                        unsigned char color = pdata[index]; // 获取当前像素的灰度值（0或255）
                        // 映射到RGBA值

                        if (color == 0)
                        {
                            pnew_data[index * 4 + 0] = 0; // R
                            pnew_data[index * 4 + 1] = 0; // G
                            pnew_data[index * 4 + 2] = 0; // B
                            pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                        }
                        else
                        {
                            pnew_data[index * 4 + 0] = 255; // R
                            pnew_data[index * 4 + 1] = 255; // G
                            pnew_data[index * 4 + 2] = 255; // B
                            pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                        }
                    }
                }

                sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.bmp",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                stbi_write_bmp(bmp_name, width, height, 4, pnew_data);
                // 使用data进行图像处理...
                lv_mem_free(pnew_data);
                stbi_image_free(pdata); // 释放内存

                child_count = lv_obj_get_child_cnt(addition_QR_code_middle_bg);
                if(child_count > 0)
                {
                    lv_obj_del(lv_obj_get_child(addition_QR_code_middle_bg,0));
                }

                //显示图像
                img = lv_img_create(addition_QR_code_middle_bg);
                sprintf(bmp_name_1,"A:%s",bmp_name);
                lv_img_set_src(img, bmp_name_1);
                lv_obj_center(img);           

                break;
            case 4:
                if(str_len != 40)
                {
                    ZBarcode_Delete(my_symbol);
                    break;                
                }

                if(check_string_format(lv_label_get_text(label_btn_addition_QR_code_text)) != 0)
                {
                    ZBarcode_Delete(my_symbol);
                    break;                  
                }

                my_symbol->symbology = BARCODE_EAN128;
                my_symbol->input_mode |= GS1PARENS_MODE;
                height_len = atoi(lv_label_get_text(label_btn_addition_QR_code_height));

                if (height_len > QR_BAR_MAX_HIGHT)
                {
                    height_len = QR_BAR_MAX_HIGHT;
                }
                else if (height_len < QR_BAR_MIN_HIGHT)
                {
                    height_len = QR_BAR_MIN_HIGHT;
                }

                printf("height_len=%u\n\r",height_len);

                my_symbol->scale = 1;

                if(lv_obj_has_state(sw_addition_QR_code_figure, LV_STATE_CHECKED) == 1)
                {
                    my_symbol->show_hrt = 1;
                    memcpy(my_symbol->text,lv_label_get_text(label_btn_addition_QR_code_text),strlen(lv_label_get_text(label_btn_addition_QR_code_text))+ 1);
                }
                else
                {
                    my_symbol->show_hrt = 0;
                }

                if (lv_obj_has_state(sw_addition_QR_code_border, LV_STATE_CHECKED) == 1)
                {
                    my_symbol->output_options = BARCODE_BOX;
                    my_symbol->whitespace_width = 3;
                    my_symbol-> whitespace_height = 3; 
                    my_symbol-> border_width = 2;   /* Size of border in X-dimensions */
                }

                printf("%s\n\r",lv_label_get_text(label_btn_addition_QR_code_text));

                strcpy(my_symbol->outfile, "out.bmp");
                ZBarcode_Encode(my_symbol, (unsigned char *)lv_label_get_text(label_btn_addition_QR_code_text), 0);
                //ZBarcode_Encode(my_symbol, (unsigned char *)"(01)98898765432106(3202)012345(15)991231", 0);

                ZBarcode_Print(my_symbol, 0);

                pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                printf("width=%d\n\r", width);
                printf("height=%d\n\r", height);
                printf("channels=%d\n\r", channels);
    
                my_symbol->scale = (float)((float)118.0/(float)height);

                printf("scale=%f\n\r", (double)my_symbol->scale);

                strcpy(my_symbol->outfile, "out.bmp");
                ZBarcode_Encode(my_symbol, (unsigned char *)lv_label_get_text(label_btn_addition_QR_code_text), 0);
                //ZBarcode_Encode(my_symbol, (unsigned char *)"(01)98898765432106(3202)012345(15)991231", 0);

                ZBarcode_Print(my_symbol, 0);
                ZBarcode_Delete(my_symbol);
                stbi_image_free(pdata);
        
                pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                printf("width=%d\n\r", width);
                printf("height=%d\n\r", height);
                printf("channels=%d\n\r", channels);

                pnew_data = (unsigned char*)lv_mem_alloc(width * height * 4); // 为32位数据分配内存
                if (!pnew_data) 
                {
                    fprintf(stderr, "Memory allocation failed\n");
                    stbi_image_free(pdata);
                    return;
                }
                else
                {
                    printf("lv_mem_alloc ok\n\r");
                }

                for (int y = 0; y < height; y++) 
                {
                    for (int x = 0; x < width; x++) 
                    {
                        int index = y * width + x; // 计算当前像素在原始数据中的索引
                        unsigned char color = pdata[index]; // 获取当前像素的灰度值（0或255）
                        // 映射到RGBA值

                        if (color == 0)
                        {
                            pnew_data[index * 4 + 0] = 0; // R
                            pnew_data[index * 4 + 1] = 0; // G
                            pnew_data[index * 4 + 2] = 0; // B
                            pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                        }
                        else
                        {
                            pnew_data[index * 4 + 0] = 255; // R
                            pnew_data[index * 4 + 1] = 255; // G
                            pnew_data[index * 4 + 2] = 255; // B
                            pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                        }
                    }
                }

                sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.bmp",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                stbi_write_bmp(bmp_name, width, height, 4, pnew_data);
                // 使用data进行图像处理...
                lv_mem_free(pnew_data);
                stbi_image_free(pdata); // 释放内存

                data = stbi_load(bmp_name, &width, &height, &channels, 0);
                if (!data) 
                {
                    printf("错误：无法加载图片 %s\n", bmp_name);
                }
                printf("图片加载成功：%dx%d，%d 通道\n", width, height, channels);

                sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.png",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                
                success = stbi_write_png(bmp_name, width, height, channels, data, width * channels);
                if (!success) 
                {
                    printf("错误：保存 PNG 失败\n");
                } 
                else
                {
                    printf("PNG 保存成功：%s\n", bmp_name);
                }

                // 释放内存
                stbi_image_free(data);

                child_count = lv_obj_get_child_cnt(addition_QR_code_middle_bg);
                if(child_count > 0)
                {
                    lv_obj_del(lv_obj_get_child(addition_QR_code_middle_bg,0));
                }

                //显示图像
                img = lv_img_create(addition_QR_code_middle_bg);
                sprintf(bmp_name_1,"A:%s",bmp_name);
                lv_img_set_src(img, bmp_name_1);
                lv_img_set_zoom(img,150);
                lv_obj_center(img);      


                break;
            case 5:
                if(str_len != 11)
                {
                    ZBarcode_Delete(my_symbol);
                    break;                
                }
                my_symbol->symbology = BARCODE_UPCA;

                height_len = atoi(lv_label_get_text(label_btn_addition_QR_code_height));

                if (height_len > QR_BAR_MAX_HIGHT)
                {
                    height_len = QR_BAR_MAX_HIGHT;
                }
                else if (height_len < QR_BAR_MIN_HIGHT)
                {
                    height_len = QR_BAR_MIN_HIGHT;
                }

                printf("height_len=%u\n\r",height_len);

                my_symbol->scale = 1;

                if(lv_obj_has_state(sw_addition_QR_code_figure, LV_STATE_CHECKED) == 1)
                {
                    my_symbol->show_hrt = 1;
                    memcpy(my_symbol->text,lv_label_get_text(label_btn_addition_QR_code_text),strlen(lv_label_get_text(label_btn_addition_QR_code_text))+ 1);
                }
                else
                {
                    my_symbol->show_hrt = 0;
                }

                if (lv_obj_has_state(sw_addition_QR_code_border, LV_STATE_CHECKED) == 1)
                {
                    my_symbol->output_options = BARCODE_BOX;
                    my_symbol->whitespace_width = 3;
                    my_symbol-> whitespace_height = 3; 
                    my_symbol-> border_width = 2;   /* Size of border in X-dimensions */
                }

                strcpy(my_symbol->outfile, "out.bmp");
                ZBarcode_Encode(my_symbol, (unsigned char *)lv_label_get_text(label_btn_addition_QR_code_text), 0);

                ZBarcode_Print(my_symbol, 0);

                pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                printf("width=%d\n\r", width);
                printf("height=%d\n\r", height);
                printf("channels=%d\n\r", channels);
    
                my_symbol->scale = (float)((float)90.0/(float)height);

                //    my_symbol->scale = (float)height_len/2/(float)height;
                printf("scale=%f\n\r", (double)my_symbol->scale);

                strcpy(my_symbol->outfile, "out.bmp");
                ZBarcode_Encode(my_symbol, (unsigned char *)lv_label_get_text(label_btn_addition_QR_code_text), 0);

                ZBarcode_Print(my_symbol, 0);
                ZBarcode_Delete(my_symbol);
                stbi_image_free(pdata);
        
                pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                printf("width=%d\n\r", width);
                printf("height=%d\n\r", height);
                printf("channels=%d\n\r", channels);

                pnew_data = (unsigned char*)lv_mem_alloc(width * height * 4); // 为32位数据分配内存
                if (!pnew_data) 
                {
                    fprintf(stderr, "Memory allocation failed\n");
                    stbi_image_free(pdata);
                    return;
                }
                else
                {
                    printf("lv_mem_alloc ok\n\r");
                }

                for (int y = 0; y < height; y++) 
                {
                    for (int x = 0; x < width; x++) 
                    {
                        int index = y * width + x; // 计算当前像素在原始数据中的索引
                        unsigned char color = pdata[index]; // 获取当前像素的灰度值（0或255）
                        // 映射到RGBA值

                        if (color == 0)
                        {
                            pnew_data[index * 4 + 0] = 0; // R
                            pnew_data[index * 4 + 1] = 0; // G
                            pnew_data[index * 4 + 2] = 0; // B
                            pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                        }
                        else
                        {
                            pnew_data[index * 4 + 0] = 255; // R
                            pnew_data[index * 4 + 1] = 255; // G
                            pnew_data[index * 4 + 2] = 255; // B
                            pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                        }
                    }
                }  

                sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.bmp",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                stbi_write_bmp(bmp_name, width, height, 4, pnew_data);
                // 使用data进行图像处理...
                lv_mem_free(pnew_data);
                stbi_image_free(pdata); // 释放内存

                child_count = lv_obj_get_child_cnt(addition_QR_code_middle_bg);
                if(child_count > 0)
                {
                    lv_obj_del(lv_obj_get_child(addition_QR_code_middle_bg,0));
                }

                //显示图像
                img = lv_img_create(addition_QR_code_middle_bg);
                sprintf(bmp_name_1,"A:%s",bmp_name);
                lv_img_set_src(img, bmp_name_1);
                lv_obj_center(img);       

                break;
            case 6:
                if(str_len != 7)
                {
                    ZBarcode_Delete(my_symbol);
                    break;                
                }

                my_symbol->symbology = BARCODE_UPCE;

                height_len = atoi(lv_label_get_text(label_btn_addition_QR_code_height));

                if (height_len > QR_BAR_MAX_HIGHT)
                {
                    height_len = QR_BAR_MAX_HIGHT;
                }
                else if (height_len < QR_BAR_MIN_HIGHT)
                {
                    height_len = QR_BAR_MIN_HIGHT;
                }

                printf("height_len=%u\n\r",height_len);

                my_symbol->scale = 1;

                if(lv_obj_has_state(sw_addition_QR_code_figure, LV_STATE_CHECKED) == 1)
                {
                    my_symbol->show_hrt = 1;
                    memcpy(my_symbol->text,lv_label_get_text(label_btn_addition_QR_code_text),strlen(lv_label_get_text(label_btn_addition_QR_code_text))+ 1);
                }
                else
                {
                    my_symbol->show_hrt = 0;
                }

                if (lv_obj_has_state(sw_addition_QR_code_border, LV_STATE_CHECKED) == 1)
                {
                    my_symbol->output_options = BARCODE_BOX;
                    my_symbol->whitespace_width = 3;
                    my_symbol-> whitespace_height = 3; 
                    my_symbol-> border_width = 2;   /* Size of border in X-dimensions */
                }

                strcpy(my_symbol->outfile, "out.bmp");
                ZBarcode_Encode(my_symbol, (unsigned char *)lv_label_get_text(label_btn_addition_QR_code_text), 0);

                ZBarcode_Print(my_symbol, 0);

                pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                printf("width=%d\n\r", width);
                printf("height=%d\n\r", height);
                printf("channels=%d\n\r", channels);
    
                my_symbol->scale = (float)((float)90.0/(float)height);
                //    my_symbol->scale = (float)height_len/2/(float)height;
                printf("scale=%f\n\r", (double)my_symbol->scale);

                strcpy(my_symbol->outfile, "out.bmp");
                ZBarcode_Encode(my_symbol, (unsigned char *)lv_label_get_text(label_btn_addition_QR_code_text), 0);

                ZBarcode_Print(my_symbol, 0);
                ZBarcode_Delete(my_symbol);
                stbi_image_free(pdata);
        
                pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                printf("width=%d\n\r", width);
                printf("height=%d\n\r", height);
                printf("channels=%d\n\r", channels);

                pnew_data = (unsigned char*)lv_mem_alloc(width * height * 4); // 为32位数据分配内存
                if (!pnew_data) 
                {
                    fprintf(stderr, "Memory allocation failed\n");
                    stbi_image_free(pdata);
                    return;
                }
                else
                {
                    printf("lv_mem_alloc ok\n\r");
                }

                for (int y = 0; y < height; y++) 
                {
                    for (int x = 0; x < width; x++) 
                    {
                        int index = y * width + x; // 计算当前像素在原始数据中的索引
                        unsigned char color = pdata[index]; // 获取当前像素的灰度值（0或255）
                        // 映射到RGBA值

                        if (color == 0)
                        {
                            pnew_data[index * 4 + 0] = 0; // R
                            pnew_data[index * 4 + 1] = 0; // G
                            pnew_data[index * 4 + 2] = 0; // B
                            pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                        }
                        else
                        {
                            pnew_data[index * 4 + 0] = 255; // R
                            pnew_data[index * 4 + 1] = 255; // G
                            pnew_data[index * 4 + 2] = 255; // B
                            pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                        }
                    }
                }

                sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.bmp",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                stbi_write_bmp(bmp_name, width, height, 4, pnew_data);
                // 使用data进行图像处理...
                lv_mem_free(pnew_data);
                stbi_image_free(pdata); // 释放内存

                child_count = lv_obj_get_child_cnt(addition_QR_code_middle_bg);
                if(child_count > 0)
                {
                    lv_obj_del(lv_obj_get_child(addition_QR_code_middle_bg,0));
                }

                //显示图像
                img = lv_img_create(addition_QR_code_middle_bg);
                sprintf(bmp_name_1,"A:%s",bmp_name);
                lv_img_set_src(img, bmp_name_1);
                lv_obj_center(img);           

                break;
            case 7:
                if(str_len != 13)
                {
                    ZBarcode_Delete(my_symbol);
                    break;                
                }

                my_symbol->symbology = BARCODE_ITF14;

                height_len = atoi(lv_label_get_text(label_btn_addition_QR_code_height));

                if (height_len > QR_BAR_MAX_HIGHT)
                {
                    height_len = QR_BAR_MAX_HIGHT;
                }
                else if (height_len < QR_BAR_MIN_HIGHT)
                {
                    height_len = QR_BAR_MIN_HIGHT;
                }

                printf("height_len=%u\n\r",height_len);

                my_symbol->scale = 1;


                if(lv_obj_has_state(sw_addition_QR_code_figure, LV_STATE_CHECKED) == 1)
                {
                    my_symbol->show_hrt = 1;
                    memcpy(my_symbol->text,lv_label_get_text(label_btn_addition_QR_code_text),strlen(lv_label_get_text(label_btn_addition_QR_code_text))+ 1);
                }
                else
                {
                    my_symbol->show_hrt = 0;
                }

                if (lv_obj_has_state(sw_addition_QR_code_border, LV_STATE_CHECKED) == 1)
                {
                    my_symbol->output_options = BARCODE_BOX;
                    my_symbol->whitespace_width = 3;
                    my_symbol-> whitespace_height = 3; 
                    my_symbol-> border_width = 2;   /* Size of border in X-dimensions */
                }

                strcpy(my_symbol->outfile, "out.bmp");
                ZBarcode_Encode(my_symbol, (unsigned char *)lv_label_get_text(label_btn_addition_QR_code_text), 0);

                ZBarcode_Print(my_symbol, 0);

                pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                printf("width=%d\n\r", width);
                printf("height=%d\n\r", height);
                printf("channels=%d\n\r", channels);
    
                my_symbol->scale = (float)((float)90.0/(float)height);
               //     my_symbol->scale = (float)height_len/2/(float)height;
                printf("scale=%f\n\r", (double)my_symbol->scale);

                strcpy(my_symbol->outfile, "out.bmp");
                ZBarcode_Encode(my_symbol, (unsigned char *)lv_label_get_text(label_btn_addition_QR_code_text), 0);

                ZBarcode_Print(my_symbol, 0);
                ZBarcode_Delete(my_symbol);
                stbi_image_free(pdata);
        
                pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                printf("width=%d\n\r", width);
                printf("height=%d\n\r", height);
                printf("channels=%d\n\r", channels);

                pnew_data = (unsigned char*)lv_mem_alloc(width * height * 4); // 为32位数据分配内存
                if (!pnew_data) 
                {
                    fprintf(stderr, "Memory allocation failed\n");
                    stbi_image_free(pdata);
                    return;
                }
                else
                {
                    printf("lv_mem_alloc ok\n\r");
                }

                for (int y = 0; y < height; y++) 
                {
                    for (int x = 0; x < width; x++) 
                    {
                        int index = y * width + x; // 计算当前像素在原始数据中的索引
                        unsigned char color = pdata[index]; // 获取当前像素的灰度值（0或255）
                        // 映射到RGBA值

                        if (color == 0)
                        {
                            pnew_data[index * 4 + 0] = 0; // R
                            pnew_data[index * 4 + 1] = 0; // G
                            pnew_data[index * 4 + 2] = 0; // B
                            pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                        }
                        else
                        {
                            pnew_data[index * 4 + 0] = 255; // R
                            pnew_data[index * 4 + 1] = 255; // G
                            pnew_data[index * 4 + 2] = 255; // B
                            pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                        }
                    }
                }

                sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.bmp",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                stbi_write_bmp(bmp_name, width, height, 4, pnew_data);
                // 使用data进行图像处理...
                lv_mem_free(pnew_data);
                stbi_image_free(pdata); // 释放内存

                child_count = lv_obj_get_child_cnt(addition_QR_code_middle_bg);
                if(child_count > 0)
                {
                    lv_obj_del(lv_obj_get_child(addition_QR_code_middle_bg,0));
                }

                //显示图像
                img = lv_img_create(addition_QR_code_middle_bg);
                sprintf(bmp_name_1,"A:%s",bmp_name);
                lv_img_set_src(img, bmp_name_1);
                lv_obj_center(img);            

                break;
            case 8:

                if(str_len > 40)
                {
                    ZBarcode_Delete(my_symbol);
                    break;                
                }

                my_symbol->symbology = BARCODE_C25INTER;

                height_len = atoi(lv_label_get_text(label_btn_addition_QR_code_height));

                if (height_len > QR_BAR_MAX_HIGHT)
                {
                    height_len = QR_BAR_MAX_HIGHT;
                }
                else if (height_len < QR_BAR_MIN_HIGHT)
                {
                    height_len = QR_BAR_MIN_HIGHT;
                }

                printf("height_len=%u\n\r",height_len);

                my_symbol->scale = 1;


                if(lv_obj_has_state(sw_addition_QR_code_figure, LV_STATE_CHECKED) == 1)
                {
                    my_symbol->show_hrt = 1;
                    memcpy(my_symbol->text,lv_label_get_text(label_btn_addition_QR_code_text),strlen(lv_label_get_text(label_btn_addition_QR_code_text))+ 1);
                }
                else
                {
                    my_symbol->show_hrt = 0;
                }

                if (lv_obj_has_state(sw_addition_QR_code_border, LV_STATE_CHECKED) == 1)
                {
                    my_symbol->output_options = BARCODE_BOX;
                    my_symbol->whitespace_width = 3;
                    my_symbol-> whitespace_height = 3; 
                    my_symbol-> border_width = 2;   /* Size of border in X-dimensions */
                }

                strcpy(my_symbol->outfile, "out.bmp");
                ZBarcode_Encode(my_symbol, (unsigned char *)lv_label_get_text(label_btn_addition_QR_code_text), 0);

                ZBarcode_Print(my_symbol, 0);

                pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                printf("width=%d\n\r", width);
                printf("height=%d\n\r", height);
                printf("channels=%d\n\r", channels);
    
                my_symbol->scale = (float)((float)90.0/(float)height);

                 //   my_symbol->scale = (float)height_len/2/(float)height;
                printf("scale=%f\n\r", (double)my_symbol->scale);

                strcpy(my_symbol->outfile, "out.bmp");
                ZBarcode_Encode(my_symbol, (unsigned char *)lv_label_get_text(label_btn_addition_QR_code_text), 0);

                ZBarcode_Print(my_symbol, 0);
                ZBarcode_Delete(my_symbol);
                stbi_image_free(pdata);
        
                pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                printf("width=%d\n\r", width);
                printf("height=%d\n\r", height);
                printf("channels=%d\n\r", channels);

                pnew_data = (unsigned char*)lv_mem_alloc(width * height * 4); // 为32位数据分配内存
                if (!pnew_data) 
                {
                    fprintf(stderr, "Memory allocation failed\n");
                    stbi_image_free(pdata);
                    return;
                }
                else
                {
                    printf("lv_mem_alloc ok\n\r");
                }

                for (int y = 0; y < height; y++) 
                {
                    for (int x = 0; x < width; x++) 
                    {
                        int index = y * width + x; // 计算当前像素在原始数据中的索引
                        unsigned char color = pdata[index]; // 获取当前像素的灰度值（0或255）
                        // 映射到RGBA值

                        if (color == 0)
                        {
                            pnew_data[index * 4 + 0] = 0; // R
                            pnew_data[index * 4 + 1] = 0; // G
                            pnew_data[index * 4 + 2] = 0; // B
                            pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                        }
                        else
                        {
                            pnew_data[index * 4 + 0] = 255; // R
                            pnew_data[index * 4 + 1] = 255; // G
                            pnew_data[index * 4 + 2] = 255; // B
                            pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                        }
                    }
                } 

                sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.bmp",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                stbi_write_bmp(bmp_name, width, height, 4, pnew_data);
                // 使用data进行图像处理...
                lv_mem_free(pnew_data);
                stbi_image_free(pdata); // 释放内存

                child_count = lv_obj_get_child_cnt(addition_QR_code_middle_bg);
                if(child_count > 0)
                {
                    lv_obj_del(lv_obj_get_child(addition_QR_code_middle_bg,0));
                }

                //显示图像
                img = lv_img_create(addition_QR_code_middle_bg);
                sprintf(bmp_name_1,"A:%s",bmp_name);
                lv_img_set_src(img, bmp_name_1);
                lv_obj_center(img);          

                break;
            case 9:

                if(str_len != 13)
                {
                    ZBarcode_Delete(my_symbol);
                    break;                
                }
                my_symbol->symbology = BARCODE_EAN14;

                height_len = atoi(lv_label_get_text(label_btn_addition_QR_code_height));

                if (height_len > QR_BAR_MAX_HIGHT)
                {
                    height_len = QR_BAR_MAX_HIGHT;
                }
                else if (height_len < QR_BAR_MIN_HIGHT)
                {
                    height_len = QR_BAR_MIN_HIGHT;
                }

                printf("height_len=%u\n\r",height_len);

                my_symbol->scale = 1;

                if(lv_obj_has_state(sw_addition_QR_code_figure, LV_STATE_CHECKED) == 1)
                {
                    my_symbol->show_hrt = 1;
                    memcpy(my_symbol->text,lv_label_get_text(label_btn_addition_QR_code_text),strlen(lv_label_get_text(label_btn_addition_QR_code_text))+ 1);
                }
                else
                {
                    my_symbol->show_hrt = 0;
                }

                if (lv_obj_has_state(sw_addition_QR_code_border, LV_STATE_CHECKED) == 1)
                {
                    my_symbol->output_options = BARCODE_BOX;
                    my_symbol->whitespace_width = 3;
                    my_symbol-> whitespace_height = 3; 
                    my_symbol-> border_width = 2;   /* Size of border in X-dimensions */
                }

                strcpy(my_symbol->outfile, "out.bmp");
                ZBarcode_Encode(my_symbol, (unsigned char *)lv_label_get_text(label_btn_addition_QR_code_text), 0);

                ZBarcode_Print(my_symbol, 0);

                pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                printf("width=%d\n\r", width);
                printf("height=%d\n\r", height);
                printf("channels=%d\n\r", channels);
    
                my_symbol->scale = (float)((float)90.0/(float)height);

                 //   my_symbol->scale = (float)height_len/2/(float)height;
                printf("scale=%f\n\r", (double)my_symbol->scale);

                strcpy(my_symbol->outfile, "out.bmp");
                ZBarcode_Encode(my_symbol, (unsigned char *)lv_label_get_text(label_btn_addition_QR_code_text), 0);

                ZBarcode_Print(my_symbol, 0);
                ZBarcode_Delete(my_symbol);
                stbi_image_free(pdata);
        
                pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                printf("width=%d\n\r", width);
                printf("height=%d\n\r", height);
                printf("channels=%d\n\r", channels);

                pnew_data = (unsigned char*)lv_mem_alloc(width * height * 4); // 为32位数据分配内存
                if (!pnew_data) 
                {
                    fprintf(stderr, "Memory allocation failed\n");
                    stbi_image_free(pdata);
                    return;
                }
                else
                {
                    printf("lv_mem_alloc ok\n\r");
                }

                for (int y = 0; y < height; y++) 
                {
                    for (int x = 0; x < width; x++) 
                    {
                        int index = y * width + x; // 计算当前像素在原始数据中的索引
                        unsigned char color = pdata[index]; // 获取当前像素的灰度值（0或255）
                        // 映射到RGBA值

                        if (color == 0)
                        {
                            pnew_data[index * 4 + 0] = 0; // R
                            pnew_data[index * 4 + 1] = 0; // G
                            pnew_data[index * 4 + 2] = 0; // B
                            pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                        }
                        else
                        {
                            pnew_data[index * 4 + 0] = 255; // R
                            pnew_data[index * 4 + 1] = 255; // G
                            pnew_data[index * 4 + 2] = 255; // B
                            pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                        }
                    }
                }

                sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.bmp",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                stbi_write_bmp(bmp_name, width, height, 4, pnew_data);
                // 使用data进行图像处理...
                lv_mem_free(pnew_data);
                stbi_image_free(pdata); // 释放内存

                child_count = lv_obj_get_child_cnt(addition_QR_code_middle_bg);
                if(child_count > 0)
                {
                    lv_obj_del(lv_obj_get_child(addition_QR_code_middle_bg,0));
                }

                //显示图像
                img = lv_img_create(addition_QR_code_middle_bg);
                sprintf(bmp_name_1,"A:%s",bmp_name);
                lv_img_set_src(img, bmp_name_1);
                lv_obj_center(img);            

                break;
        }
    }
}

static void button_keyboard_confirm_QR_code_text_event_cb(lv_event_t* e)
{
    lv_event_code_t code;
    code = lv_event_get_code(e);
    if (code == LV_EVENT_CLICKED)
    {
        printf("button_keyboard_confirm_QR_code_text_event_cb\n");
        buzzer_enable = 1;
        //获取输入框数据给到文本显示框
        lv_label_set_text(label_btn_addition_QR_code_text, lv_textarea_get_text(textarea_text_keyboard));
        lv_obj_set_style_text_opa(label_btn_addition_QR_code_text, LV_OPA_COVER, LV_STATE_DEFAULT);
        lv_obj_del(textarea_bg_keyboard);
        lv_obj_del(pinyin_ime);
        lv_obj_del(textarea_text_keyboard);
        lv_obj_del(keyboard_bg);
        lv_obj_del(label_keyboard_confirm);
        lv_obj_del(btn_keyboard_confirm);
        lv_obj_del(label_keyboard_return);
        lv_obj_del(btn_keyboard_return);
        update_preview_QR_bar_code();
        if(flag_modification_or_addition == 1)
        {
            addition_QR_bar_updata();
        }
    }
}


static void button_keyboard_return_QR_code_text_event_cb(lv_event_t* e)
{
    lv_event_code_t code;
    code = lv_event_get_code(e);
    if (code == LV_EVENT_CLICKED)
    {
        printf("button_keyboard_return_QR_code_text_event_cb\n");
        buzzer_enable = 1;

        lv_obj_del(textarea_bg_keyboard);
        lv_obj_del(pinyin_ime);
        lv_obj_del(textarea_text_keyboard);
        lv_obj_del(keyboard_bg);
        lv_obj_del(label_keyboard_confirm);
        lv_obj_del(btn_keyboard_confirm);
        lv_obj_del(label_keyboard_return);
        lv_obj_del(btn_keyboard_return);

        addition_QR_bar_updata();
    }
}


static void btn_addition_QR_code_text_event_cb(lv_event_t* e)
{
    lv_event_code_t code;
    code = lv_event_get_code(e);

    if (code == LV_EVENT_CLICKED)
    {
        printf("btn_addition_QR_code_text_event_cb\n");

        buzzer_enable = 1;

        textarea_bg_keyboard = lv_obj_create(lv_scr_act());
        /* 设置大小 */

        lv_obj_set_size(textarea_bg_keyboard, 480, 272);
        lv_obj_align(textarea_bg_keyboard, LV_ALIGN_TOP_LEFT, 0, 0);
        lv_obj_set_style_border_width(textarea_bg_keyboard, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_border_color(textarea_bg_keyboard, lv_color_hex(0x9bcd9b), LV_STATE_DEFAULT); /* 设置边框颜色 */
        //lv_obj_set_style_border_opa(file_management_win, 100, LV_STATE_DEFAULT); /* 设置边框透明度 */
        lv_obj_set_style_radius(textarea_bg_keyboard, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_color(textarea_bg_keyboard, lv_color_hex(0x1fadd3), LV_STATE_DEFAULT);

        //输入框+键盘
        LV_FONT_DECLARE(heiFont16_1);
        pinyin_ime = lv_ime_pinyin_create(lv_scr_act());
        lv_obj_set_style_text_font(pinyin_ime, &heiFont16_1, 0);
        //lv_obj_set_style_text_font(pinyin_ime, &lv_font_simsun_16_cjk, 0);
        //lv_ime_pinyin_set_dict(pinyin_ime, your_dict); // Use a custom dictionary. If it is not set, the built-in dictionary will be used.

        textarea_text_keyboard = lv_textarea_create(lv_scr_act());
        //lv_textarea_set_one_line(textarea_text_keyboard, true);
        lv_obj_set_size(textarea_text_keyboard, 480, 95);
        lv_obj_set_style_text_font(textarea_text_keyboard, &heiFont16_1, 0);
        lv_obj_align(textarea_text_keyboard, LV_ALIGN_TOP_LEFT, 0, 0);
        lv_textarea_set_max_length(textarea_text_keyboard, 100);
        lv_textarea_set_placeholder_text(textarea_text_keyboard, "Smart printer");
        //lv_obj_add_event_cb(textarea_text_keyboard, textarea_text_event_cb, LV_EVENT_ALL, NULL);
        lv_obj_set_style_border_width(textarea_text_keyboard, 1, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_border_color(textarea_text_keyboard, lv_color_hex(0xAAAAAA), LV_STATE_DEFAULT); /* 设置边框颜色 */
        lv_obj_set_style_border_opa(textarea_text_keyboard, 100, LV_STATE_DEFAULT); /* 设置边框透明度 */
        lv_obj_set_style_radius(textarea_text_keyboard, 0, LV_STATE_DEFAULT); /* 设置圆角 */

        if (strlen(lv_label_get_text(label_btn_addition_QR_code_text)) != 0)
        {
            lv_textarea_set_text(textarea_text_keyboard, lv_label_get_text(label_btn_addition_QR_code_text));
        }

        /*Create a keyboard and add it to ime_pinyin*/
        text_edit_keyboard = lv_keyboard_create(lv_scr_act());
        lv_ime_pinyin_set_keyboard(pinyin_ime, text_edit_keyboard);
        lv_keyboard_set_textarea(text_edit_keyboard, textarea_text_keyboard);
        //lv_obj_set_style_bg_color(text_edit_keyboard, lv_color_hex(0xff4040), LV_PART_MAIN);
        lv_obj_set_style_bg_color(text_edit_keyboard, lv_color_hex(0x1fadd3), LV_PART_MAIN);
        lv_obj_add_event_cb(textarea_text_keyboard, textarea_text_event_cb, LV_EVENT_ALL, text_edit_keyboard);
        lv_obj_align(text_edit_keyboard, LV_ALIGN_TOP_LEFT, 0, 115);
        lv_obj_set_size(text_edit_keyboard, 480, 133);

        /*Get the cand_panel, and adjust its size and position*/
        keyboard_cand_panel = lv_ime_pinyin_get_cand_panel(pinyin_ime);
        lv_obj_set_size(keyboard_cand_panel, LV_PCT(100), LV_PCT(10));
        lv_obj_align_to(keyboard_cand_panel, text_edit_keyboard, LV_ALIGN_OUT_TOP_MID, 0, 5);
        lv_obj_set_style_bg_color(keyboard_cand_panel, lv_color_hex(0x8B1A1A), LV_PART_MAIN);
        lv_obj_set_style_text_font(keyboard_cand_panel, &heiFont16_1, 0);

        keyboard_bg = lv_obj_create(lv_scr_act());
        lv_obj_set_size(keyboard_bg, 480, 24);
        lv_obj_align(keyboard_bg, LV_ALIGN_TOP_LEFT, 0, 248);
        lv_obj_set_style_border_width(keyboard_bg, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_radius(keyboard_bg, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_color(keyboard_bg, lv_color_hex(0x28536a), LV_STATE_DEFAULT);
        lv_obj_remove_style(keyboard_bg, 0, LV_PART_SCROLLBAR);


        LV_FONT_DECLARE(heiFont16_1);
        label_keyboard_return = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_keyboard_return, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_keyboard_return, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_keyboard_return, "返回");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_keyboard_return, "Return");
        }
        lv_obj_align(label_keyboard_return, LV_ALIGN_TOP_LEFT, 140, 252);

        LV_IMG_DECLARE(get_back);
        btn_keyboard_return = lv_imgbtn_create(lv_scr_act());
        lv_imgbtn_set_src(btn_keyboard_return, LV_IMGBTN_STATE_RELEASED, NULL, &get_back, NULL);
        lv_obj_set_size(btn_keyboard_return, get_back.header.w, get_back.header.h);
        lv_obj_align(btn_keyboard_return, LV_ALIGN_TOP_LEFT, 180, 250);
        lv_obj_add_event_cb(btn_keyboard_return, button_keyboard_return_QR_code_text_event_cb, LV_EVENT_CLICKED, NULL);

        LV_IMG_DECLARE(confirm);
        btn_keyboard_confirm = lv_imgbtn_create(lv_scr_act());
        lv_imgbtn_set_src(btn_keyboard_confirm, LV_IMGBTN_STATE_RELEASED, NULL, &confirm, NULL);
        lv_obj_set_size(btn_keyboard_confirm, get_back.header.w, get_back.header.h);
        lv_obj_align(btn_keyboard_confirm, LV_ALIGN_TOP_LEFT, 250, 250);
        lv_obj_add_event_cb(btn_keyboard_confirm, button_keyboard_confirm_QR_code_text_event_cb, LV_EVENT_CLICKED, NULL);

        LV_FONT_DECLARE(heiFont16_1);
        label_keyboard_confirm = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_keyboard_confirm, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_keyboard_confirm, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_keyboard_confirm, "确定");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_keyboard_confirm, "Confirm");
        }
        lv_obj_align(label_keyboard_confirm, LV_ALIGN_TOP_LEFT, 277, 252);
    }
}


static void button_qr_code_event_cb(lv_event_t* e)
{
    lv_event_code_t code;
    int i;
    lv_obj_t* obj = lv_event_get_target(e);
    code = lv_event_get_code(e);
    if (code == LV_EVENT_FOCUSED)
    {
        printf("button_typeface_event_cb LV_EVENT_FOCUSED\n");
        buzzer_enable = 1;
        lv_obj_t* label = lv_obj_get_child(obj, 0);
        lv_obj_set_style_bg_color(obj, lv_color_hex(0x7FFFD4), LV_PART_MAIN);

        for (i = 0; i < QR_CODE_NUMBER; i++)
        {
            if (strncmp(lv_label_get_text(label), QR_code_name[i], strlen(lv_label_get_text(label))) == 0)
            {
                break;
            }
        }
        QR_code_type = i;
        printf("QR_code_type=%d\n", QR_code_type);
    }
    else if (code == LV_EVENT_DEFOCUSED)
    {
        printf("button_typeface_event_cb LV_EVENT_DEFOCUSED\n");
        lv_obj_set_style_bg_color(obj, lv_color_hex(0xffffff), LV_PART_MAIN);
    }
}


static void button_QR_code_type_return_event_cb(lv_event_t* e)
{
    lv_event_code_t code;
    int i;
    code = lv_event_get_code(e);
    if (code == LV_EVENT_CLICKED)
    {
        printf("button_QR_code_type_return_event_cb\n");
        buzzer_enable = 1;

        lv_obj_del(typeface_head_bg);
        lv_obj_del(label_typeface_return);
        lv_obj_del(btn_typeface_return);
        lv_obj_del(btn_typeface_confirm);
        lv_obj_del(label_typeface_confirm);
        lv_obj_del(label_typeface_head);

        for (i = 0; i < QR_CODE_NUMBER; i++)
        {
            lv_obj_del(typeface_obj[i].obj_typeface_label);
            lv_obj_del(typeface_obj[i].obj_typeface_btn);
        }

        lv_obj_del(win_content_typeface);
        lv_obj_del(win_obj_typeface);
    }
}


static void button_QR_code_type_confirm_event_cb(lv_event_t* e)
{
    lv_event_code_t code;
    int i;
    code = lv_event_get_code(e);
    if (code == LV_EVENT_CLICKED)
    {
        printf("button_QR_code_type_confirm_event_cb\n");
        buzzer_enable = 1;
        lv_label_set_text(label_btn_addition_QR_code_QR, QR_code_name[QR_code_type]);
        lv_obj_del(typeface_head_bg);
        lv_obj_del(label_typeface_return);
        lv_obj_del(btn_typeface_return);
        lv_obj_del(btn_typeface_confirm);
        lv_obj_del(label_typeface_confirm);
        lv_obj_del(label_typeface_head);

        for (i = 0; i < QR_CODE_NUMBER; i++)
        {
            lv_obj_del(typeface_obj[i].obj_typeface_label);
            lv_obj_del(typeface_obj[i].obj_typeface_btn);
        }

        lv_obj_del(win_content_typeface);
        lv_obj_del(win_obj_typeface);
        QR_or_bar_code_flag = 0;

        update_preview_QR_bar_code();
    }
}


static void btn_addition_QR_code_QR_event_cb(lv_event_t* e)
{
    lv_event_code_t code;

    code = lv_event_get_code(e);
    int i;
    int size_wide = 100;
    int size_high = 24;

    if (code == LV_EVENT_CLICKED)
    {
        buzzer_enable = 1;
        typeface_head_bg = lv_obj_create(lv_scr_act());
        lv_obj_set_size(typeface_head_bg, 480, 24);
        lv_obj_align(typeface_head_bg, LV_ALIGN_TOP_LEFT, 0, 0);
        lv_obj_set_style_border_width(typeface_head_bg, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_border_color(typeface_head_bg, lv_color_hex(0x9bcd9b), LV_STATE_DEFAULT); /* 设置边框颜色 */
        lv_obj_set_style_radius(typeface_head_bg, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_color(typeface_head_bg, lv_color_hex(0x1fadd3), LV_STATE_DEFAULT);

        LV_FONT_DECLARE(heiFont16_1);
        label_typeface_head = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_typeface_head, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_typeface_head, lv_color_hex(0xFFFFFF), LV_STATE_DEFAULT);
        lv_obj_align(label_typeface_head, LV_ALIGN_TOP_LEFT, 200, 4);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_typeface_head,  "二维码类型");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_typeface_head, "Qr code type");
        }


        win_obj_typeface = lv_obj_create(lv_scr_act());
        lv_obj_align(win_obj_typeface, LV_ALIGN_TOP_LEFT, 0, 24);
        lv_obj_set_size(win_obj_typeface, 480, 224);
        lv_obj_set_style_bg_color(win_obj_typeface, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        lv_obj_set_style_bg_opa(win_obj_typeface, LV_OPA_COVER, LV_STATE_DEFAULT);
        lv_obj_set_style_border_width(win_obj_typeface, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_border_color(win_obj_typeface, lv_color_hex(0xcccccc), LV_STATE_DEFAULT); /* 设置边框颜色 */
        lv_obj_clear_flag(win_obj_typeface, LV_OBJ_FLAG_SCROLLABLE);
        lv_obj_set_style_radius(win_obj_typeface, 0, LV_STATE_DEFAULT); /* 设置圆角 */

        win_content_typeface = lv_obj_create(win_obj_typeface);
        lv_obj_set_size(win_content_typeface, 480, 224);
        lv_obj_align(win_content_typeface, LV_ALIGN_TOP_LEFT, 0, 0);
        lv_obj_set_style_bg_color(win_content_typeface, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        lv_obj_set_style_border_width(win_content_typeface, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_border_color(win_content_typeface, lv_color_hex(0xcccccc), LV_STATE_DEFAULT); /* 设置边框颜色 */
        lv_obj_clear_flag(win_content_typeface, LV_OBJ_FLAG_SCROLLABLE);
        lv_obj_set_style_radius(win_content_typeface, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_pad_all(win_content_typeface, 0, LV_STATE_DEFAULT);

        for (i = 0; i < QR_CODE_NUMBER; i++)
        {
            typeface_obj[i].obj_typeface_btn = lv_btn_create(win_content_typeface);
            lv_obj_set_size(typeface_obj[i].obj_typeface_btn, size_wide, size_high);
            lv_obj_align(typeface_obj[i].obj_typeface_btn, LV_ALIGN_TOP_LEFT, (i % 5 + 1) * 10 + (i % 5) * size_wide, (i / 5 + 1) * 5 + i / 5 * size_high);
            lv_obj_set_style_border_width(typeface_obj[i].obj_typeface_btn, 1, LV_PART_MAIN); /* 设置边框宽度 */
            lv_obj_set_style_border_color(typeface_obj[i].obj_typeface_btn, lv_color_hex(0x000000), LV_PART_MAIN); /* 设置边框颜色 */
            lv_obj_set_style_radius(typeface_obj[i].obj_typeface_btn, 0, LV_PART_MAIN); /* 设置圆角 */
            lv_obj_set_style_bg_color(typeface_obj[i].obj_typeface_btn, lv_color_hex(0xffffff), LV_PART_MAIN);
            lv_obj_set_style_shadow_width(typeface_obj[i].obj_typeface_btn, 0, LV_PART_MAIN);
            lv_obj_add_event_cb(typeface_obj[i].obj_typeface_btn, button_qr_code_event_cb, LV_EVENT_ALL, NULL);

            LV_FONT_DECLARE(heiFont16_1);
            typeface_obj[i].obj_typeface_label = lv_label_create(typeface_obj[i].obj_typeface_btn);
            lv_obj_set_style_text_font(typeface_obj[i].obj_typeface_label, &heiFont16_1, LV_STATE_DEFAULT);
            lv_label_set_text(typeface_obj[i].obj_typeface_label, QR_code_name[i]);
            lv_obj_center(typeface_obj[i].obj_typeface_label);
            lv_obj_set_style_text_color(typeface_obj[i].obj_typeface_label, lv_color_hex(0x000000), LV_STATE_DEFAULT);
        }

        LV_FONT_DECLARE(heiFont16_1);
        label_typeface_return = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_typeface_return, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_typeface_return, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_typeface_return,  "返回");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_typeface_return, "Return");
        }
        lv_obj_align(label_typeface_return, LV_ALIGN_TOP_LEFT, 140, 252);

        LV_IMG_DECLARE(get_back);
        btn_typeface_return = lv_imgbtn_create(lv_scr_act());
        lv_imgbtn_set_src(btn_typeface_return, LV_IMGBTN_STATE_RELEASED, NULL, &get_back, NULL);
        lv_obj_set_size(btn_typeface_return, get_back.header.w, get_back.header.h);
        lv_obj_align(btn_typeface_return, LV_ALIGN_TOP_LEFT, 180, 250);
        lv_obj_add_event_cb(btn_typeface_return, button_QR_code_type_return_event_cb, LV_EVENT_CLICKED, NULL);


        LV_IMG_DECLARE(confirm);
        btn_typeface_confirm = lv_imgbtn_create(lv_scr_act());
        lv_imgbtn_set_src(btn_typeface_confirm, LV_IMGBTN_STATE_RELEASED, NULL, &confirm, NULL);
        lv_obj_set_size(btn_typeface_confirm, get_back.header.w, get_back.header.h);
        lv_obj_align(btn_typeface_confirm, LV_ALIGN_TOP_LEFT, 250, 250);
        lv_obj_add_event_cb(btn_typeface_confirm, button_QR_code_type_confirm_event_cb, LV_EVENT_CLICKED, NULL);

        LV_FONT_DECLARE(heiFont16_1);
        label_typeface_confirm = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_typeface_confirm, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_typeface_confirm, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_typeface_confirm,  "确定");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_typeface_confirm, "Confirm");
        }
        lv_obj_align(label_typeface_confirm, LV_ALIGN_TOP_LEFT, 277, 252);
    }
}

static void button_QR_code_height_confirm_event_cb(lv_event_t* e)
{
    lv_event_code_t code;
    int i=0;
    char temp_str[12] = { 0 };
    code = lv_event_get_code(e);
    if (code == LV_EVENT_CLICKED)
    {
        printf("button_QR_code_height_confirm_event_cb\n");

        buzzer_enable = 1;

        const char* pwd_txt = lv_textarea_get_text(pwd_text_area);
        if ((pwd_txt != NULL))
        {
            i = atoi(pwd_txt);
            if (i > QR_BAR_MAX_HIGHT)
            {
                i = QR_BAR_MAX_HIGHT;
            }
            else if (i < QR_BAR_MIN_HIGHT)
            {
                i = QR_BAR_MIN_HIGHT;
            }
        }

        sprintf(temp_str, "%d", i);
        lv_label_set_text(label_btn_addition_QR_code_height, temp_str);

   
        lv_obj_del(typeface_head_bg);
        lv_obj_del(label_typeface_head);
        lv_obj_del(typeface_slider_bg);
        lv_obj_del(pwd_text_area);
        lv_obj_del(pwd_keyboard);

        lv_obj_del(label_typeface_return);
        lv_obj_del(btn_typeface_return);
        lv_obj_del(btn_typeface_confirm);
        lv_obj_del(label_typeface_confirm);
        update_preview_QR_bar_code();
    }
}




static void button_QR_code_height_return_event_cb(lv_event_t* e)
{
    lv_event_code_t code;
    code = lv_event_get_code(e);
    if (code == LV_EVENT_CLICKED)
    {
        printf("button_QR_code_height_return_event_cb\n");

        buzzer_enable = 1;
        lv_obj_del(typeface_head_bg);
        lv_obj_del(label_typeface_head);
        lv_obj_del(typeface_slider_bg);
        lv_obj_del(pwd_text_area);
        lv_obj_del(pwd_keyboard);

        lv_obj_del(label_typeface_return);
        lv_obj_del(btn_typeface_return);
        lv_obj_del(btn_typeface_confirm);
        lv_obj_del(label_typeface_confirm);
    }
}


static void btn_addition_QR_code_height_event_cb(lv_event_t* e)
{
    lv_event_code_t code;

    code = lv_event_get_code(e);

    if (code == LV_EVENT_CLICKED)
    {
        printf("btn_addition_QR_code_height_event_cb\n");
        buzzer_enable = 1;
        typeface_head_bg = lv_obj_create(lv_scr_act());
        lv_obj_set_size(typeface_head_bg, 480, 24);
        lv_obj_align(typeface_head_bg, LV_ALIGN_TOP_LEFT, 0, 0);
        lv_obj_set_style_border_width(typeface_head_bg, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_border_color(typeface_head_bg, lv_color_hex(0x9bcd9b), LV_STATE_DEFAULT); /* 设置边框颜色 */
        lv_obj_set_style_radius(typeface_head_bg, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_color(typeface_head_bg, lv_color_hex(0x1fadd3), LV_STATE_DEFAULT);

        LV_FONT_DECLARE(heiFont16_1);
        label_typeface_head = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_typeface_head, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_typeface_head, lv_color_hex(0xFFFFFF), LV_STATE_DEFAULT);
        lv_obj_align(label_typeface_head, LV_ALIGN_TOP_LEFT, 200, 4);

        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_typeface_head,  "高度");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_typeface_head, "Height");
        }

        typeface_slider_bg = lv_obj_create(lv_scr_act());
        lv_obj_set_size(typeface_slider_bg, 480, 224);
        lv_obj_align(typeface_slider_bg, LV_ALIGN_TOP_LEFT, 0, 24);
        lv_obj_set_style_border_width(typeface_slider_bg, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_border_color(typeface_slider_bg, lv_color_hex(0xaaaaaa), LV_STATE_DEFAULT); /* 设置边框颜色 */
        lv_obj_set_style_radius(typeface_slider_bg, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_color(typeface_slider_bg, lv_color_hex(0xaaaaaa), LV_STATE_DEFAULT);

        //数字键盘
        pwd_text_area = lv_textarea_create(lv_scr_act());
        if (pwd_text_area == NULL)
        {
            printf("[%s:%d] create pwd_text_area obj failed\n", __FUNCTION__, __LINE__);
            return;
        }

        // 密码框样式
        static lv_style_t pwd_text_style;
        lv_style_init(&pwd_text_style); // 初始化样式
        lv_style_set_radius(&pwd_text_style, 0); // 设置样式的圆角弧度
        lv_style_set_border_width(&pwd_text_style, 1); // 设置边框宽度
        lv_style_set_pad_all(&pwd_text_style, 0); // 设置样式的内部填充
        lv_style_set_text_font(&pwd_text_style, &lv_font_montserrat_18); //设置字体
        //lv_textarea_set_password_mode(pwd_text_area, true); // 文本区域开启密码模式
        lv_textarea_set_max_length(pwd_text_area, 3); // 设置可输入的文本的最大长度
        lv_obj_add_style(pwd_text_area, &pwd_text_style, 0); // 给btn_label添加样式
        lv_obj_set_size(pwd_text_area, 480, 50); // 设置对象大小
        lv_textarea_set_text(pwd_text_area, ""); // 文本框置空
        lv_obj_align(pwd_text_area, LV_ALIGN_TOP_LEFT, 0, 24);

        // 基于键盘背景对象创建密码校验提示标签
        hint_label = lv_label_create(lv_scr_act());
        if (hint_label == NULL)
        {
            printf("[%s:%d] create hint_label obj failed\n", __FUNCTION__, __LINE__);
            return;
        }

        // 密码提示文本样式
        static lv_style_t hint_label_style;
        lv_style_init(&hint_label_style); // 初始化样式
        lv_style_set_radius(&hint_label_style, 0); // 设置样式的圆角弧度
        lv_style_set_border_width(&hint_label_style, 0); //设置边框宽度
        lv_style_set_text_color(&hint_label_style, lv_palette_main(LV_PALETTE_RED));  // 字体颜色设置为红色
        lv_style_set_text_font(&hint_label_style, &lv_font_montserrat_12); //设置字体
        lv_label_set_long_mode(hint_label, LV_LABEL_LONG_SCROLL_CIRCULAR); // 长文本循环滚动
        lv_obj_add_style(hint_label, &hint_label_style, 0); // 给btn_label添加样式
        lv_obj_align(hint_label, LV_ALIGN_TOP_MID, 0, 110); // 顶部居中显示
        lv_label_set_text(hint_label, ""); // 设置文本内容

        // 基于键盘背景对象创建键盘对象
        pwd_keyboard = lv_keyboard_create(lv_scr_act());
        if (pwd_keyboard == NULL)
        {
            printf("[%s:%d] create pwd_keyboard obj failed\n", __FUNCTION__, __LINE__);
            return;
        }

        //键盘样式
        static lv_style_t pwd_kb_style;
        lv_style_init(&pwd_kb_style); // 初始化样式
        lv_style_set_radius(&pwd_kb_style, 5); // 设置样式的圆角弧度
        lv_style_set_border_width(&pwd_kb_style, 0); //设置边框宽度
        lv_style_set_bg_color(&pwd_kb_style, lv_color_hex(0xF98E2D));
        lv_style_set_text_opa(&pwd_kb_style, LV_OPA_COVER);
        lv_style_set_text_font(&pwd_kb_style, &lv_font_montserrat_20); //设置字体
        lv_obj_set_size(pwd_keyboard, 480, 174); //设置键盘大小
        lv_keyboard_set_mode(pwd_keyboard, LV_KEYBOARD_MODE_NUMBER_2); //设置键盘模式为数字键盘
        lv_keyboard_set_map(pwd_keyboard, LV_KEYBOARD_MODE_NUMBER_2, keyboard_map, keyboard_ctrl); // 设置键盘映射
        lv_keyboard_set_textarea(pwd_keyboard, pwd_text_area); // 键盘对象和文本框绑定
        lv_obj_add_style(pwd_keyboard, &pwd_kb_style, 0); // 添加样式
        lv_obj_align(pwd_keyboard, LV_ALIGN_TOP_LEFT, 0, 74);


        LV_FONT_DECLARE(heiFont16_1);
        label_typeface_return = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_typeface_return, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_typeface_return, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_typeface_return,  "返回");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_typeface_return, "Return");
        }
        lv_obj_align(label_typeface_return, LV_ALIGN_TOP_LEFT, 140, 252);

        LV_IMG_DECLARE(get_back);
        btn_typeface_return = lv_imgbtn_create(lv_scr_act());
        lv_imgbtn_set_src(btn_typeface_return, LV_IMGBTN_STATE_RELEASED, NULL, &get_back, NULL);
        lv_obj_set_size(btn_typeface_return, get_back.header.w, get_back.header.h);
        lv_obj_align(btn_typeface_return, LV_ALIGN_TOP_LEFT, 180, 250);
        lv_obj_add_event_cb(btn_typeface_return, button_QR_code_height_return_event_cb, LV_EVENT_CLICKED, NULL);


        LV_IMG_DECLARE(confirm);
        btn_typeface_confirm = lv_imgbtn_create(lv_scr_act());
        lv_imgbtn_set_src(btn_typeface_confirm, LV_IMGBTN_STATE_RELEASED, NULL, &confirm, NULL);
        lv_obj_set_size(btn_typeface_confirm, get_back.header.w, get_back.header.h);
        lv_obj_align(btn_typeface_confirm, LV_ALIGN_TOP_LEFT, 250, 250);
        lv_obj_add_event_cb(btn_typeface_confirm, button_QR_code_height_confirm_event_cb, LV_EVENT_CLICKED, NULL);

        LV_FONT_DECLARE(heiFont16_1);
        label_typeface_confirm = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_typeface_confirm, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_typeface_confirm, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_typeface_confirm,  "确定");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_typeface_confirm, "Confirm");
        }
        lv_obj_align(label_typeface_confirm, LV_ALIGN_TOP_LEFT, 277, 252);
    }
}


static void sw_addition_QR_code_border_event_cb(lv_event_t* e)
{
    lv_event_code_t code = lv_event_get_code(e);
    lv_obj_t* obj = lv_event_get_target(e);
    if (code == LV_EVENT_VALUE_CHANGED)
    {
        printf("State: %s\n", lv_obj_has_state(obj, LV_STATE_CHECKED) ? "On" : "Off");
        buzzer_enable = 1;
        update_preview_QR_bar_code();
    }
}


static void button_bar_code_event_cb(lv_event_t* e)
{
    lv_event_code_t code;
    int i;
    lv_obj_t* obj = lv_event_get_target(e);
    code = lv_event_get_code(e);
    if (code == LV_EVENT_FOCUSED)
    {
        printf("button_typeface_event_cb LV_EVENT_FOCUSED\n");
        buzzer_enable = 1;
        lv_obj_t* label = lv_obj_get_child(obj, 0);
        lv_obj_set_style_bg_color(obj, lv_color_hex(0x7FFFD4), LV_PART_MAIN);

        for (i = 0; i < BAR_CODE_NUMBER; i++)
        {
            if (strncmp(lv_label_get_text(label), bar_code_name[i], strlen(lv_label_get_text(label))) == 0)
            {
                break;
            }
        }
        bar_code_type = i;
        printf("QR_code_type=%d\n", bar_code_type);
    }
    else if (code == LV_EVENT_DEFOCUSED)
    {
        printf("button_typeface_event_cb LV_EVENT_DEFOCUSED\n");
        lv_obj_set_style_bg_color(obj, lv_color_hex(0xffffff), LV_PART_MAIN);
    }
}


static void button_bar_code_type_return_event_cb(lv_event_t* e)
{
    lv_event_code_t code;
    int i;
    code = lv_event_get_code(e);
    if (code == LV_EVENT_CLICKED)
    {
        printf("button_bar_code_type_return_event_cb\n");

        buzzer_enable = 1;

        lv_obj_del(typeface_head_bg);
        lv_obj_del(label_typeface_return);
        lv_obj_del(btn_typeface_return);
        lv_obj_del(btn_typeface_confirm);
        lv_obj_del(label_typeface_confirm);
        lv_obj_del(label_typeface_head);

        for (i = 0; i < QR_CODE_NUMBER; i++)
        {
            lv_obj_del(typeface_obj[i].obj_typeface_label);
            lv_obj_del(typeface_obj[i].obj_typeface_btn);
        }

        lv_obj_del(win_content_typeface);
        lv_obj_del(win_obj_typeface);
    }
}


static void button_bar_code_type_confirm_event_cb(lv_event_t* e)
{
    lv_event_code_t code;
    int i;
    code = lv_event_get_code(e);
    if (code == LV_EVENT_CLICKED)
    {
        printf("button_bar_code_type_confirm_event_cb\n");

        buzzer_enable = 1;

        lv_label_set_text(label_btn_addition_QR_code_bar_code, bar_code_name[bar_code_type]);
        lv_obj_del(typeface_head_bg);
        lv_obj_del(label_typeface_return);
        lv_obj_del(btn_typeface_return);
        lv_obj_del(btn_typeface_confirm);
        lv_obj_del(label_typeface_confirm);
        lv_obj_del(label_typeface_head);

        for (i = 0; i < QR_CODE_NUMBER; i++)
        {
            lv_obj_del(typeface_obj[i].obj_typeface_label);
            lv_obj_del(typeface_obj[i].obj_typeface_btn);
        }

        lv_obj_del(win_content_typeface);
        lv_obj_del(win_obj_typeface);
        QR_or_bar_code_flag = 1;
        update_preview_QR_bar_code();
    }
}


static void btn_addition_QR_code_bar_code_event_cb(lv_event_t* e)
{
    lv_event_code_t code;

    code = lv_event_get_code(e);
    int i;
    int size_wide = 84;
    int size_high = 24;


    if (code == LV_EVENT_CLICKED)
    {
        buzzer_enable = 1;
        typeface_head_bg = lv_obj_create(lv_scr_act());
        lv_obj_set_size(typeface_head_bg, 480, 24);
        lv_obj_align(typeface_head_bg, LV_ALIGN_TOP_LEFT, 0, 0);
        lv_obj_set_style_border_width(typeface_head_bg, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_border_color(typeface_head_bg, lv_color_hex(0x9bcd9b), LV_STATE_DEFAULT); /* 设置边框颜色 */
        lv_obj_set_style_radius(typeface_head_bg, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_color(typeface_head_bg, lv_color_hex(0x1fadd3), LV_STATE_DEFAULT);

        LV_FONT_DECLARE(heiFont16_1);
        label_typeface_head = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_typeface_head, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_typeface_head, lv_color_hex(0xFFFFFF), LV_STATE_DEFAULT);
        lv_obj_align(label_typeface_head, LV_ALIGN_TOP_LEFT, 200, 4);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_typeface_head,  "条形码类型");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_typeface_head, "Barcode type");
        }

        win_obj_typeface = lv_obj_create(lv_scr_act());
        lv_obj_align(win_obj_typeface, LV_ALIGN_TOP_LEFT, 0, 24);
        lv_obj_set_size(win_obj_typeface, 480, 224);
        lv_obj_set_style_bg_color(win_obj_typeface, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        lv_obj_set_style_bg_opa(win_obj_typeface, LV_OPA_COVER, LV_STATE_DEFAULT);
        lv_obj_set_style_border_width(win_obj_typeface, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_border_color(win_obj_typeface, lv_color_hex(0xcccccc), LV_STATE_DEFAULT); /* 设置边框颜色 */
        lv_obj_clear_flag(win_obj_typeface, LV_OBJ_FLAG_SCROLLABLE);
        lv_obj_set_style_radius(win_obj_typeface, 0, LV_STATE_DEFAULT); /* 设置圆角 */

        win_content_typeface = lv_obj_create(win_obj_typeface);
        lv_obj_set_size(win_content_typeface, 480, 224);
        lv_obj_align(win_content_typeface, LV_ALIGN_TOP_LEFT, 0, 0);
        lv_obj_set_style_bg_color(win_content_typeface, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        lv_obj_set_style_border_width(win_content_typeface, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_border_color(win_content_typeface, lv_color_hex(0xcccccc), LV_STATE_DEFAULT); /* 设置边框颜色 */
        lv_obj_clear_flag(win_content_typeface, LV_OBJ_FLAG_SCROLLABLE);
        lv_obj_set_style_radius(win_content_typeface, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_pad_all(win_content_typeface, 0, LV_STATE_DEFAULT);

        for (i = 0; i < BAR_CODE_NUMBER; i++)
        {
            typeface_obj[i].obj_typeface_btn = lv_btn_create(win_content_typeface);
            lv_obj_set_size(typeface_obj[i].obj_typeface_btn, size_wide, size_high);
            lv_obj_align(typeface_obj[i].obj_typeface_btn, LV_ALIGN_TOP_LEFT, (i % 5 + 1) * 5 + (i % 5) * size_wide, (i / 5 + 1) * 5 + i / 5 * size_high);
            lv_obj_set_style_border_width(typeface_obj[i].obj_typeface_btn, 1, LV_PART_MAIN); /* 设置边框宽度 */
            lv_obj_set_style_border_color(typeface_obj[i].obj_typeface_btn, lv_color_hex(0x000000), LV_PART_MAIN); /* 设置边框颜色 */
            lv_obj_set_style_radius(typeface_obj[i].obj_typeface_btn, 0, LV_PART_MAIN); /* 设置圆角 */
            lv_obj_set_style_bg_color(typeface_obj[i].obj_typeface_btn, lv_color_hex(0xffffff), LV_PART_MAIN);
            lv_obj_set_style_shadow_width(typeface_obj[i].obj_typeface_btn, 0, LV_PART_MAIN);
            lv_obj_add_event_cb(typeface_obj[i].obj_typeface_btn, button_bar_code_event_cb, LV_EVENT_ALL, NULL);

            LV_FONT_DECLARE(heiFont16_1);
            typeface_obj[i].obj_typeface_label = lv_label_create(typeface_obj[i].obj_typeface_btn);
            lv_obj_set_style_text_font(typeface_obj[i].obj_typeface_label, &heiFont16_1, LV_STATE_DEFAULT);
            lv_label_set_text(typeface_obj[i].obj_typeface_label, bar_code_name[i]);
            lv_obj_center(typeface_obj[i].obj_typeface_label);
            lv_obj_set_style_text_color(typeface_obj[i].obj_typeface_label, lv_color_hex(0x000000), LV_STATE_DEFAULT);
        }


        LV_FONT_DECLARE(heiFont16_1);
        label_typeface_return = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_typeface_return, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_typeface_return, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_typeface_return,  "返回");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_typeface_return, "Return");
        }
        lv_obj_align(label_typeface_return, LV_ALIGN_TOP_LEFT, 140, 252);

        LV_IMG_DECLARE(get_back);
        btn_typeface_return = lv_imgbtn_create(lv_scr_act());
        lv_imgbtn_set_src(btn_typeface_return, LV_IMGBTN_STATE_RELEASED, NULL, &get_back, NULL);
        lv_obj_set_size(btn_typeface_return, get_back.header.w, get_back.header.h);
        lv_obj_align(btn_typeface_return, LV_ALIGN_TOP_LEFT, 180, 250);
        lv_obj_add_event_cb(btn_typeface_return, button_bar_code_type_return_event_cb, LV_EVENT_CLICKED, NULL);


        LV_IMG_DECLARE(confirm);
        btn_typeface_confirm = lv_imgbtn_create(lv_scr_act());
        lv_imgbtn_set_src(btn_typeface_confirm, LV_IMGBTN_STATE_RELEASED, NULL, &confirm, NULL);
        lv_obj_set_size(btn_typeface_confirm, get_back.header.w, get_back.header.h);
        lv_obj_align(btn_typeface_confirm, LV_ALIGN_TOP_LEFT, 250, 250);
        lv_obj_add_event_cb(btn_typeface_confirm, button_bar_code_type_confirm_event_cb, LV_EVENT_CLICKED, NULL);

        LV_FONT_DECLARE(heiFont16_1);
        label_typeface_confirm = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_typeface_confirm, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_typeface_confirm, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_typeface_confirm,  "确定");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_typeface_confirm, "Confirm");
        }
        lv_obj_align(label_typeface_confirm, LV_ALIGN_TOP_LEFT, 277, 252);
    }
}


static void button_QR_code_width_confirm_event_cb(lv_event_t* e)
{
    lv_event_code_t code;
    int i=0;
    char temp_str[12] = { 0 };
    code = lv_event_get_code(e);
    if (code == LV_EVENT_CLICKED)
    {
        printf("button_QR_code_width_confirm_event_cb\n");
        buzzer_enable = 1;
        const char* pwd_txt = lv_textarea_get_text(pwd_text_area);
        if ((pwd_txt != NULL))
        {
            i = atoi(pwd_txt);
            if (i > 100)
            {
                i = 100;
            }
            else if (i < 50)
            {
                i = 50;
            }
        }

        sprintf(temp_str, "%d", i);
        lv_label_set_text(label_btn_addition_QR_code_width, temp_str);

      
        lv_obj_del(typeface_head_bg);
        lv_obj_del(label_typeface_head);
        lv_obj_del(typeface_slider_bg);
        lv_obj_del(pwd_text_area);
        lv_obj_del(pwd_keyboard);

        lv_obj_del(label_typeface_return);
        lv_obj_del(btn_typeface_return);
        lv_obj_del(btn_typeface_confirm);
        lv_obj_del(label_typeface_confirm);
        update_preview_QR_bar_code();
    }
}



static void button_QR_code_width_return_event_cb(lv_event_t* e)
{
    lv_event_code_t code;
    code = lv_event_get_code(e);
    if (code == LV_EVENT_CLICKED)
    {
        printf("button_QR_code_width_return_event_cb\n");
        buzzer_enable = 1;

        lv_obj_del(typeface_head_bg);
        lv_obj_del(label_typeface_head);
        lv_obj_del(typeface_slider_bg);
        lv_obj_del(pwd_text_area);
        lv_obj_del(pwd_keyboard);

        lv_obj_del(label_typeface_return);
        lv_obj_del(btn_typeface_return);
        lv_obj_del(btn_typeface_confirm);
        lv_obj_del(label_typeface_confirm);
    }
}



static void btn_addition_QR_code_width_event_cb(lv_event_t* e)
{
    lv_event_code_t code;

    code = lv_event_get_code(e);

    if (code == LV_EVENT_CLICKED)
    {
        printf("btn_addition_QR_code_width_event_cb\n");
        buzzer_enable = 1;
        typeface_head_bg = lv_obj_create(lv_scr_act());
        lv_obj_set_size(typeface_head_bg, 480, 24);
        lv_obj_align(typeface_head_bg, LV_ALIGN_TOP_LEFT, 0, 0);
        lv_obj_set_style_border_width(typeface_head_bg, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_border_color(typeface_head_bg, lv_color_hex(0x9bcd9b), LV_STATE_DEFAULT); /* 设置边框颜色 */
        lv_obj_set_style_radius(typeface_head_bg, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_color(typeface_head_bg, lv_color_hex(0x1fadd3), LV_STATE_DEFAULT);

        LV_FONT_DECLARE(heiFont16_1);
        label_typeface_head = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_typeface_head, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_typeface_head, lv_color_hex(0xFFFFFF), LV_STATE_DEFAULT);
        lv_obj_align(label_typeface_head, LV_ALIGN_TOP_LEFT, 200, 4);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_typeface_head,  "宽度");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_typeface_head, "Width");
        }

        typeface_slider_bg = lv_obj_create(lv_scr_act());
        lv_obj_set_size(typeface_slider_bg, 480, 224);
        lv_obj_align(typeface_slider_bg, LV_ALIGN_TOP_LEFT, 0, 24);
        lv_obj_set_style_border_width(typeface_slider_bg, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_border_color(typeface_slider_bg, lv_color_hex(0xaaaaaa), LV_STATE_DEFAULT); /* 设置边框颜色 */
        lv_obj_set_style_radius(typeface_slider_bg, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_color(typeface_slider_bg, lv_color_hex(0xaaaaaa), LV_STATE_DEFAULT);

        //数字键盘
        pwd_text_area = lv_textarea_create(lv_scr_act());
        if (pwd_text_area == NULL)
        {
            printf("[%s:%d] create pwd_text_area obj failed\n", __FUNCTION__, __LINE__);
            return;
        }

        // 密码框样式
        static lv_style_t pwd_text_style;
        lv_style_init(&pwd_text_style); // 初始化样式
        lv_style_set_radius(&pwd_text_style, 0); // 设置样式的圆角弧度
        lv_style_set_border_width(&pwd_text_style, 1); // 设置边框宽度
        lv_style_set_pad_all(&pwd_text_style, 0); // 设置样式的内部填充
        lv_style_set_text_font(&pwd_text_style, &lv_font_montserrat_18); //设置字体
        //lv_textarea_set_password_mode(pwd_text_area, true); // 文本区域开启密码模式
        lv_textarea_set_max_length(pwd_text_area, 3); // 设置可输入的文本的最大长度
        lv_obj_add_style(pwd_text_area, &pwd_text_style, 0); // 给btn_label添加样式
        lv_obj_set_size(pwd_text_area, 480, 50); // 设置对象大小
        lv_textarea_set_text(pwd_text_area, ""); // 文本框置空
        lv_obj_align(pwd_text_area, LV_ALIGN_TOP_LEFT, 0, 24);

        // 基于键盘背景对象创建密码校验提示标签
        hint_label = lv_label_create(lv_scr_act());
        if (hint_label == NULL)
        {
            printf("[%s:%d] create hint_label obj failed\n", __FUNCTION__, __LINE__);
            return;
        }

        // 密码提示文本样式
        static lv_style_t hint_label_style;
        lv_style_init(&hint_label_style); // 初始化样式
        lv_style_set_radius(&hint_label_style, 0); // 设置样式的圆角弧度
        lv_style_set_border_width(&hint_label_style, 0); //设置边框宽度
        lv_style_set_text_color(&hint_label_style, lv_palette_main(LV_PALETTE_RED));  // 字体颜色设置为红色
        lv_style_set_text_font(&hint_label_style, &lv_font_montserrat_12); //设置字体
        lv_label_set_long_mode(hint_label, LV_LABEL_LONG_SCROLL_CIRCULAR); // 长文本循环滚动
        lv_obj_add_style(hint_label, &hint_label_style, 0); // 给btn_label添加样式
        lv_obj_align(hint_label, LV_ALIGN_TOP_MID, 0, 110); // 顶部居中显示
        lv_label_set_text(hint_label, ""); // 设置文本内容

        // 基于键盘背景对象创建键盘对象
        pwd_keyboard = lv_keyboard_create(lv_scr_act());
        if (pwd_keyboard == NULL)
        {
            printf("[%s:%d] create pwd_keyboard obj failed\n", __FUNCTION__, __LINE__);
            return;
        }

        //键盘样式
        static lv_style_t pwd_kb_style;
        lv_style_init(&pwd_kb_style); // 初始化样式
        lv_style_set_radius(&pwd_kb_style, 5); // 设置样式的圆角弧度
        lv_style_set_border_width(&pwd_kb_style, 0); //设置边框宽度
        lv_style_set_bg_color(&pwd_kb_style, lv_color_hex(0xF98E2D));
        lv_style_set_text_opa(&pwd_kb_style, LV_OPA_COVER);
        lv_style_set_text_font(&pwd_kb_style, &lv_font_montserrat_20); //设置字体
        lv_obj_set_size(pwd_keyboard, 480, 174); //设置键盘大小
        lv_keyboard_set_mode(pwd_keyboard, LV_KEYBOARD_MODE_NUMBER_2); //设置键盘模式为数字键盘
        lv_keyboard_set_map(pwd_keyboard, LV_KEYBOARD_MODE_NUMBER_2, keyboard_map, keyboard_ctrl); // 设置键盘映射
        lv_keyboard_set_textarea(pwd_keyboard, pwd_text_area); // 键盘对象和文本框绑定
        lv_obj_add_style(pwd_keyboard, &pwd_kb_style, 0); // 添加样式
        lv_obj_align(pwd_keyboard, LV_ALIGN_TOP_LEFT, 0, 74);


        LV_FONT_DECLARE(heiFont16_1);
        label_typeface_return = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_typeface_return, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_typeface_return, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_typeface_return, "返回");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_typeface_return, "Return");
        }
        lv_obj_align(label_typeface_return, LV_ALIGN_TOP_LEFT, 140, 252);

        LV_IMG_DECLARE(get_back);
        btn_typeface_return = lv_imgbtn_create(lv_scr_act());
        lv_imgbtn_set_src(btn_typeface_return, LV_IMGBTN_STATE_RELEASED, NULL, &get_back, NULL);
        lv_obj_set_size(btn_typeface_return, get_back.header.w, get_back.header.h);
        lv_obj_align(btn_typeface_return, LV_ALIGN_TOP_LEFT, 180, 250);
        lv_obj_add_event_cb(btn_typeface_return, button_QR_code_width_return_event_cb, LV_EVENT_CLICKED, NULL);


        LV_IMG_DECLARE(confirm);
        btn_typeface_confirm = lv_imgbtn_create(lv_scr_act());
        lv_imgbtn_set_src(btn_typeface_confirm, LV_IMGBTN_STATE_RELEASED, NULL, &confirm, NULL);
        lv_obj_set_size(btn_typeface_confirm, get_back.header.w, get_back.header.h);
        lv_obj_align(btn_typeface_confirm, LV_ALIGN_TOP_LEFT, 250, 250);
        lv_obj_add_event_cb(btn_typeface_confirm, button_QR_code_width_confirm_event_cb, LV_EVENT_CLICKED, NULL);

        LV_FONT_DECLARE(heiFont16_1);
        label_typeface_confirm = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_typeface_confirm, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_typeface_confirm, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_typeface_confirm, "确定");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_typeface_confirm, "Confirm");
        }
        lv_obj_align(label_typeface_confirm, LV_ALIGN_TOP_LEFT, 277, 252);
    }
}



static void btn_addition_QR_code_return_event_cb(lv_event_t* e)
{
    lv_event_code_t code;
    code = lv_event_get_code(e);
    if (code == LV_EVENT_CLICKED)
    {
        printf("btn_addition_QR_code_return_event_cb\n");
        buzzer_enable = 1;
        lv_obj_del(btn_addition_QR_code_confirm);
        lv_obj_del(label_addition_QR_code_confirm);
        lv_obj_del(btn_addition_QR_code_return);
        lv_obj_del(label_addition_QR_code_return);
        lv_obj_del(obj_addition_QR_code_bottom_bg);
        lv_obj_del(sw_addition_QR_code_border);
        lv_obj_del(label_addition_QR_code_border);
        lv_obj_del(img_addition_QR_code_border);
        lv_obj_del(label_btn_addition_QR_code_width);
        lv_obj_del(btn_addition_QR_code_width);
        lv_obj_del(label_addition_QR_code_width);
        lv_obj_del(img_addition_QR_code_width);
        lv_obj_del(label_btn_addition_QR_code_bar_code);
        lv_obj_del(btn_addition_QR_code_bar_code);
        lv_obj_del(label_addition_QR_code_bar_code);
        lv_obj_del(img_addition_QR_code_bar_code);
        lv_obj_del(sw_addition_QR_code_figure);
        lv_obj_del(label_addition_QR_code_figure);
        lv_obj_del(img_addition_QR_code_figure);
        lv_obj_del(label_btn_addition_QR_code_height);
        lv_obj_del(btn_addition_QR_code_height);
        lv_obj_del(label_addition_QR_code_height);
        lv_obj_del(img_addition_QR_code_height);
        lv_obj_del(label_btn_addition_QR_code_QR);
        lv_obj_del(btn_addition_QR_code_QR);
        lv_obj_del(label_addition_QR_code_QR);
        lv_obj_del(img_addition_QR_code);
        lv_obj_del(label_btn_addition_QR_code_text);
        lv_obj_del(label_btn_addition_QR_code_text_1);
        lv_obj_del(btn_addition_QR_code_text);
        lv_obj_del(label_addition_QR_code_text);
        lv_obj_del(img_addition_QR_code_text);
        lv_obj_del(addition_QR_code_middle_bg_1);
        lv_obj_del(addition_QR_code_middle_bg);
        lv_obj_del(label_addition_QR_code_head);
        lv_obj_del(addition_QR_code_head_bg);

        //删除添加界面
        lv_obj_del(img_addition_bg);
        lv_obj_del(btn_addition_text);
        lv_obj_del(label_btn_addition_text);
        lv_obj_del(btn_addition_date);
        lv_obj_del(label_btn_addition_date);
        lv_obj_del(btn_addition_picture);
        lv_obj_del(label_btn_addition_picture);
        lv_obj_del(btn_addition_QR_code);
        lv_obj_del(label_btn_addition_QR_code);
        lv_obj_del(btn_addition_bar_code);
        lv_obj_del(label_btn_addition_bar_code);
        lv_obj_del(btn_addition_count);
        lv_obj_del(label_btn_addition_count);
        lv_obj_del(btn_addition_subsection);
        lv_obj_del(label_btn_addition_subsection);
        lv_obj_del(btn_addition_symbol);
        lv_obj_del(label_btn_addition_symbol);
        lv_obj_del(btn_addition_icon);
        lv_obj_del(label_btn_addition_icon);
        lv_obj_del(btn_addition_more_functions);
        lv_obj_del(label_btn_addition_more_functions);
        lv_obj_del(btn_addition_return);
    }
}




int check_string_format(const char *str) {
    // 定义正则表达式：
    // ^\\(01\\)[0-9]{14}\\([0-9]{4}\\)[0-9]{6}\\([0-9]{2}\\)[0-9]{6}$
    // 解释：
    // ^ 开头
    // \\(01\\) 固定匹配 (01)
    // [0-9]{14} 匹配 14 位数字，如 98898765432106
    // \\([0-9]{4}\\) 匹配 4 位数字的括号部分，如 (3202)
    // [0-9]{6} 匹配 6 位数字，如 012345
    // \\([0-9]{2}\\) 匹配 2 位数字的括号部分，如 (15)
    // [0-9]{6} 匹配 6 位数字，如 991231
    // $ 结尾
    const char *pattern = "^\\(01\\)[0-9]{14}\\([0-9]{4}\\)[0-9]{6}\\([0-9]{2}\\)[0-9]{6}$";
    
    regex_t regex;
    int ret;
    
    // 编译正则表达式
    if (regcomp(&regex, pattern, REG_EXTENDED) != 0) {
        fprintf(stderr, "无法编译正则表达式\n");
        return -1;
    }
    
    // 执行匹配
    ret = regexec(&regex, str, 0, NULL, 0);
    regfree(&regex); // 释放正则表达式
    
    if (ret == 0) {
        return 0; // 匹配成功
    } else {
        return -1; // 匹配失败
    }
}




static void btn_addition_QR_code_confirm_event_cb(lv_event_t* e)
{
    lv_event_code_t code;
    int win_content_child_num = 0;
    struct zint_symbol* my_symbol = NULL;
    int str_len;
    //int width_len;
    int height_len;
    int width, height, channels;
    unsigned char* pdata = NULL; 
    unsigned char* pnew_data = NULL;
    lv_obj_t* img = NULL;
    char bmp_name[100] = {0};
    char bmp_name_1[128] = {0};
    unsigned char *data = NULL;
    int success;

    code = lv_event_get_code(e);
    if (code == LV_EVENT_CLICKED)
    {
        printf("btn_addition_QR_code_confirm_event_cb\n");
        buzzer_enable = 1;
        //在主界面显示二维码
        str_len = strlen(lv_label_get_text(label_btn_addition_QR_code_text));
        printf("str_len=%u\n\r", str_len);

        win_content_child_num = lv_obj_get_child_cnt(win_content);

        printf("win_content_child_num=%u\n\r", win_content_child_num);

        if ((str_len > 0) && (win_content_child_num < NEW_TEXT_MAX_NUMBER))
        {
            lv_obj_t* temp_obj = lv_obj_create(win_content);

            lv_obj_set_style_bg_opa(temp_obj, LV_OPA_TRANSP, 0);
            lv_obj_set_style_border_width(temp_obj, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */

            lv_obj_add_event_cb(temp_obj, drag_event_handler, LV_EVENT_PRESSING, NULL);
            lv_obj_add_event_cb(temp_obj, drag_event_handler, LV_EVENT_FOCUSED, NULL);
            lv_obj_add_event_cb(temp_obj, drag_event_handler, LV_EVENT_DEFOCUSED, NULL);
            lv_obj_clear_flag(temp_obj, LV_OBJ_FLAG_SCROLLABLE);

            printf("QR_or_bar_code_flag=%u\n\r",QR_or_bar_code_flag);
            printf("QR_code_type=%u\n\r",QR_code_type);
            printf("bar_code_type=%u\n\r",bar_code_type);

            memcpy(data_structure[win_content_child_num].data.qr_bar.text,lv_label_get_text(label_btn_addition_QR_code_text),strlen(lv_label_get_text(label_btn_addition_QR_code_text))+ 1);
    
            if (QR_or_bar_code_flag == 0)
            {
                my_symbol = ZBarcode_Create();

                data_structure[win_content_child_num].data.qr_bar.type = QR_or_bar_code_flag;
                data_structure[win_content_child_num].data.qr_bar.symbology = QR_code_type;
                data_structure[win_content_child_num].type = TYPE_QR;

                switch (QR_code_type)
                {
                    case 0:
                    default:

                        height_len = atoi(lv_label_get_text(label_btn_addition_QR_code_height));

                        if (height_len > QR_BAR_MAX_HIGHT)
                        {
                            height_len = QR_BAR_MAX_HIGHT;
                        }
                        else if (height_len < QR_BAR_MIN_HIGHT)
                        {
                            height_len = QR_BAR_MIN_HIGHT;
                        }

                        printf("height_len=%u\n\r",height_len);

                        data_structure[win_content_child_num].data.qr_bar.height = height_len;

                        my_symbol->symbology = BARCODE_QRCODE;
                        my_symbol->scale = 1;
                        my_symbol->option_1 = 2; //容错级别

                        if(str_len < 20)
                        {
                            my_symbol->option_2 = 1;
                        }
                        else if(str_len < 38)
                        {
                            my_symbol->option_2 = 2;
                        }
                        else if(str_len < 61)
                        {
                            my_symbol->option_2 = 3;
                        }
                        else if(str_len < 90)
                        {
                            my_symbol->option_2 = 4;
                        }
                        else if(str_len < 122)
                        {
                            my_symbol->option_2 = 5;
                        }

                        memcpy(data_structure[win_content_child_num].data.qr_bar.text,lv_label_get_text(label_btn_addition_QR_code_text),str_len);
#if 0
                        if(lv_obj_has_state(sw_addition_QR_code_figure, LV_STATE_CHECKED) == 1)
                        {
                            my_symbol->show_hrt = 1;
                            memcpy(my_symbol->text,lv_label_get_text(label_btn_addition_QR_code_text),strlen(lv_label_get_text(label_btn_addition_QR_code_text))+ 1);
                            //figure_borders |= 0x01;
                            data_structure[win_content_child_num].data.qr_bar.figure = 1;
                        }
#endif

                        if (lv_obj_has_state(sw_addition_QR_code_border, LV_STATE_CHECKED) == 1)
                        {
                            my_symbol->output_options = BARCODE_BOX;
                            my_symbol->whitespace_width = 3;
                            my_symbol-> whitespace_height = 3; 
                            my_symbol-> border_width = 2;   /* Size of border in X-dimensions */
                            //figure_borders |= 0x02;
                            data_structure[win_content_child_num].data.qr_bar.borders = 1;
                        }

                        strcpy(my_symbol->outfile, "out.bmp");
                        ZBarcode_Encode(my_symbol, (unsigned char *)lv_label_get_text(label_btn_addition_QR_code_text), 0);

                        ZBarcode_Print(my_symbol, 0);
                        //ZBarcode_Delete(my_symbol);

                        pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                        printf("width=%d\n\r", width);
                        printf("height=%d\n\r", height);
                        printf("channels=%d\n\r", channels);
            
                        my_symbol->scale = (float)((float)150.0*(float)height_len/(float)QR_BAR_MAX_HIGHT/(float)width);
                         //  my_symbol->scale = (float)height_len/(float)height;
                        printf("scale=%f\n\r",(double)my_symbol->scale);
   
                        strcpy(my_symbol->outfile, "out.bmp");
                        ZBarcode_Encode(my_symbol, (unsigned char *)lv_label_get_text(label_btn_addition_QR_code_text), 0);

                        ZBarcode_Print(my_symbol, 0);
                        ZBarcode_Delete(my_symbol);
                        stbi_image_free(pdata);
                
                        pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                        printf("width=%d\n\r", width);
                        printf("height=%d\n\r", height);
                        printf("channels=%d\n\r", channels);

                        lv_obj_set_size(temp_obj, width, height);

                        pnew_data = (unsigned char*)lv_mem_alloc(width * height * 4); // 为32位数据分配内存
                        if (!pnew_data) 
                        {
                            fprintf(stderr, "Memory allocation failed\n");
                            stbi_image_free(pdata);
                            return;
                        }
                        else
                        {
                            printf("lv_mem_alloc ok\n\r");
                        }

                        for (int y = 0; y < height; y++) 
                        {
                            for (int x = 0; x < width; x++) 
                            {
                                int index = y * width + x; // 计算当前像素在原始数据中的索引
                                unsigned char color = pdata[index]; // 获取当前像素的灰度值（0或255）
                                // 映射到RGBA值

                                if (color == 0)
                                {
                                    pnew_data[index * 4 + 0] = 0; // R
                                    pnew_data[index * 4 + 1] = 0; // G
                                    pnew_data[index * 4 + 2] = 0; // B
                                    pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                                }
                                else
                                {
                                    pnew_data[index * 4 + 0] = 255; // R
                                    pnew_data[index * 4 + 1] = 255; // G
                                    pnew_data[index * 4 + 2] = 255; // B
                                    pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                                }
                            }
                        }
                        sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.bmp",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                        stbi_write_bmp(bmp_name, width, height, 4, pnew_data);
                        // 使用data进行图像处理...
                        lv_mem_free(pnew_data);
                        stbi_image_free(pdata); // 释放内存

                        data = stbi_load(bmp_name, &width, &height, &channels, 0);
                        if (!data) 
                        {
                            printf("错误：无法加载图片 %s\n", bmp_name);
                        }
                        printf("图片加载成功：%dx%d，%d 通道\n", width, height, channels);

                        sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.png",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                        
                        success = stbi_write_png(bmp_name, width, height, channels, data, width * channels);
                        if (!success) 
                        {
                            printf("错误：保存 PNG 失败\n");
                        } 
                        else
                        {
                            printf("PNG 保存成功：%s\n", bmp_name);
                        }

                        // 释放内存
                        stbi_image_free(data);

                        //显示图像
                        img = lv_img_create(temp_obj);
                        sprintf(bmp_name_1,"A:%s",bmp_name);
                        lv_img_set_src(img, bmp_name_1);
                        lv_obj_center(img);

                        data_structure[win_content_child_num].data.qr_bar.size  = 256;

                        break;
                    case 1:
                      
#if 0
                        width_len = atoi(lv_label_get_text(label_btn_addition_QR_code_width));

                        if (width_len > 100)
                        {
                            width_len = 100;
                        }
                        else if (width_len < 50)
                        {
                            width_len = 50;
                        }

                        printf("width_len=%u\n\r",width_len);

                        data_structure[win_content_child_num].data.qr_bar.width = width_len;
#endif
                        my_symbol->symbology = BARCODE_PDF417;

                        height_len = atoi(lv_label_get_text(label_btn_addition_QR_code_height));

                        if (height_len > QR_BAR_MAX_HIGHT)
                        {
                            height_len = QR_BAR_MAX_HIGHT;
                        }
                        else if (height_len < QR_BAR_MIN_HIGHT)
                        {
                            height_len = QR_BAR_MIN_HIGHT;
                        }

                        printf("height_len=%u\n\r",height_len);

                        data_structure[win_content_child_num].data.qr_bar.height = height_len;

                        my_symbol->scale = 1;

                        memcpy(data_structure[win_content_child_num].data.qr_bar.text,lv_label_get_text(label_btn_addition_QR_code_text),str_len);
#if 0
                        if(lv_obj_has_state(sw_addition_QR_code_figure, LV_STATE_CHECKED) == 1)
                        {
                            my_symbol->show_hrt = 1;
                            memcpy(my_symbol->text,lv_label_get_text(label_btn_addition_QR_code_text),strlen(lv_label_get_text(label_btn_addition_QR_code_text))+ 1);
                            //figure_borders |= 0x01;
                            data_structure[win_content_child_num].data.qr_bar.figure = 1;
                        }

#endif
                        if (lv_obj_has_state(sw_addition_QR_code_border, LV_STATE_CHECKED) == 1)
                        {
                            my_symbol->output_options = BARCODE_BOX;
                            my_symbol->whitespace_width = 3;
                            my_symbol-> whitespace_height = 3; 
                            my_symbol-> border_width = 2;   /* Size of border in X-dimensions */
                            //figure_borders |= 0x02;
                            data_structure[win_content_child_num].data.qr_bar.borders = 1;
                        }

                        strcpy(my_symbol->outfile, "out.bmp");
                        ZBarcode_Encode(my_symbol, (unsigned char *)lv_label_get_text(label_btn_addition_QR_code_text), 0);

                        ZBarcode_Print(my_symbol, 0);
            
                        pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                        printf("width=%d\n\r", width);
                        printf("height=%d\n\r", height);
                        printf("channels=%d\n\r", channels);
            
                        my_symbol->scale = (float)((float)150.0*(float)height_len/(float)QR_BAR_MAX_HIGHT/(float)height);
                        printf("scale=%f\n\r", (double)my_symbol->scale);
   
                        strcpy(my_symbol->outfile, "out.bmp");
                        ZBarcode_Encode(my_symbol, (unsigned char *)lv_label_get_text(label_btn_addition_QR_code_text), 0);

                        ZBarcode_Print(my_symbol, 0);
                        ZBarcode_Delete(my_symbol);
                        stbi_image_free(pdata);
                
                        pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                        printf("width=%d\n\r", width);
                        printf("height=%d\n\r", height);
                        printf("channels=%d\n\r", channels);

                        lv_obj_set_size(temp_obj, width, height);

                        pnew_data = (unsigned char*)lv_mem_alloc(width * height * 4); // 为32位数据分配内存
                        if (!pnew_data) 
                        {
                            fprintf(stderr, "Memory allocation failed\n");
                            stbi_image_free(pdata);
                            return;
                        }
                        else
                        {
                            printf("lv_mem_alloc ok\n\r");
                        }

                        for (int y = 0; y < height; y++) 
                        {
                            for (int x = 0; x < width; x++) 
                            {
                                int index = y * width + x; // 计算当前像素在原始数据中的索引
                                unsigned char color = pdata[index]; // 获取当前像素的灰度值（0或255）
                                // 映射到RGBA值

                                if (color == 0)
                                {
                                    pnew_data[index * 4 + 0] = 0; // R
                                    pnew_data[index * 4 + 1] = 0; // G
                                    pnew_data[index * 4 + 2] = 0; // B
                                    pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                                }
                                else
                                {
                                    pnew_data[index * 4 + 0] = 255; // R
                                    pnew_data[index * 4 + 1] = 255; // G
                                    pnew_data[index * 4 + 2] = 255; // B
                                    pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                                }
                            }
                        }

                        sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.bmp",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                        stbi_write_bmp(bmp_name, width, height, 4, pnew_data);
                        // 使用data进行图像处理...
                        lv_mem_free(pnew_data);
                        stbi_image_free(pdata); // 释放内存

                        data = stbi_load(bmp_name, &width, &height, &channels, 0);
                        if (!data) 
                        {
                            printf("错误：无法加载图片 %s\n", bmp_name);
                        }
                        printf("图片加载成功：%dx%d，%d 通道\n", width, height, channels);

                        sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.png",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                        
                        success = stbi_write_png(bmp_name, width, height, channels, data, width * channels);
                        if (!success) 
                        {
                            printf("错误：保存 PNG 失败\n");
                        } 
                        else
                        {
                            printf("PNG 保存成功：%s\n", bmp_name);
                        }

                        // 释放内存
                        stbi_image_free(data);

                        //显示图像
                        img = lv_img_create(temp_obj);
                        sprintf(bmp_name_1,"A:%s",bmp_name);
                        lv_img_set_src(img, bmp_name_1);
                        lv_obj_center(img);

                        data_structure[win_content_child_num].data.qr_bar.size  = 256;

                        break;
                    case 2:
                        my_symbol->symbology = BARCODE_DATAMATRIX;

                        height_len = atoi(lv_label_get_text(label_btn_addition_QR_code_height));

                        if (height_len > QR_BAR_MAX_HIGHT)
                        {
                            height_len = QR_BAR_MAX_HIGHT;
                        }
                        else if (height_len < QR_BAR_MIN_HIGHT)
                        {
                            height_len = QR_BAR_MIN_HIGHT;
                        }

                        printf("height_len=%u\n\r",height_len);

                        data_structure[win_content_child_num].data.qr_bar.height = height_len;

                        my_symbol->scale = 1;

                        memcpy(data_structure[win_content_child_num].data.qr_bar.text,lv_label_get_text(label_btn_addition_QR_code_text),str_len);

#if 0
                        if(lv_obj_has_state(sw_addition_QR_code_figure, LV_STATE_CHECKED) == 1)
                        {
                            my_symbol->show_hrt = 1;
                            memcpy(my_symbol->text,lv_label_get_text(label_btn_addition_QR_code_text),strlen(lv_label_get_text(label_btn_addition_QR_code_text))+ 1);
                            //figure_borders |= 0x01;
                            data_structure[win_content_child_num].data.qr_bar.figure = 1;
                        }
#endif

                        if (lv_obj_has_state(sw_addition_QR_code_border, LV_STATE_CHECKED) == 1)
                        {
                            my_symbol->output_options = BARCODE_BOX;
                            my_symbol->whitespace_width = 3;
                            my_symbol-> whitespace_height = 3; 
                            my_symbol-> border_width = 2;   /* Size of border in X-dimensions */
                            //figure_borders |= 0x02;
                            data_structure[win_content_child_num].data.qr_bar.borders = 1;
                        }

                        strcpy(my_symbol->outfile, "out.bmp");
                        ZBarcode_Encode(my_symbol, (unsigned char *)lv_label_get_text(label_btn_addition_QR_code_text), 0);

                        ZBarcode_Print(my_symbol, 0);

                        pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                        printf("width=%d\n\r", width);
                        printf("height=%d\n\r", height);
                        printf("channels=%d\n\r", channels);
            
                        my_symbol->scale = (float)((float)150.0*(float)height_len/(float)QR_BAR_MAX_HIGHT/(float)height);
                        printf("scale=%f\n\r",(double)my_symbol->scale);
   
                        strcpy(my_symbol->outfile, "out.bmp");
                        ZBarcode_Encode(my_symbol, (unsigned char *)lv_label_get_text(label_btn_addition_QR_code_text), 0);

                        ZBarcode_Print(my_symbol, 0);
                        ZBarcode_Delete(my_symbol);
                        stbi_image_free(pdata);
                
                        pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                        printf("width=%d\n\r", width);
                        printf("height=%d\n\r", height);
                        printf("channels=%d\n\r", channels);

                        lv_obj_set_size(temp_obj, width, height);

                        pnew_data = (unsigned char*)lv_mem_alloc(width * height * 4); // 为32位数据分配内存
                        if (!pnew_data) 
                        {
                            fprintf(stderr, "Memory allocation failed\n");
                            stbi_image_free(pdata);
                            return;
                        }
                        else
                        {
                            printf("lv_mem_alloc ok\n\r");
                        }

                        for (int y = 0; y < height; y++) 
                        {
                            for (int x = 0; x < width; x++) 
                            {
                                int index = y * width + x; // 计算当前像素在原始数据中的索引
                                unsigned char color = pdata[index]; // 获取当前像素的灰度值（0或255）
                                // 映射到RGBA值

                                if (color == 0)
                                {
                                    pnew_data[index * 4 + 0] = 0; // R
                                    pnew_data[index * 4 + 1] = 0; // G
                                    pnew_data[index * 4 + 2] = 0; // B
                                    pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                                }
                                else
                                {
                                    pnew_data[index * 4 + 0] = 255; // R
                                    pnew_data[index * 4 + 1] = 255; // G
                                    pnew_data[index * 4 + 2] = 255; // B
                                    pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                                }
                            }
                        }

                        sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.bmp",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                        stbi_write_bmp(bmp_name, width, height, 4, pnew_data);
                        // 使用data进行图像处理...
                        lv_mem_free(pnew_data);
                        stbi_image_free(pdata); // 释放内存

                        data = stbi_load(bmp_name, &width, &height, &channels, 0);
                        if (!data) 
                        {
                            printf("错误：无法加载图片 %s\n", bmp_name);
                        }
                        printf("图片加载成功：%dx%d，%d 通道\n", width, height, channels);

                        sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.png",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                        
                        success = stbi_write_png(bmp_name, width, height, channels, data, width * channels);
                        if (!success) 
                        {
                            printf("错误：保存 PNG 失败\n");
                        } 
                        else
                        {
                            printf("PNG 保存成功：%s\n", bmp_name);
                        }

                        // 释放内存
                        stbi_image_free(data);

                        //显示图像
                        img = lv_img_create(temp_obj);
                        sprintf(bmp_name_1,"A:%s",bmp_name);
                        lv_img_set_src(img, bmp_name_1);
                        lv_obj_center(img);

                        data_structure[win_content_child_num].data.qr_bar.size  = 256;

                        break;
                    case 3:
                        my_symbol->symbology = BARCODE_HANXIN;

                        height_len = atoi(lv_label_get_text(label_btn_addition_QR_code_height));

                        if (height_len > QR_BAR_MAX_HIGHT)
                        {
                            height_len = QR_BAR_MAX_HIGHT;
                        }
                        else if (height_len < QR_BAR_MIN_HIGHT)
                        {
                            height_len = QR_BAR_MIN_HIGHT;
                        }

                        printf("height_len=%u\n\r",height_len);

                        data_structure[win_content_child_num].data.qr_bar.height = height_len;

                        my_symbol->scale = 1;

                        memcpy(data_structure[win_content_child_num].data.qr_bar.text,lv_label_get_text(label_btn_addition_QR_code_text),str_len);
#if 0
                        if(lv_obj_has_state(sw_addition_QR_code_figure, LV_STATE_CHECKED) == 1)
                        {
                            my_symbol->show_hrt = 1;
                            memcpy(my_symbol->text,lv_label_get_text(label_btn_addition_QR_code_text),strlen(lv_label_get_text(label_btn_addition_QR_code_text))+ 1);
                            //figure_borders |= 0x01;
                            data_structure[win_content_child_num].data.qr_bar.figure = 1;
                        }
#endif

                        if (lv_obj_has_state(sw_addition_QR_code_border, LV_STATE_CHECKED) == 1)
                        {
                            my_symbol->output_options = BARCODE_BOX;
                            my_symbol->whitespace_width = 3;
                            my_symbol-> whitespace_height = 3; 
                            my_symbol-> border_width = 2;   /* Size of border in X-dimensions */
                            //figure_borders |= 0x02;
                            data_structure[win_content_child_num].data.qr_bar.borders = 1;
                        }

                        strcpy(my_symbol->outfile, "out.bmp");
                        ZBarcode_Encode(my_symbol, (unsigned char *)lv_label_get_text(label_btn_addition_QR_code_text), 0);

                        ZBarcode_Print(my_symbol, 0);

                        pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                        printf("width=%d\n\r", width);
                        printf("height=%d\n\r", height);
                        printf("channels=%d\n\r", channels);
            
                        my_symbol->scale = (float)((float)150.0*(float)height_len/(float)QR_BAR_MAX_HIGHT/(float)height);
                         //  my_symbol->scale = (float)height_len/(float)height;
                        printf("scale=%f\n\r",(double)my_symbol->scale);
   
                        strcpy(my_symbol->outfile, "out.bmp");
                        ZBarcode_Encode(my_symbol, (unsigned char *)lv_label_get_text(label_btn_addition_QR_code_text), 0);

                        ZBarcode_Print(my_symbol, 0);
                        ZBarcode_Delete(my_symbol);
                        stbi_image_free(pdata);
                
                        pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                        printf("width=%d\n\r", width);
                        printf("height=%d\n\r", height);
                        printf("channels=%d\n\r", channels);

                        lv_obj_set_size(temp_obj, width, height);

                        pnew_data = (unsigned char*)lv_mem_alloc(width * height * 4); // 为32位数据分配内存
                        if (!pnew_data) 
                        {
                            fprintf(stderr, "Memory allocation failed\n");
                            stbi_image_free(pdata);
                            return;
                        }
                        else
                        {
                            printf("lv_mem_alloc ok\n\r");
                        }

                        for (int y = 0; y < height; y++) 
                        {
                            for (int x = 0; x < width; x++) 
                            {
                                int index = y * width + x; // 计算当前像素在原始数据中的索引
                                unsigned char color = pdata[index]; // 获取当前像素的灰度值（0或255）
                                // 映射到RGBA值

                                if (color == 0)
                                {
                                    pnew_data[index * 4 + 0] = 0; // R
                                    pnew_data[index * 4 + 1] = 0; // G
                                    pnew_data[index * 4 + 2] = 0; // B
                                    pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                                }
                                else
                                {
                                    pnew_data[index * 4 + 0] = 255; // R
                                    pnew_data[index * 4 + 1] = 255; // G
                                    pnew_data[index * 4 + 2] = 255; // B
                                    pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                                }
                            }
                        }
                        
                        sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.bmp",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                        stbi_write_bmp(bmp_name, width, height, 4, pnew_data);
                        // 使用data进行图像处理...
                        lv_mem_free(pnew_data);
                        stbi_image_free(pdata); // 释放内存

                        data = stbi_load(bmp_name, &width, &height, &channels, 1);
                        if (!data) 
                        {
                            printf("错误：无法加载图片 %s\n", bmp_name);
                        }
                        printf("图片加载成功：%dx%d，%d 通道\n", width, height, channels);

                        sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.png",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                        
                        success = stbi_write_png(bmp_name, width, height, channels, data, width * channels);
                        if (!success) 
                        {
                            printf("错误：保存 PNG 失败\n");
                        } 
                        else
                        {
                            printf("PNG 保存成功：%s\n", bmp_name);
                        }

                        // 释放内存
                        stbi_image_free(data);

                        //显示图像
                        img = lv_img_create(temp_obj);
                        sprintf(bmp_name_1,"A:%s",bmp_name);
                        lv_img_set_src(img, bmp_name_1);
                        lv_obj_center(img);

                        data_structure[win_content_child_num].data.qr_bar.size  = 256;

                        break;
                }
            }
            else
            {               
                data_structure[win_content_child_num].data.qr_bar.type = QR_or_bar_code_flag;
                data_structure[win_content_child_num].data.qr_bar.symbology = bar_code_type;
                data_structure[win_content_child_num].type = TYPE_BAR;
                my_symbol = ZBarcode_Create();
                switch (bar_code_type)
                {
                    case 0:
                    default:
                    {
                        if(str_len > 80)
                        {
                             ZBarcode_Delete(my_symbol);
                             break;
                        }

                        my_symbol->symbology = BARCODE_CODE39;

                        height_len = atoi(lv_label_get_text(label_btn_addition_QR_code_height));

                        if (height_len > QR_BAR_MAX_HIGHT)
                        {
                            height_len = QR_BAR_MAX_HIGHT;
                        }
                        else if (height_len < QR_BAR_MIN_HIGHT)
                        {
                            height_len = QR_BAR_MIN_HIGHT;
                        }

                        printf("height_len=%u\n\r",height_len);

                        data_structure[win_content_child_num].data.qr_bar.height = height_len;

                        my_symbol->scale = 1;

                        memcpy(data_structure[win_content_child_num].data.qr_bar.text,lv_label_get_text(label_btn_addition_QR_code_text),str_len + 1);

                        //figure_borders = 0;

                        if(lv_obj_has_state(sw_addition_QR_code_figure, LV_STATE_CHECKED) == 1)
                        {
                            my_symbol->show_hrt = 1;
                            memcpy(my_symbol->text,lv_label_get_text(label_btn_addition_QR_code_text),str_len + 1);
                            //figure_borders |= 0x01;
                            data_structure[win_content_child_num].data.qr_bar.figure = 1;
                        }
                        else
                        {
                             my_symbol->show_hrt = 0;
                             data_structure[win_content_child_num].data.qr_bar.figure = 0;
                        }

                        if (lv_obj_has_state(sw_addition_QR_code_border, LV_STATE_CHECKED) == 1)
                        {
                            my_symbol->output_options = BARCODE_BOX;
                            my_symbol->whitespace_width = 3;
                            my_symbol-> whitespace_height = 3; 
                            my_symbol-> border_width = 2;   /* Size of border in X-dimensions */
                            data_structure[win_content_child_num].data.qr_bar.borders = 1;
                        }
                        else
                        {
                            data_structure[win_content_child_num].data.qr_bar.borders = 0;
                        }

                        strcpy(my_symbol->outfile, "out.bmp");
                        ZBarcode_Encode(my_symbol, (unsigned char *)lv_label_get_text(label_btn_addition_QR_code_text), 0);

                        ZBarcode_Print(my_symbol, 0);
                        //ZBarcode_Delete(my_symbol);

                        pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                        printf("width=%d\n\r", width);
                        printf("height=%d\n\r", height);
                        printf("channels=%d\n\r", channels);
            
                        my_symbol->scale = (float)((float)150.0*(float)height_len/(float)QR_BAR_MAX_HIGHT/(float)height);
                        //   my_symbol->scale = (float)height_len/(float)height;
                        printf("scale=%f\n\r", (double)my_symbol->scale);
   
                        strcpy(my_symbol->outfile, "out.bmp");
                        ZBarcode_Encode(my_symbol, (unsigned char *)lv_label_get_text(label_btn_addition_QR_code_text), 0);

                        ZBarcode_Print(my_symbol, 0);
                        ZBarcode_Delete(my_symbol);
                        stbi_image_free(pdata);
                
                        pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                        printf("width=%d\n\r", width);
                        printf("height=%d\n\r", height);
                        printf("channels=%d\n\r", channels);

                        lv_obj_set_size(temp_obj, width, height);

                        pnew_data = (unsigned char*)lv_mem_alloc(width * height * 4); // 为32位数据分配内存
                        if (!pnew_data) 
                        {
                            fprintf(stderr, "Memory allocation failed\n");
                            stbi_image_free(pdata);
                            return;
                        }
                        else
                        {
                            printf("lv_mem_alloc ok\n\r");
                        }

                        for (int y = 0; y < height; y++) 
                        {
                            for (int x = 0; x < width; x++) 
                            {
                                int index = y * width + x; // 计算当前像素在原始数据中的索引
                                unsigned char color = pdata[index]; // 获取当前像素的灰度值（0或255）
                                // 映射到RGBA值

                                if (color == 0)
                                {
                                    pnew_data[index * 4 + 0] = 0; // R
                                    pnew_data[index * 4 + 1] = 0; // G
                                    pnew_data[index * 4 + 2] = 0; // B
                                    pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                                }
                                else
                                {
                                    pnew_data[index * 4 + 0] = 255; // R
                                    pnew_data[index * 4 + 1] = 255; // G
                                    pnew_data[index * 4 + 2] = 255; // B
                                    pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                                }
                            }
                        }

                        sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.bmp",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                        stbi_write_bmp(bmp_name, width, height, 4, pnew_data);
                        // 使用data进行图像处理...
                        lv_mem_free(pnew_data);
                        stbi_image_free(pdata); // 释放内存

                        data = stbi_load(bmp_name, &width, &height, &channels, 0);
                        if (!data) 
                        {
                            printf("错误：无法加载图片 %s\n", bmp_name);
                        }
                        printf("图片加载成功：%dx%d，%d 通道\n", width, height, channels);

                        sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.png",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                        
                        success = stbi_write_png(bmp_name, width, height, channels, data, width * channels);
                        if (!success) 
                        {
                            printf("错误：保存 PNG 失败\n");
                        } 
                        else
                        {
                            printf("PNG 保存成功：%s\n", bmp_name);
                        }

                        // 释放内存
                        stbi_image_free(data);

                        //显示图像
                        img = lv_img_create(temp_obj);
                        sprintf(bmp_name_1,"A:%s",bmp_name);
                        lv_img_set_src(img, bmp_name_1);
                        lv_obj_center(img);

                        data_structure[win_content_child_num].data.qr_bar.size  = 256;

                        break;
                    }
                    case 1:
                    {
                        if(str_len > 80)
                        {
                            ZBarcode_Delete(my_symbol);
                            break;
                        }
                        my_symbol->symbology = BARCODE_CODE128;
                        height_len = atoi(lv_label_get_text(label_btn_addition_QR_code_height));

                        if (height_len > QR_BAR_MAX_HIGHT)
                        {
                            height_len = QR_BAR_MAX_HIGHT;
                        }
                        else if (height_len < QR_BAR_MIN_HIGHT)
                        {
                            height_len = QR_BAR_MIN_HIGHT;
                        }

                        printf("height_len=%u\n\r",height_len);

                        data_structure[win_content_child_num].data.qr_bar.height = height_len;

                        my_symbol->scale = 1;

                        if(lv_obj_has_state(sw_addition_QR_code_figure, LV_STATE_CHECKED) == 1)
                        {
                            my_symbol->show_hrt = 1;
                            memcpy(my_symbol->text,lv_label_get_text(label_btn_addition_QR_code_text),str_len + 1);
                            //figure_borders |= 0x01;
                            data_structure[win_content_child_num].data.qr_bar.figure = 1;
                        }
                        else
                        {
                            my_symbol->show_hrt = 0;
                            data_structure[win_content_child_num].data.qr_bar.figure = 0;
                        }

                        if (lv_obj_has_state(sw_addition_QR_code_border, LV_STATE_CHECKED) == 1)
                        {
                            my_symbol->output_options = BARCODE_BOX;
                            my_symbol->whitespace_width = 3;
                            my_symbol-> whitespace_height = 3; 
                            my_symbol-> border_width = 2;   /* Size of border in X-dimensions */
                            //figure_borders |= 0x02;
                            data_structure[win_content_child_num].data.qr_bar.borders = 1;
                        }

                        memcpy(data_structure[win_content_child_num].data.qr_bar.text,lv_label_get_text(label_btn_addition_QR_code_text),str_len+1);

                        strcpy(my_symbol->outfile, "out.bmp");
                        ZBarcode_Encode(my_symbol, (unsigned char *)lv_label_get_text(label_btn_addition_QR_code_text), 0);

                        ZBarcode_Print(my_symbol, 0);
                        //ZBarcode_Delete(my_symbol);

                        pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                        printf("width=%d\n\r", width);
                        printf("height=%d\n\r", height);
                        printf("channels=%d\n\r", channels);
            
                        my_symbol->scale = (float)((float)150.0*(float)height_len/(float)QR_BAR_MAX_HIGHT/(float)height);
                      //     my_symbol->scale = (float)height_len/(float)height;
                        printf("scale=%f\n\r",(double)my_symbol->scale);
   
                        strcpy(my_symbol->outfile, "out.bmp");
                        ZBarcode_Encode(my_symbol, (unsigned char *)lv_label_get_text(label_btn_addition_QR_code_text), 0);

                        ZBarcode_Print(my_symbol, 0);
                        ZBarcode_Delete(my_symbol);
                        stbi_image_free(pdata);
                
                        pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                        printf("width=%d\n\r", width);
                        printf("height=%d\n\r", height);
                        printf("channels=%d\n\r", channels);

                        lv_obj_set_size(temp_obj, width, height);

                        pnew_data = (unsigned char*)lv_mem_alloc(width * height * 4); // 为32位数据分配内存
                        if (!pnew_data) 
                        {
                            fprintf(stderr, "Memory allocation failed\n");
                            stbi_image_free(pdata);
                            return;
                        }
                        else
                        {
                            printf("lv_mem_alloc ok\n\r");
                        }

                        for (int y = 0; y < height; y++) 
                        {
                            for (int x = 0; x < width; x++) 
                            {
                                int index = y * width + x; // 计算当前像素在原始数据中的索引
                                unsigned char color = pdata[index]; // 获取当前像素的灰度值（0或255）
                                // 映射到RGBA值

                                if (color == 0)
                                {
                                    pnew_data[index * 4 + 0] = 0; // R
                                    pnew_data[index * 4 + 1] = 0; // G
                                    pnew_data[index * 4 + 2] = 0; // B
                                    pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                                }
                                else
                                {
                                    pnew_data[index * 4 + 0] = 255; // R
                                    pnew_data[index * 4 + 1] = 255; // G
                                    pnew_data[index * 4 + 2] = 255; // B
                                    pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                                }
                            }
                        }

                        sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.bmp",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                        stbi_write_bmp(bmp_name, width, height, 4, pnew_data);
                        // 使用data进行图像处理...
                        lv_mem_free(pnew_data);
                        stbi_image_free(pdata); // 释放内存

                        data = stbi_load(bmp_name, &width, &height, &channels, 0);
                        if (!data) 
                        {
                            printf("错误：无法加载图片 %s\n", bmp_name);
                        }
                        printf("图片加载成功：%dx%d，%d 通道\n", width, height, channels);

                        sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.png",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                        
                        success = stbi_write_png(bmp_name, width, height, channels, data, width * channels);
                        if (!success) 
                        {
                            printf("错误：保存 PNG 失败\n");
                        } 
                        else
                        {
                            printf("PNG 保存成功：%s\n", bmp_name);
                        }

                        // 释放内存
                        stbi_image_free(data);

                        //显示图像
                        img = lv_img_create(temp_obj);
                        sprintf(bmp_name_1,"A:%s",bmp_name);
                        lv_img_set_src(img, bmp_name_1);
                        lv_obj_center(img);

                        data_structure[win_content_child_num].data.qr_bar.size  = 256;
                        break;
                    }
                    case 2:
                    case 3:
                        if(str_len > 13)
                        {
                            ZBarcode_Delete(my_symbol);
                            break;
                        }
                        my_symbol->symbology = BARCODE_EANX;

                        height_len = atoi(lv_label_get_text(label_btn_addition_QR_code_height));

                        if (height_len > QR_BAR_MAX_HIGHT)
                        {
                            height_len = QR_BAR_MAX_HIGHT;
                        }
                        else if (height_len < QR_BAR_MIN_HIGHT)
                        {
                            height_len = QR_BAR_MIN_HIGHT;
                        }

                        printf("height_len=%u\n\r",height_len);

                        data_structure[win_content_child_num].data.qr_bar.height = height_len;

                        my_symbol->scale = 1;
                                                
                        memcpy(data_structure[win_content_child_num].data.qr_bar.text,lv_label_get_text(label_btn_addition_QR_code_text),str_len + 1);

                        if(lv_obj_has_state(sw_addition_QR_code_figure, LV_STATE_CHECKED) == 1)
                        {
                            my_symbol->show_hrt = 1;
                            memcpy(my_symbol->text,lv_label_get_text(label_btn_addition_QR_code_text),str_len + 1);
                            //figure_borders |= 0x01;
                            data_structure[win_content_child_num].data.qr_bar.figure = 1;
                        }
                        else
                        {
                            my_symbol->show_hrt = 0;
                            data_structure[win_content_child_num].data.qr_bar.figure = 0;
                        }

                        if (lv_obj_has_state(sw_addition_QR_code_border, LV_STATE_CHECKED) == 1)
                        {
                            my_symbol->output_options = BARCODE_BOX;
                            my_symbol->whitespace_width = 3;
                            my_symbol-> whitespace_height = 3; 
                            my_symbol-> border_width = 2;   /* Size of border in X-dimensions */
                            //figure_borders |= 0x02;
                            data_structure[win_content_child_num].data.qr_bar.borders = 1;
                        }


                        strcpy(my_symbol->outfile, "out.bmp");
                        ZBarcode_Encode(my_symbol, (unsigned char *)lv_label_get_text(label_btn_addition_QR_code_text), 0);

                        ZBarcode_Print(my_symbol, 0);

                        pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                        printf("width=%d\n\r", width);
                        printf("height=%d\n\r", height);
                        printf("channels=%d\n\r", channels);
            
                        my_symbol->scale = (float)((float)150.0*(float)height_len/(float)QR_BAR_MAX_HIGHT/(float)height);
                        printf("scale=%f\n\r",(double)my_symbol->scale);
   
                        strcpy(my_symbol->outfile, "out.bmp");
                        ZBarcode_Encode(my_symbol, (unsigned char *)lv_label_get_text(label_btn_addition_QR_code_text), 0);

                        ZBarcode_Print(my_symbol, 0);
                        ZBarcode_Delete(my_symbol);
                        stbi_image_free(pdata);
                
                        pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                        printf("width=%d\n\r", width);
                        printf("height=%d\n\r", height);
                        printf("channels=%d\n\r", channels);

                        lv_obj_set_size(temp_obj, width, height);

                        pnew_data = (unsigned char*)lv_mem_alloc(width * height * 4); // 为32位数据分配内存
                        if (!pnew_data) 
                        {
                            fprintf(stderr, "Memory allocation failed\n");
                            stbi_image_free(pdata);
                            return;
                        }
                        else
                        {
                            printf("lv_mem_alloc ok\n\r");
                        }

                        for (int y = 0; y < height; y++) 
                        {
                            for (int x = 0; x < width; x++) 
                            {
                                int index = y * width + x; // 计算当前像素在原始数据中的索引
                                unsigned char color = pdata[index]; // 获取当前像素的灰度值（0或255）
                                // 映射到RGBA值

                                if (color == 0)
                                {
                                    pnew_data[index * 4 + 0] = 0; // R
                                    pnew_data[index * 4 + 1] = 0; // G
                                    pnew_data[index * 4 + 2] = 0; // B
                                    pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                                }
                                else
                                {
                                    pnew_data[index * 4 + 0] = 255; // R
                                    pnew_data[index * 4 + 1] = 255; // G
                                    pnew_data[index * 4 + 2] = 255; // B
                                    pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                                }
                            }
                        }

                        sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.bmp",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                        stbi_write_bmp(bmp_name, width, height, 4, pnew_data);
                        // 使用data进行图像处理...
                        lv_mem_free(pnew_data);
                        stbi_image_free(pdata); // 释放内存

                        data = stbi_load(bmp_name, &width, &height, &channels, 0);
                        if (!data) 
                        {
                            printf("错误：无法加载图片 %s\n", bmp_name);
                        }
                        printf("图片加载成功：%dx%d，%d 通道\n", width, height, channels);

                        sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.png",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                        
                        success = stbi_write_png(bmp_name, width, height, channels, data, width * channels);
                        if (!success) 
                        {
                            printf("错误：保存 PNG 失败\n");
                        } 
                        else
                        {
                            printf("PNG 保存成功：%s\n", bmp_name);
                        }

                        // 释放内存
                        stbi_image_free(data);

                        //显示图像
                        img = lv_img_create(temp_obj);
                        sprintf(bmp_name_1,"A:%s",bmp_name);
                        lv_img_set_src(img, bmp_name_1);
                        lv_obj_center(img);

                        data_structure[win_content_child_num].data.qr_bar.size  = 256;

                        break;
                    case 4:

                        if(str_len != 40)
                        {
                            ZBarcode_Delete(my_symbol);
                            break;                
                        }

                        if(check_string_format(lv_label_get_text(label_btn_addition_QR_code_text)) != 0)
                        {
                            ZBarcode_Delete(my_symbol);
                            break;                  
                        }
                        
                        my_symbol->symbology = BARCODE_EAN128;
                        my_symbol->input_mode |= GS1PARENS_MODE;
                        height_len = atoi(lv_label_get_text(label_btn_addition_QR_code_height));

                        if (height_len > QR_BAR_MAX_HIGHT)
                        {
                            height_len = QR_BAR_MAX_HIGHT;
                        }
                        else if (height_len < QR_BAR_MIN_HIGHT)
                        {
                            height_len = QR_BAR_MIN_HIGHT;
                        }

                        printf("height_len=%u\n\r",height_len);

                        data_structure[win_content_child_num].data.qr_bar.height = height_len;

                        my_symbol->scale = 1;

                        memcpy(data_structure[win_content_child_num].data.qr_bar.text,lv_label_get_text(label_btn_addition_QR_code_text),str_len);

                        if(lv_obj_has_state(sw_addition_QR_code_figure, LV_STATE_CHECKED) == 1)
                        {
                            my_symbol->show_hrt = 1;
                            memcpy(my_symbol->text,lv_label_get_text(label_btn_addition_QR_code_text),strlen(lv_label_get_text(label_btn_addition_QR_code_text))+ 1);
                            //figure_borders |= 0x01;
                            data_structure[win_content_child_num].data.qr_bar.figure = 1;
                        }
                        else
                        {
                            my_symbol->show_hrt = 0;
                            data_structure[win_content_child_num].data.qr_bar.figure = 0;
                        }

                        if (lv_obj_has_state(sw_addition_QR_code_border, LV_STATE_CHECKED) == 1)
                        {
                            my_symbol->output_options = BARCODE_BOX;
                            my_symbol->whitespace_width = 3;
                            my_symbol-> whitespace_height = 3; 
                            my_symbol-> border_width = 2;   /* Size of border in X-dimensions */
                            //figure_borders |= 0x02;
                            data_structure[win_content_child_num].data.qr_bar.borders = 1;
                        }

                        strcpy(my_symbol->outfile, "out.bmp");

                        printf("%s\n\r",lv_label_get_text(label_btn_addition_QR_code_text));

                        ZBarcode_Encode(my_symbol, (unsigned char *)lv_label_get_text(label_btn_addition_QR_code_text), 0);
                        //ZBarcode_Encode(my_symbol, (unsigned char *)"(01)98898765432106(3202)012345(15)991231", 0);

                        ZBarcode_Print(my_symbol, 0);
                        //ZBarcode_Delete(my_symbol);

                        pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                        printf("width=%d\n\r", width);
                        printf("height=%d\n\r", height);
                        printf("channels=%d\n\r", channels);
            
                        my_symbol->scale = (float)((float)118.0*(float)height_len/(float)QR_BAR_MAX_HIGHT/(float)height);

                        //my_symbol->scale = (float)((float)150.0*(float)height_len/(float)QR_BAR_MAX_HIGHT/(float)height);
                        
                        printf("scale=%f\n\r", (double)my_symbol->scale);
   
                        strcpy(my_symbol->outfile, "out.bmp");
                        ZBarcode_Encode(my_symbol, (unsigned char *)lv_label_get_text(label_btn_addition_QR_code_text), 0);

                        ZBarcode_Print(my_symbol, 0);
                        ZBarcode_Delete(my_symbol);
                        stbi_image_free(pdata);
                
                        pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                        printf("width=%d\n\r", width);
                        printf("height=%d\n\r", height);
                        printf("channels=%d\n\r", channels);

                        lv_obj_set_size(temp_obj, width, height);

                        pnew_data = (unsigned char*)lv_mem_alloc(width * height * 4); // 为32位数据分配内存
                        if (!pnew_data) 
                        {
                            fprintf(stderr, "Memory allocation failed\n");
                            stbi_image_free(pdata);
                            return;
                        }
                        else
                        {
                            printf("lv_mem_alloc ok\n\r");
                        }

                        for (int y = 0; y < height; y++) 
                        {
                            for (int x = 0; x < width; x++) 
                            {
                                int index = y * width + x; // 计算当前像素在原始数据中的索引
                                unsigned char color = pdata[index]; // 获取当前像素的灰度值（0或255）
                                // 映射到RGBA值

                                if (color == 0)
                                {
                                    pnew_data[index * 4 + 0] = 0; // R
                                    pnew_data[index * 4 + 1] = 0; // G
                                    pnew_data[index * 4 + 2] = 0; // B
                                    pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                                }
                                else
                                {
                                    pnew_data[index * 4 + 0] = 255; // R
                                    pnew_data[index * 4 + 1] = 255; // G
                                    pnew_data[index * 4 + 2] = 255; // B
                                    pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                                }
                            }
                        }

                        sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.bmp",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                        stbi_write_bmp(bmp_name, width, height, 4, pnew_data);
                        // 使用data进行图像处理...
                        lv_mem_free(pnew_data);
                        stbi_image_free(pdata); // 释放内存

                        data = stbi_load(bmp_name, &width, &height, &channels, 0);
                        if (!data) 
                        {
                            printf("错误：无法加载图片 %s\n", bmp_name);
                        }
                        printf("图片加载成功：%dx%d，%d 通道\n", width, height, channels);

                        sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.png",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                        
                        success = stbi_write_png(bmp_name, width, height, channels, data, width * channels);
                        if (!success) 
                        {
                            printf("错误：保存 PNG 失败\n");
                        } 
                        else
                        {
                            printf("PNG 保存成功：%s\n", bmp_name);
                        }

                        // 释放内存
                        stbi_image_free(data);

                        //显示图像
                        img = lv_img_create(temp_obj);
                        sprintf(bmp_name_1,"A:%s",bmp_name);
                        lv_img_set_src(img, bmp_name_1);
                        lv_obj_center(img);

                        data_structure[win_content_child_num].data.qr_bar.size  = 256;

                        break;
                    case 5:

                        if(str_len != 11)
                        {
                            ZBarcode_Delete(my_symbol);
                            break;                
                        }
                        my_symbol->symbology = BARCODE_UPCA;

                        height_len = atoi(lv_label_get_text(label_btn_addition_QR_code_height));

                        if (height_len > QR_BAR_MAX_HIGHT)
                        {
                            height_len = QR_BAR_MAX_HIGHT;
                        }
                        else if (height_len < QR_BAR_MIN_HIGHT)
                        {
                            height_len = QR_BAR_MIN_HIGHT;
                        }

                        printf("height_len=%u\n\r",height_len);

                        data_structure[win_content_child_num].data.qr_bar.height = height_len;

                        my_symbol->scale = 1;

                        memcpy(data_structure[win_content_child_num].data.qr_bar.text,lv_label_get_text(label_btn_addition_QR_code_text),str_len);

                        if(lv_obj_has_state(sw_addition_QR_code_figure, LV_STATE_CHECKED) == 1)
                        {
                            my_symbol->show_hrt = 1;
                            memcpy(my_symbol->text,lv_label_get_text(label_btn_addition_QR_code_text),strlen(lv_label_get_text(label_btn_addition_QR_code_text))+ 1);
                            //figure_borders |= 0x01;
                            data_structure[win_content_child_num].data.qr_bar.figure = 1;
                        }
                        else
                        {
                            my_symbol->show_hrt = 0;
                            data_structure[win_content_child_num].data.qr_bar.figure = 0;
                        }

                        if (lv_obj_has_state(sw_addition_QR_code_border, LV_STATE_CHECKED) == 1)
                        {
                            my_symbol->output_options = BARCODE_BOX;
                            my_symbol->whitespace_width = 3;
                            my_symbol-> whitespace_height = 3; 
                            my_symbol-> border_width = 2;   /* Size of border in X-dimensions */
                            //figure_borders |= 0x02;
                            data_structure[win_content_child_num].data.qr_bar.borders = 1;
                        }

                        strcpy(my_symbol->outfile, "out.bmp");
                        ZBarcode_Encode(my_symbol, (unsigned char *)lv_label_get_text(label_btn_addition_QR_code_text), 0);

                        ZBarcode_Print(my_symbol, 0);
                        //ZBarcode_Delete(my_symbol);

                        pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                        printf("width=%d\n\r", width);
                        printf("height=%d\n\r", height);
                        printf("channels=%d\n\r", channels);
            
                        my_symbol->scale = (float)((float)150.0*(float)height_len/(float)QR_BAR_MAX_HIGHT/(float)height);
                        //   my_symbol->scale = (float)height_len/(float)height;
                        printf("scale=%f\n\r", (double)my_symbol->scale);
   
                        strcpy(my_symbol->outfile, "out.bmp");
                        ZBarcode_Encode(my_symbol, (unsigned char *)lv_label_get_text(label_btn_addition_QR_code_text), 0);

                        ZBarcode_Print(my_symbol, 0);
                        ZBarcode_Delete(my_symbol);
                        stbi_image_free(pdata);
                
                        pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                        printf("width=%d\n\r", width);
                        printf("height=%d\n\r", height);
                        printf("channels=%d\n\r", channels);

                        lv_obj_set_size(temp_obj, width, height);

                        pnew_data = (unsigned char*)lv_mem_alloc(width * height * 4); // 为32位数据分配内存
                        if (!pnew_data) 
                        {
                            fprintf(stderr, "Memory allocation failed\n");
                            stbi_image_free(pdata);
                            return;
                        }
                        else
                        {
                            printf("lv_mem_alloc ok\n\r");
                        }

                        for (int y = 0; y < height; y++) 
                        {
                            for (int x = 0; x < width; x++) 
                            {
                                int index = y * width + x; // 计算当前像素在原始数据中的索引
                                unsigned char color = pdata[index]; // 获取当前像素的灰度值（0或255）
                                // 映射到RGBA值

                                if (color == 0)
                                {
                                    pnew_data[index * 4 + 0] = 0; // R
                                    pnew_data[index * 4 + 1] = 0; // G
                                    pnew_data[index * 4 + 2] = 0; // B
                                    pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                                }
                                else
                                {
                                    pnew_data[index * 4 + 0] = 255; // R
                                    pnew_data[index * 4 + 1] = 255; // G
                                    pnew_data[index * 4 + 2] = 255; // B
                                    pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                                }
                            }
                        }

                        sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.bmp",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                        stbi_write_bmp(bmp_name, width, height, 4, pnew_data);
                        // 使用data进行图像处理...
                        lv_mem_free(pnew_data);
                        stbi_image_free(pdata); // 释放内存

                        data = stbi_load(bmp_name, &width, &height, &channels, 0);
                        if (!data) 
                        {
                            printf("错误：无法加载图片 %s\n", bmp_name);
                        }
                        printf("图片加载成功：%dx%d，%d 通道\n", width, height, channels);

                        sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.png",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                        
                        success = stbi_write_png(bmp_name, width, height, channels, data, width * channels);
                        if (!success) 
                        {
                            printf("错误：保存 PNG 失败\n");
                        } 
                        else
                        {
                            printf("PNG 保存成功：%s\n", bmp_name);
                        }

                        // 释放内存
                        stbi_image_free(data);

                        //显示图像
                        img = lv_img_create(temp_obj);
                        sprintf(bmp_name_1,"A:%s",bmp_name);
                        lv_img_set_src(img, bmp_name_1);
                        lv_obj_center(img);

                        data_structure[win_content_child_num].data.qr_bar.size  = 256;

                        break;
                    case 6:

                        if(str_len != 7)
                        {
                            ZBarcode_Delete(my_symbol);
                            break;                
                        }

                        my_symbol->symbology = BARCODE_UPCE;

                        height_len = atoi(lv_label_get_text(label_btn_addition_QR_code_height));

                        if (height_len > QR_BAR_MAX_HIGHT)
                        {
                            height_len = QR_BAR_MAX_HIGHT;
                        }
                        else if (height_len < QR_BAR_MIN_HIGHT)
                        {
                            height_len = QR_BAR_MIN_HIGHT;
                        }

                        printf("height_len=%u\n\r",height_len);

                        data_structure[win_content_child_num].data.qr_bar.height = height_len;

                        my_symbol->scale = 1;

                        memcpy(data_structure[win_content_child_num].data.qr_bar.text,lv_label_get_text(label_btn_addition_QR_code_text),str_len);

                        if(lv_obj_has_state(sw_addition_QR_code_figure, LV_STATE_CHECKED) == 1)
                        {
                            my_symbol->show_hrt = 1;
                            memcpy(my_symbol->text,lv_label_get_text(label_btn_addition_QR_code_text),strlen(lv_label_get_text(label_btn_addition_QR_code_text))+ 1);
                            //figure_borders |= 0x01;
                            data_structure[win_content_child_num].data.qr_bar.figure = 1;
                        }
                        else
                        {
                            my_symbol->show_hrt = 0;
                            data_structure[win_content_child_num].data.qr_bar.figure = 0;
                        }

                        if (lv_obj_has_state(sw_addition_QR_code_border, LV_STATE_CHECKED) == 1)
                        {
                            my_symbol->output_options = BARCODE_BOX;
                            my_symbol->whitespace_width = 3;
                            my_symbol-> whitespace_height = 3; 
                            my_symbol-> border_width = 2;   /* Size of border in X-dimensions */
                            //figure_borders |= 0x02;
                            data_structure[win_content_child_num].data.qr_bar.borders = 1;
                        }

                        strcpy(my_symbol->outfile, "out.bmp");
                        ZBarcode_Encode(my_symbol, (unsigned char *)lv_label_get_text(label_btn_addition_QR_code_text), 0);

                        ZBarcode_Print(my_symbol, 0);

                        pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                        printf("width=%d\n\r", width);
                        printf("height=%d\n\r", height);
                        printf("channels=%d\n\r", channels);
            
                        my_symbol->scale = (float)((float)150.0*(float)height_len/(float)QR_BAR_MAX_HIGHT/(float)height);
        
                        printf("scale=%f\n\r", (double)my_symbol->scale);
   
                        strcpy(my_symbol->outfile, "out.bmp");
                        ZBarcode_Encode(my_symbol, (unsigned char *)lv_label_get_text(label_btn_addition_QR_code_text), 0);

                        ZBarcode_Print(my_symbol, 0);
                        ZBarcode_Delete(my_symbol);
                        stbi_image_free(pdata);
                
                        pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                        printf("width=%d\n\r", width);
                        printf("height=%d\n\r", height);
                        printf("channels=%d\n\r", channels);

                        lv_obj_set_size(temp_obj, width, height);

                        pnew_data = (unsigned char*)lv_mem_alloc(width * height * 4); // 为32位数据分配内存
                        if (!pnew_data) 
                        {
                            fprintf(stderr, "Memory allocation failed\n");
                            stbi_image_free(pdata);
                            return;
                        }
                        else
                        {
                            printf("lv_mem_alloc ok\n\r");
                        }

                        for (int y = 0; y < height; y++) 
                        {
                            for (int x = 0; x < width; x++) 
                            {
                                int index = y * width + x; // 计算当前像素在原始数据中的索引
                                unsigned char color = pdata[index]; // 获取当前像素的灰度值（0或255）
                                // 映射到RGBA值

                                if (color == 0)
                                {
                                    pnew_data[index * 4 + 0] = 0; // R
                                    pnew_data[index * 4 + 1] = 0; // G
                                    pnew_data[index * 4 + 2] = 0; // B
                                    pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                                }
                                else
                                {
                                    pnew_data[index * 4 + 0] = 255; // R
                                    pnew_data[index * 4 + 1] = 255; // G
                                    pnew_data[index * 4 + 2] = 255; // B
                                    pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                                }
                            }
                        }

                        sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.bmp",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                        stbi_write_bmp(bmp_name, width, height, 4, pnew_data);
                        // 使用data进行图像处理...
                        lv_mem_free(pnew_data);
                        stbi_image_free(pdata); // 释放内存

                        data = stbi_load(bmp_name, &width, &height, &channels, 0);
                        if (!data) 
                        {
                            printf("错误：无法加载图片 %s\n", bmp_name);
                        }
                        printf("图片加载成功：%dx%d，%d 通道\n", width, height, channels);

                        sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.png",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                        
                        success = stbi_write_png(bmp_name, width, height, channels, data, width * channels);
                        if (!success) 
                        {
                            printf("错误：保存 PNG 失败\n");
                        } 
                        else
                        {
                            printf("PNG 保存成功：%s\n", bmp_name);
                        }

                        // 释放内存
                        stbi_image_free(data);

                        //显示图像
                        img = lv_img_create(temp_obj);
                        sprintf(bmp_name_1,"A:%s",bmp_name);
                        lv_img_set_src(img, bmp_name_1);
                        lv_obj_center(img);

                        data_structure[win_content_child_num].data.qr_bar.size  = 256;
                        break;
                    case 7:
                        if(str_len != 13)
                        {
                            ZBarcode_Delete(my_symbol);
                            break;                
                        }
                        my_symbol->symbology = BARCODE_ITF14;

                        height_len = atoi(lv_label_get_text(label_btn_addition_QR_code_height));

                        if (height_len > QR_BAR_MAX_HIGHT)
                        {
                            height_len = QR_BAR_MAX_HIGHT;
                        }
                        else if (height_len < QR_BAR_MIN_HIGHT)
                        {
                            height_len = QR_BAR_MIN_HIGHT;
                        }

                        printf("height_len=%u\n\r",height_len);

                        data_structure[win_content_child_num].data.qr_bar.height = height_len;

                        my_symbol->scale = 1;

                        memcpy(data_structure[win_content_child_num].data.qr_bar.text,lv_label_get_text(label_btn_addition_QR_code_text),str_len);

                        if(lv_obj_has_state(sw_addition_QR_code_figure, LV_STATE_CHECKED) == 1)
                        {
                            my_symbol->show_hrt = 1;
                            memcpy(my_symbol->text,lv_label_get_text(label_btn_addition_QR_code_text),strlen(lv_label_get_text(label_btn_addition_QR_code_text))+ 1);
                            //figure_borders |= 0x01;
                            data_structure[win_content_child_num].data.qr_bar.figure = 1;
                        }
                        else
                        {
                            my_symbol->show_hrt = 0;
                            data_structure[win_content_child_num].data.qr_bar.figure = 0;
                        }

                        if (lv_obj_has_state(sw_addition_QR_code_border, LV_STATE_CHECKED) == 1)
                        {
                            my_symbol->output_options = BARCODE_BOX;
                            my_symbol->whitespace_width = 3;
                            my_symbol-> whitespace_height = 3; 
                            my_symbol-> border_width = 2;   /* Size of border in X-dimensions */
                            //figure_borders |= 0x02;
                            data_structure[win_content_child_num].data.qr_bar.borders = 1;
                        }

                        strcpy(my_symbol->outfile, "out.bmp");
                        ZBarcode_Encode(my_symbol, (unsigned char *)lv_label_get_text(label_btn_addition_QR_code_text), 0);

                        ZBarcode_Print(my_symbol, 0);
                        //ZBarcode_Delete(my_symbol);

                        pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                        printf("width=%d\n\r", width);
                        printf("height=%d\n\r", height);
                        printf("channels=%d\n\r", channels);
            
                        my_symbol->scale = (float)((float)150.0*(float)height_len/(float)QR_BAR_MAX_HIGHT/(float)height);
                         //  my_symbol->scale = (float)height_len/(float)height;
                        printf("scale=%f\n\r", (double)my_symbol->scale);
   
                        strcpy(my_symbol->outfile, "out.bmp");
                        ZBarcode_Encode(my_symbol, (unsigned char *)lv_label_get_text(label_btn_addition_QR_code_text), 0);

                        ZBarcode_Print(my_symbol, 0);
                        ZBarcode_Delete(my_symbol);
                        stbi_image_free(pdata);
                
                        pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                        printf("width=%d\n\r", width);
                        printf("height=%d\n\r", height);
                        printf("channels=%d\n\r", channels);

                        lv_obj_set_size(temp_obj, width, height);

                        pnew_data = (unsigned char*)lv_mem_alloc(width * height * 4); // 为32位数据分配内存
                        if (!pnew_data) 
                        {
                            fprintf(stderr, "Memory allocation failed\n");
                            stbi_image_free(pdata);
                            return;
                        }
                        else
                        {
                            printf("lv_mem_alloc ok\n\r");
                        }

                        for (int y = 0; y < height; y++) 
                        {
                            for (int x = 0; x < width; x++) 
                            {
                                int index = y * width + x; // 计算当前像素在原始数据中的索引
                                unsigned char color = pdata[index]; // 获取当前像素的灰度值（0或255）
                                // 映射到RGBA值

                                if (color == 0)
                                {
                                    pnew_data[index * 4 + 0] = 0; // R
                                    pnew_data[index * 4 + 1] = 0; // G
                                    pnew_data[index * 4 + 2] = 0; // B
                                    pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                                }
                                else
                                {
                                    pnew_data[index * 4 + 0] = 255; // R
                                    pnew_data[index * 4 + 1] = 255; // G
                                    pnew_data[index * 4 + 2] = 255; // B
                                    pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                                }
                            }
                        }

                        sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.bmp",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                        stbi_write_bmp(bmp_name, width, height, 4, pnew_data);
                        // 使用data进行图像处理...
                        lv_mem_free(pnew_data);
                        stbi_image_free(pdata); // 释放内存

                        data = stbi_load(bmp_name, &width, &height, &channels, 0);
                        if (!data) 
                        {
                            printf("错误：无法加载图片 %s\n", bmp_name);
                        }
                        printf("图片加载成功：%dx%d，%d 通道\n", width, height, channels);

                        sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.png",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                        
                        success = stbi_write_png(bmp_name, width, height, channels, data, width * channels);
                        if (!success) 
                        {
                            printf("错误：保存 PNG 失败\n");
                        } 
                        else
                        {
                            printf("PNG 保存成功：%s\n", bmp_name);
                        }

                        // 释放内存
                        stbi_image_free(data);

                        //显示图像
                        img = lv_img_create(temp_obj);
                        sprintf(bmp_name_1,"A:%s",bmp_name);
                        lv_img_set_src(img, bmp_name_1);
                        lv_obj_center(img);

                        data_structure[win_content_child_num].data.qr_bar.size  = 256;

                        break;
                    case 8:
                        if(str_len > 40)
                        {
                            ZBarcode_Delete(my_symbol);
                            break;                
                        }
                        my_symbol->symbology = BARCODE_C25INTER;

                        height_len = atoi(lv_label_get_text(label_btn_addition_QR_code_height));

                        if (height_len > QR_BAR_MAX_HIGHT)
                        {
                            height_len = QR_BAR_MAX_HIGHT;
                        }
                        else if (height_len < QR_BAR_MIN_HIGHT)
                        {
                            height_len = QR_BAR_MIN_HIGHT;
                        }

                        printf("height_len=%u\n\r",height_len);

                        data_structure[win_content_child_num].data.qr_bar.height = height_len;

                        my_symbol->scale = 1;

                        memcpy(data_structure[win_content_child_num].data.qr_bar.text,lv_label_get_text(label_btn_addition_QR_code_text),str_len);

                        if(lv_obj_has_state(sw_addition_QR_code_figure, LV_STATE_CHECKED) == 1)
                        {
                            my_symbol->show_hrt = 1;
                            memcpy(my_symbol->text,lv_label_get_text(label_btn_addition_QR_code_text),strlen(lv_label_get_text(label_btn_addition_QR_code_text))+ 1);
                            //figure_borders |= 0x01;
                            data_structure[win_content_child_num].data.qr_bar.figure = 1;
                        }
                        else
                        {
                            my_symbol->show_hrt = 0;
                            data_structure[win_content_child_num].data.qr_bar.figure = 0;
                        }

                        if (lv_obj_has_state(sw_addition_QR_code_border, LV_STATE_CHECKED) == 1)
                        {
                            my_symbol->output_options = BARCODE_BOX;
                            my_symbol->whitespace_width = 3;
                            my_symbol-> whitespace_height = 3; 
                            my_symbol-> border_width = 2;   /* Size of border in X-dimensions */
                            //figure_borders |= 0x02;
                            data_structure[win_content_child_num].data.qr_bar.borders = 1;
                        }

                        strcpy(my_symbol->outfile, "out.bmp");
                        ZBarcode_Encode(my_symbol, (unsigned char *)lv_label_get_text(label_btn_addition_QR_code_text), 0);

                        ZBarcode_Print(my_symbol, 0);
                        //ZBarcode_Delete(my_symbol);

                        pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                        printf("width=%d\n\r", width);
                        printf("height=%d\n\r", height);
                        printf("channels=%d\n\r", channels);
            
                        my_symbol->scale = (float)((float)150.0*(float)height_len/(float)QR_BAR_MAX_HIGHT/(float)height);
                        //   my_symbol->scale = (float)height_len/(float)height;
                        printf("scale=%f\n\r", (double)my_symbol->scale);
   
                        strcpy(my_symbol->outfile, "out.bmp");
                        ZBarcode_Encode(my_symbol, (unsigned char *)lv_label_get_text(label_btn_addition_QR_code_text), 0);

                        ZBarcode_Print(my_symbol, 0);
                        ZBarcode_Delete(my_symbol);
                        stbi_image_free(pdata);
                
                        pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                        printf("width=%d\n\r", width);
                        printf("height=%d\n\r", height);
                        printf("channels=%d\n\r", channels);

                        lv_obj_set_size(temp_obj, width, height);

                        pnew_data = (unsigned char*)lv_mem_alloc(width * height * 4); // 为32位数据分配内存
                        if (!pnew_data) 
                        {
                            fprintf(stderr, "Memory allocation failed\n");
                            stbi_image_free(pdata);
                            return;
                        }
                        else
                        {
                            printf("lv_mem_alloc ok\n\r");
                        }

                        for (int y = 0; y < height; y++) 
                        {
                            for (int x = 0; x < width; x++) 
                            {
                                int index = y * width + x; // 计算当前像素在原始数据中的索引
                                unsigned char color = pdata[index]; // 获取当前像素的灰度值（0或255）
                                // 映射到RGBA值

                                if (color == 0)
                                {
                                    pnew_data[index * 4 + 0] = 0; // R
                                    pnew_data[index * 4 + 1] = 0; // G
                                    pnew_data[index * 4 + 2] = 0; // B
                                    pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                                }
                                else
                                {
                                    pnew_data[index * 4 + 0] = 255; // R
                                    pnew_data[index * 4 + 1] = 255; // G
                                    pnew_data[index * 4 + 2] = 255; // B
                                    pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                                }
                            }
                        }

                        sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.bmp",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                        stbi_write_bmp(bmp_name, width, height, 4, pnew_data);
                        // 使用data进行图像处理...
                        lv_mem_free(pnew_data);
                        stbi_image_free(pdata); // 释放内存

                        data = stbi_load(bmp_name, &width, &height, &channels, 0);
                        if (!data) 
                        {
                            printf("错误：无法加载图片 %s\n", bmp_name);
                        }
                        printf("图片加载成功：%dx%d，%d 通道\n", width, height, channels);

                        sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.png",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                        
                        success = stbi_write_png(bmp_name, width, height, channels, data, width * channels);
                        if (!success) 
                        {
                            printf("错误：保存 PNG 失败\n");
                        } 
                        else
                        {
                            printf("PNG 保存成功：%s\n", bmp_name);
                        }

                        // 释放内存
                        stbi_image_free(data);

                        //显示图像
                        img = lv_img_create(temp_obj);
                        sprintf(bmp_name_1,"A:%s",bmp_name);
                        lv_img_set_src(img, bmp_name_1);
                        lv_obj_center(img);

                        data_structure[win_content_child_num].data.qr_bar.size  = 256;
                        break;
                    case 9:
                        if(str_len != 13)
                        {
                            ZBarcode_Delete(my_symbol);
                            break;                
                        }
                        my_symbol->symbology = BARCODE_EAN14;

                        height_len = atoi(lv_label_get_text(label_btn_addition_QR_code_height));

                        if (height_len > QR_BAR_MAX_HIGHT)
                        {
                            height_len = QR_BAR_MAX_HIGHT;
                        }
                        else if (height_len < QR_BAR_MIN_HIGHT)
                        {
                            height_len = QR_BAR_MIN_HIGHT;
                        }

                        printf("height_len=%u\n\r",height_len);

                        data_structure[win_content_child_num].data.qr_bar.height = height_len;

                        my_symbol->scale = 1;

                        memcpy(data_structure[win_content_child_num].data.qr_bar.text,lv_label_get_text(label_btn_addition_QR_code_text),str_len);


                        if(lv_obj_has_state(sw_addition_QR_code_figure, LV_STATE_CHECKED) == 1)
                        {
                            my_symbol->show_hrt = 1;
                            memcpy(my_symbol->text,lv_label_get_text(label_btn_addition_QR_code_text),strlen(lv_label_get_text(label_btn_addition_QR_code_text))+ 1);
                            //figure_borders |= 0x01;
                            data_structure[win_content_child_num].data.qr_bar.figure = 1;
                        }
                        else
                        {
                            my_symbol->show_hrt = 0;
                            data_structure[win_content_child_num].data.qr_bar.figure = 0;
                        }

                        if (lv_obj_has_state(sw_addition_QR_code_border, LV_STATE_CHECKED) == 1)
                        {
                            my_symbol->output_options = BARCODE_BOX;
                            my_symbol->whitespace_width = 3;
                            my_symbol-> whitespace_height = 3; 
                            my_symbol-> border_width = 2;   /* Size of border in X-dimensions */
                            //figure_borders |= 0x02;
                            data_structure[win_content_child_num].data.qr_bar.borders = 1;
                        }

                        strcpy(my_symbol->outfile, "out.bmp");
                        ZBarcode_Encode(my_symbol, (unsigned char *)lv_label_get_text(label_btn_addition_QR_code_text), 0);

                        ZBarcode_Print(my_symbol, 0);
                        //ZBarcode_Delete(my_symbol);

                        pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                        printf("width=%d\n\r", width);
                        printf("height=%d\n\r", height);
                        printf("channels=%d\n\r", channels);
            
                        my_symbol->scale = (float)((float)150.0*(float)height_len/(float)QR_BAR_MAX_HIGHT/(float)height);
                        //   my_symbol->scale = (float)height_len/(float)height;
                        printf("scale=%f\n\r",(double) my_symbol->scale);
   
                        strcpy(my_symbol->outfile, "out.bmp");
                        ZBarcode_Encode(my_symbol, (unsigned char *)lv_label_get_text(label_btn_addition_QR_code_text), 0);

                        ZBarcode_Print(my_symbol, 0);
                        ZBarcode_Delete(my_symbol);
                        stbi_image_free(pdata);
                
                        pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                        printf("width=%d\n\r", width);
                        printf("height=%d\n\r", height);
                        printf("channels=%d\n\r", channels);

                        lv_obj_set_size(temp_obj, width, height);

                        pnew_data = (unsigned char*)lv_mem_alloc(width * height * 4); // 为32位数据分配内存
                        if (!pnew_data) 
                        {
                            fprintf(stderr, "Memory allocation failed\n");
                            stbi_image_free(pdata);
                            return;
                        }
                        else
                        {
                            printf("lv_mem_alloc ok\n\r");
                        }

                        for (int y = 0; y < height; y++) 
                        {
                            for (int x = 0; x < width; x++) 
                            {
                                int index = y * width + x; // 计算当前像素在原始数据中的索引
                                unsigned char color = pdata[index]; // 获取当前像素的灰度值（0或255）
                                // 映射到RGBA值

                                if (color == 0)
                                {
                                    pnew_data[index * 4 + 0] = 0; // R
                                    pnew_data[index * 4 + 1] = 0; // G
                                    pnew_data[index * 4 + 2] = 0; // B
                                    pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                                }
                                else
                                {
                                    pnew_data[index * 4 + 0] = 255; // R
                                    pnew_data[index * 4 + 1] = 255; // G
                                    pnew_data[index * 4 + 2] = 255; // B
                                    pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                                }
                            }
                        }

                        sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.bmp",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                        stbi_write_bmp(bmp_name, width, height, 4, pnew_data);
                        // 使用data进行图像处理...
                        lv_mem_free(pnew_data);
                        stbi_image_free(pdata); // 释放内存

                        data = stbi_load(bmp_name, &width, &height, &channels, 0);
                        if (!data) 
                        {
                            printf("错误：无法加载图片 %s\n", bmp_name);
                        }
                        printf("图片加载成功：%dx%d，%d 通道\n", width, height, channels);

                        sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.png",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                        
                        success = stbi_write_png(bmp_name, width, height, channels, data, width * channels);
                        if (!success) 
                        {
                            printf("错误：保存 PNG 失败\n");
                        } 
                        else
                        {
                            printf("PNG 保存成功：%s\n", bmp_name);
                        }

                        // 释放内存
                        stbi_image_free(data);

                        //显示图像
                        img = lv_img_create(temp_obj);
                        sprintf(bmp_name_1,"A:%s",bmp_name);
                        lv_img_set_src(img, bmp_name_1);
                        lv_obj_center(img);

                        data_structure[win_content_child_num].data.qr_bar.size  = 256;

                        break;
                }
            }

            //lv_obj_align(temp_obj, LV_ALIGN_TOP_LEFT, 30, 0);

            lv_obj_align(temp_obj, LV_ALIGN_TOP_LEFT, 30 + 20*win_content_child_num, 6*win_content_child_num);
        }

        lv_obj_del(btn_addition_QR_code_confirm);
        lv_obj_del(label_addition_QR_code_confirm);
        lv_obj_del(btn_addition_QR_code_return);
        lv_obj_del(label_addition_QR_code_return);
        lv_obj_del(obj_addition_QR_code_bottom_bg);
        lv_obj_del(sw_addition_QR_code_border);
        lv_obj_del(label_addition_QR_code_border);
        lv_obj_del(img_addition_QR_code_border);
        lv_obj_del(label_btn_addition_QR_code_width);
        lv_obj_del(btn_addition_QR_code_width);
        lv_obj_del(label_addition_QR_code_width);
        lv_obj_del(img_addition_QR_code_width);
        lv_obj_del(label_btn_addition_QR_code_bar_code);
        lv_obj_del(btn_addition_QR_code_bar_code);
        lv_obj_del(label_addition_QR_code_bar_code);
        lv_obj_del(img_addition_QR_code_bar_code);
        lv_obj_del(sw_addition_QR_code_figure);
        lv_obj_del(label_addition_QR_code_figure);
        lv_obj_del(img_addition_QR_code_figure);
        lv_obj_del(label_btn_addition_QR_code_height);
        lv_obj_del(btn_addition_QR_code_height);
        lv_obj_del(label_addition_QR_code_height);
        lv_obj_del(img_addition_QR_code_height);
        lv_obj_del(label_btn_addition_QR_code_QR);
        lv_obj_del(btn_addition_QR_code_QR);
        lv_obj_del(label_addition_QR_code_QR);
        lv_obj_del(img_addition_QR_code);
        lv_obj_del(label_btn_addition_QR_code_text);
        lv_obj_del(label_btn_addition_QR_code_text_1);
        lv_obj_del(btn_addition_QR_code_text);
        lv_obj_del(label_addition_QR_code_text);
        lv_obj_del(img_addition_QR_code_text);
        lv_obj_del(addition_QR_code_middle_bg_1);
        lv_obj_del(addition_QR_code_middle_bg);
        lv_obj_del(label_addition_QR_code_head);
        lv_obj_del(addition_QR_code_head_bg);

        //删除添加界面
        lv_obj_del(img_addition_bg);
        lv_obj_del(btn_addition_text);
        lv_obj_del(label_btn_addition_text);
        lv_obj_del(btn_addition_date);
        lv_obj_del(label_btn_addition_date);
        lv_obj_del(btn_addition_picture);
        lv_obj_del(label_btn_addition_picture);
        lv_obj_del(btn_addition_QR_code);
        lv_obj_del(label_btn_addition_QR_code);
        lv_obj_del(btn_addition_bar_code);
        lv_obj_del(label_btn_addition_bar_code);
        lv_obj_del(btn_addition_count);
        lv_obj_del(label_btn_addition_count);
        lv_obj_del(btn_addition_subsection);
        lv_obj_del(label_btn_addition_subsection);
        lv_obj_del(btn_addition_symbol);
        lv_obj_del(label_btn_addition_symbol);
        lv_obj_del(btn_addition_icon);
        lv_obj_del(label_btn_addition_icon);
        lv_obj_del(btn_addition_more_functions);
        lv_obj_del(label_btn_addition_more_functions);
        lv_obj_del(btn_addition_return);
    }
}

void addition_QR_bar_updata(void)
{
    int len = strlen(lv_label_get_text(label_btn_addition_QR_code_text));
    printf("len=%u\n\r", len);
    if (len == 0)
    {
        lv_obj_set_style_bg_opa(label_btn_addition_QR_code_text, LV_OPA_TRANSP, LV_PART_MAIN);
        lv_obj_clear_flag(label_btn_addition_QR_code_text_1, LV_OBJ_FLAG_HIDDEN);
    }
    else
    {
        lv_obj_set_style_bg_opa(label_btn_addition_QR_code_text, LV_OPA_COVER, LV_PART_MAIN);
        lv_obj_add_flag(label_btn_addition_QR_code_text_1, LV_OBJ_FLAG_HIDDEN);
    }
}

static void btn_addition_QR_code_event_cb(lv_event_t* e)
{
    lv_event_code_t code;

    code = lv_event_get_code(e);

    if ((code == LV_EVENT_CLICKED) && (print_status == 0))
    {
        printf("btn_addition_QR_code_event_cb\n");
        buzzer_enable = 1;
        addition_QR_code_head_bg = lv_obj_create(lv_scr_act());
        lv_obj_set_size(addition_QR_code_head_bg, 480, 24);
        lv_obj_align(addition_QR_code_head_bg, LV_ALIGN_TOP_LEFT, 0, 0);
        lv_obj_set_style_border_width(addition_QR_code_head_bg, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_radius(addition_QR_code_head_bg, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_color(addition_QR_code_head_bg, lv_color_hex(0x28536a), LV_STATE_DEFAULT);
        lv_obj_remove_style(addition_QR_code_head_bg, 0, LV_PART_SCROLLBAR);

        LV_FONT_DECLARE(heiFont16_1);
        label_addition_QR_code_head = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_addition_QR_code_head, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_addition_QR_code_head, lv_color_hex(0xFFFFFF), LV_STATE_DEFAULT);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_addition_QR_code_head,  "二维码和条码");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_addition_QR_code_head, "Qr codes and bar codes");
        }
        lv_obj_align(label_addition_QR_code_head, LV_ALIGN_TOP_LEFT, 200, 4);


        addition_QR_code_middle_bg = lv_obj_create(lv_scr_act());
        lv_obj_set_size(addition_QR_code_middle_bg, 480, 100);
        lv_obj_align(addition_QR_code_middle_bg, LV_ALIGN_TOP_LEFT, 0, 24);
        lv_obj_set_style_border_width(addition_QR_code_middle_bg, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_radius(addition_QR_code_middle_bg, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_color(addition_QR_code_middle_bg, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        lv_obj_remove_style(addition_QR_code_middle_bg, 0, LV_PART_SCROLLBAR);


        addition_QR_code_middle_bg_1 = lv_obj_create(lv_scr_act());
        lv_obj_set_size(addition_QR_code_middle_bg_1, 480, 124);
        lv_obj_align(addition_QR_code_middle_bg_1, LV_ALIGN_TOP_LEFT, 0, 124);
        lv_obj_set_style_border_width(addition_QR_code_middle_bg_1, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_radius(addition_QR_code_middle_bg_1, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_color(addition_QR_code_middle_bg_1, lv_color_hex(0x1fadd3), LV_STATE_DEFAULT);
        lv_obj_remove_style(addition_QR_code_middle_bg_1, 0, LV_PART_SCROLLBAR);


        LV_IMG_DECLARE(text);
        img_addition_QR_code_text = lv_img_create(lv_scr_act());
        lv_img_set_src(img_addition_QR_code_text, &text);
        lv_obj_align(img_addition_QR_code_text, LV_ALIGN_TOP_LEFT, 10, 130);

        LV_FONT_DECLARE(heiFont16_1);
        label_addition_QR_code_text = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_addition_QR_code_text, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_addition_QR_code_text, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_addition_QR_code_text, "文本");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_addition_QR_code_text, "Text");
        }
        lv_obj_align(label_addition_QR_code_text, LV_ALIGN_TOP_LEFT, 46, 134);

        LV_FONT_DECLARE(heiFont16_1);
        btn_addition_QR_code_text = lv_btn_create(lv_scr_act());
        lv_obj_set_size(btn_addition_QR_code_text, 360, 24);
        lv_obj_align(btn_addition_QR_code_text, LV_ALIGN_TOP_LEFT, 100, 130);
        lv_obj_set_style_border_width(btn_addition_QR_code_text, 1, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_border_color(btn_addition_QR_code_text, lv_color_hex(0xaaaaaa), LV_STATE_DEFAULT); /* 设置边框颜色 */
        lv_obj_set_style_radius(btn_addition_QR_code_text, 10, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_color(btn_addition_QR_code_text, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        label_btn_addition_QR_code_text = lv_label_create(btn_addition_QR_code_text);
        lv_obj_set_style_text_font(label_btn_addition_QR_code_text, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_btn_addition_QR_code_text, lv_color_hex(0x000000), LV_STATE_DEFAULT);
        lv_label_set_text(label_btn_addition_QR_code_text, "");
        lv_obj_set_style_text_opa(label_btn_addition_QR_code_text, LV_OPA_COVER, LV_STATE_DEFAULT);
        lv_obj_align(label_btn_addition_QR_code_text, LV_ALIGN_CENTER, 0, 0);
        lv_obj_set_style_border_width(label_btn_addition_QR_code_text, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_border_color(label_btn_addition_QR_code_text, lv_color_hex(0x000000), LV_STATE_DEFAULT); /* 设置边框颜色 */
        lv_obj_set_style_border_opa(label_btn_addition_QR_code_text, LV_OPA_TRANSP, LV_STATE_DEFAULT); /* 设置边框透明度 */
        lv_obj_set_style_radius(label_btn_addition_QR_code_text, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_opa(label_btn_addition_QR_code_text, LV_OPA_TRANSP, LV_PART_MAIN);
        lv_obj_set_style_bg_color(label_btn_addition_QR_code_text, lv_color_hex(0xffffff), LV_PART_MAIN);
        lv_obj_add_event_cb(btn_addition_QR_code_text, btn_addition_QR_code_text_event_cb, LV_EVENT_CLICKED, NULL);


        label_btn_addition_QR_code_text_1 = lv_label_create(btn_addition_QR_code_text);
        lv_obj_set_style_text_font(label_btn_addition_QR_code_text_1, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_btn_addition_QR_code_text_1, lv_color_hex(0x000000), LV_STATE_DEFAULT);

        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_btn_addition_QR_code_text_1, "请输入文字");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_btn_addition_QR_code_text_1, "Please enter the text.");
        }
        lv_obj_set_style_text_opa(label_btn_addition_QR_code_text_1, LV_OPA_60, LV_STATE_DEFAULT);
        lv_obj_align(label_btn_addition_QR_code_text_1, LV_ALIGN_CENTER, 0, 0);
        lv_obj_set_style_border_width(label_btn_addition_QR_code_text_1, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_border_color(label_btn_addition_QR_code_text_1, lv_color_hex(0x000000), LV_STATE_DEFAULT); /* 设置边框颜色 */
        lv_obj_set_style_border_opa(label_btn_addition_QR_code_text_1, LV_OPA_TRANSP, LV_STATE_DEFAULT); /* 设置边框透明度 */
        lv_obj_set_style_radius(label_btn_addition_QR_code_text_1, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_opa(label_btn_addition_QR_code_text_1, LV_OPA_COVER, LV_PART_MAIN);
        lv_obj_set_style_bg_color(label_btn_addition_QR_code_text_1, lv_color_hex(0xffffff), LV_PART_MAIN);
        lv_obj_set_style_text_opa(label_btn_addition_QR_code_text_1, LV_OPA_60, LV_STATE_DEFAULT);


        LV_IMG_DECLARE(qr_code);
        img_addition_QR_code = lv_img_create(lv_scr_act());
        lv_img_set_src(img_addition_QR_code, &qr_code);
        lv_obj_align(img_addition_QR_code, LV_ALIGN_TOP_LEFT, 10, 160);

        LV_FONT_DECLARE(heiFont16_1);
        label_addition_QR_code_QR = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_addition_QR_code_QR, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_addition_QR_code_QR, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_addition_QR_code_QR,  "二维码");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_addition_QR_code_QR, "QR code");
        }
        lv_obj_align(label_addition_QR_code_QR, LV_ALIGN_TOP_LEFT, 46, 164);

        LV_FONT_DECLARE(heiFont16_1);
        btn_addition_QR_code_QR = lv_btn_create(lv_scr_act());
        lv_obj_set_size(btn_addition_QR_code_QR, 100, 24);
        lv_obj_align(btn_addition_QR_code_QR, LV_ALIGN_TOP_LEFT,100, 160);
        lv_obj_set_style_border_width(btn_addition_QR_code_QR, 1, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_border_color(btn_addition_QR_code_QR, lv_color_hex(0x000000), LV_STATE_DEFAULT); /* 设置边框颜色 */
        lv_obj_set_style_radius(btn_addition_QR_code_QR, 10, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_color(btn_addition_QR_code_QR, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        label_btn_addition_QR_code_QR = lv_label_create(btn_addition_QR_code_QR);
        lv_obj_set_style_text_font(label_btn_addition_QR_code_QR, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_btn_addition_QR_code_QR, lv_color_hex(0x000000), LV_STATE_DEFAULT);
        lv_label_set_text(label_btn_addition_QR_code_QR, "QR");
        lv_obj_align(label_btn_addition_QR_code_QR, LV_ALIGN_CENTER, 0, 0);
        lv_obj_set_style_border_width(label_btn_addition_QR_code_QR, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_border_color(label_btn_addition_QR_code_QR, lv_color_hex(0x000000), LV_STATE_DEFAULT); /* 设置边框颜色 */
        lv_obj_set_style_border_opa(label_btn_addition_QR_code_QR, 100, LV_STATE_DEFAULT); /* 设置边框透明度 */
        lv_obj_set_style_radius(label_btn_addition_QR_code_QR, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_opa(label_btn_addition_QR_code_QR, LV_OPA_COVER, LV_PART_MAIN);
        lv_obj_set_style_bg_color(label_btn_addition_QR_code_QR, lv_color_hex(0xffffff), LV_PART_MAIN);
        lv_obj_add_event_cb(btn_addition_QR_code_QR, btn_addition_QR_code_QR_event_cb, LV_EVENT_CLICKED, NULL);

        QR_code_type = 0;

        LV_IMG_DECLARE(word_size);
        img_addition_QR_code_height = lv_img_create(lv_scr_act());
        lv_img_set_src(img_addition_QR_code_height, &word_size);
        lv_obj_align(img_addition_QR_code_height, LV_ALIGN_TOP_LEFT, 10, 190);

        LV_FONT_DECLARE(heiFont16_1);
        label_addition_QR_code_height = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_addition_QR_code_height, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_addition_QR_code_height, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_addition_QR_code_height, "高度");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_addition_QR_code_height, "Height");
        }
        lv_obj_align(label_addition_QR_code_height, LV_ALIGN_TOP_LEFT, 46, 194);

        LV_FONT_DECLARE(heiFont16_1);
        btn_addition_QR_code_height = lv_btn_create(lv_scr_act());
        lv_obj_set_size(btn_addition_QR_code_height, 100, 24);
        lv_obj_align(btn_addition_QR_code_height, LV_ALIGN_TOP_LEFT, 100, 190);
        lv_obj_set_style_border_width(btn_addition_QR_code_height, 1, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_border_color(btn_addition_QR_code_height, lv_color_hex(0x000000), LV_STATE_DEFAULT); /* 设置边框颜色 */
        lv_obj_set_style_radius(btn_addition_QR_code_height, 10, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_color(btn_addition_QR_code_height, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        label_btn_addition_QR_code_height = lv_label_create(btn_addition_QR_code_height);
        lv_obj_set_style_text_font(label_btn_addition_QR_code_height, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_btn_addition_QR_code_height, lv_color_hex(0x000000), LV_STATE_DEFAULT);
        lv_label_set_text(label_btn_addition_QR_code_height, "200");
        lv_obj_align(label_btn_addition_QR_code_height, LV_ALIGN_CENTER, 0, 0);
        lv_obj_set_style_border_width(label_btn_addition_QR_code_height, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_border_color(label_btn_addition_QR_code_height, lv_color_hex(0x000000), LV_STATE_DEFAULT); /* 设置边框颜色 */
        lv_obj_set_style_border_opa(label_btn_addition_QR_code_height, 100, LV_STATE_DEFAULT); /* 设置边框透明度 */
        lv_obj_set_style_radius(label_btn_addition_QR_code_height, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_opa(label_btn_addition_QR_code_height, LV_OPA_COVER, LV_PART_MAIN);
        lv_obj_set_style_bg_color(label_btn_addition_QR_code_height, lv_color_hex(0xffffff), LV_PART_MAIN);
        lv_obj_add_event_cb(btn_addition_QR_code_height, btn_addition_QR_code_height_event_cb, LV_EVENT_CLICKED, NULL);


        LV_IMG_DECLARE(figure);
        img_addition_QR_code_figure = lv_img_create(lv_scr_act());
        lv_img_set_src(img_addition_QR_code_figure, &figure);
        lv_obj_align(img_addition_QR_code_figure, LV_ALIGN_TOP_LEFT, 10, 220);

        LV_FONT_DECLARE(heiFont16_1);
        label_addition_QR_code_figure = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_addition_QR_code_figure, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_addition_QR_code_figure, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_addition_QR_code_figure, "数字");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_addition_QR_code_figure, "Figure");
        }
        lv_obj_align(label_addition_QR_code_figure, LV_ALIGN_TOP_LEFT, 46, 224);


        sw_addition_QR_code_figure = lv_switch_create(lv_scr_act());
        lv_obj_set_pos(sw_addition_QR_code_figure, 100, 220);
        lv_obj_set_width(sw_addition_QR_code_figure, 48);
        lv_obj_set_height(sw_addition_QR_code_figure, 23);
        //lv_obj_set_style_bg_color(bold_sw, lv_color_hex(0x00ff00), LV_PART_MAIN);
        lv_obj_set_style_bg_color(sw_addition_QR_code_figure, lv_color_hex(0x00ff00), LV_STATE_CHECKED | LV_PART_INDICATOR);
        lv_obj_add_event_cb(sw_addition_QR_code_figure, sw_addition_QR_code_border_event_cb, LV_EVENT_ALL, NULL);



        LV_IMG_DECLARE(bar_code);
        img_addition_QR_code_bar_code = lv_img_create(lv_scr_act());
        lv_img_set_src(img_addition_QR_code_bar_code, &bar_code);
        lv_obj_align(img_addition_QR_code_bar_code, LV_ALIGN_TOP_LEFT, 240, 160);

        LV_FONT_DECLARE(heiFont16_1);
        label_addition_QR_code_bar_code = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_addition_QR_code_bar_code, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_addition_QR_code_bar_code, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_addition_QR_code_bar_code, "条形码");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_addition_QR_code_bar_code, "Bar code");
        }
        lv_obj_align(label_addition_QR_code_bar_code, LV_ALIGN_TOP_LEFT, 276, 164);

        LV_FONT_DECLARE(heiFont16_1);
        btn_addition_QR_code_bar_code = lv_btn_create(lv_scr_act());
        lv_obj_set_size(btn_addition_QR_code_bar_code, 100, 24);
        lv_obj_align(btn_addition_QR_code_bar_code, LV_ALIGN_TOP_LEFT, 330, 160);
        lv_obj_set_style_border_width(btn_addition_QR_code_bar_code, 1, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_border_color(btn_addition_QR_code_bar_code, lv_color_hex(0x000000), LV_STATE_DEFAULT); /* 设置边框颜色 */
        lv_obj_set_style_radius(btn_addition_QR_code_bar_code, 10, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_color(btn_addition_QR_code_bar_code, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        label_btn_addition_QR_code_bar_code = lv_label_create(btn_addition_QR_code_bar_code);
        lv_obj_set_style_text_font(label_btn_addition_QR_code_bar_code, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_btn_addition_QR_code_bar_code, lv_color_hex(0x000000), LV_STATE_DEFAULT);
        lv_label_set_text(label_btn_addition_QR_code_bar_code, "CODE128");
        lv_obj_align(label_btn_addition_QR_code_bar_code, LV_ALIGN_CENTER, 0, 0);
        lv_obj_set_style_border_width(label_btn_addition_QR_code_bar_code, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_border_color(label_btn_addition_QR_code_bar_code, lv_color_hex(0x000000), LV_STATE_DEFAULT); /* 设置边框颜色 */
        lv_obj_set_style_border_opa(label_btn_addition_QR_code_bar_code, 100, LV_STATE_DEFAULT); /* 设置边框透明度 */
        lv_obj_set_style_radius(label_btn_addition_QR_code_bar_code, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_opa(label_btn_addition_QR_code_bar_code, LV_OPA_COVER, LV_PART_MAIN);
        lv_obj_set_style_bg_color(label_btn_addition_QR_code_bar_code, lv_color_hex(0xffffff), LV_PART_MAIN);
        lv_obj_add_event_cb(btn_addition_QR_code_bar_code, btn_addition_QR_code_bar_code_event_cb, LV_EVENT_CLICKED, NULL);

        bar_code_type = 1;

        LV_IMG_DECLARE(width);
        img_addition_QR_code_width = lv_img_create(lv_scr_act());
        lv_img_set_src(img_addition_QR_code_width, &width);
        lv_obj_align(img_addition_QR_code_width, LV_ALIGN_TOP_LEFT, 240, 190);

        LV_FONT_DECLARE(heiFont16_1);
        label_addition_QR_code_width = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_addition_QR_code_width, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_addition_QR_code_width, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_addition_QR_code_width, "宽度");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_addition_QR_code_width, "Width");
        }
        lv_obj_align(label_addition_QR_code_width, LV_ALIGN_TOP_LEFT, 276, 194);

        LV_FONT_DECLARE(heiFont16_1);
        btn_addition_QR_code_width = lv_btn_create(lv_scr_act());
        lv_obj_set_size(btn_addition_QR_code_width, 100, 24);
        lv_obj_align(btn_addition_QR_code_width, LV_ALIGN_TOP_LEFT, 330, 190);
        lv_obj_set_style_border_width(btn_addition_QR_code_width, 1, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_border_color(btn_addition_QR_code_width, lv_color_hex(0x000000), LV_STATE_DEFAULT); /* 设置边框颜色 */
        lv_obj_set_style_radius(btn_addition_QR_code_width, 10, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_color(btn_addition_QR_code_width, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        label_btn_addition_QR_code_width = lv_label_create(btn_addition_QR_code_width);
        lv_obj_set_style_text_font(label_btn_addition_QR_code_width, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_btn_addition_QR_code_width, lv_color_hex(0x000000), LV_STATE_DEFAULT);
        lv_label_set_text(label_btn_addition_QR_code_width, "");
        lv_obj_align(label_btn_addition_QR_code_width, LV_ALIGN_CENTER, 0, 0);
        lv_obj_set_style_border_width(label_btn_addition_QR_code_width, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_border_color(label_btn_addition_QR_code_width, lv_color_hex(0x000000), LV_STATE_DEFAULT); /* 设置边框颜色 */
        lv_obj_set_style_border_opa(label_btn_addition_QR_code_width, 100, LV_STATE_DEFAULT); /* 设置边框透明度 */
        lv_obj_set_style_radius(label_btn_addition_QR_code_width, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_opa(label_btn_addition_QR_code_width, LV_OPA_COVER, LV_PART_MAIN);
        lv_obj_set_style_bg_color(label_btn_addition_QR_code_width, lv_color_hex(0xffffff), LV_PART_MAIN);
        lv_obj_add_event_cb(btn_addition_QR_code_width, btn_addition_QR_code_width_event_cb, LV_EVENT_CLICKED, NULL);


        LV_IMG_DECLARE(border);
        img_addition_QR_code_border = lv_img_create(lv_scr_act());
        lv_img_set_src(img_addition_QR_code_border, &border);
        lv_obj_align(img_addition_QR_code_border, LV_ALIGN_TOP_LEFT, 240, 220);

        LV_FONT_DECLARE(heiFont16_1);
        label_addition_QR_code_border = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_addition_QR_code_border, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_addition_QR_code_border, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_addition_QR_code_border, "边框");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_addition_QR_code_border, "Border");
        }
        lv_obj_align(label_addition_QR_code_border, LV_ALIGN_TOP_LEFT, 276, 224);


        sw_addition_QR_code_border = lv_switch_create(lv_scr_act());
        lv_obj_set_pos(sw_addition_QR_code_border, 330, 220);
        lv_obj_set_width(sw_addition_QR_code_border, 48);
        lv_obj_set_height(sw_addition_QR_code_border, 23);
        //lv_obj_set_style_bg_color(bold_sw, lv_color_hex(0x00ff00), LV_PART_MAIN);
        lv_obj_set_style_bg_color(sw_addition_QR_code_border, lv_color_hex(0x00ff00), LV_STATE_CHECKED | LV_PART_INDICATOR);
        lv_obj_add_event_cb(sw_addition_QR_code_border, sw_addition_QR_code_border_event_cb, LV_EVENT_ALL, NULL);

        obj_addition_QR_code_bottom_bg = lv_obj_create(lv_scr_act());
        lv_obj_set_size(obj_addition_QR_code_bottom_bg, 480, 24);
        lv_obj_align(obj_addition_QR_code_bottom_bg, LV_ALIGN_TOP_LEFT, 0, 248);
        lv_obj_set_style_border_width(obj_addition_QR_code_bottom_bg, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_radius(obj_addition_QR_code_bottom_bg, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_color(obj_addition_QR_code_bottom_bg, lv_color_hex(0x28536a), LV_STATE_DEFAULT);
        lv_obj_remove_style(obj_addition_QR_code_bottom_bg, 0, LV_PART_SCROLLBAR);

        
        LV_FONT_DECLARE(heiFont16_1);
        label_addition_QR_code_return = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_addition_QR_code_return, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_addition_QR_code_return, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_addition_QR_code_return, "返回");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_addition_QR_code_return, "Return");
        }
        lv_obj_align(label_addition_QR_code_return, LV_ALIGN_TOP_LEFT, 140, 252);

        LV_IMG_DECLARE(get_back);
        btn_addition_QR_code_return = lv_imgbtn_create(lv_scr_act());
        lv_imgbtn_set_src(btn_addition_QR_code_return, LV_IMGBTN_STATE_RELEASED, NULL, &get_back, NULL);
        lv_obj_set_size(btn_addition_QR_code_return, get_back.header.w, get_back.header.h);
        lv_obj_align(btn_addition_QR_code_return, LV_ALIGN_TOP_LEFT, 180, 250);
        lv_obj_add_event_cb(btn_addition_QR_code_return, btn_addition_QR_code_return_event_cb, LV_EVENT_CLICKED, NULL);

        LV_IMG_DECLARE(confirm);
        btn_addition_QR_code_confirm = lv_imgbtn_create(lv_scr_act());
        lv_imgbtn_set_src(btn_addition_QR_code_confirm, LV_IMGBTN_STATE_RELEASED, NULL, &confirm, NULL);
        lv_obj_set_size(btn_addition_QR_code_confirm, get_back.header.w, get_back.header.h);
        lv_obj_align(btn_addition_QR_code_confirm, LV_ALIGN_TOP_LEFT, 250, 250);
        lv_obj_add_event_cb(btn_addition_QR_code_confirm, btn_addition_QR_code_confirm_event_cb, LV_EVENT_CLICKED, NULL);

        LV_FONT_DECLARE(heiFont16_1);
        label_addition_QR_code_confirm = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_addition_QR_code_confirm, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_addition_QR_code_confirm, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_addition_QR_code_confirm, "确定");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_addition_QR_code_confirm, "Confirm");
        }
        lv_obj_align(label_addition_QR_code_confirm, LV_ALIGN_TOP_LEFT, 277, 252);

        addition_QR_bar_updata();
        
    }
}

static void btn_addition_bar_code_event_cb(lv_event_t* e)
{
    lv_event_code_t code;

    code = lv_event_get_code(e);

    if ((code == LV_EVENT_CLICKED) && (print_status == 0))
    {
        printf("btn_addition_bar_code_event_cb\n");
    }
}

static void button_addition_event_cb(lv_event_t* e)
{
     lv_event_code_t code;
    //lv_obj_t* keyboard;
    //lv_obj_t* textarea;
    //lv_obj_t* pinyin_ime;
    //lv_obj_t* cand_panel;

    code = lv_event_get_code(e);
    if ((code == LV_EVENT_CLICKED) && (print_status == 0))
    {
        printf("addition\n");
        flag_modification_or_addition = 0;
        buzzer_enable = 1;
        LV_IMG_DECLARE(img_addition_bg_2);
        img_addition_bg = lv_img_create(lv_scr_act());
        lv_img_set_src(img_addition_bg, &img_addition_bg_2);
        lv_obj_align(img_addition_bg, LV_ALIGN_TOP_LEFT, 0, 0);


        LV_IMG_DECLARE(img_text_40);
        btn_addition_text = lv_imgbtn_create(lv_scr_act());
        lv_imgbtn_set_src(btn_addition_text, LV_IMGBTN_STATE_RELEASED, NULL, &img_text_40, NULL);
        lv_obj_set_size(btn_addition_text, img_text_40.header.w, img_text_40.header.h);
        lv_obj_align(btn_addition_text, LV_ALIGN_TOP_LEFT, 60, 40);
        lv_obj_add_event_cb(btn_addition_text, button_addition_text_event_cb, LV_EVENT_CLICKED, NULL);


        LV_FONT_DECLARE(heiFont16_1);
        label_btn_addition_text = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_btn_addition_text, &heiFont16_1, LV_STATE_DEFAULT);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_btn_addition_text,  "文本");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_btn_addition_text, "Text");
        }
        lv_obj_align(label_btn_addition_text, LV_ALIGN_TOP_LEFT, 65, 85);
        lv_obj_set_style_text_color(label_btn_addition_text, lv_color_hex(0xffffff), LV_STATE_DEFAULT);


        LV_IMG_DECLARE(img_date_40);
        btn_addition_date = lv_imgbtn_create(lv_scr_act());
        lv_imgbtn_set_src(btn_addition_date, LV_IMGBTN_STATE_RELEASED, NULL, &img_date_40, NULL);
        lv_obj_set_size(btn_addition_date, img_date_40.header.w, img_date_40.header.h);
        lv_obj_align(btn_addition_date, LV_ALIGN_TOP_LEFT, 140, 40);
        lv_obj_add_event_cb(btn_addition_date, button_addition_date_event_cb, LV_EVENT_CLICKED, NULL);


        LV_FONT_DECLARE(heiFont16_1);
        label_btn_addition_date = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_btn_addition_date, &heiFont16_1, LV_STATE_DEFAULT);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_btn_addition_date,  "日期");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_btn_addition_date, "Date");
        }
        lv_obj_align(label_btn_addition_date, LV_ALIGN_TOP_LEFT, 145, 85);
        lv_obj_set_style_text_color(label_btn_addition_date, lv_color_hex(0xffffff), LV_STATE_DEFAULT);


        LV_IMG_DECLARE(img_picture_40);
        btn_addition_picture = lv_imgbtn_create(lv_scr_act());
        lv_imgbtn_set_src(btn_addition_picture, LV_IMGBTN_STATE_RELEASED, NULL, &img_picture_40, NULL);
        lv_obj_set_size(btn_addition_picture, img_picture_40.header.w, img_picture_40.header.h);
        lv_obj_align(btn_addition_picture, LV_ALIGN_TOP_LEFT, 220, 40);
        lv_obj_add_event_cb(btn_addition_picture, button_addition_picture_event_cb, LV_EVENT_CLICKED, NULL);

        LV_FONT_DECLARE(heiFont16_1);
        label_btn_addition_picture = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_btn_addition_picture, &heiFont16_1, LV_STATE_DEFAULT);

        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_btn_addition_picture,  "图片");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_btn_addition_picture, "Picture");
        }
        lv_obj_align(label_btn_addition_picture, LV_ALIGN_TOP_LEFT, 225, 85);
        lv_obj_set_style_text_color(label_btn_addition_picture, lv_color_hex(0xffffff), LV_STATE_DEFAULT);

        LV_IMG_DECLARE(img_QR_40);
        btn_addition_QR_code = lv_imgbtn_create(lv_scr_act());
        lv_imgbtn_set_src(btn_addition_QR_code, LV_IMGBTN_STATE_RELEASED, NULL, &img_QR_40, NULL);
        lv_obj_set_size(btn_addition_QR_code, img_QR_40.header.w, img_QR_40.header.h);
        lv_obj_align(btn_addition_QR_code, LV_ALIGN_TOP_LEFT, 300, 40);
        lv_obj_add_event_cb(btn_addition_QR_code, btn_addition_QR_code_event_cb, LV_EVENT_CLICKED, NULL);

        LV_FONT_DECLARE(heiFont16_1);
        label_btn_addition_QR_code = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_btn_addition_QR_code, &heiFont16_1, LV_STATE_DEFAULT);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_btn_addition_QR_code,  "二维码");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_btn_addition_QR_code, "QR code");
        }
        lv_obj_align(label_btn_addition_QR_code, LV_ALIGN_TOP_LEFT, 300, 85);
        lv_obj_set_style_text_color(label_btn_addition_QR_code, lv_color_hex(0xffffff), LV_STATE_DEFAULT);

        LV_IMG_DECLARE(img_bar_40);
        btn_addition_bar_code = lv_imgbtn_create(lv_scr_act());
        lv_imgbtn_set_src(btn_addition_bar_code, LV_IMGBTN_STATE_RELEASED, NULL, &img_bar_40, NULL);
        lv_obj_set_size(btn_addition_bar_code, img_bar_40.header.w, img_bar_40.header.h);
        lv_obj_align(btn_addition_bar_code, LV_ALIGN_TOP_LEFT, 380, 40);
        lv_obj_add_event_cb(btn_addition_bar_code, btn_addition_QR_code_event_cb, LV_EVENT_CLICKED, NULL);

        LV_FONT_DECLARE(heiFont16_1);
        label_btn_addition_bar_code = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_btn_addition_bar_code, &heiFont16_1, LV_STATE_DEFAULT);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_btn_addition_bar_code, "条码");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_btn_addition_bar_code, "Bar code");
        }
        lv_obj_align(label_btn_addition_bar_code, LV_ALIGN_TOP_LEFT, 385, 85);
        lv_obj_set_style_text_color(label_btn_addition_bar_code, lv_color_hex(0xffffff), LV_STATE_DEFAULT);


        LV_IMG_DECLARE(img_count_40);
        btn_addition_count = lv_imgbtn_create(lv_scr_act());
        lv_imgbtn_set_src(btn_addition_count, LV_IMGBTN_STATE_RELEASED, NULL, &img_count_40, NULL);
        lv_obj_set_size(btn_addition_count, img_count_40.header.w, img_count_40.header.h);
        lv_obj_align(btn_addition_count, LV_ALIGN_TOP_LEFT, 60, 130);
        lv_obj_add_event_cb(btn_addition_count, btn_addition_count_event_cb, LV_EVENT_CLICKED, NULL);


        LV_FONT_DECLARE(heiFont16_1);
        label_btn_addition_count = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_btn_addition_count, &heiFont16_1, LV_STATE_DEFAULT);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_btn_addition_count, "计数");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_btn_addition_count, "Count");
        }
        lv_obj_align(label_btn_addition_count, LV_ALIGN_TOP_LEFT, 65, 175);
        lv_obj_set_style_text_color(label_btn_addition_count, lv_color_hex(0xffffff), LV_STATE_DEFAULT);


        LV_IMG_DECLARE(img_subsection_40);
        btn_addition_subsection = lv_imgbtn_create(lv_scr_act());
        lv_imgbtn_set_src(btn_addition_subsection, LV_IMGBTN_STATE_RELEASED, NULL, &img_subsection_40, NULL);
        lv_obj_set_size(btn_addition_subsection, img_subsection_40.header.w, img_subsection_40.header.h);
        lv_obj_align(btn_addition_subsection, LV_ALIGN_TOP_LEFT, 140, 130);
        lv_obj_add_event_cb(btn_addition_subsection, btn_addition_subsection_event_cb, LV_EVENT_CLICKED, NULL);


        LV_FONT_DECLARE(heiFont16_1);
        label_btn_addition_subsection = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_btn_addition_subsection, &heiFont16_1, LV_STATE_DEFAULT);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_btn_addition_subsection, "分段");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_btn_addition_subsection, "Subsection");
        }
        lv_obj_align(label_btn_addition_subsection, LV_ALIGN_TOP_LEFT, 145, 175);
        lv_obj_set_style_text_color(label_btn_addition_subsection, lv_color_hex(0xffffff), LV_STATE_DEFAULT);


        LV_IMG_DECLARE(img_symbol_40);
        btn_addition_symbol = lv_imgbtn_create(lv_scr_act());
        lv_imgbtn_set_src(btn_addition_symbol, LV_IMGBTN_STATE_RELEASED, NULL, &img_symbol_40, NULL);
        lv_obj_set_size(btn_addition_symbol, img_symbol_40.header.w, img_symbol_40.header.h);
        lv_obj_align(btn_addition_symbol, LV_ALIGN_TOP_LEFT, 220, 130);
        lv_obj_add_event_cb(btn_addition_symbol, btn_addition_symbol_event_cb, LV_EVENT_CLICKED, NULL);


        LV_FONT_DECLARE(heiFont16_1);
        label_btn_addition_symbol = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_btn_addition_symbol, &heiFont16_1, LV_STATE_DEFAULT);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_btn_addition_symbol, "符号");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_btn_addition_symbol, "Symbol");
        }
        lv_obj_align(label_btn_addition_symbol, LV_ALIGN_TOP_LEFT, 225, 175);
        lv_obj_set_style_text_color(label_btn_addition_symbol, lv_color_hex(0xffffff), LV_STATE_DEFAULT);


        LV_IMG_DECLARE(img_icon_40);
        btn_addition_icon = lv_imgbtn_create(lv_scr_act());
        lv_imgbtn_set_src(btn_addition_icon, LV_IMGBTN_STATE_RELEASED, NULL, &img_icon_40, NULL);
        lv_obj_set_size(btn_addition_icon, img_icon_40.header.w, img_icon_40.header.h);
        lv_obj_align(btn_addition_icon, LV_ALIGN_TOP_LEFT, 300, 130);
        lv_obj_add_event_cb(btn_addition_icon, btn_addition_icon_event_cb, LV_EVENT_CLICKED, NULL);


        LV_FONT_DECLARE(heiFont16_1);
        label_btn_addition_icon = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_btn_addition_icon, &heiFont16_1, LV_STATE_DEFAULT);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_btn_addition_icon, "标识");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_btn_addition_icon, "Icon");
        }
        lv_obj_align(label_btn_addition_icon, LV_ALIGN_TOP_LEFT, 305, 175);
        lv_obj_set_style_text_color(label_btn_addition_icon, lv_color_hex(0xffffff), LV_STATE_DEFAULT);


        LV_IMG_DECLARE(img_more_functions_40);
        btn_addition_more_functions = lv_imgbtn_create(lv_scr_act());
        lv_imgbtn_set_src(btn_addition_more_functions, LV_IMGBTN_STATE_RELEASED, NULL, &img_more_functions_40, NULL);
        lv_obj_set_size(btn_addition_more_functions, img_more_functions_40.header.w, img_more_functions_40.header.h);
        lv_obj_align(btn_addition_more_functions, LV_ALIGN_TOP_LEFT, 380, 130);
        lv_obj_add_event_cb(btn_addition_more_functions, btn_addition_more_functions_event_cb, LV_EVENT_CLICKED, NULL);


        LV_FONT_DECLARE(heiFont16_1);
        label_btn_addition_more_functions = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_btn_addition_more_functions, &heiFont16_1, LV_STATE_DEFAULT);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_btn_addition_more_functions, "更多");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_btn_addition_more_functions, "More");
        }
        lv_obj_align(label_btn_addition_more_functions, LV_ALIGN_TOP_LEFT, 385, 175);
        lv_obj_set_style_text_color(label_btn_addition_more_functions, lv_color_hex(0xffffff), LV_STATE_DEFAULT);


        LV_IMG_DECLARE(img_return_1);
        btn_addition_return = lv_imgbtn_create(lv_scr_act());
        lv_imgbtn_set_src(btn_addition_return, LV_IMGBTN_STATE_RELEASED, NULL, &img_return_1, NULL);
        lv_obj_set_size(btn_addition_return, img_return_1.header.w, img_return_1.header.h);
        lv_obj_align(btn_addition_return, LV_ALIGN_TOP_LEFT, 370, 220);
        lv_obj_add_event_cb(btn_addition_return, imgbtn_addition_return_event_cb, LV_EVENT_CLICKED, NULL);
    }
}




//sprintf(temp_typeface, "/media/%s", typeface_buf[i]);
static void button_delete_event_cb(lv_event_t* e)
{
    lv_event_code_t code;
    int i,k;
    char date_time_str[64] ={0};
    int win_content_child_num = 0;
    //char file_name[128]={ 0 };
    //char temp_typeface[128] = { 0 };
    int word_space = 0;
    //int word_size = 0;
    //int x_size = 0;
    //int y_size = 0;
    struct zint_symbol* my_symbol = NULL;
    int str_len;
    //int width_len;
    int height_len;
    int width, height, channels;
    unsigned char* pdata = NULL; 
    unsigned char* pnew_data = NULL;
    lv_obj_t* img = NULL;
    lv_obj_t* temp_obj = NULL;
    char tempString[32] = { 0 };
    lv_point_t text_size;
    lv_obj_t* label1; 
    char bmp_name[64]={0};
    char bmp_name_1[80]={0};  
    int success;
    unsigned char * data = NULL;
    lv_obj_t* img_obj = NULL;
    lv_img_t* img_1 = NULL;
    lv_img_dsc_t* img_dsc = NULL;
    lv_font_t* temp_font = NULL;
    int now_year = 0;
    int now_month = 0;
    int now_day = 0;
    int end_year = 0;
    int end_month = 0;
    int end_day = 0;

    code = lv_event_get_code(e);
    if ((code == LV_EVENT_CLICKED)&&(print_status == 0))
    {
        if (temp_focused_obj != NULL)
        {
            buzzer_enable = 1;
            k = lv_obj_get_index(temp_focused_obj);
            win_content_child_num = lv_obj_get_child_cnt(win_content);

            printf("k=%d child_num=%d\n", k, win_content_child_num);

            for (i = 0; i < win_content_child_num; i++)
            {
                printf("\n\r###############################\n");
                printf("i=%d\n", i);
                printf("x=%d\n", data_structure[i].x);
                printf("y=%d\n", data_structure[i].y);
                printf("type=%d\n", data_structure[i].type);
            }
            
            //删除所有数据
            for(i=0;i<win_content_child_num;i++)
            {
                if(data_structure[i].type == TYPE_WORD)
                {
                    //删除所有数据
                    lv_style_reset(&data_structure[i].data.word.style);
                    //lv_ft_font_destroy(data_structure[i].data.word.info.font);   
                }
                else if(data_structure[i].type == TYPE_DATE)
                {
                    lv_style_reset(&data_structure[i].data.date_time.style);
                    //lv_ft_font_destroy(data_structure[i].data.date_time.info.font);   
                }
                else if(data_structure[i].type == TYPE_PITCTURE)
                {

                }
                else if(data_structure[i].type == TYPE_QR)
                {

                }
                else if(data_structure[i].type == TYPE_BAR)
                {

                }
                else if(data_structure[i].type == TYPE_COUNT)
                {
                    lv_style_reset(&data_structure[i].data.count.style);
                    //lv_ft_font_destroy(data_structure[i].data.count.info.font);  
                }
                else if(data_structure[i].type == TYPE_BREAK)
                {

                }
                else if(data_structure[i].type == TYPE_SYMBOL)
                {
                    //删除所有数据
                    lv_style_reset(&data_structure[i].data.word.style);
                    //lv_ft_font_destroy(data_structure[i].data.word.info.font);  
                }
            }   


            for (i = 0; i < win_content_child_num; i++)
            {
                lv_obj_del(lv_obj_get_child(win_content, 0));
            }


            //重新整理数据
            for (i = k; i < win_content_child_num - 1; i++)
            {
                memcpy((char*)&data_structure[i], (char*)&data_structure[i + 1], sizeof(DATA_STRUCTURE));
            }

            win_content_child_num--;

             printf("win_content_child_num=%d\n\r",win_content_child_num);

            //重新新建数据
            for(i=0;i< win_content_child_num;i++)
            { 
                printf("type=%d\n\r",data_structure[i].type);
                switch(data_structure[i].type)
                {
                    case TYPE_WORD:
                    {
                        temp_obj = lv_obj_create(win_content);          
                        //sprintf(temp_typeface,"/media/%s", typeface_buf[data_structure[i].data.word.typeface]);
                        //data_structure[i].data.word.info.name = temp_typeface;
                        //printf("%s\n\r", temp_typeface);
                        data_structure[i].data.word.info.weight = data_structure[i].data.word.size;
                        data_structure[i].data.word.info.style = data_structure[i].data.word.italic_bold;
                        //lv_ft_font_init(&data_structure[i].data.word.info);
                        printf("typeface=%d\n\r", data_structure[i].data.word.typeface);
                        temp_font = font_list_get(data_structure[i].data.word.typeface, data_structure[i].data.word.size, data_structure[i].data.word.info.style);
                        lv_txt_get_size(&text_size, data_structure[i].data.word.text, temp_font, data_structure[i].data.word.space, 0, LV_COORD_MAX, LV_TEXT_FLAG_NONE);  
                 
                        lv_obj_set_style_bg_opa(temp_obj, LV_OPA_TRANSP, 0);
                        lv_obj_set_style_border_width(temp_obj, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */

                        lv_obj_add_event_cb(temp_obj, drag_event_handler, LV_EVENT_PRESSING, NULL);
                        lv_obj_add_event_cb(temp_obj, drag_event_handler, LV_EVENT_FOCUSED, NULL);
                        lv_obj_add_event_cb(temp_obj, drag_event_handler, LV_EVENT_DEFOCUSED, NULL);
                        lv_obj_clear_flag(temp_obj, LV_OBJ_FLAG_SCROLLABLE);
                        lv_style_init(&data_structure[i].data.word.style);
                        lv_style_set_text_font(&data_structure[i].data.word.style,temp_font);
                        word_space = data_structure[i].data.word.space;
                        printf("x=%u y=%u\n\r", text_size.x, text_size.y);

                        //x_size = text_size.x + text_size.x / text_size.y * word_space * 2;

                        //printf("x_size=%d\n\r", x_size);

                        lv_obj_set_size(temp_obj, text_size.x, text_size.y);
                        lv_obj_set_style_transform_angle(temp_obj, data_structure[i].data.word.spin*10, 0);

                        if (data_structure[i].data.word.spin != 0)
                        {
                            lv_obj_align(temp_obj, LV_ALIGN_TOP_LEFT,  text_size.x, text_size.y);
                        }

                        lv_style_set_text_letter_space(&data_structure[i].data.word.style, word_space);
                        label1 = lv_label_create(temp_obj);
                        lv_obj_add_style(label1, &data_structure[i].data.word.style, 0);
                        lv_label_set_text(label1, data_structure[i].data.word.text);
                        lv_obj_center(label1);     
                        lv_obj_align(temp_obj, LV_ALIGN_OUT_TOP_LEFT, data_structure[i].x, data_structure[i].y);
                        break;
                    }             
                    case TYPE_ICON:
                    {

                        temp_obj = lv_obj_create(win_content);

                        lv_obj_set_style_bg_opa(temp_obj, LV_OPA_TRANSP, 0);
                        lv_obj_set_style_border_width(temp_obj, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */

                        lv_obj_add_event_cb(temp_obj, drag_event_handler, LV_EVENT_PRESSING, NULL);
                        lv_obj_add_event_cb(temp_obj, drag_event_handler, LV_EVENT_FOCUSED, NULL);
                        lv_obj_add_event_cb(temp_obj, drag_event_handler, LV_EVENT_DEFOCUSED, NULL);
                        lv_obj_clear_flag(temp_obj, LV_OBJ_FLAG_SCROLLABLE);

                        // 假设你有一个图片对象
                        img_obj = lv_img_create(temp_obj);
                        lv_img_set_src(img_obj,  &icon_buf[data_structure[i].data.icon.type]);

                        lv_obj_center(img_obj);
                        
                        lv_img_set_zoom(img_obj, data_structure[i].data.icon.size);

                        // 获取图片对象
                        img_1 = (lv_img_t*)img_obj;

                        // 获取图片的源文件
                        img_dsc = (lv_img_dsc_t*)img_1->src;

                        // 获取图片的宽和高
                        width = img_dsc->header.w * data_structure[i].data.icon.size / 256;
                        height = img_dsc->header.h * data_structure[i].data.icon.size / 256;

                        // 打印宽和高
                        printf("Image width: %d, height: %d\n", width, height);
                        lv_obj_set_size(temp_obj, width, height);
                        lv_obj_align(temp_obj, LV_ALIGN_OUT_TOP_LEFT, data_structure[i].x, data_structure[i].y); 
                        break;
                    }
                    case TYPE_DATE:
                    {
                        temp_obj = lv_obj_create(win_content);          
                        //sprintf(temp_typeface,"/media/%s", typeface_buf[data_structure[i].data.date_time.typeface]);
                        //data_structure[i].data.date_time.info.name = temp_typeface;
                        //printf("%s\n\r", temp_typeface);
                        data_structure[i].data.date_time.info.weight = data_structure[i].data.date_time.size;
                        data_structure[i].data.date_time.info.style = data_structure[i].data.date_time.italic_bold;
                        //lv_ft_font_init(&data_structure[i].data.date_time.info);
                        //lv_txt_get_size(&text_size, data_structure[i].data.date_time.text, data_structure[i].data.date_time.info.font, 0, 0, LV_COORD_MAX, LV_TEXT_FLAG_NONE);
                        temp_font = font_list_get(data_structure[i].data.date_time.typeface, data_structure[i].data.date_time.size, data_structure[i].data.date_time.italic_bold);
                        lv_txt_get_size(&text_size, data_structure[i].data.date_time.text, temp_font, data_structure[i].data.date_time.space, 0, LV_COORD_MAX, LV_TEXT_FLAG_NONE);

                        lv_obj_set_style_bg_opa(temp_obj, LV_OPA_TRANSP, 0);
                        lv_obj_set_style_border_width(temp_obj, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */

                        lv_obj_add_event_cb(temp_obj, drag_event_handler, LV_EVENT_PRESSING, NULL);
                        lv_obj_add_event_cb(temp_obj, drag_event_handler, LV_EVENT_FOCUSED, NULL);
                        lv_obj_add_event_cb(temp_obj, drag_event_handler, LV_EVENT_DEFOCUSED, NULL);
                        lv_obj_clear_flag(temp_obj, LV_OBJ_FLAG_SCROLLABLE);

                        lv_style_init(&data_structure[i].data.date_time.style);
                        lv_style_set_text_font(&data_structure[i].data.date_time.style, temp_font);
                        printf("x=%u y=%u\n\r", text_size.x, text_size.y);
                        lv_obj_set_size(temp_obj, text_size.x, text_size.y);
                        lv_obj_set_style_transform_angle(temp_obj, data_structure[i].data.date_time.spin*10, 0);

                        if (data_structure[i].data.word.spin != 0)
                        {
                            lv_obj_align(temp_obj, LV_ALIGN_TOP_LEFT, text_size.x, text_size.y);
                        }

                        lv_style_set_text_letter_space(&data_structure[i].data.date_time.style, word_space);
                        label1 = lv_label_create(temp_obj);
                        lv_obj_add_style(label1, &data_structure[i].data.date_time.style, 0);

                        if(data_structure[i].data.date_time.date_or_time == 0)
                        {
                            switch(data_structure[i].data.date_time.date_or_time_type)
                            {
                                case 0:
                                    sprintf(date_time_str, "%04d/%02d/%02d", 2000 + g_system_time[0], g_system_time[1], g_system_time[2]);
                                    break;
                                case 1:
                                    sprintf(date_time_str, "%02d/%02d/%02d", g_system_time[0], g_system_time[1], g_system_time[2]);
                                    break;
                                case 2:
                                    sprintf(date_time_str, "%04d-%02d-%02d", 2000 + g_system_time[0], g_system_time[1], g_system_time[2]);
                                    break;
                                case 3:
                                    sprintf(date_time_str, "%02d-%02d-%02d", g_system_time[0], g_system_time[1], g_system_time[2]);
                                    break;
                                case 4:
                                    sprintf(date_time_str, "%04d.%02d.%02d", 2000 + g_system_time[0], g_system_time[1], g_system_time[2]);
                                    break;
                                case 5:
                                    sprintf(date_time_str, "%02d.%02d.%02d", g_system_time[0], g_system_time[1], g_system_time[2]);
                                    break;
                                case 6:
                                    sprintf(date_time_str, "%02d/%02d/%04d", g_system_time[2],  g_system_time[1], 2000 + g_system_time[0]);
                                    break;
                                case 7:
                                    sprintf(date_time_str, "%02d/%02d/%02d", g_system_time[2],  g_system_time[1], g_system_time[0]);
                                    break;
                                case 8:
                                    sprintf(date_time_str, "%02d-%02d-%04d", g_system_time[2],  g_system_time[1], 2000 + g_system_time[0]);
                                    break;
                                case 9:
                                    sprintf(date_time_str, "%02d-%02d-%02d", g_system_time[2],  g_system_time[1], g_system_time[0]);
                                    break;
                                case 10:
                                    sprintf(date_time_str, "%02d.%02d.%04d", g_system_time[2],  g_system_time[1], 2000 + g_system_time[0]);
                                    break;
                                case 11:
                                    sprintf(date_time_str, "%02d.%02d.%02d", g_system_time[2],  g_system_time[1], g_system_time[0]);
                                    break;
                                case 12:
                                    sprintf(date_time_str, "%04d年%02d月%02d日", 2000 + g_system_time[0], g_system_time[1], g_system_time[2]);
                                    break;
                                case 13:
                                    sprintf(date_time_str, "%02d年%02d月%02d日", g_system_time[0], g_system_time[1], g_system_time[2]);
                                    break;
                                case 14:
                                    sprintf(date_time_str, "%s",data_structure[i].data.date_time.text);
                                    break;
                                case 15:
                                    sprintf(date_time_str, "延期");
                                    break;
                            }
                        }
                        else if(data_structure[i].data.date_time.date_or_time == 2)
                        {

                            calculateExpiryDate(now_year,now_month,now_day,data_structure[i].data.date_time.year,data_structure[i].data.date_time.month,data_structure[i].data.date_time.day,&end_year,&end_month,&end_day);

                            switch(data_structure[i].data.date_time.date_or_time_type)
                            {
                                case 0:
                                    sprintf(date_time_str, "%04d/%02d/%02d", end_year, end_month, end_day);
                                    break;
                                case 1:
                                    sprintf(date_time_str, "%02d/%02d/%02d", end_year%100, end_month, end_day);
                                    break;
                                case 2:
                                    sprintf(date_time_str, "%04d-%02d-%02d", end_year, end_month, end_day);
                                    break;
                                case 3:
                                    sprintf(date_time_str, "%02d-%02d-%02d", end_year%100, end_month, end_day);
                                    break;
                                case 4:
                                    sprintf(date_time_str, "%04d.%02d.%02d", end_year, end_month, end_day);
                                    break;
                                case 5:
                                    sprintf(date_time_str, "%02d.%02d.%02d", end_year%100, end_month, end_day);
                                    break;
                                case 6:
                                    sprintf(date_time_str, "%02d/%02d/%04d", end_day,  end_month, end_year);
                                    break;
                                case 7:
                                    sprintf(date_time_str, "%02d/%02d/%02d", end_day,  end_month, end_year%100);
                                    break;
                                case 8:
                                    sprintf(date_time_str, "%02d-%02d-%04d", end_day,  end_month, end_year);
                                    break;
                                case 9:
                                    sprintf(date_time_str, "%02d-%02d-%02d", end_day,  end_month, end_year%100);
                                    break;
                                case 10:
                                    sprintf(date_time_str, "%02d.%02d.%04d", end_day,  end_month, end_year);
                                    break;
                                case 11:
                                    sprintf(date_time_str, "%02d.%02d.%02d", end_day,  end_month, end_year%100);
                                    break;
                                case 12:
                                    sprintf(date_time_str, "%04d年%02d月%02d日", end_year, end_month, end_day);
                                    break;
                                case 13:
                                    sprintf(date_time_str, "%02d年%02d月%02d日", end_year%100, end_month, end_day);
                                    break;
                                case 14:
                                    sprintf(date_time_str, "%s",data_structure[i].data.date_time.text);
                                    break;
                                case 15:
                                    sprintf(date_time_str, "延期");
                                    break;
                            }
                        }
                        else
                        {
                            switch(data_structure[i].data.date_time.date_or_time_type)
                            {
                                case 0:
                                    sprintf(date_time_str, "%02d:%02d:%02d", g_system_time[3], g_system_time[4], g_system_time[5]);
                                    break;
                                case 1:
                                    sprintf(date_time_str, "%02d:%02d", g_system_time[3], g_system_time[4]);
                                    break;
                                case 2:
                                    if (g_system_time[3] > 12)
                                    {
                                        sprintf(date_time_str, "%02d:%02d:%02d PM", g_system_time[3] - 12, g_system_time[4], g_system_time[5]);
                                    }
                                    else
                                    {
                                        sprintf(date_time_str, "%02d:%02d:%02d AM", g_system_time[3], g_system_time[4], g_system_time[5]);
                                    }
                                    break;
                                case 3:
                                    if (g_system_time[3] > 12)
                                    {
                                        sprintf(date_time_str, "%02d:%02d PM", g_system_time[3] - 12, g_system_time[4]);
                                    }
                                    else
                                    {
                                        sprintf(date_time_str, "%02d:%02d AM", g_system_time[3], g_system_time[4]);
                                    }
                                    break;
                                case 4:
                                    sprintf(date_time_str, "%02d时%02d分%02d秒", g_system_time[3], g_system_time[4], g_system_time[5]);
                                    break;
                                case 5:
                                    sprintf(date_time_str, "%s",data_structure[i].data.date_time.text);
                                    break;
                                case 6:
                                    sprintf(date_time_str, "延期");
                                    break;
                            }              
                        }

                        lv_label_set_text(label1, date_time_str);
                        lv_obj_center(label1);     
                        lv_obj_align(temp_obj, LV_ALIGN_OUT_TOP_LEFT, data_structure[i].x, data_structure[i].y);
                        break;
                    }
                    case TYPE_QR:
                    {
                        str_len = strlen(data_structure[i].data.qr_bar.text);

                        //data_structure[i].data.qr_bar.size = 256;
                        
                        temp_obj = lv_obj_create(win_content);
                        lv_obj_set_style_bg_opa(temp_obj, LV_OPA_TRANSP, 0);
                        lv_obj_set_style_border_width(temp_obj, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */

                        lv_obj_add_event_cb(temp_obj, drag_event_handler, LV_EVENT_PRESSING, NULL);
                        lv_obj_add_event_cb(temp_obj, drag_event_handler, LV_EVENT_FOCUSED, NULL);
                        lv_obj_add_event_cb(temp_obj, drag_event_handler, LV_EVENT_DEFOCUSED, NULL);
                        lv_obj_clear_flag(temp_obj, LV_OBJ_FLAG_SCROLLABLE);

                        my_symbol = ZBarcode_Create();

                        switch (data_structure[i].data.qr_bar.symbology)
                        {
                            case 0:
                            default:
                            {
                                height_len = data_structure[i].data.qr_bar.height;
                                my_symbol->symbology = BARCODE_QRCODE;
                                my_symbol->scale = 1;
                                my_symbol->option_1 = 2; //容错级别

                                if(str_len < 20)
                                {
                                    my_symbol->option_2 = 1;
                                }
                                else if(str_len < 38)
                                {
                                    my_symbol->option_2 = 2;
                                }
                                else if(str_len < 61)
                                {
                                    my_symbol->option_2 = 3;
                                }
                                else if(str_len < 90)
                                {
                                    my_symbol->option_2 = 4;
                                }
                                else if(str_len < 122)
                                {
                                    my_symbol->option_2 = 5;
                                }
#if 0
                                if( data_structure[i].data.qr_bar.figure== 1)
                                {
                                    my_symbol->show_hrt = 1;
                                    memcpy(my_symbol->text,data_structure[i].data.qr_bar.text,str_len);
                                }
#endif

                                if (data_structure[i].data.qr_bar.borders == 1)
                                {
                                    my_symbol->output_options = BARCODE_BOX;
                                    my_symbol->whitespace_width = 3;
                                    my_symbol-> whitespace_height = 3; 
                                    my_symbol-> border_width = 2;   /* Size of border in X-dimensions */
                                }

                                strcpy(my_symbol->outfile, "out.bmp");
                                ZBarcode_Encode(my_symbol, (unsigned char *)data_structure[i].data.qr_bar.text, 0);

                                ZBarcode_Print(my_symbol, 0);

                                pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                                printf("width=%d\n\r", width);
                                printf("height=%d\n\r", height);
                                printf("channels=%d\n\r", channels);
                    
                                my_symbol->scale = (float)((float)150.0*(float)height_len/(float)QR_BAR_MAX_HIGHT/(float)width);
                                 //  my_symbol->scale = (float)height_len/(float)height;
                                printf("scale=%f\n\r", (double)my_symbol->scale);
        
                                strcpy(my_symbol->outfile, "out.bmp");
                                ZBarcode_Encode(my_symbol, (unsigned char *)data_structure[i].data.qr_bar.text, 0);

                                ZBarcode_Print(my_symbol, 0);
                                ZBarcode_Delete(my_symbol);
                                stbi_image_free(pdata);
                        
                                pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                                printf("width=%d\n\r", width);
                                printf("height=%d\n\r", height);
                                printf("channels=%d\n\r", channels);

                                lv_obj_set_size(temp_obj, width, height);

                                pnew_data = (unsigned char*)lv_mem_alloc(width * height * 4); // 为32位数据分配内存
                                if (!pnew_data) 
                                {
                                    fprintf(stderr, "Memory allocation failed\n");
                                    stbi_image_free(pdata);
                                    return;
                                }
                                else
                                {
                                    printf("lv_mem_alloc ok\n\r");
                                }

                                for (int y = 0; y < height; y++) 
                                {
                                    for (int x = 0; x < width; x++) 
                                    {
                                        int index = y * width + x; // 计算当前像素在原始数据中的索引
                                        unsigned char color = pdata[index]; // 获取当前像素的灰度值（0或255）
                                        // 映射到RGBA值

                                        if (color == 0)
                                        {
                                            pnew_data[index * 4 + 0] = 0; // R
                                            pnew_data[index * 4 + 1] = 0; // G
                                            pnew_data[index * 4 + 2] = 0; // B
                                            pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                                        }
                                        else
                                        {
                                            pnew_data[index * 4 + 0] = 255; // R
                                            pnew_data[index * 4 + 1] = 255; // G
                                            pnew_data[index * 4 + 2] = 255; // B
                                            pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                                        }
                                    }
                                }

                                sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.bmp",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                                stbi_write_bmp(bmp_name, width, height, 4, pnew_data);
                                // 使用data进行图像处理...
                                lv_mem_free(pnew_data);
                                stbi_image_free(pdata); // 释放内存

                                data = stbi_load(bmp_name, &width, &height, &channels, 0);
                                if (!data) 
                                {
                                    printf("错误：无法加载图片 %s\n", bmp_name);
                                }
                                printf("图片加载成功：%dx%d，%d 通道\n", width, height, channels);

                                sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.png",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                                
                                success = stbi_write_png(bmp_name, width, height, channels, data, width * channels);
                                if (!success) 
                                {
                                    printf("错误：保存 PNG 失败\n");
                                } 
                                else
                                {
                                    printf("PNG 保存成功：%s\n", bmp_name);
                                }

                                // 释放内存
                                stbi_image_free(data);

                                //显示图像
                                img = lv_img_create(temp_obj);
                                sprintf(bmp_name_1,"A:%s",bmp_name);
                                lv_img_set_src(img, bmp_name_1);
                                lv_obj_center(img);


                                lv_img_header_t header;
                                lv_res_t res = lv_img_decoder_get_info(bmp_name_1, &header);  // 直接传入文件路径

                                if (res == LV_RES_OK)
                                {
                                    printf("PNG: %dx%d\n", header.w, header.h);
                                }
                                else
                                {
                                    printf("lv_img_decoder_get_info error\n");
                                }

                                lv_img_set_zoom(img,data_structure[i].data.qr_bar.size);

                                width = header.w * data_structure[i].data.qr_bar.size / 256;
                                height = header.h * data_structure[i].data.qr_bar.size / 256;

                                lv_obj_set_size(temp_obj, width, height);

                                lv_obj_align(temp_obj, LV_ALIGN_OUT_TOP_LEFT, data_structure[i].x, data_structure[i].y);

                                break;
                            }
                            case 1:
                            {
                            
        #if 0
                                width_len = atoi(lv_label_get_text(label_btn_addition_QR_code_width));

                                if (width_len > 100)
                                {
                                    width_len = 100;
                                }
                                else if (width_len < 50)
                                {
                                    width_len = 50;
                                }

                                printf("width_len=%u\n\r",width_len);

                                data_structure[win_content_child_num].data.qr_bar.width = width_len;
        #endif
                                my_symbol->symbology = BARCODE_PDF417;
                                height_len =  data_structure[i].data.qr_bar.height;
                                my_symbol->scale = 1;

                                        //figure_borders = 0;
#if 0
                                        if(lv_obj_has_state(sw_addition_QR_code_figure, LV_STATE_CHECKED) == 1)
                                        {
                                            my_symbol->show_hrt = 1;
                                            memcpy(my_symbol->text,lv_label_get_text(label_btn_addition_QR_code_text),strlen(lv_label_get_text(label_btn_addition_QR_code_text))+ 1);
                                            //figure_borders |= 0x01;
                                            data_structure[win_content_child_num].data.qr_bar.figure = 1;
                                        }
#endif
                                        if (data_structure[i].data.qr_bar.borders == 1)
                                        {
                                            my_symbol->output_options = BARCODE_BOX;
                                            my_symbol->whitespace_width = 3;
                                            my_symbol-> whitespace_height = 3; 
                                            my_symbol-> border_width = 2;   /* Size of border in X-dimensions */
                                            //figure_borders |= 0x02;
                                        }
                

                                strcpy(my_symbol->outfile, "out.bmp");
                                ZBarcode_Encode(my_symbol, (unsigned char *)data_structure[i].data.qr_bar.text, 0);

                                ZBarcode_Print(my_symbol, 0);
                    
                                pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                                printf("width=%d\n\r", width);
                                printf("height=%d\n\r", height);
                                printf("channels=%d\n\r", channels);
                    
                               my_symbol->scale = (float)((float)150.0*(float)height_len/(float)QR_BAR_MAX_HIGHT/(float)height);
                                //   my_symbol->scale = (float)height_len/(float)height;
                                printf("scale=%f\n\r", (double)my_symbol->scale);
        
                                strcpy(my_symbol->outfile, "out.bmp");
                                ZBarcode_Encode(my_symbol, (unsigned char *)data_structure[i].data.qr_bar.text, 0);

                                ZBarcode_Print(my_symbol, 0);
                                ZBarcode_Delete(my_symbol);
                                stbi_image_free(pdata);
                        
                                pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                                printf("width=%d\n\r", width);
                                printf("height=%d\n\r", height);
                                printf("channels=%d\n\r", channels);

                                lv_obj_set_size(temp_obj, width, height);

                                pnew_data = (unsigned char*)lv_mem_alloc(width * height * 4); // 为32位数据分配内存
                                if (!pnew_data) 
                                {
                                    fprintf(stderr, "Memory allocation failed\n");
                                    stbi_image_free(pdata);
                                    return;
                                }
                                else
                                {
                                    printf("lv_mem_alloc ok\n\r");
                                }

                                for (int y = 0; y < height; y++) 
                                {
                                    for (int x = 0; x < width; x++) 
                                    {
                                        int index = y * width + x; // 计算当前像素在原始数据中的索引
                                        unsigned char color = pdata[index]; // 获取当前像素的灰度值（0或255）
                                        // 映射到RGBA值

                                        if (color == 0)
                                        {
                                            pnew_data[index * 4 + 0] = 0; // R
                                            pnew_data[index * 4 + 1] = 0; // G
                                            pnew_data[index * 4 + 2] = 0; // B
                                            pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                                        }
                                        else
                                        {
                                            pnew_data[index * 4 + 0] = 255; // R
                                            pnew_data[index * 4 + 1] = 255; // G
                                            pnew_data[index * 4 + 2] = 255; // B
                                            pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                                        }
                                    }
                                }

                                sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.bmp",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                                stbi_write_bmp(bmp_name, width, height, 4, pnew_data);
                                // 使用data进行图像处理...
                                lv_mem_free(pnew_data);
                                stbi_image_free(pdata); // 释放内存


                                data = stbi_load(bmp_name, &width, &height, &channels, 0);
                                if (!data) 
                                {
                                    printf("错误：无法加载图片 %s\n", bmp_name);
                                }
                                printf("图片加载成功：%dx%d，%d 通道\n", width, height, channels);

                                sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.png",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                                
                                success = stbi_write_png(bmp_name, width, height, channels, data, width * channels);
                                if (!success) 
                                {
                                    printf("错误：保存 PNG 失败\n");
                                } 
                                else
                                {
                                    printf("PNG 保存成功：%s\n", bmp_name);
                                }

                                // 释放内存
                                stbi_image_free(data);

                                //显示图像
                                img = lv_img_create(temp_obj);
                                sprintf(bmp_name_1,"A:%s",bmp_name);
                                lv_img_set_src(img, bmp_name_1);
                                lv_obj_center(img);


                                lv_img_header_t header;
                                lv_res_t res = lv_img_decoder_get_info(bmp_name_1, &header);  // 直接传入文件路径

                                if (res == LV_RES_OK)
                                {
                                    printf("PNG: %dx%d\n", header.w, header.h);
                                }
                                else
                                {
                                    printf("lv_img_decoder_get_info error\n");
                                }

                                lv_img_set_zoom(img,data_structure[i].data.qr_bar.size);

                                width = header.w * data_structure[i].data.qr_bar.size / 256;
                                height = header.h * data_structure[i].data.qr_bar.size / 256;

                                lv_obj_set_size(temp_obj, width, height);

                                lv_obj_align(temp_obj, LV_ALIGN_OUT_TOP_LEFT, data_structure[i].x, data_structure[i].y);

                                break;
                            }
                            case 2:
                            {
                                my_symbol->symbology = BARCODE_DATAMATRIX;
                                height_len =  data_structure[i].data.qr_bar.height;
                                my_symbol->scale = 1;

        #if 0
                                if(lv_obj_has_state(sw_addition_QR_code_figure, LV_STATE_CHECKED) == 1)
                                {
                                    my_symbol->show_hrt = 1;
                                    memcpy(my_symbol->text,lv_label_get_text(label_btn_addition_QR_code_text),strlen(lv_label_get_text(label_btn_addition_QR_code_text))+ 1);
                                    //figure_borders |= 0x01;
                                    data_structure[win_content_child_num].data.qr_bar.figure = 1;
                                }
        #endif
                                if (data_structure[i].data.qr_bar.borders == 1)
                                {
                                    my_symbol->output_options = BARCODE_BOX;
                                    my_symbol->whitespace_width = 3;
                                    my_symbol-> whitespace_height = 3; 
                                    my_symbol-> border_width = 2;   /* Size of border in X-dimensions */
                                    //figure_borders |= 0x02;
                                }

                                strcpy(my_symbol->outfile, "out.bmp");
                                ZBarcode_Encode(my_symbol, (unsigned char *)data_structure[i].data.qr_bar.text, 0);

                                ZBarcode_Print(my_symbol, 0);
                                //ZBarcode_Delete(my_symbol);

                                pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                                printf("width=%d\n\r", width);
                                printf("height=%d\n\r", height);
                                printf("channels=%d\n\r", channels);
                    
                                my_symbol->scale = (float)((float)150.0*(float)height_len/(float)QR_BAR_MAX_HIGHT/(float)height);
                                 //  my_symbol->scale = (float)height_len/(float)height;
                                printf("scale=%f\n\r", (double)my_symbol->scale);
        
                                strcpy(my_symbol->outfile, "out.bmp");
                                ZBarcode_Encode(my_symbol, (unsigned char *)data_structure[i].data.qr_bar.text, 0);

                                ZBarcode_Print(my_symbol, 0);
                                ZBarcode_Delete(my_symbol);
                                stbi_image_free(pdata);
                        
                                pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                                printf("width=%d\n\r", width);
                                printf("height=%d\n\r", height);
                                printf("channels=%d\n\r", channels);

                                lv_obj_set_size(temp_obj, width, height);

                                pnew_data = (unsigned char*)lv_mem_alloc(width * height * 4); // 为32位数据分配内存
                                if (!pnew_data) 
                                {
                                    fprintf(stderr, "Memory allocation failed\n");
                                    stbi_image_free(pdata);
                                    return;
                                }
                                else
                                {
                                    printf("lv_mem_alloc ok\n\r");
                                }

                                for (int y = 0; y < height; y++) 
                                {
                                    for (int x = 0; x < width; x++) 
                                    {
                                        int index = y * width + x; // 计算当前像素在原始数据中的索引
                                        unsigned char color = pdata[index]; // 获取当前像素的灰度值（0或255）
                                        // 映射到RGBA值

                                        if (color == 0)
                                        {
                                            pnew_data[index * 4 + 0] = 0; // R
                                            pnew_data[index * 4 + 1] = 0; // G
                                            pnew_data[index * 4 + 2] = 0; // B
                                            pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                                        }
                                        else
                                        {
                                            pnew_data[index * 4 + 0] = 255; // R
                                            pnew_data[index * 4 + 1] = 255; // G
                                            pnew_data[index * 4 + 2] = 255; // B
                                            pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                                        }
                                    }
                                }

                                sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.bmp",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                                stbi_write_bmp(bmp_name, width, height, 4, pnew_data);
                                // 使用data进行图像处理...
                                lv_mem_free(pnew_data);
                                stbi_image_free(pdata); // 释放内存

                                data = stbi_load(bmp_name, &width, &height, &channels, 0);
                                if (!data) 
                                {
                                    printf("错误：无法加载图片 %s\n", bmp_name);
                                }
                                printf("图片加载成功：%dx%d，%d 通道\n", width, height, channels);

                                sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.png",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                                
                                success = stbi_write_png(bmp_name, width, height, channels, data, width * channels);
                                if (!success) 
                                {
                                    printf("错误：保存 PNG 失败\n");
                                } 
                                else
                                {
                                    printf("PNG 保存成功：%s\n", bmp_name);
                                }

                                // 释放内存
                                stbi_image_free(data);

                                //显示图像
                                img = lv_img_create(temp_obj);
                                sprintf(bmp_name_1,"A:%s",bmp_name);
                                lv_img_set_src(img, bmp_name_1);
                                lv_obj_center(img);


                                lv_img_header_t header;
                                lv_res_t res = lv_img_decoder_get_info(bmp_name_1, &header);  // 直接传入文件路径

                                if (res == LV_RES_OK)
                                {
                                    printf("PNG: %dx%d\n", header.w, header.h);
                                }
                                else
                                {
                                    printf("lv_img_decoder_get_info error\n");
                                }

                                lv_img_set_zoom(img,data_structure[i].data.qr_bar.size);

                                width = header.w * data_structure[i].data.qr_bar.size / 256;
                                height = header.h * data_structure[i].data.qr_bar.size / 256;

                                lv_obj_set_size(temp_obj, width, height);

                                lv_obj_align(temp_obj, LV_ALIGN_OUT_TOP_LEFT, data_structure[i].x, data_structure[i].y);

                                break;
                            }
                            case 3:
                            {
                                my_symbol->symbology = BARCODE_HANXIN;
                                height_len = data_structure[i].data.qr_bar.height;
                                my_symbol->scale = 1;
        #if 0
                                if(lv_obj_has_state(sw_addition_QR_code_figure, LV_STATE_CHECKED) == 1)
                                {
                                    my_symbol->show_hrt = 1;
                                    memcpy(my_symbol->text,lv_label_get_text(label_btn_addition_QR_code_text),strlen(lv_label_get_text(label_btn_addition_QR_code_text))+ 1);
                                    //figure_borders |= 0x01;
                                    data_structure[win_content_child_num].data.qr_bar.figure = 1;
                                }
        #endif
                                if (data_structure[i].data.qr_bar.borders == 1)
                                {
                                    my_symbol->output_options = BARCODE_BOX;
                                    my_symbol->whitespace_width = 3;
                                    my_symbol-> whitespace_height = 3; 
                                    my_symbol-> border_width = 2;   /* Size of border in X-dimensions */
                                    //figure_borders |= 0x02;
                                }
    

                                strcpy(my_symbol->outfile, "out.bmp");
                                ZBarcode_Encode(my_symbol, (unsigned char *)data_structure[i].data.qr_bar.text, 0);

                                ZBarcode_Print(my_symbol, 0);
                                //ZBarcode_Delete(my_symbol);

                                pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                                printf("width=%d\n\r", width);
                                printf("height=%d\n\r", height);
                                printf("channels=%d\n\r", channels);
                    
                                my_symbol->scale = (float)((float)150.0*(float)height_len/(float)QR_BAR_MAX_HIGHT/(float)height);

                                printf("scale=%f\n\r", (double)my_symbol->scale);
        
                                strcpy(my_symbol->outfile, "out.bmp");
                                ZBarcode_Encode(my_symbol, (unsigned char *)data_structure[i].data.qr_bar.text, 0);

                                ZBarcode_Print(my_symbol, 0);
                                ZBarcode_Delete(my_symbol);
                                stbi_image_free(pdata);
                        
                                pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                                printf("width=%d\n\r", width);
                                printf("height=%d\n\r", height);
                                printf("channels=%d\n\r", channels);

                                lv_obj_set_size(temp_obj, width, height);

                                pnew_data = (unsigned char*)lv_mem_alloc(width * height * 4); // 为32位数据分配内存
                                if (!pnew_data) 
                                {
                                    fprintf(stderr, "Memory allocation failed\n");
                                    stbi_image_free(pdata);
                                    return;
                                }
                                else
                                {
                                    printf("lv_mem_alloc ok\n\r");
                                }

                                for (int y = 0; y < height; y++) 
                                {
                                    for (int x = 0; x < width; x++) 
                                    {
                                        int index = y * width + x; // 计算当前像素在原始数据中的索引
                                        unsigned char color = pdata[index]; // 获取当前像素的灰度值（0或255）
                                        // 映射到RGBA值

                                        if (color == 0)
                                        {
                                            pnew_data[index * 4 + 0] = 0; // R
                                            pnew_data[index * 4 + 1] = 0; // G
                                            pnew_data[index * 4 + 2] = 0; // B
                                            pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                                        }
                                        else
                                        {
                                            pnew_data[index * 4 + 0] = 255; // R
                                            pnew_data[index * 4 + 1] = 255; // G
                                            pnew_data[index * 4 + 2] = 255; // B
                                            pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                                        }
                                    }
                                }

                                sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.bmp",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                                stbi_write_bmp(bmp_name, width, height, 4, pnew_data);
                                // 使用data进行图像处理...
                                lv_mem_free(pnew_data);
                                stbi_image_free(pdata); // 释放内存

                                data = stbi_load(bmp_name, &width, &height, &channels, 0);
                                if (!data) 
                                {
                                    printf("错误：无法加载图片 %s\n", bmp_name);
                                }
                                printf("图片加载成功：%dx%d，%d 通道\n", width, height, channels);

                                sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.png",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                                
                                success = stbi_write_png(bmp_name, width, height, channels, data, width * channels);
                                if (!success) 
                                {
                                    printf("错误：保存 PNG 失败\n");
                                } 
                                else
                                {
                                    printf("PNG 保存成功：%s\n", bmp_name);
                                }

                                // 释放内存
                                stbi_image_free(data);

                                //显示图像
                                img = lv_img_create(temp_obj);
                                sprintf(bmp_name_1,"A:%s",bmp_name);
                                lv_img_set_src(img, bmp_name_1);
                                lv_obj_center(img);

                                lv_img_header_t header;
                                lv_res_t res = lv_img_decoder_get_info(bmp_name_1, &header);  // 直接传入文件路径

                                if (res == LV_RES_OK)
                                {
                                    printf("PNG: %dx%d\n", header.w, header.h);
                                }
                                else
                                {
                                    printf("lv_img_decoder_get_info error\n");
                                }

                                lv_img_set_zoom(img,data_structure[i].data.qr_bar.size);

                                width = header.w * data_structure[i].data.qr_bar.size / 256;
                                height = header.h * data_structure[i].data.qr_bar.size / 256;

                                lv_obj_set_size(temp_obj, width, height);
    

                                lv_obj_align(temp_obj, LV_ALIGN_OUT_TOP_LEFT, data_structure[i].x, data_structure[i].y);

                                break;
                            }
                        }
                        break;
                    }
                    case TYPE_BAR:
                    {
                        //str_len = strlen(data_structure[i].data.qr_bar.text) + 1;
                        //data_structure[i].data.qr_bar.size = 256;
                        
                        temp_obj = lv_obj_create(win_content);
                        lv_obj_set_style_bg_opa(temp_obj, LV_OPA_TRANSP, 0);
                        lv_obj_set_style_border_width(temp_obj, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */

                        lv_obj_add_event_cb(temp_obj, drag_event_handler, LV_EVENT_PRESSING, NULL);
                        lv_obj_add_event_cb(temp_obj, drag_event_handler, LV_EVENT_FOCUSED, NULL);
                        lv_obj_add_event_cb(temp_obj, drag_event_handler, LV_EVENT_DEFOCUSED, NULL);
                        lv_obj_clear_flag(temp_obj, LV_OBJ_FLAG_SCROLLABLE);

                        my_symbol = ZBarcode_Create();
                        switch (data_structure[i].data.qr_bar.symbology)
                        {
                            case 0:
                            default:
                            {
                                my_symbol->symbology = BARCODE_CODE39;
                                height_len =  data_structure[i].data.qr_bar.height;
                                printf("height_len=%d\n\r",height_len);
                                my_symbol->scale = 1;

                                if (data_structure[i].data.qr_bar.figure == 1)
                                {
                                    my_symbol->show_hrt = 1;
                                    memcpy(my_symbol->text,data_structure[i].data.qr_bar.text,strlen(data_structure[i].data.qr_bar.text)+ 1);
                                }
                                else
                                {
                                    my_symbol->show_hrt = 0;
                                }

                                if (data_structure[i].data.qr_bar.borders == 1)
                                {
                                    my_symbol->output_options = BARCODE_BOX;
                                    my_symbol->whitespace_width = 3;
                                    my_symbol-> whitespace_height = 3; 
                                    my_symbol-> border_width = 2;   /* Size of border in X-dimensions */
                                }

                                strcpy(my_symbol->outfile, "out.bmp");
                                printf("%s\n\r",data_structure[i].data.qr_bar.text);
                                ZBarcode_Encode(my_symbol, (unsigned char *)data_structure[i].data.qr_bar.text, 0);

                                ZBarcode_Print(my_symbol, 0);
                                //ZBarcode_Delete(my_symbol);

                                pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                                printf("width=%d\n\r", width);
                                printf("height=%d\n\r", height);
                                printf("channels=%d\n\r", channels);
                    
                                my_symbol->scale = (float)((float)150.0*(float)height_len/(float)QR_BAR_MAX_HIGHT/(float)height);
                               //    my_symbol->scale = (float)height_len/(float)height;
                                printf("scale=%f\n\r", (double)my_symbol->scale);
        
                                strcpy(my_symbol->outfile, "out.bmp");
                                ZBarcode_Encode(my_symbol, (unsigned char *)data_structure[i].data.qr_bar.text, 0);

                                ZBarcode_Print(my_symbol, 0);
                                ZBarcode_Delete(my_symbol);
                                stbi_image_free(pdata);
                        
                                pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                                printf("width=%d\n\r", width);
                                printf("height=%d\n\r", height);
                                printf("channels=%d\n\r", channels);

                                //lv_obj_set_size(temp_obj, width, height);

                                pnew_data = (unsigned char*)lv_mem_alloc(width * height * 4); // 为32位数据分配内存
                                if (!pnew_data) 
                                {
                                    fprintf(stderr, "Memory allocation failed\n");
                                    stbi_image_free(pdata);
                                    return;
                                }
                                else
                                {
                                    printf("lv_mem_alloc ok\n\r");
                                }

                                for (int y = 0; y < height; y++) 
                                {
                                    for (int x = 0; x < width; x++) 
                                    {
                                        int index = y * width + x; // 计算当前像素在原始数据中的索引
                                        unsigned char color = pdata[index]; // 获取当前像素的灰度值（0或255）
                                        // 映射到RGBA值

                                        if (color == 0)
                                        {
                                            pnew_data[index * 4 + 0] = 0; // R
                                            pnew_data[index * 4 + 1] = 0; // G
                                            pnew_data[index * 4 + 2] = 0; // B
                                            pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                                        }
                                        else
                                        {
                                            pnew_data[index * 4 + 0] = 255; // R
                                            pnew_data[index * 4 + 1] = 255; // G
                                            pnew_data[index * 4 + 2] = 255; // B
                                            pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                                        }
                                    }
                                }

#if 0
                                        stbi_write_bmp("QR_bar_code.bmp", width, height, 4, pnew_data);
                                        // 使用data进行图像处理...
                                        lv_mem_free(pnew_data);
                                        stbi_image_free(pdata); // 释放内存

                                        //显示图像
                                        img = lv_img_create(temp_obj);
                                        lv_img_set_src(img, "A:/root/QR_bar_code.bmp");
                                        lv_obj_center(img);
#endif

                                sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.bmp",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                                stbi_write_bmp(bmp_name, width, height, 4, pnew_data);
                                // 使用data进行图像处理...
                                lv_mem_free(pnew_data);
                                stbi_image_free(pdata); // 释放内存

                                data = stbi_load(bmp_name, &width, &height, &channels, 0);
                                if (!data) 
                                {
                                    printf("错误：无法加载图片 %s\n", bmp_name);
                                }
                                printf("图片加载成功：%dx%d，%d 通道\n", width, height, channels);

                                sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.png",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                                
                                success = stbi_write_png(bmp_name, width, height, channels, data, width * channels);
                                if (!success) 
                                {
                                    printf("错误：保存 PNG 失败\n");
                                } 
                                else
                                {
                                    printf("PNG 保存成功：%s\n", bmp_name);
                                }

                                // 释放内存
                                stbi_image_free(data);

                                //显示图像
                                img = lv_img_create(temp_obj);
                                sprintf(bmp_name_1,"A:%s",bmp_name);
                                lv_img_set_src(img, bmp_name_1);
                                lv_obj_center(img);

                                lv_img_header_t header;
                                lv_res_t res = lv_img_decoder_get_info(bmp_name_1, &header);  // 直接传入文件路径

                                if (res == LV_RES_OK)
                                {
                                    printf("PNG: %dx%d\n", header.w, header.h);
                                }
                                else
                                {
                                    printf("lv_img_decoder_get_info error\n");
                                }

                                lv_img_set_zoom(img,data_structure[i].data.qr_bar.size);

                                width = header.w * data_structure[i].data.qr_bar.size / 256;
                                height = header.h * data_structure[i].data.qr_bar.size / 256;

                                printf("width1=%d\n\r", width);
                                printf("height1=%d\n\r", height);

                                lv_obj_set_size(temp_obj, width, height);

                                lv_obj_align(temp_obj, LV_ALIGN_OUT_TOP_LEFT, data_structure[i].x, data_structure[i].y);

                                break;
                            }
                            case 1:
                            {
                                my_symbol->symbology = BARCODE_CODE128;
                                height_len = data_structure[win_content_child_num].data.qr_bar.height;
                                my_symbol->scale = 1;

                                if (data_structure[i].data.qr_bar.figure == 1)
                                {
                                    my_symbol->show_hrt = 1;
                                    memcpy(my_symbol->text,lv_label_get_text(label_btn_addition_QR_code_text),strlen(lv_label_get_text(label_btn_addition_QR_code_text))+ 1);
                                }
                                else
                                {
                                    my_symbol->show_hrt = 0;
                                }

                                if (data_structure[i].data.qr_bar.borders == 1)
                                {
                                    my_symbol->output_options = BARCODE_BOX;
                                    my_symbol->whitespace_width = 3;
                                    my_symbol-> whitespace_height = 3; 
                                    my_symbol-> border_width = 2;   /* Size of border in X-dimensions */
                                }

                                strcpy(my_symbol->outfile, "out.bmp");
                                ZBarcode_Encode(my_symbol, (unsigned char *)data_structure[i].data.qr_bar.text, 0);

                                ZBarcode_Print(my_symbol, 0);
                                //ZBarcode_Delete(my_symbol);

                                pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                                printf("width=%d\n\r", width);
                                printf("height=%d\n\r", height);
                                printf("channels=%d\n\r", channels);
                    
                                my_symbol->scale = (float)((float)150.0*(float)height_len/(float)QR_BAR_MAX_HIGHT/(float)height);
                                //   my_symbol->scale = (float)height_len/(float)height;
                                printf("scale=%f\n\r", (double)my_symbol->scale);
        
                                strcpy(my_symbol->outfile, "out.bmp");
                                ZBarcode_Encode(my_symbol, (unsigned char *)data_structure[i].data.qr_bar.text, 0);

                                ZBarcode_Print(my_symbol, 0);
                                ZBarcode_Delete(my_symbol);
                                stbi_image_free(pdata);
                        
                                pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                                printf("width=%d\n\r", width);
                                printf("height=%d\n\r", height);
                                printf("channels=%d\n\r", channels);

                                lv_obj_set_size(temp_obj, width, height);

                                pnew_data = (unsigned char*)lv_mem_alloc(width * height * 4); // 为32位数据分配内存
                                if (!pnew_data) 
                                {
                                    fprintf(stderr, "Memory allocation failed\n");
                                    stbi_image_free(pdata);
                                    return;
                                }
                                else
                                {
                                    printf("lv_mem_alloc ok\n\r");
                                }

                                for (int y = 0; y < height; y++) 
                                {
                                    for (int x = 0; x < width; x++) 
                                    {
                                        int index = y * width + x; // 计算当前像素在原始数据中的索引
                                        unsigned char color = pdata[index]; // 获取当前像素的灰度值（0或255）
                                        // 映射到RGBA值

                                        if (color == 0)
                                        {
                                            pnew_data[index * 4 + 0] = 0; // R
                                            pnew_data[index * 4 + 1] = 0; // G
                                            pnew_data[index * 4 + 2] = 0; // B
                                            pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                                        }
                                        else
                                        {
                                            pnew_data[index * 4 + 0] = 255; // R
                                            pnew_data[index * 4 + 1] = 255; // G
                                            pnew_data[index * 4 + 2] = 255; // B
                                            pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                                        }
                                    }
                                }

#if 0
                                stbi_write_bmp("QR_bar_code.bmp", width, height, 4, pnew_data);
                                // 使用data进行图像处理...
                                lv_mem_free(pnew_data);
                                stbi_image_free(pdata); // 释放内存

                                //显示图像
                                img = lv_img_create(temp_obj);
                                lv_img_set_src(img, "A:/root/QR_bar_code.bmp");
                                lv_obj_center(img);
#endif
                                sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.bmp",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                                stbi_write_bmp(bmp_name, width, height, 4, pnew_data);
                                // 使用data进行图像处理...
                                lv_mem_free(pnew_data);
                                stbi_image_free(pdata); // 释放内存
                                                                
                                data = stbi_load(bmp_name, &width, &height, &channels, 0);
                                if (!data) 
                                {
                                    printf("错误：无法加载图片 %s\n", bmp_name);
                                }
                                printf("图片加载成功：%dx%d，%d 通道\n", width, height, channels);

                                sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.png",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                                
                                success = stbi_write_png(bmp_name, width, height, channels, data, width * channels);
                                if (!success) 
                                {
                                    printf("错误：保存 PNG 失败\n");
                                } 
                                else
                                {
                                    printf("PNG 保存成功：%s\n", bmp_name);
                                }

                                // 释放内存
                                stbi_image_free(data);

                                //显示图像
                                img = lv_img_create(temp_obj);
                                sprintf(bmp_name_1,"A:%s",bmp_name);
                                lv_img_set_src(img, bmp_name_1);
                                lv_obj_center(img);


                                lv_img_header_t header;
                                lv_res_t res = lv_img_decoder_get_info(bmp_name_1, &header);  // 直接传入文件路径

                                if (res == LV_RES_OK)
                                {
                                    printf("PNG: %dx%d\n", header.w, header.h);
                                }
                                else
                                {
                                    printf("lv_img_decoder_get_info error\n");
                                }

                                lv_img_set_zoom(img,data_structure[i].data.qr_bar.size);

                                width = header.w * data_structure[i].data.qr_bar.size / 256;
                                height = header.h * data_structure[i].data.qr_bar.size / 256;

                                lv_obj_set_size(temp_obj, width, height);

                                lv_obj_align(temp_obj, LV_ALIGN_OUT_TOP_LEFT, data_structure[i].x, data_structure[i].y);

                                break;
                            }
                            case 2:
                            case 3:
                            {
                                my_symbol->symbology = BARCODE_EANX;
                                height_len = data_structure[i].data.qr_bar.height;
                                my_symbol->scale = 1;

                                if (data_structure[i].data.qr_bar.figure == 1)
                                {
                                    my_symbol->show_hrt = 1;
                                    memcpy(my_symbol->text,lv_label_get_text(label_btn_addition_QR_code_text),strlen(lv_label_get_text(label_btn_addition_QR_code_text))+ 1);
                                }
                                else
                                {
                                    my_symbol->show_hrt = 0;
                                }

                                if (data_structure[i].data.qr_bar.borders == 1)
                                {
                                    my_symbol->output_options = BARCODE_BOX;
                                    my_symbol->whitespace_width = 3;
                                    my_symbol-> whitespace_height = 3; 
                                    my_symbol-> border_width = 2;   /* Size of border in X-dimensions */
                                }

                                strcpy(my_symbol->outfile, "out.bmp");
                                ZBarcode_Encode(my_symbol, (unsigned char *)data_structure[i].data.qr_bar.text, 0);

                                ZBarcode_Print(my_symbol, 0);
                                //ZBarcode_Delete(my_symbol);

                                pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                                printf("width=%d\n\r", width);
                                printf("height=%d\n\r", height);
                                printf("channels=%d\n\r", channels);
                    
                                my_symbol->scale = (float)((float)150.0*(float)height_len/(float)QR_BAR_MAX_HIGHT/(float)height);
                                 //  my_symbol->scale = (float)height_len/(float)height;
                                printf("scale=%f\n\r",(double)my_symbol->scale);
        
                                strcpy(my_symbol->outfile, "out.bmp");
                                ZBarcode_Encode(my_symbol, (unsigned char *)data_structure[i].data.qr_bar.text, 0);

                                ZBarcode_Print(my_symbol, 0);
                                ZBarcode_Delete(my_symbol);
                                stbi_image_free(pdata);
                        
                                pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                                printf("width=%d\n\r", width);
                                printf("height=%d\n\r", height);
                                printf("channels=%d\n\r", channels);

                                lv_obj_set_size(temp_obj, width, height);

                                pnew_data = (unsigned char*)lv_mem_alloc(width * height * 4); // 为32位数据分配内存
                                if (!pnew_data) 
                                {
                                    fprintf(stderr, "Memory allocation failed\n");
                                    stbi_image_free(pdata);
                                    return;
                                }
                                else
                                {
                                    printf("lv_mem_alloc ok\n\r");
                                }

                                for (int y = 0; y < height; y++) 
                                {
                                    for (int x = 0; x < width; x++) 
                                    {
                                        int index = y * width + x; // 计算当前像素在原始数据中的索引
                                        unsigned char color = pdata[index]; // 获取当前像素的灰度值（0或255）
                                        // 映射到RGBA值

                                        if (color == 0)
                                        {
                                            pnew_data[index * 4 + 0] = 0; // R
                                            pnew_data[index * 4 + 1] = 0; // G
                                            pnew_data[index * 4 + 2] = 0; // B
                                            pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                                        }
                                        else
                                        {
                                            pnew_data[index * 4 + 0] = 255; // R
                                            pnew_data[index * 4 + 1] = 255; // G
                                            pnew_data[index * 4 + 2] = 255; // B
                                            pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                                        }
                                    }
                                }

#if 0
                                stbi_write_bmp("QR_bar_code.bmp", width, height, 4, pnew_data);
                                // 使用data进行图像处理...
                                lv_mem_free(pnew_data);
                                stbi_image_free(pdata); // 释放内存

                                //显示图像
                                img = lv_img_create(temp_obj);
                                lv_img_set_src(img, "A:/root/QR_bar_code.bmp");
                                lv_obj_center(img);
#endif

                                sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.bmp",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                                stbi_write_bmp(bmp_name, width, height, 4, pnew_data);
                                // 使用data进行图像处理...
                                lv_mem_free(pnew_data);
                                stbi_image_free(pdata); // 释放内存

                                data = stbi_load(bmp_name, &width, &height, &channels, 0);
                                if (!data) 
                                {
                                    printf("错误：无法加载图片 %s\n", bmp_name);
                                }
                                printf("图片加载成功：%dx%d，%d 通道\n", width, height, channels);

                                sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.png",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                                
                                success = stbi_write_png(bmp_name, width, height, channels, data, width * channels);
                                if (!success) 
                                {
                                    printf("错误：保存 PNG 失败\n");
                                } 
                                else
                                {
                                    printf("PNG 保存成功：%s\n", bmp_name);
                                }

                                // 释放内存
                                stbi_image_free(data);

                                //显示图像
                                img = lv_img_create(temp_obj);
                                sprintf(bmp_name_1,"A:%s",bmp_name);
                                lv_img_set_src(img, bmp_name_1);
                                lv_obj_center(img);


                                lv_img_header_t header;
                                lv_res_t res = lv_img_decoder_get_info(bmp_name_1, &header);  // 直接传入文件路径

                                if (res == LV_RES_OK)
                                {
                                    printf("PNG: %dx%d\n", header.w, header.h);
                                }
                                else
                                {
                                    printf("lv_img_decoder_get_info error\n");
                                }

                                lv_img_set_zoom(img,data_structure[i].data.qr_bar.size);

                                width = header.w * data_structure[i].data.qr_bar.size / 256;
                                height = header.h * data_structure[i].data.qr_bar.size / 256;

                                lv_obj_set_size(temp_obj, width, height);

                                lv_obj_align(temp_obj, LV_ALIGN_OUT_TOP_LEFT, data_structure[i].x, data_structure[i].y);

                                break;
                            }
                            case 4:
                            {
                                my_symbol->symbology = BARCODE_EAN128;
                                my_symbol->input_mode |= GS1PARENS_MODE;
                                height_len =  data_structure[i].data.qr_bar.height ;
                                my_symbol->scale = 1;

                                if (data_structure[i].data.qr_bar.figure == 1)
                                {
                                    my_symbol->show_hrt = 1;
                                    memcpy(my_symbol->text,lv_label_get_text(label_btn_addition_QR_code_text),strlen(lv_label_get_text(label_btn_addition_QR_code_text))+ 1);
                                }
                                else
                                {
                                    my_symbol->show_hrt = 0;
                                }

                                if (data_structure[i].data.qr_bar.borders == 1)
                                {
                                    my_symbol->output_options = BARCODE_BOX;
                                    my_symbol->whitespace_width = 3;
                                    my_symbol-> whitespace_height = 3; 
                                    my_symbol-> border_width = 2;   /* Size of border in X-dimensions */
                                }

                                strcpy(my_symbol->outfile, "out.bmp");

                                ZBarcode_Encode(my_symbol, (unsigned char *)data_structure[i].data.qr_bar.text, 0);
                                //ZBarcode_Encode(my_symbol, (unsigned char *)"(01)98898765432106(3202)012345(15)991231", 0);

                                ZBarcode_Print(my_symbol, 0);
                                //ZBarcode_Delete(my_symbol);

                                pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                                printf("width=%d\n\r", width);
                                printf("height=%d\n\r", height);
                                printf("channels=%d\n\r", channels);
                    
                                my_symbol->scale = (float)((float)118.0*(float)height_len/(float)QR_BAR_MAX_HIGHT/(float)height);
                                printf("scale=%f\n\r", (double)my_symbol->scale);
        
                                strcpy(my_symbol->outfile, "out.bmp");
                                ZBarcode_Encode(my_symbol, (unsigned char *)data_structure[i].data.qr_bar.text, 0);

                                ZBarcode_Print(my_symbol, 0);
                                ZBarcode_Delete(my_symbol);
                                stbi_image_free(pdata);
                        
                                pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                                printf("width=%d\n\r", width);
                                printf("height=%d\n\r", height);
                                printf("channels=%d\n\r", channels);

                                lv_obj_set_size(temp_obj, width, height);

                                pnew_data = (unsigned char*)lv_mem_alloc(width * height * 4); // 为32位数据分配内存
                                if (!pnew_data) 
                                {
                                    fprintf(stderr, "Memory allocation failed\n");
                                    stbi_image_free(pdata);
                                    return;
                                }
                                else
                                {
                                    printf("lv_mem_alloc ok\n\r");
                                }

                                for (int y = 0; y < height; y++) 
                                {
                                    for (int x = 0; x < width; x++) 
                                    {
                                        int index = y * width + x; // 计算当前像素在原始数据中的索引
                                        unsigned char color = pdata[index]; // 获取当前像素的灰度值（0或255）
                                        // 映射到RGBA值

                                        if (color == 0)
                                        {
                                            pnew_data[index * 4 + 0] = 0; // R
                                            pnew_data[index * 4 + 1] = 0; // G
                                            pnew_data[index * 4 + 2] = 0; // B
                                            pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                                        }
                                        else
                                        {
                                            pnew_data[index * 4 + 0] = 255; // R
                                            pnew_data[index * 4 + 1] = 255; // G
                                            pnew_data[index * 4 + 2] = 255; // B
                                            pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                                        }
                                    }
                                }

#if 0
                                stbi_write_bmp("QR_bar_code.bmp", width, height, 4, pnew_data);
                                // 使用data进行图像处理...
                                lv_mem_free(pnew_data);
                                stbi_image_free(pdata); // 释放内存

                                //显示图像
                                img = lv_img_create(temp_obj);
                                lv_img_set_src(img, "A:/root/QR_bar_code.bmp");
                                lv_obj_center(img);
#endif

                                sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.bmp",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                                stbi_write_bmp(bmp_name, width, height, 4, pnew_data);
                                // 使用data进行图像处理...
                                lv_mem_free(pnew_data);
                                stbi_image_free(pdata); // 释放内存

                                data = stbi_load(bmp_name, &width, &height, &channels, 0);
                                if (!data) 
                                {
                                    printf("错误：无法加载图片 %s\n", bmp_name);
                                }
                                printf("图片加载成功：%dx%d，%d 通道\n", width, height, channels);

                                sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.png",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                                
                                success = stbi_write_png(bmp_name, width, height, channels, data, width * channels);
                                if (!success) 
                                {
                                    printf("错误：保存 PNG 失败\n");
                                } 
                                else
                                {
                                    printf("PNG 保存成功：%s\n", bmp_name);
                                }

                                // 释放内存
                                stbi_image_free(data);

                                //显示图像
                                img = lv_img_create(temp_obj);
                                sprintf(bmp_name_1,"A:%s",bmp_name);
                                lv_img_set_src(img, bmp_name_1);
                                lv_obj_center(img);


                                lv_img_header_t header;
                                lv_res_t res = lv_img_decoder_get_info(bmp_name_1, &header);  // 直接传入文件路径

                                if (res == LV_RES_OK)
                                {
                                    printf("PNG: %dx%d\n", header.w, header.h);
                                }
                                else
                                {
                                    printf("lv_img_decoder_get_info error\n");
                                }

                                lv_img_set_zoom(img,data_structure[i].data.qr_bar.size);

                                width = header.w * data_structure[i].data.qr_bar.size / 256;
                                height = header.h * data_structure[i].data.qr_bar.size / 256;

                                lv_obj_set_size(temp_obj, width, height);

                                lv_obj_align(temp_obj, LV_ALIGN_OUT_TOP_LEFT, data_structure[i].x, data_structure[i].y);

                                break;
                            }
                            case 5:
                            {
                                my_symbol->symbology = BARCODE_UPCA;
                                height_len = data_structure[i].data.qr_bar.height;
                                my_symbol->scale = 1;

                                if (data_structure[i].data.qr_bar.figure == 1)
                                {
                                    my_symbol->show_hrt = 1;
                                    memcpy(my_symbol->text,lv_label_get_text(label_btn_addition_QR_code_text),strlen(lv_label_get_text(label_btn_addition_QR_code_text))+ 1);
                                }
                                else
                                {
                                    my_symbol->show_hrt = 0;
                                }

                                if (data_structure[i].data.qr_bar.borders == 1)
                                {
                                    my_symbol->output_options = BARCODE_BOX;
                                    my_symbol->whitespace_width = 3;
                                    my_symbol-> whitespace_height = 3; 
                                    my_symbol-> border_width = 2;   /* Size of border in X-dimensions */
                                }

                                strcpy(my_symbol->outfile, "out.bmp");
                                ZBarcode_Encode(my_symbol, (unsigned char *)data_structure[i].data.qr_bar.text, 0);

                                ZBarcode_Print(my_symbol, 0);
                                //ZBarcode_Delete(my_symbol);

                                pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                                printf("width=%d\n\r", width);
                                printf("height=%d\n\r", height);
                                printf("channels=%d\n\r", channels);
                    
                                my_symbol->scale = (float)((float)150.0*(float)height_len/(float)QR_BAR_MAX_HIGHT/(float)height);
                                 //  my_symbol->scale = (float)height_len/(float)height;
                                printf("scale=%f\n\r", (double)my_symbol->scale);
        
                                strcpy(my_symbol->outfile, "out.bmp");
                                ZBarcode_Encode(my_symbol, (unsigned char *)data_structure[i].data.qr_bar.text, 0);

                                ZBarcode_Print(my_symbol, 0);
                                ZBarcode_Delete(my_symbol);
                                stbi_image_free(pdata);
                        
                                pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                                printf("width=%d\n\r", width);
                                printf("height=%d\n\r", height);
                                printf("channels=%d\n\r", channels);

                                lv_obj_set_size(temp_obj, width, height);

                                pnew_data = (unsigned char*)lv_mem_alloc(width * height * 4); // 为32位数据分配内存
                                if (!pnew_data) 
                                {
                                    fprintf(stderr, "Memory allocation failed\n");
                                    stbi_image_free(pdata);
                                    return;
                                }
                                else
                                {
                                    printf("lv_mem_alloc ok\n\r");
                                }

                                for (int y = 0; y < height; y++) 
                                {
                                    for (int x = 0; x < width; x++) 
                                    {
                                        int index = y * width + x; // 计算当前像素在原始数据中的索引
                                        unsigned char color = pdata[index]; // 获取当前像素的灰度值（0或255）
                                        // 映射到RGBA值

                                        if (color == 0)
                                        {
                                            pnew_data[index * 4 + 0] = 0; // R
                                            pnew_data[index * 4 + 1] = 0; // G
                                            pnew_data[index * 4 + 2] = 0; // B
                                            pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                                        }
                                        else
                                        {
                                            pnew_data[index * 4 + 0] = 255; // R
                                            pnew_data[index * 4 + 1] = 255; // G
                                            pnew_data[index * 4 + 2] = 255; // B
                                            pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                                        }
                                    }
                                }

#if 0
                                stbi_write_bmp("QR_bar_code.bmp", width, height, 4, pnew_data);
                                // 使用data进行图像处理...
                                lv_mem_free(pnew_data);
                                stbi_image_free(pdata); // 释放内存

                                //显示图像
                                img = lv_img_create(temp_obj);
                                lv_img_set_src(img, "A:/root/QR_bar_code.bmp");
                                lv_obj_center(img);
#endif

                                sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.bmp",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                                stbi_write_bmp(bmp_name, width, height, 4, pnew_data);
                                // 使用data进行图像处理...
                                lv_mem_free(pnew_data);
                                stbi_image_free(pdata); // 释放内存


                                data = stbi_load(bmp_name, &width, &height, &channels, 0);
                                if (!data) 
                                {
                                    printf("错误：无法加载图片 %s\n", bmp_name);
                                }
                                printf("图片加载成功：%dx%d，%d 通道\n", width, height, channels);

                                sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.png",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                                
                                success = stbi_write_png(bmp_name, width, height, channels, data, width * channels);
                                if (!success) 
                                {
                                    printf("错误：保存 PNG 失败\n");
                                } 
                                else
                                {
                                    printf("PNG 保存成功：%s\n", bmp_name);
                                }

                                // 释放内存
                                stbi_image_free(data);

                                //显示图像
                                img = lv_img_create(temp_obj);
                                sprintf(bmp_name_1,"A:%s",bmp_name);
                                lv_img_set_src(img, bmp_name_1);
                                lv_obj_center(img);


                                lv_img_header_t header;
                                lv_res_t res = lv_img_decoder_get_info(bmp_name_1, &header);  // 直接传入文件路径

                                if (res == LV_RES_OK)
                                {
                                    printf("PNG: %dx%d\n", header.w, header.h);
                                }
                                else
                                {
                                    printf("lv_img_decoder_get_info error\n");
                                }

                                lv_img_set_zoom(img,data_structure[i].data.qr_bar.size);

                                width = header.w * data_structure[i].data.qr_bar.size / 256;
                                height = header.h * data_structure[i].data.qr_bar.size / 256;

                                lv_obj_set_size(temp_obj, width, height);

                                lv_obj_align(temp_obj, LV_ALIGN_OUT_TOP_LEFT, data_structure[i].x, data_structure[i].y);

                                break;
                            }
                            case 6:
                            {
                                my_symbol->symbology = BARCODE_UPCE;
                                height_len = data_structure[i].data.qr_bar.height;
                                my_symbol->scale = 1;

                                if (data_structure[i].data.qr_bar.figure == 1)
                                {
                                    my_symbol->show_hrt = 1;
                                    memcpy(my_symbol->text,lv_label_get_text(label_btn_addition_QR_code_text),strlen(lv_label_get_text(label_btn_addition_QR_code_text))+ 1);
                                }
                                else
                                {
                                    my_symbol->show_hrt = 0;
                                }

                                if (data_structure[i].data.qr_bar.borders == 1)
                                {
                                    my_symbol->output_options = BARCODE_BOX;
                                    my_symbol->whitespace_width = 3;
                                    my_symbol-> whitespace_height = 3; 
                                    my_symbol-> border_width = 2;   /* Size of border in X-dimensions */
                                }

                                strcpy(my_symbol->outfile, "out.bmp");
                                ZBarcode_Encode(my_symbol, (unsigned char *)data_structure[i].data.qr_bar.text, 0);

                                ZBarcode_Print(my_symbol, 0);
                                //ZBarcode_Delete(my_symbol);

                                pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                                printf("width=%d\n\r", width);
                                printf("height=%d\n\r", height);
                                printf("channels=%d\n\r", channels);
                    
                                my_symbol->scale = (float)((float)150.0*(float)height_len/(float)QR_BAR_MAX_HIGHT/(float)height);
                                //   my_symbol->scale = (float)height_len/(float)height;
                                printf("scale=%f\n\r", (double)my_symbol->scale);
        
                                strcpy(my_symbol->outfile, "out.bmp");
                                ZBarcode_Encode(my_symbol, (unsigned char *)data_structure[i].data.qr_bar.text, 0);

                                ZBarcode_Print(my_symbol, 0);
                                ZBarcode_Delete(my_symbol);
                                stbi_image_free(pdata);
                        
                                pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                                printf("width=%d\n\r", width);
                                printf("height=%d\n\r", height);
                                printf("channels=%d\n\r", channels);

                                lv_obj_set_size(temp_obj, width, height);

                                pnew_data = (unsigned char*)lv_mem_alloc(width * height * 4); // 为32位数据分配内存
                                if (!pnew_data) 
                                {
                                    fprintf(stderr, "Memory allocation failed\n");
                                    stbi_image_free(pdata);
                                    return;
                                }
                                else
                                {
                                    printf("lv_mem_alloc ok\n\r");
                                }

                                for (int y = 0; y < height; y++) 
                                {
                                    for (int x = 0; x < width; x++) 
                                    {
                                        int index = y * width + x; // 计算当前像素在原始数据中的索引
                                        unsigned char color = pdata[index]; // 获取当前像素的灰度值（0或255）
                                        // 映射到RGBA值

                                        if (color == 0)
                                        {
                                            pnew_data[index * 4 + 0] = 0; // R
                                            pnew_data[index * 4 + 1] = 0; // G
                                            pnew_data[index * 4 + 2] = 0; // B
                                            pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                                        }
                                        else
                                        {
                                            pnew_data[index * 4 + 0] = 255; // R
                                            pnew_data[index * 4 + 1] = 255; // G
                                            pnew_data[index * 4 + 2] = 255; // B
                                            pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                                        }
                                    }
                                }

#if 0
                                stbi_write_bmp("QR_bar_code.bmp", width, height, 4, pnew_data);
                                // 使用data进行图像处理...
                                lv_mem_free(pnew_data);
                                stbi_image_free(pdata); // 释放内存

                                //显示图像
                                img = lv_img_create(temp_obj);
                                lv_img_set_src(img, "A:/root/QR_bar_code.bmp");
                                lv_obj_center(img);     
#endif

                                sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.bmp",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                                stbi_write_bmp(bmp_name, width, height, 4, pnew_data);
                                // 使用data进行图像处理...
                                lv_mem_free(pnew_data);
                                stbi_image_free(pdata); // 释放内存


                                data = stbi_load(bmp_name, &width, &height, &channels, 0);
                                if (!data) 
                                {
                                    printf("错误：无法加载图片 %s\n", bmp_name);
                                }
                                printf("图片加载成功：%dx%d，%d 通道\n", width, height, channels);

                                sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.png",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                                
                                success = stbi_write_png(bmp_name, width, height, channels, data, width * channels);
                                if (!success) 
                                {
                                    printf("错误：保存 PNG 失败\n");
                                } 
                                else
                                {
                                    printf("PNG 保存成功：%s\n", bmp_name);
                                }

                                // 释放内存
                                stbi_image_free(data);

                                //显示图像
                                img = lv_img_create(temp_obj);
                                sprintf(bmp_name_1,"A:%s",bmp_name);
                                lv_img_set_src(img, bmp_name_1);
                                lv_obj_center(img); 


                                lv_img_header_t header;
                                lv_res_t res = lv_img_decoder_get_info(bmp_name_1, &header);  // 直接传入文件路径

                                if (res == LV_RES_OK)
                                {
                                    printf("PNG: %dx%d\n", header.w, header.h);
                                }
                                else
                                {
                                    printf("lv_img_decoder_get_info error\n");
                                }

                                lv_img_set_zoom(img,data_structure[i].data.qr_bar.size);

                                width = header.w * data_structure[i].data.qr_bar.size / 256;
                                height = header.h * data_structure[i].data.qr_bar.size / 256;

                                lv_obj_set_size(temp_obj, width, height);

                                lv_obj_align(temp_obj, LV_ALIGN_OUT_TOP_LEFT, data_structure[i].x, data_structure[i].y); 

                                break;
                            }
                            case 7:
                            {
                                my_symbol->symbology = BARCODE_ITF14;
                                height_len = data_structure[i].data.qr_bar.height;
                                my_symbol->scale = 1;

                                if (data_structure[i].data.qr_bar.figure == 1)
                                {
                                    my_symbol->show_hrt = 1;
                                    memcpy(my_symbol->text,lv_label_get_text(label_btn_addition_QR_code_text),strlen(lv_label_get_text(label_btn_addition_QR_code_text))+ 1);
                                }
                                else
                                {
                                    my_symbol->show_hrt = 0;
                                }

                                if (data_structure[i].data.qr_bar.borders == 1)
                                {
                                    my_symbol->output_options = BARCODE_BOX;
                                    my_symbol->whitespace_width = 3;
                                    my_symbol-> whitespace_height = 3; 
                                    my_symbol-> border_width = 2;   /* Size of border in X-dimensions */
                                }

                                strcpy(my_symbol->outfile, "out.bmp");
                                ZBarcode_Encode(my_symbol, (unsigned char *)data_structure[i].data.qr_bar.text, 0);

                                ZBarcode_Print(my_symbol, 0);
                                //ZBarcode_Delete(my_symbol);

                                pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                                printf("width=%d\n\r", width);
                                printf("height=%d\n\r", height);
                                printf("channels=%d\n\r", channels);
                    
                                my_symbol->scale = (float)((float)150.0*(float)height_len/(float)QR_BAR_MAX_HIGHT/(float)height);
                                 //  my_symbol->scale = (float)height_len/(float)height;
                                printf("scale=%f\n\r", (double)my_symbol->scale);
        
                                strcpy(my_symbol->outfile, "out.bmp");
                                ZBarcode_Encode(my_symbol, (unsigned char *)data_structure[i].data.qr_bar.text, 0);

                                ZBarcode_Print(my_symbol, 0);
                                ZBarcode_Delete(my_symbol);
                                stbi_image_free(pdata);
                        
                                pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                                printf("width=%d\n\r", width);
                                printf("height=%d\n\r", height);
                                printf("channels=%d\n\r", channels);

                                lv_obj_set_size(temp_obj, width, height);

                                pnew_data = (unsigned char*)lv_mem_alloc(width * height * 4); // 为32位数据分配内存
                                if (!pnew_data) 
                                {
                                    fprintf(stderr, "Memory allocation failed\n");
                                    stbi_image_free(pdata);
                                    return;
                                }
                                else
                                {
                                    printf("lv_mem_alloc ok\n\r");
                                }

                                for (int y = 0; y < height; y++) 
                                {
                                    for (int x = 0; x < width; x++) 
                                    {
                                        int index = y * width + x; // 计算当前像素在原始数据中的索引
                                        unsigned char color = pdata[index]; // 获取当前像素的灰度值（0或255）
                                        // 映射到RGBA值

                                        if (color == 0)
                                        {
                                            pnew_data[index * 4 + 0] = 0; // R
                                            pnew_data[index * 4 + 1] = 0; // G
                                            pnew_data[index * 4 + 2] = 0; // B
                                            pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                                        }
                                        else
                                        {
                                            pnew_data[index * 4 + 0] = 255; // R
                                            pnew_data[index * 4 + 1] = 255; // G
                                            pnew_data[index * 4 + 2] = 255; // B
                                            pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                                        }
                                    }
                                }

#if 0
                                stbi_write_bmp("QR_bar_code.bmp", width, height, 4, pnew_data);
                                // 使用data进行图像处理...
                                lv_mem_free(pnew_data);
                                stbi_image_free(pdata); // 释放内存

                                //显示图像
                                img = lv_img_create(temp_obj);
                                lv_img_set_src(img, "A:/root/QR_bar_code.bmp");
                                lv_obj_center(img);
#endif

                                sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.bmp",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                                stbi_write_bmp(bmp_name, width, height, 4, pnew_data);
                                // 使用data进行图像处理...
                                lv_mem_free(pnew_data);
                                stbi_image_free(pdata); // 释放内存


                                data = stbi_load(bmp_name, &width, &height, &channels, 0);
                                if (!data) 
                                {
                                    printf("错误：无法加载图片 %s\n", bmp_name);
                                }
                                printf("图片加载成功：%dx%d，%d 通道\n", width, height, channels);

                                sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.png",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                                
                                success = stbi_write_png(bmp_name, width, height, channels, data, width * channels);
                                if (!success) 
                                {
                                    printf("错误：保存 PNG 失败\n");
                                } 
                                else
                                {
                                    printf("PNG 保存成功：%s\n", bmp_name);
                                }

                                // 释放内存
                                stbi_image_free(data);

                                //显示图像
                                img = lv_img_create(temp_obj);
                                sprintf(bmp_name_1,"A:%s",bmp_name);
                                lv_img_set_src(img, bmp_name_1);
                                lv_obj_center(img);


                                lv_img_header_t header;
                                lv_res_t res = lv_img_decoder_get_info(bmp_name_1, &header);  // 直接传入文件路径

                                if (res == LV_RES_OK)
                                {
                                    printf("PNG: %dx%d\n", header.w, header.h);
                                }
                                else
                                {
                                    printf("lv_img_decoder_get_info error\n");
                                }

                                lv_img_set_zoom(img,data_structure[i].data.qr_bar.size);

                                width = header.w * data_structure[i].data.qr_bar.size / 256;
                                height = header.h * data_structure[i].data.qr_bar.size / 256;

                                lv_obj_set_size(temp_obj, width, height);

                                lv_obj_align(temp_obj, LV_ALIGN_OUT_TOP_LEFT, data_structure[i].x, data_structure[i].y); 

                                break;
                            }
                            case 8:
                            {
                                my_symbol->symbology = BARCODE_C25INTER;
                                height_len = data_structure[i].data.qr_bar.height;
                                my_symbol->scale = 1;

                                if (data_structure[i].data.qr_bar.figure == 1)
                                {
                                    my_symbol->show_hrt = 1;
                                    memcpy(my_symbol->text,lv_label_get_text(label_btn_addition_QR_code_text),strlen(lv_label_get_text(label_btn_addition_QR_code_text))+ 1);
                                }
                                else
                                {
                                    my_symbol->show_hrt = 0;
                                }

                                if (data_structure[i].data.qr_bar.borders == 1)
                                {
                                    my_symbol->output_options = BARCODE_BOX;
                                    my_symbol->whitespace_width = 3;
                                    my_symbol-> whitespace_height = 3; 
                                    my_symbol-> border_width = 2;   /* Size of border in X-dimensions */
                                }

                                strcpy(my_symbol->outfile, "out.bmp");
                                ZBarcode_Encode(my_symbol, (unsigned char *)data_structure[i].data.qr_bar.text, 0);

                                ZBarcode_Print(my_symbol, 0);
                                //ZBarcode_Delete(my_symbol);

                                pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                                printf("width=%d\n\r", width);
                                printf("height=%d\n\r", height);
                                printf("channels=%d\n\r", channels);
                    
                                my_symbol->scale = (float)((float)150.0*(float)height_len/(float)QR_BAR_MAX_HIGHT/(float)height);
                                 //  my_symbol->scale = (float)height_len/(float)height;
                                printf("scale=%f\n\r", (double)my_symbol->scale);
        
                                strcpy(my_symbol->outfile, "out.bmp");
                                ZBarcode_Encode(my_symbol, (unsigned char *)data_structure[i].data.qr_bar.text, 0);

                                ZBarcode_Print(my_symbol, 0);
                                ZBarcode_Delete(my_symbol);
                                stbi_image_free(pdata);
                
                                pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                                printf("width=%d\n\r", width);
                                printf("height=%d\n\r", height);
                                printf("channels=%d\n\r", channels);

                                lv_obj_set_size(temp_obj, width, height);

                                pnew_data = (unsigned char*)lv_mem_alloc(width * height * 4); // 为32位数据分配内存
                                if (!pnew_data) 
                                {
                                    fprintf(stderr, "Memory allocation failed\n");
                                    stbi_image_free(pdata);
                                    return;
                                }
                                else
                                {
                                    printf("lv_mem_alloc ok\n\r");
                                }

                                for (int y = 0; y < height; y++) 
                                {
                                    for (int x = 0; x < width; x++) 
                                    {
                                        int index = y * width + x; // 计算当前像素在原始数据中的索引
                                        unsigned char color = pdata[index]; // 获取当前像素的灰度值（0或255）
                                        // 映射到RGBA值

                                        if (color == 0)
                                        {
                                            pnew_data[index * 4 + 0] = 0; // R
                                            pnew_data[index * 4 + 1] = 0; // G
                                            pnew_data[index * 4 + 2] = 0; // B
                                            pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                                        }
                                        else
                                        {
                                            pnew_data[index * 4 + 0] = 255; // R
                                            pnew_data[index * 4 + 1] = 255; // G
                                            pnew_data[index * 4 + 2] = 255; // B
                                            pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                                        }
                                    }
                                }

#if 0
                                stbi_write_bmp("QR_bar_code.bmp", width, height, 4, pnew_data);
                                // 使用data进行图像处理...
                                lv_mem_free(pnew_data);
                                stbi_image_free(pdata); // 释放内存

                                //显示图像
                                img = lv_img_create(temp_obj);
                                lv_img_set_src(img, "A:/root/QR_bar_code.bmp");
                                lv_obj_center(img);
#endif

                                sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.bmp",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                                stbi_write_bmp(bmp_name, width, height, 4, pnew_data);
                                // 使用data进行图像处理...
                                lv_mem_free(pnew_data);
                                stbi_image_free(pdata); // 释放内存

                                data = stbi_load(bmp_name, &width, &height, &channels, 0);
                                if (!data) 
                                {
                                    printf("错误：无法加载图片 %s\n", bmp_name);
                                }
                                printf("图片加载成功：%dx%d，%d 通道\n", width, height, channels);

                                sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.png",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                                
                                success = stbi_write_png(bmp_name, width, height, channels, data, width * channels);
                                if (!success) 
                                {
                                    printf("错误：保存 PNG 失败\n");
                                } 
                                else
                                {
                                    printf("PNG 保存成功：%s\n", bmp_name);
                                }

                                // 释放内存
                                stbi_image_free(data);

                                //显示图像
                                img = lv_img_create(temp_obj);
                                sprintf(bmp_name_1,"A:%s",bmp_name);
                                lv_img_set_src(img, bmp_name_1);
                                lv_obj_center(img);


                                lv_img_header_t header;
                                lv_res_t res = lv_img_decoder_get_info(bmp_name_1, &header);  // 直接传入文件路径

                                if (res == LV_RES_OK)
                                {
                                    printf("PNG: %dx%d\n", header.w, header.h);
                                }
                                else
                                {
                                    printf("lv_img_decoder_get_info error\n");
                                }

                                lv_img_set_zoom(img,data_structure[i].data.qr_bar.size);

                                width = header.w * data_structure[i].data.qr_bar.size / 256;
                                height = header.h * data_structure[i].data.qr_bar.size / 256;

                                lv_obj_set_size(temp_obj, width, height);

                                lv_obj_align(temp_obj, LV_ALIGN_OUT_TOP_LEFT, data_structure[i].x, data_structure[i].y); 

                                break;
                            }
                            case 9:
                            {
                                my_symbol->symbology = BARCODE_EAN14;
                                height_len = data_structure[i].data.qr_bar.height;
                                my_symbol->scale = 1;

                                if (data_structure[i].data.qr_bar.figure == 1)
                                {
                                    my_symbol->show_hrt = 1;
                                    memcpy(my_symbol->text,lv_label_get_text(label_btn_addition_QR_code_text),strlen(lv_label_get_text(label_btn_addition_QR_code_text))+ 1);
                                }
                                else
                                {
                                    my_symbol->show_hrt = 0;
                                }

                                if (data_structure[i].data.qr_bar.borders == 1)
                                {
                                    my_symbol->output_options = BARCODE_BOX;
                                    my_symbol->whitespace_width = 3;
                                    my_symbol-> whitespace_height = 3; 
                                    my_symbol-> border_width = 2;   /* Size of border in X-dimensions */
                                }

                                strcpy(my_symbol->outfile, "out.bmp");
                                ZBarcode_Encode(my_symbol, (unsigned char *)data_structure[i].data.qr_bar.text, 0);

                                ZBarcode_Print(my_symbol, 0);
                                //ZBarcode_Delete(my_symbol);

                                pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                                printf("width=%d\n\r", width);
                                printf("height=%d\n\r", height);
                                printf("channels=%d\n\r", channels);
                    
                                my_symbol->scale = (float)((float)150.0*(float)height_len/(float)QR_BAR_MAX_HIGHT/(float)height);
                                //   my_symbol->scale = (float)height_len/(float)height;
                                printf("scale=%f\n\r", (double)my_symbol->scale);

                                strcpy(my_symbol->outfile, "out.bmp");
                                ZBarcode_Encode(my_symbol, (unsigned char *)data_structure[i].data.qr_bar.text, 0);

                                ZBarcode_Print(my_symbol, 0);
                                ZBarcode_Delete(my_symbol);
                                stbi_image_free(pdata);
                        
                                pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                                printf("width=%d\n\r", width);
                                printf("height=%d\n\r", height);
                                printf("channels=%d\n\r", channels);

                                lv_obj_set_size(temp_obj, width, height);

                                pnew_data = (unsigned char*)lv_mem_alloc(width * height * 4); // 为32位数据分配内存
                                if (!pnew_data) 
                                {
                                    fprintf(stderr, "Memory allocation failed\n");
                                    stbi_image_free(pdata);
                                    return;
                                }
                                else
                                {
                                    printf("lv_mem_alloc ok\n\r");
                                }

                                for (int y = 0; y < height; y++) 
                                {
                                    for (int x = 0; x < width; x++) 
                                    {
                                        int index = y * width + x; // 计算当前像素在原始数据中的索引
                                        unsigned char color = pdata[index]; // 获取当前像素的灰度值（0或255）
                                        // 映射到RGBA值

                                        if (color == 0)
                                        {
                                            pnew_data[index * 4 + 0] = 0; // R
                                            pnew_data[index * 4 + 1] = 0; // G
                                            pnew_data[index * 4 + 2] = 0; // B
                                            pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                                        }
                                        else
                                        {
                                            pnew_data[index * 4 + 0] = 255; // R
                                            pnew_data[index * 4 + 1] = 255; // G
                                            pnew_data[index * 4 + 2] = 255; // B
                                            pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                                        }
                                    }
                                }

#if 0
                                stbi_write_bmp("QR_bar_code.bmp", width, height, 4, pnew_data);
                                // 使用data进行图像处理...
                                lv_mem_free(pnew_data);
                                stbi_image_free(pdata); // 释放内存

                                //显示图像
                                img = lv_img_create(temp_obj);
                                lv_img_set_src(img, "A:/root/QR_bar_code.bmp");
                                lv_obj_center(img);
#endif

                                sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.bmp",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                                stbi_write_bmp(bmp_name, width, height, 4, pnew_data);
                                // 使用data进行图像处理...
                                lv_mem_free(pnew_data);
                                stbi_image_free(pdata); // 释放内存

                                data = stbi_load(bmp_name, &width, &height, &channels, 0);
                                if (!data) 
                                {
                                    printf("错误：无法加载图片 %s\n", bmp_name);
                                }
                                printf("图片加载成功：%dx%d，%d 通道\n", width, height, channels);

                                sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.png",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                                
                                success = stbi_write_png(bmp_name, width, height, channels, data, width * channels);
                                if (!success) 
                                {
                                    printf("错误：保存 PNG 失败\n");
                                } 
                                else
                                {
                                    printf("PNG 保存成功：%s\n", bmp_name);
                                }

                                // 释放内存
                                stbi_image_free(data);

                                //显示图像
                                img = lv_img_create(temp_obj);
                                sprintf(bmp_name_1,"A:%s",bmp_name);
                                lv_img_set_src(img, bmp_name_1);
                                lv_obj_center(img);


                                lv_img_header_t header;
                                lv_res_t res = lv_img_decoder_get_info(bmp_name_1, &header);  // 直接传入文件路径

                                if (res == LV_RES_OK)
                                {
                                    printf("PNG: %dx%d\n", header.w, header.h);
                                }
                                else
                                {
                                    printf("lv_img_decoder_get_info error\n");
                                }

                                lv_img_set_zoom(img,data_structure[i].data.qr_bar.size);

                                width = header.w * data_structure[i].data.qr_bar.size / 256;
                                height = header.h * data_structure[i].data.qr_bar.size / 256;

                                lv_obj_set_size(temp_obj, width, height);

                                lv_obj_align(temp_obj, LV_ALIGN_OUT_TOP_LEFT, data_structure[i].x, data_structure[i].y); 

                                break;
                            }
                        }
                        break;
                    }
                    case TYPE_PITCTURE:
                    {
                        temp_obj = lv_obj_create(win_content);

                        lv_obj_set_style_bg_opa(temp_obj, LV_OPA_TRANSP, 0);
                        lv_obj_set_style_border_width(temp_obj, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */

                        lv_obj_add_event_cb(temp_obj, drag_event_handler, LV_EVENT_PRESSING, NULL);
                        lv_obj_add_event_cb(temp_obj, drag_event_handler, LV_EVENT_FOCUSED, NULL);
                        lv_obj_add_event_cb(temp_obj, drag_event_handler, LV_EVENT_DEFOCUSED, NULL);
                        lv_obj_clear_flag(temp_obj, LV_OBJ_FLAG_SCROLLABLE);

                        char picture_name[128]={0};

                        // 假设你有一个图片对象
                        img_obj = lv_img_create(temp_obj);

                        if(strcmp(data_structure[i].data.picture.text_1,"png") != 0)
                        {
                            data = stbi_load(data_structure[i].data.picture.text_1, &width, &height, &channels, 0);
                            if (!data) 
                            {
                                printf("错误：无法加载图片 %s\n", data_structure[i].data.picture.text_1);
                            }

                            printf("图片加载成功：%dx%d，%d 通道\n", width, height, channels);


                            // 步骤 2：将数据保存为 PNG
                            success = stbi_write_png(data_structure[i].data.picture.text_2, width, height, channels, data, width * channels);
                            if (!success) 
                            {
                                printf("错误：保存 PNG 失败\n");
                            } 
                            else 
                            {
                                printf("PNG 保存成功：%s\n", data_structure[i].data.picture.text_2);
                            }

                            sprintf(picture_name, "A:%s", data_structure[i].data.picture.text_2);

                            stbi_image_free(data);
                        }
                        else
                        {
                            sprintf(picture_name, "A:%s", data_structure[i].data.picture.text_1);
                        }
                        
                        lv_img_set_src(img_obj, picture_name);
                        lv_obj_center(img_obj);
                        lv_img_header_t header;
                        lv_res_t res = lv_img_decoder_get_info(picture_name, &header);  // 直接传入文件路径

                        if (res == LV_RES_OK)
                        {
                            printf("PNG: %dx%d\n", header.w, header.h);
                        }
                        else
                        {
                            printf("lv_img_decoder_get_info error\n");
                        }

                        lv_img_set_zoom(img_obj,data_structure[i].data.picture.size);

                        width = header.w * data_structure[i].data.picture.size / 256;
                        height = header.h * data_structure[i].data.picture.size / 256;

                        lv_obj_set_size(temp_obj, width, height);
                        lv_obj_align(temp_obj, LV_ALIGN_OUT_TOP_LEFT, data_structure[i].x, data_structure[i].y); 
                        break;
                    }
                    case TYPE_BREAK:
                    {
                        temp_obj = lv_obj_create(win_content);
                        lv_obj_set_style_bg_opa(temp_obj, LV_OPA_COVER, 0);
                        lv_obj_set_style_bg_color(temp_obj, lv_color_hex(0xFF6A6A), LV_STATE_DEFAULT);
                        lv_obj_set_style_border_width(temp_obj, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */

                        lv_obj_add_event_cb(temp_obj, drag_event_handler, LV_EVENT_PRESSING, NULL);
                        lv_obj_add_event_cb(temp_obj, drag_event_handler, LV_EVENT_FOCUSED, NULL);
                        lv_obj_add_event_cb(temp_obj, drag_event_handler, LV_EVENT_DEFOCUSED, NULL);
                        lv_obj_clear_flag(temp_obj, LV_OBJ_FLAG_SCROLLABLE);

                        lv_obj_set_size(temp_obj, 5, 150);

                        lv_obj_align(temp_obj, LV_ALIGN_OUT_TOP_LEFT, data_structure[i].x, data_structure[i].y); 
                        break;
                    }
                    case TYPE_COUNT:
                    {
                        //保存所有数据
                        //data_structure[win_content_child_num].data.count.law = lv_dropdown_get_selected(dropdown_addition_count_law);
                        //data_structure[win_content_child_num].data.count.repetition = atoi(lv_label_get_text(label_btn_addition_count_times_repetition));

                        temp_obj = lv_obj_create(win_content);
                        //sprintf(temp_typeface, "/media/%s", typeface_buf[data_structure[win_content_child_num].data.count.typeface]);
                        //data_structure[win_content_child_num].data.count.typeface = i;
                        //printf("%s\n", temp_typeface);
                        //data_structure[win_content_child_num].data.count.info.name = temp_typeface;
                        data_structure[i].data.count.info.weight = data_structure[i].data.count.size;

                        //lv_ft_font_init(&data_structure[win_content_child_num].data.count.info);

                        temp_font = font_list_get(data_structure[i].data.count.typeface, data_structure[i].data.count.size,0);

                        printf("lead_zero=%d\n\r", data_structure[i].data.count.lead_zero);
                        printf("law=%d\n\r", data_structure[i].data.count.law);

                        //确定显示值的位数
                        //递增
                        if (data_structure[i].data.count.law == 0)
                        {
                            if (data_structure[i].data.count.current_value < data_structure[i].data.count.minimum)
                            {
                                data_structure[i].data.count.current_value = data_structure[i].data.count.minimum;
                            }
                            else if(data_structure[i].data.count.current_value > data_structure[i].data.count.maximum)
                            {
                                data_structure[i].data.count.current_value = data_structure[i].data.count.maximum;
                            }

                            if (data_structure[i].data.count.lead_zero == 0)
                            {
                                formatNumberWithLeadingZeros(data_structure[i].data.count.current_value, data_structure[i].data.count.maximum, tempString);
                            }
                            else
                            {
                                sprintf(tempString, "%d", data_structure[i].data.count.current_value);
                            }
                        }
                        else
                        {
                            if (data_structure[i].data.count.current_value < data_structure[i].data.count.minimum)
                            {
                                data_structure[i].data.count.current_value = data_structure[i].data.count.minimum;
                            }
                            else if (data_structure[i].data.count.current_value > data_structure[i].data.count.maximum)
                            {
                                data_structure[i].data.count.current_value = data_structure[i].data.count.maximum;
                            }

                            if (data_structure[i].data.count.lead_zero == 0)
                            {
                                formatNumberWithLeadingZeros(data_structure[i].data.count.current_value, data_structure[i].data.count.maximum, tempString);
                            }
                            else
                            {
                                sprintf(tempString, "%d", data_structure[i].data.count.current_value);
                            }       
                        }

                        printf("tempString=%s\n\r", tempString);
                        lv_txt_get_size(&text_size, tempString, temp_font, data_structure[i].data.count.space, 0, LV_COORD_MAX, LV_TEXT_FLAG_NONE);

                        lv_obj_set_style_bg_opa(temp_obj, LV_OPA_TRANSP, 0);
                        lv_obj_set_style_border_width(temp_obj, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */

                        lv_obj_add_event_cb(temp_obj, drag_event_handler, LV_EVENT_PRESSING, NULL);
                        lv_obj_add_event_cb(temp_obj, drag_event_handler, LV_EVENT_FOCUSED, NULL);
                        lv_obj_add_event_cb(temp_obj, drag_event_handler, LV_EVENT_DEFOCUSED, NULL);
                        lv_obj_clear_flag(temp_obj, LV_OBJ_FLAG_SCROLLABLE);

                        lv_style_init(&data_structure[i].data.count.style);
                        lv_style_set_text_font(&data_structure[i].data.count.style, temp_font);

                        word_space =  data_structure[i].data.count.space;
                        printf("x=%u y=%u\n\r", text_size.x, text_size.y);
                        lv_obj_set_size(temp_obj, text_size.x, text_size.y);

                        lv_style_set_text_letter_space(&data_structure[i].data.count.style, word_space);
                        label1 = lv_label_create(temp_obj);
                        lv_obj_add_style(label1, &data_structure[i].data.count.style, 0);
                        lv_label_set_text(label1, tempString);
                        lv_obj_center(label1);

                        lv_obj_align(temp_obj, LV_ALIGN_OUT_TOP_LEFT, data_structure[i].x, data_structure[i].y); 

                        break;
                    }
                    case TYPE_SYMBOL:
                    {
                        temp_obj = lv_obj_create(win_content);

                        //sprintf(temp_typeface, "/media/%s", typeface_buf[0]);
                        //data_structure[win_content_child_num].data.word.typeface = 0;
                        //info.name = "./lvgl/src/extra/libs/freetype/arial.ttf";
                        //info.name = "./lvgl/src/extra/libs/freetype/simsun.ttc";
                        //sprintf(temp_typeface, "./lvgl/src/extra/libs/freetype/%s", typeface_buf[SOURCE_HAN_SERIF_CN_REGULAR_1]);
                        //printf("%s\n", temp_typeface);

                        //data_structure[win_content_child_num].data.word.info.name = temp_typeface;

                        data_structure[i].data.word.info.weight = data_structure[i].data.word.size;

                        data_structure[i].data.word.spin = 0;

                        data_structure[i].data.word.info.style = FT_FONT_STYLE_NORMAL;

                        //lv_ft_font_init(&data_structure[win_content_child_num].data.word.info);

                        temp_font = font_list_get(0, data_structure[i].data.word.size, 0);

                        lv_txt_get_size(&text_size,  data_structure[i].data.word.text, temp_font, 0, 0, LV_COORD_MAX, LV_TEXT_FLAG_NONE);

                        lv_obj_set_style_bg_opa(temp_obj, LV_OPA_TRANSP, 0);
                        lv_obj_set_style_border_width(temp_obj, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */

                        lv_obj_add_event_cb(temp_obj, drag_event_handler, LV_EVENT_PRESSING, NULL);
                        lv_obj_add_event_cb(temp_obj, drag_event_handler, LV_EVENT_FOCUSED, NULL);
                        lv_obj_add_event_cb(temp_obj, drag_event_handler, LV_EVENT_DEFOCUSED, NULL);
                        lv_obj_clear_flag(temp_obj, LV_OBJ_FLAG_SCROLLABLE);

                        lv_style_init(&data_structure[i].data.word.style);
                        lv_style_set_text_font(&data_structure[i].data.word.style, temp_font);

                        lv_obj_set_size(temp_obj, text_size.x, text_size.y);

                        label1 = lv_label_create(temp_obj);
                        lv_obj_add_style(label1, &data_structure[i].data.word.style, 0);
                        lv_label_set_text(label1, data_structure[i].data.word.text);
                        lv_obj_center(label1);
                        lv_obj_align(temp_obj, LV_ALIGN_OUT_TOP_LEFT, data_structure[i].x, data_structure[i].y); 
                        break;
                    }  
                }   
            }
        }
    }
}

#if 0
//sprintf(temp_typeface, "/media/%s", typeface_buf[i]);
static void button_modification_confirm_event_cb(lv_event_t* e)
{
      lv_event_code_t code;
    int i=0;
    int word_space = 0;
    int word_size = 0;
    int x_size = 0;
    //int y_size = 0;
    int k = 0;
    int location_x;
    int location_y;

    code = lv_event_get_code(e);
    //char tempString[128] = { 0 };
    char temp_typeface[128] = { 0 };
    if (code == LV_EVENT_CLICKED)
    {
        printf("button_modification_confirm_event_cb\n");

        int len = strlen(lv_label_get_text(label_file_management_label)) + 1;
        printf("len=%u\n\r", len);

        if (len > 1) 
        {
            //删除
            k = lv_obj_get_index(temp_focused_obj);
            printf("k=%d\n\r",k);

            lv_obj_t* label1 = lv_obj_get_child(temp_focused_obj, 0);
            lv_style_reset(&data_structure[k].data.word.style);
            lv_ft_font_destroy(data_structure[k].data.word.info.font);


            location_x = lv_obj_get_x(temp_focused_obj);
            location_y = lv_obj_get_y(temp_focused_obj);

            for (i = 0; i < TYPEFACE_NUMBER; i++)
            {
                if (strncmp(lv_label_get_text(label_file_management_typeface_label), typeface_name[i], strlen(lv_label_get_text(label_file_management_typeface_label))) == 0)
                {
                    break;
                }
            }

            sprintf(temp_typeface, "/media/%s", typeface_buf[i]);
            data_structure[k].data.word.typeface = i;

            data_structure[k].data.word.info.name = temp_typeface;

            word_size = atoi(lv_label_get_text(label_file_management_word_size_label));

            if (word_size < 12)
            {
                word_size = 12;
            }

            if (word_size > 200)
            {
                word_size = 200;
            }

            printf("word_size=%u\n\r", word_size);

            data_structure[k].data.word.info.weight = word_size;

            data_structure[k].data.word.info.style = FT_FONT_STYLE_NORMAL;

            if (lv_obj_has_state(sw_management_line_italic, LV_STATE_CHECKED) == 1)
            {
                data_structure[k].data.word.info.style |= FT_FONT_STYLE_ITALIC;
            }

            if (lv_obj_has_state(sw_file_management_bold, LV_STATE_CHECKED) == 1)
            {
                data_structure[k].data.word.info.style |= FT_FONT_STYLE_BOLD;
            }

            printf("info.style=%d\n\r", data_structure[k].data.word.info.style);

            lv_ft_font_init(&data_structure[k].data.word.info);

            lv_point_t text_size;
            lv_txt_get_size(&text_size, lv_label_get_text(label_file_management_label), data_structure[k].data.word.info.font, 0, 0, LV_COORD_MAX, LV_TEXT_FLAG_NONE);

            lv_style_init(&data_structure[k].data.word.style);
            lv_style_set_text_font(&data_structure[k].data.word.style, data_structure[k].data.word.info.font);

            word_space = atoi(lv_label_get_text(label_file_management_word_space_label));

            if (word_space < 0)
            {
                word_space = 0;
            }

            if (word_space > 100)
            {
                word_space = 100;
            }
            printf("x=%u y=%u\n\r", text_size.x, text_size.y);

            x_size = text_size.x + text_size.x * 2 * word_space / text_size.y;
            //x_size = text_size.x + len * word_space;

            printf("x_size=%d\n\r", x_size);
            printf("word_space=%d\n\r", word_space);
            lv_obj_set_size(temp_focused_obj, x_size, text_size.y);

            lv_style_set_text_letter_space(&data_structure[k].data.word.style, word_space);

            lv_obj_align(temp_focused_obj, LV_ALIGN_OUT_TOP_LEFT, location_x, location_y);
        
            lv_obj_add_style(label1, &data_structure[k].data.word.style, 0);
            lv_label_set_text(label1, lv_label_get_text(label_file_management_label));
            lv_obj_center(label1);
            strncpy(data_structure[k].data.word.text, lv_label_get_text(label_file_management_label), len);
            data_structure[k].data.word.size = word_size;
            data_structure[k].data.word.space = word_space;
            data_structure[k].data.word.italic_bold = data_structure[k].data.word.info.style;
            printf("italic_bold=%d\n\r", data_structure[k].data.word.italic_bold);
            printf("text=%s\n\r", data_structure[k].data.word.text);
        }

        lv_obj_del(file_management_win);
        lv_obj_del(file_management_head_bg);
        //lv_obj_del(label_file_management_total_output);
        lv_obj_del(label_file_management);
        //lv_obj_del(label_file_management_date);
        //lv_obj_del(label_file_management_time);
        //lv_obj_del(img_file_management_battery_level);
        lv_obj_del(label_file_management_label);
        lv_obj_del(file_management_middle_bg);
        lv_obj_del(img_file_management_text);
        lv_obj_del(label_file_management_text);
        lv_obj_del(btn_file_management_text);
        //lv_obj_del(img_file_management_text_time);
        //lv_obj_del(label_file_management_text_time);
        //lv_obj_del(label_file_management_text_time_label);

        lv_obj_del(img_file_management_typeface);
        lv_obj_del(label_file_management_typeface);
        lv_obj_del(label_file_management_typeface_label);
        lv_obj_del(btn_file_management_typeface);

        lv_obj_del(img_file_management_word_space);
        lv_obj_del(label_file_management_word_space);
        lv_obj_del(label_file_management_word_space_label);
        lv_obj_del(btn_file_management_word_space_label);

        lv_obj_del(img_file_management_word_size);
        lv_obj_del(label_file_management_word_size);
        lv_obj_del(label_file_management_word_size_label);
        lv_obj_del(btn_file_management_word_size_label);

        lv_obj_del(img_file_management_spin);
        lv_obj_del(label_file_management_spin);
        lv_obj_del(label_btn_modification_text_spin);
        lv_obj_del(btn_modification_text_spin);

        lv_obj_del(img_file_management_bold);
        lv_obj_del(label_file_management_bold);
        lv_obj_del(sw_file_management_bold);

        lv_obj_del(img_management_line_italic);
        lv_obj_del(label_management_line_italic);
        lv_obj_del(sw_management_line_italic);

        lv_obj_del(file_management_bottom_bg);
        lv_obj_del(label_file_management_return);
        lv_obj_del(imgbtn_file_management_get_back);
        lv_obj_del(imgbtn_file_management_confirm);
        lv_obj_del(label_file_management_confirm);
       
    }
}
#endif

#if 0
static void label_btn_modification_text_spin_event_cb(lv_event_t* e)
{
    lv_event_code_t code;

    code = lv_event_get_code(e);
    //int len = 0;
    //int i;
    //int offset_x;
    //int offset_y;
    //int line_num = 5;
    //int size_wide = 85;
    //int size_high = 24;
    lv_obj_t* obj = lv_event_get_target(e);

    if (code == LV_EVENT_CLICKED)
    {
        typeface_head_bg = lv_obj_create(lv_scr_act());
        lv_obj_set_size(typeface_head_bg, 480, 24);
        lv_obj_align(typeface_head_bg, LV_ALIGN_TOP_LEFT, 0, 0);
        lv_obj_set_style_border_width(typeface_head_bg, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_border_color(typeface_head_bg, lv_color_hex(0x9bcd9b), LV_STATE_DEFAULT); /* 设置边框颜色 */
        lv_obj_set_style_radius(typeface_head_bg, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_color(typeface_head_bg, lv_color_hex(0x1fadd3), LV_STATE_DEFAULT);

        LV_FONT_DECLARE(heiFont16_1);
        label_typeface_head = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_typeface_head, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_typeface_head, lv_color_hex(0xFFFFFF), LV_STATE_DEFAULT);
        lv_obj_align(label_typeface_head, LV_ALIGN_TOP_LEFT, 200, 4);

        if (obj == btn_file_management_word_space_label)
        {
            printf("btn_file_management_word_space_label\n");
            lv_label_set_text(label_typeface_head, "间隔");
        }
        else if (obj == btn_file_management_word_size_label)
        {
            printf("btn_file_management_word_size_label\n");
            lv_label_set_text(label_typeface_head, "字号");
        }

        typeface_slider_bg = lv_obj_create(lv_scr_act());
        lv_obj_set_size(typeface_slider_bg, 480, 224);
        lv_obj_align(typeface_slider_bg, LV_ALIGN_TOP_LEFT, 0, 24);
        lv_obj_set_style_border_width(typeface_slider_bg, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_border_color(typeface_slider_bg, lv_color_hex(0xaaaaaa), LV_STATE_DEFAULT); /* 设置边框颜色 */
        lv_obj_set_style_radius(typeface_slider_bg, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_color(typeface_slider_bg, lv_color_hex(0xaaaaaa), LV_STATE_DEFAULT);

        //数字键盘
        pwd_text_area = lv_textarea_create(lv_scr_act());
        if (pwd_text_area == NULL)
        {
            printf("[%s:%d] create pwd_text_area obj failed\n", __FUNCTION__, __LINE__);
            return;
        }

        // 密码框样式
        static lv_style_t pwd_text_style;
        lv_style_init(&pwd_text_style); // 初始化样式
        lv_style_set_radius(&pwd_text_style, 0); // 设置样式的圆角弧度
        lv_style_set_border_width(&pwd_text_style, 1); // 设置边框宽度
        lv_style_set_pad_all(&pwd_text_style, 0); // 设置样式的内部填充
        lv_style_set_text_font(&pwd_text_style, &lv_font_montserrat_18); //设置字体
        //lv_textarea_set_password_mode(pwd_text_area, true); // 文本区域开启密码模式
        lv_textarea_set_max_length(pwd_text_area, 3); // 设置可输入的文本的最大长度
        lv_obj_add_style(pwd_text_area, &pwd_text_style, 0); // 给btn_label添加样式
        lv_obj_set_size(pwd_text_area, 480, 50); // 设置对象大小
        lv_textarea_set_text(pwd_text_area, ""); // 文本框置空
        lv_obj_align(pwd_text_area, LV_ALIGN_TOP_LEFT, 0, 24);

        // 基于键盘背景对象创建密码校验提示标签
        hint_label = lv_label_create(lv_scr_act());
        if (hint_label == NULL)
        {
            printf("[%s:%d] create hint_label obj failed\n", __FUNCTION__, __LINE__);
            return;
        }

        // 密码提示文本样式
        static lv_style_t hint_label_style;
        lv_style_init(&hint_label_style); // 初始化样式
        lv_style_set_radius(&hint_label_style, 0); // 设置样式的圆角弧度
        lv_style_set_border_width(&hint_label_style, 0); //设置边框宽度
        lv_style_set_text_color(&hint_label_style, lv_palette_main(LV_PALETTE_RED));  // 字体颜色设置为红色
        lv_style_set_text_font(&hint_label_style, &lv_font_montserrat_12); //设置字体
        lv_label_set_long_mode(hint_label, LV_LABEL_LONG_SCROLL_CIRCULAR); // 长文本循环滚动
        lv_obj_add_style(hint_label, &hint_label_style, 0); // 给btn_label添加样式
        lv_obj_align(hint_label, LV_ALIGN_TOP_MID, 0, 110); // 顶部居中显示
        lv_label_set_text(hint_label, ""); // 设置文本内容

        // 基于键盘背景对象创建键盘对象
        pwd_keyboard = lv_keyboard_create(lv_scr_act());
        if (pwd_keyboard == NULL)
        {
            printf("[%s:%d] create pwd_keyboard obj failed\n", __FUNCTION__, __LINE__);
            return;
        }

        //键盘样式
        static lv_style_t pwd_kb_style;
        lv_style_init(&pwd_kb_style); // 初始化样式
        lv_style_set_radius(&pwd_kb_style, 5); // 设置样式的圆角弧度
        lv_style_set_border_width(&pwd_kb_style, 0); //设置边框宽度
        lv_style_set_bg_color(&pwd_kb_style, lv_color_hex(0xF98E2D));
        lv_style_set_text_opa(&pwd_kb_style, LV_OPA_COVER);
        lv_style_set_text_font(&pwd_kb_style, &lv_font_montserrat_20); //设置字体
        lv_obj_set_size(pwd_keyboard, 480, 174); //设置键盘大小
        lv_keyboard_set_mode(pwd_keyboard, LV_KEYBOARD_MODE_NUMBER_2); //设置键盘模式为数字键盘
        lv_keyboard_set_map(pwd_keyboard, LV_KEYBOARD_MODE_NUMBER_2, keyboard_map, keyboard_ctrl); // 设置键盘映射
        lv_keyboard_set_textarea(pwd_keyboard, pwd_text_area); // 键盘对象和文本框绑定
        lv_obj_add_style(pwd_keyboard, &pwd_kb_style, 0); // 添加样式
        lv_obj_align(pwd_keyboard, LV_ALIGN_TOP_LEFT, 0, 74);


        LV_FONT_DECLARE(heiFont16_1);
        label_typeface_return = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_typeface_return, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_typeface_return, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        lv_label_set_text(label_typeface_return, "返回");
        lv_obj_align(label_typeface_return, LV_ALIGN_TOP_LEFT, 140, 252);

        LV_IMG_DECLARE(get_back);
        btn_typeface_return = lv_imgbtn_create(lv_scr_act());
        lv_imgbtn_set_src(btn_typeface_return, LV_IMGBTN_STATE_RELEASED, NULL, &get_back, NULL);
        lv_obj_set_size(btn_typeface_return, get_back.header.w, get_back.header.h);
        lv_obj_align(btn_typeface_return, LV_ALIGN_TOP_LEFT, 180, 250);
        lv_obj_add_event_cb(btn_typeface_return, button_work_size_return_event_cb, LV_EVENT_CLICKED, NULL);


        LV_IMG_DECLARE(confirm);
        btn_typeface_confirm = lv_imgbtn_create(lv_scr_act());
        lv_imgbtn_set_src(btn_typeface_confirm, LV_IMGBTN_STATE_RELEASED, NULL, &confirm, NULL);
        lv_obj_set_size(btn_typeface_confirm, get_back.header.w, get_back.header.h);
        lv_obj_align(btn_typeface_confirm, LV_ALIGN_TOP_LEFT, 250, 250);
        lv_obj_add_event_cb(btn_typeface_confirm, button_word_size_confirm_event_cb, LV_EVENT_CLICKED, NULL);

        LV_FONT_DECLARE(heiFont16_1);
        label_typeface_confirm = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_typeface_confirm, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_typeface_confirm, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        lv_label_set_text(label_typeface_confirm, "确定");
        lv_obj_align(label_typeface_confirm, LV_ALIGN_TOP_LEFT, 277, 252);
    }
}
#endif

#if 0
static void button_modification_text_event_cb(void)
{

    printf("button_modification_text_event_cb\n");
    file_management_win = lv_obj_create(lv_scr_act());
    lv_obj_set_size(file_management_win, 480, 272);
    lv_obj_align(file_management_win, LV_ALIGN_TOP_LEFT, 0, 0);
    lv_obj_set_style_border_width(file_management_win, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
    lv_obj_set_style_radius(file_management_win, 0, LV_STATE_DEFAULT); /* 设置圆角 */

    file_management_head_bg = lv_obj_create(lv_scr_act());
    lv_obj_set_size(file_management_head_bg, 480, 24);
    lv_obj_align(file_management_head_bg, LV_ALIGN_TOP_LEFT, 0, 0);
    lv_obj_set_style_border_width(file_management_head_bg, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
    lv_obj_set_style_radius(file_management_head_bg, 0, LV_STATE_DEFAULT); /* 设置圆角 */
    lv_obj_set_style_bg_color(file_management_head_bg, lv_color_hex(0x28536a), LV_STATE_DEFAULT);
    lv_obj_remove_style(file_management_head_bg, 0, LV_PART_SCROLLBAR);


    LV_FONT_DECLARE(heiFont16_1);
    label_file_management = lv_label_create(lv_scr_act());
    lv_obj_set_style_text_font(label_file_management, &heiFont16_1, LV_STATE_DEFAULT);
    lv_obj_set_style_text_color(label_file_management, lv_color_hex(0xFFFFFF), LV_STATE_DEFAULT);
    lv_label_set_text(label_file_management, "文本");
    lv_obj_align(label_file_management, LV_ALIGN_TOP_LEFT, 200, 4);


    LV_FONT_DECLARE(heiFont16_1);
    label_file_management_label = lv_label_create(lv_scr_act());
    lv_obj_set_width(label_file_management_label, 480);
    lv_obj_set_height(label_file_management_label, 108);
    lv_obj_set_style_text_font(label_file_management_label, &heiFont16_1, LV_STATE_DEFAULT);
    lv_obj_set_style_text_color(label_file_management_label, lv_color_hex(0x1C1C1C), LV_STATE_DEFAULT);
    lv_label_set_text(label_file_management_label, data_structure[g_modification_id].data.word.text);
    lv_obj_align(label_file_management_label, LV_ALIGN_TOP_LEFT, 0, 24);


        
    file_management_middle_bg = lv_obj_create(lv_scr_act());
    lv_obj_set_size(file_management_middle_bg, 480, 140);
    lv_obj_align(file_management_middle_bg, LV_ALIGN_TOP_LEFT, 0, 132);
    lv_obj_set_style_border_width(file_management_middle_bg, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
    lv_obj_set_style_radius(file_management_middle_bg, 0, LV_STATE_DEFAULT); /* 设置圆角 */
    lv_obj_set_style_bg_color(file_management_middle_bg, lv_color_hex(0x1fadd3), LV_STATE_DEFAULT);

    LV_IMG_DECLARE(text);
    img_file_management_text = lv_img_create(lv_scr_act());
    lv_img_set_src(img_file_management_text, &text);
    lv_obj_align(img_file_management_text, LV_ALIGN_TOP_LEFT, 10, 134);

    LV_FONT_DECLARE(heiFont16_1);
    label_file_management_text = lv_label_create(lv_scr_act());
    lv_obj_set_style_text_font(label_file_management_text, &heiFont16_1, LV_STATE_DEFAULT);
    lv_obj_set_style_text_color(label_file_management_text, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
    lv_label_set_text(label_file_management_text, "文本");
    lv_obj_align(label_file_management_text, LV_ALIGN_TOP_LEFT, 45, 139);

    LV_FONT_DECLARE(heiFont16_1);
    btn_file_management_text = lv_btn_create(lv_scr_act());
    lv_obj_set_size(btn_file_management_text, 125, 24);
    lv_obj_align(btn_file_management_text, LV_ALIGN_TOP_LEFT, 95, 136);
    lv_obj_set_style_border_width(btn_file_management_text, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
    lv_obj_set_style_radius(btn_file_management_text, 0, LV_STATE_DEFAULT); /* 设置圆角 */
    lv_obj_set_style_bg_color(btn_file_management_text, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
    label_file_management_text_label = lv_label_create(btn_file_management_text);
    lv_obj_set_style_text_font(label_file_management_text_label, &heiFont16_1, LV_STATE_DEFAULT);
    lv_obj_set_style_text_color(label_file_management_text_label, lv_color_hex(0x1C1C1C), LV_STATE_DEFAULT);
    lv_label_set_text(label_file_management_text_label, data_structure[g_modification_id].data.word.text);
    lv_obj_align(label_file_management_text_label, LV_ALIGN_CENTER, 0, 0);
    lv_obj_set_style_border_width(label_file_management_text_label, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
    lv_obj_set_style_border_color(label_file_management_text_label, lv_color_hex(0x8a8a8a), LV_STATE_DEFAULT); /* 设置边框颜色 */
    lv_obj_set_style_border_opa(label_file_management_text_label, 100, LV_STATE_DEFAULT); /* 设置边框透明度 */
    lv_obj_set_style_radius(label_file_management_text_label, 0, LV_STATE_DEFAULT); /* 设置圆角 */
    lv_obj_set_style_bg_opa(label_file_management_text_label, LV_OPA_COVER, LV_PART_MAIN);
    lv_obj_set_style_bg_color(label_file_management_text_label, lv_color_hex(0xffffff), LV_PART_MAIN);
    lv_obj_add_event_cb(btn_file_management_text, btn_file_management_text_event_cb, LV_EVENT_CLICKED, NULL);

    LV_IMG_DECLARE(typeface);
    img_file_management_typeface = lv_img_create(lv_scr_act());
    lv_img_set_src(img_file_management_typeface, &typeface);
    lv_obj_align(img_file_management_typeface, LV_ALIGN_TOP_LEFT, 10, 162);

    LV_FONT_DECLARE(heiFont16_1);
    label_file_management_typeface = lv_label_create(lv_scr_act());
    lv_obj_set_style_text_font(label_file_management_typeface, &heiFont16_1, LV_STATE_DEFAULT);
    lv_obj_set_style_text_color(label_file_management_typeface, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
    lv_label_set_text(label_file_management_typeface, "字体");
    lv_obj_align(label_file_management_typeface, LV_ALIGN_TOP_LEFT, 45, 167);


    LV_FONT_DECLARE(heiFont16_1);
    btn_file_management_typeface = lv_btn_create(lv_scr_act());
    lv_obj_set_size(btn_file_management_typeface, 125, 24);
    lv_obj_align(btn_file_management_typeface, LV_ALIGN_TOP_LEFT, 95, 164);
    lv_obj_set_style_border_width(btn_file_management_typeface, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
    lv_obj_set_style_radius(btn_file_management_typeface, 0, LV_STATE_DEFAULT); /* 设置圆角 */
    lv_obj_set_style_bg_color(btn_file_management_typeface, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
    label_file_management_typeface_label = lv_label_create(btn_file_management_typeface);
    lv_obj_set_style_text_font(label_file_management_typeface_label, &heiFont16_1, LV_STATE_DEFAULT);
    lv_obj_set_style_text_color(label_file_management_typeface_label, lv_color_hex(0x1C1C1C), LV_STATE_DEFAULT);
    lv_label_set_text(label_file_management_typeface_label, typeface_name[ data_structure[g_modification_id].data.word.typeface]);





    lv_obj_align(label_file_management_typeface_label, LV_ALIGN_CENTER, 0, 0);
    lv_obj_set_style_border_width(label_file_management_typeface_label, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
    lv_obj_set_style_border_color(label_file_management_typeface_label, lv_color_hex(0x8a8a8a), LV_STATE_DEFAULT); /* 设置边框颜色 */
    lv_obj_set_style_border_opa(label_file_management_typeface_label, 100, LV_STATE_DEFAULT); /* 设置边框透明度 */
    lv_obj_set_style_radius(label_file_management_typeface_label, 0, LV_STATE_DEFAULT); /* 设置圆角 */
    lv_obj_set_style_bg_opa(label_file_management_typeface_label, LV_OPA_COVER, LV_PART_MAIN);
    lv_obj_set_style_bg_color(label_file_management_typeface_label, lv_color_hex(0xffffff), LV_PART_MAIN);
    lv_obj_add_event_cb(btn_file_management_typeface, btn_file_management_typeface_event_cb, LV_EVENT_CLICKED, NULL);


    LV_IMG_DECLARE(word_space);
    img_file_management_word_space = lv_img_create(lv_scr_act());
    lv_img_set_src(img_file_management_word_space, &word_space);
    lv_obj_align(img_file_management_word_space, LV_ALIGN_TOP_LEFT, 250, 134);

    LV_FONT_DECLARE(heiFont16_1);
    label_file_management_word_space = lv_label_create(lv_scr_act());
    lv_obj_set_style_text_font(label_file_management_word_space, &heiFont16_1, LV_STATE_DEFAULT);
    lv_obj_set_style_text_color(label_file_management_word_space, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
    lv_label_set_text(label_file_management_word_space, "间隔");
    lv_obj_align(label_file_management_word_space, LV_ALIGN_TOP_LEFT, 285, 139);


    LV_FONT_DECLARE(heiFont16_1);
    btn_file_management_word_space_label = lv_btn_create(lv_scr_act());
    lv_obj_set_size(btn_file_management_word_space_label, 125, 24);
    lv_obj_align(btn_file_management_word_space_label, LV_ALIGN_TOP_LEFT, 338, 136);
    lv_obj_set_style_border_width(btn_file_management_word_space_label, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
    lv_obj_set_style_radius(btn_file_management_word_space_label, 0, LV_STATE_DEFAULT); /* 设置圆角 */
    lv_obj_set_style_bg_color(btn_file_management_word_space_label, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
    label_file_management_word_space_label = lv_label_create(btn_file_management_word_space_label);
    lv_obj_set_style_text_font(label_file_management_word_space_label, &heiFont16_1, LV_STATE_DEFAULT);
    lv_obj_set_style_text_color(label_file_management_word_space_label, lv_color_hex(0x1C1C1C), LV_STATE_DEFAULT);
    lv_label_set_text(label_file_management_word_space_label, "");
    lv_obj_align(label_file_management_word_space_label, LV_ALIGN_CENTER, 0, 0);
    lv_obj_set_style_border_width(label_file_management_word_space_label, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
    lv_obj_set_style_border_color(label_file_management_word_space_label, lv_color_hex(0x8a8a8a), LV_STATE_DEFAULT); /* 设置边框颜色 */
    lv_obj_set_style_border_opa(label_file_management_word_space_label, 100, LV_STATE_DEFAULT); /* 设置边框透明度 */
    lv_obj_set_style_radius(label_file_management_word_space_label, 0, LV_STATE_DEFAULT); /* 设置圆角 */
    lv_obj_set_style_bg_opa(label_file_management_word_space_label, LV_OPA_COVER, LV_PART_MAIN);
    lv_obj_set_style_bg_color(label_file_management_word_space_label, lv_color_hex(0xffffff), LV_PART_MAIN);
    lv_obj_add_event_cb(btn_file_management_word_space_label, btn_file_management_word_space_event_cb, LV_EVENT_CLICKED, NULL);


    LV_IMG_DECLARE(word_size);
    img_file_management_word_size = lv_img_create(lv_scr_act());
    lv_img_set_src(img_file_management_word_size, &word_size);
    lv_obj_align(img_file_management_word_size, LV_ALIGN_TOP_LEFT, 10, 190);

    LV_FONT_DECLARE(heiFont16_1);
    label_file_management_word_size = lv_label_create(lv_scr_act());
    lv_obj_set_style_text_font(label_file_management_word_size, &heiFont16_1, LV_STATE_DEFAULT);
    lv_obj_set_style_text_color(label_file_management_word_size, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
    lv_label_set_text(label_file_management_word_size, "字号");
    lv_obj_align(label_file_management_word_size, LV_ALIGN_TOP_LEFT, 45, 195);


    LV_FONT_DECLARE(heiFont16_1);
    btn_file_management_word_size_label = lv_btn_create(lv_scr_act());
    lv_obj_set_size(btn_file_management_word_size_label, 125, 24);
    lv_obj_align(btn_file_management_word_size_label, LV_ALIGN_TOP_LEFT, 95, 192);
    lv_obj_set_style_border_width(btn_file_management_word_size_label, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
    lv_obj_set_style_radius(btn_file_management_word_size_label, 0, LV_STATE_DEFAULT); /* 设置圆角 */
    lv_obj_set_style_bg_color(btn_file_management_word_size_label, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
    label_file_management_word_size_label = lv_label_create(btn_file_management_word_size_label);
    lv_obj_set_style_text_font(label_file_management_word_size_label, &heiFont16_1, LV_STATE_DEFAULT);
    lv_obj_set_style_text_color(label_file_management_word_size_label, lv_color_hex(0x1C1C1C), LV_STATE_DEFAULT);
    lv_label_set_text(label_file_management_word_size_label, "");
    lv_obj_align(label_file_management_word_size_label, LV_ALIGN_CENTER, 0, 0);
    lv_obj_set_style_border_width(label_file_management_word_size_label, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
    lv_obj_set_style_border_color(label_file_management_word_size_label, lv_color_hex(0x8a8a8a), LV_STATE_DEFAULT); /* 设置边框颜色 */
    lv_obj_set_style_border_opa(label_file_management_word_size_label, 100, LV_STATE_DEFAULT); /* 设置边框透明度 */
    lv_obj_set_style_radius(label_file_management_word_size_label, 0, LV_STATE_DEFAULT); /* 设置圆角 */
    lv_obj_set_style_bg_opa(label_file_management_word_size_label, LV_OPA_COVER, LV_PART_MAIN);
    lv_obj_set_style_bg_color(label_file_management_word_size_label, lv_color_hex(0xffffff), LV_PART_MAIN);
    lv_obj_add_event_cb(btn_file_management_word_size_label, btn_file_management_word_size_event_cb, LV_EVENT_CLICKED, NULL);

    LV_IMG_DECLARE(spin);
    img_file_management_spin = lv_img_create(lv_scr_act());
    lv_img_set_src(img_file_management_spin, &spin);
    lv_obj_align(img_file_management_spin, LV_ALIGN_TOP_LEFT, 250, 162);

    LV_FONT_DECLARE(heiFont16_1);
    label_file_management_spin = lv_label_create(lv_scr_act());
    lv_obj_set_style_text_font(label_file_management_spin, &heiFont16_1, LV_STATE_DEFAULT);
    lv_obj_set_style_text_color(label_file_management_spin, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
    lv_label_set_text(label_file_management_spin, "旋转");
    lv_obj_align(label_file_management_spin, LV_ALIGN_TOP_LEFT, 285, 167);


    LV_FONT_DECLARE(heiFont16_1);
    btn_addition_text_spin = lv_btn_create(lv_scr_act());
    lv_obj_set_size(btn_addition_text_spin, 125, 24);
    lv_obj_align(btn_addition_text_spin, LV_ALIGN_TOP_LEFT, 338, 164);
    lv_obj_set_style_border_width(btn_addition_text_spin, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
    lv_obj_set_style_radius(btn_addition_text_spin, 0, LV_STATE_DEFAULT); /* 设置圆角 */
    lv_obj_set_style_bg_color(btn_addition_text_spin, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
    label_btn_addition_text_spin = lv_label_create(btn_addition_text_spin);
    lv_obj_set_style_text_font(label_btn_addition_text_spin, &heiFont16_1, LV_STATE_DEFAULT);
    lv_obj_set_style_text_color(label_btn_addition_text_spin, lv_color_hex(0x1C1C1C), LV_STATE_DEFAULT);
    lv_label_set_text(label_btn_addition_text_spin, "");
    lv_obj_align(label_btn_addition_text_spin, LV_ALIGN_CENTER, 0, 0);
    lv_obj_set_style_border_width(label_btn_addition_text_spin, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
    lv_obj_set_style_border_color(label_btn_addition_text_spin, lv_color_hex(0x8a8a8a), LV_STATE_DEFAULT); /* 设置边框颜色 */
    lv_obj_set_style_border_opa(label_btn_addition_text_spin, 100, LV_STATE_DEFAULT); /* 设置边框透明度 */
    lv_obj_set_style_radius(label_btn_addition_text_spin, 0, LV_STATE_DEFAULT); /* 设置圆角 */
    lv_obj_set_style_bg_opa(label_btn_addition_text_spin, LV_OPA_COVER, LV_PART_MAIN);
    lv_obj_set_style_bg_color(label_btn_addition_text_spin, lv_color_hex(0xffffff), LV_PART_MAIN);
    lv_obj_add_event_cb(btn_addition_text_spin, btn_addition_text_spin_event_cb, LV_EVENT_CLICKED, NULL);


    LV_IMG_DECLARE(bold);
    img_file_management_bold = lv_img_create(lv_scr_act());
    lv_img_set_src(img_file_management_bold, &bold);
    lv_obj_align(img_file_management_bold, LV_ALIGN_TOP_LEFT, 250, 218);

    LV_FONT_DECLARE(heiFont16_1);
    label_file_management_bold = lv_label_create(lv_scr_act());
    lv_obj_set_style_text_font(label_file_management_bold, &heiFont16_1, LV_STATE_DEFAULT);
    lv_obj_set_style_text_color(label_file_management_bold, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
    lv_label_set_text(label_file_management_bold, "粗体");
    lv_obj_align(label_file_management_bold, LV_ALIGN_TOP_LEFT, 285, 223);

    sw_file_management_bold = lv_switch_create(lv_scr_act());
    lv_obj_set_pos(sw_file_management_bold, 343, 220);
    lv_obj_set_width(sw_file_management_bold, 48);
    lv_obj_set_height(sw_file_management_bold, 23);
    lv_obj_set_style_bg_color(sw_file_management_bold, lv_color_hex(0x00ff00), LV_STATE_CHECKED | LV_PART_INDICATOR);


    LV_IMG_DECLARE(italic);
    img_management_line_italic = lv_img_create(lv_scr_act());
    lv_img_set_src(img_management_line_italic, &italic);
    lv_obj_align(img_management_line_italic, LV_ALIGN_TOP_LEFT, 10, 218);

    LV_FONT_DECLARE(heiFont16_1);
    label_management_line_italic = lv_label_create(lv_scr_act());
    lv_obj_set_style_text_font(label_management_line_italic, &heiFont16_1, LV_STATE_DEFAULT);
    lv_obj_set_style_text_color(label_management_line_italic, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
    lv_label_set_text(label_management_line_italic, "斜体");
    lv_obj_align(label_management_line_italic, LV_ALIGN_TOP_LEFT, 45, 223);

    sw_management_line_italic = lv_switch_create(lv_scr_act());
    lv_obj_set_pos(sw_management_line_italic, 95, 220);
    lv_obj_set_width(sw_management_line_italic, 48);
    lv_obj_set_height(sw_management_line_italic, 23);
    lv_obj_set_style_bg_color(sw_management_line_italic, lv_color_hex(0x00ff00), LV_STATE_CHECKED | LV_PART_INDICATOR);

    file_management_bottom_bg = lv_obj_create(lv_scr_act());
    lv_obj_set_size(file_management_bottom_bg, 480, 24);
    lv_obj_align(file_management_bottom_bg, LV_ALIGN_TOP_LEFT, 0, 248);
    lv_obj_set_style_border_width(file_management_bottom_bg, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
    lv_obj_set_style_radius(file_management_bottom_bg, 0, LV_STATE_DEFAULT); /* 设置圆角 */
    lv_obj_set_style_bg_color(file_management_bottom_bg, lv_color_hex(0x28536a), LV_STATE_DEFAULT);
    lv_obj_remove_style(file_management_bottom_bg, 0, LV_PART_SCROLLBAR);

    LV_IMG_DECLARE(img_return);
    imgbtn_file_management_get_back = lv_imgbtn_create(lv_scr_act());
    lv_imgbtn_set_src(imgbtn_file_management_get_back, LV_IMGBTN_STATE_RELEASED, NULL, &img_return, NULL);
    lv_obj_set_size(imgbtn_file_management_get_back, img_return.header.w, img_return.header.h);
    lv_obj_align(imgbtn_file_management_get_back, LV_ALIGN_TOP_LEFT, 160, 247);
    lv_obj_add_event_cb(imgbtn_file_management_get_back, button_file_management_return_event_cb, LV_EVENT_CLICKED, NULL);

    LV_IMG_DECLARE(confirm);
    imgbtn_file_management_confirm = lv_imgbtn_create(lv_scr_act());
    lv_imgbtn_set_src(imgbtn_file_management_confirm, LV_IMGBTN_STATE_RELEASED, NULL, &confirm, NULL);
    lv_obj_set_size(imgbtn_file_management_confirm, confirm.header.w, confirm.header.h);
    lv_obj_align(imgbtn_file_management_confirm, LV_ALIGN_TOP_LEFT, 250, 250);
    lv_obj_add_event_cb(imgbtn_file_management_confirm, button_file_management_confirm_event_cb, LV_EVENT_CLICKED, NULL);

    LV_FONT_DECLARE(heiFont16_1);
    label_file_management_confirm = lv_label_create(lv_scr_act());
    lv_obj_set_style_text_font(label_file_management_confirm, &heiFont16_1, LV_STATE_DEFAULT);
    lv_obj_set_style_text_color(label_file_management_confirm, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
    lv_label_set_text(label_file_management_confirm, "确定");
    lv_obj_align(label_file_management_confirm, LV_ALIGN_TOP_LEFT, 277, 252);   
}
#endif


//文本界面，默认字体，思源1
//新建的时候，先收集数据
//再依次更新
static void modification_text_confirm_event_cb(lv_event_t* e)
{
    lv_event_code_t code;
    code = lv_event_get_code(e);
    //char temp_typeface[128] = { 0 };
    int i = 0;
    int word_space = 0;
    int word_size = 0;
    int win_content_child_num = 0;

    if (code == LV_EVENT_CLICKED)
    {
        printf("modification_text_confirm_event_cb\n\r");

        buzzer_enable = 1;

        int len = strlen(lv_label_get_text(label_file_management_label));
        printf("len=%u\n\r", len);

        if (len > 0)
        {
            //lv_style_reset(&data_structure[g_modification_id].data.word.style);
            //lv_ft_font_destroy(data_structure[g_modification_id].data.word.info.font);

            win_content_child_num = g_modification_id;

            lv_obj_t* temp_obj = lv_obj_get_child(win_content,g_modification_id);

            for (i = 0; i < TYPEFACE_NUMBER; i++)
            {
                if (strncmp(lv_label_get_text(label_file_management_typeface_label), typeface_name[i], strlen(lv_label_get_text(label_file_management_typeface_label))) == 0)
                {
                    break;
                }
            }

            //sprintf(temp_typeface, "/media/%s", typeface_buf[i]);
            data_structure[win_content_child_num].data.word.typeface = i;

            //info.name = "./lvgl/src/extra/libs/freetype/arial.ttf";
            //info.name = "./lvgl/src/extra/libs/freetype/simsun.ttc";
            //sprintf(temp_typeface, "./lvgl/src/extra/libs/freetype/%s", typeface_buf[SOURCE_HAN_SERIF_CN_REGULAR_1]);
            //printf("%s\n", temp_typeface);
            //data_structure[win_content_child_num].data.word.info.name = temp_typeface;


            word_size = atoi(lv_label_get_text(label_file_management_word_size_label));

            if (word_size < 12)
            {
                word_size = 12;
            }

            if (word_size > 200)
            {
                word_size = 200;
            }

            word_space = atoi(lv_label_get_text(label_file_management_word_space_label));

            if (word_space < 0)
            {
                word_space = 0;
            }

            if (word_space > 100)
            {
                word_space = 100;
            }

            data_structure[win_content_child_num].data.word.spin = atoi(lv_label_get_text(label_btn_addition_text_spin));

            printf("spin=%u\n\r", data_structure[win_content_child_num].data.word.spin);

            data_structure[win_content_child_num].data.word.info.weight = word_size;

            data_structure[win_content_child_num].data.word.info.style = FT_FONT_STYLE_NORMAL;

            if (lv_obj_has_state(sw_management_line_italic, LV_STATE_CHECKED) == 1)
            {
                data_structure[win_content_child_num].data.word.info.style |= FT_FONT_STYLE_ITALIC;
            }

            if (lv_obj_has_state(sw_file_management_bold, LV_STATE_CHECKED) == 1)
            {
                data_structure[win_content_child_num].data.word.info.style |= FT_FONT_STYLE_BOLD;
            }

            //lv_ft_font_init(&data_structure[win_content_child_num].data.word.info);
             printf("typeface=%d\n\r", data_structure[win_content_child_num].data.word.typeface);
             lv_font_t* temp_font = font_list_get(data_structure[win_content_child_num].data.word.typeface, data_structure[win_content_child_num].data.word.size, data_structure[win_content_child_num].data.word.info.style);
             lv_point_t text_size;
             lv_txt_get_size(&text_size, data_structure[win_content_child_num].data.word.text, temp_font, data_structure[win_content_child_num].data.word.space, 0, LV_COORD_MAX, LV_TEXT_FLAG_NONE);  
    
            //printf("x=%u y=%u\n\r", text_size.x, text_size.y);

            //lv_obj_set_size(temp_obj, text_size.x, text_size.y);

            //lv_obj_set_style_bg_opa(temp_obj, LV_OPA_TRANSP, 0);
            //lv_obj_set_style_border_width(temp_obj, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */

            //lv_obj_add_event_cb(temp_obj, drag_event_handler, LV_EVENT_PRESSING, NULL);
            //lv_obj_add_event_cb(temp_obj, drag_event_handler, LV_EVENT_FOCUSED, NULL);
            //lv_obj_add_event_cb(temp_obj, drag_event_handler, LV_EVENT_DEFOCUSED, NULL);
            //lv_obj_clear_flag(temp_obj, LV_OBJ_FLAG_SCROLLABLE);

            lv_style_init(&data_structure[win_content_child_num].data.word.style);
            lv_style_set_text_font(&data_structure[win_content_child_num].data.word.style, temp_font);
  
            printf("x=%u y=%u\n\r", text_size.x, text_size.y);

            //x_size = text_size.x + text_size.x / text_size.y * word_space * 2;

            //printf("x_size=%d\n\r", x_size);

            lv_obj_set_size(temp_obj, text_size.x,text_size.y);

            lv_style_set_text_letter_space(&data_structure[win_content_child_num].data.word.style, word_space);

            lv_obj_del(lv_obj_get_child(temp_obj,0));

            lv_obj_t* label1 = lv_label_create(temp_obj);
            lv_obj_add_style(label1, &data_structure[win_content_child_num].data.word.style, 0);
            lv_label_set_text(label1, lv_label_get_text(label_file_management_label));
            lv_obj_center(label1);

            lv_obj_set_style_transform_angle(temp_obj, data_structure[win_content_child_num].data.word.spin*10, 0);

            if (data_structure[win_content_child_num].data.word.spin != 0)
            {
                lv_obj_align(temp_obj, LV_ALIGN_TOP_LEFT, 200, 70);
            }

            strncpy(data_structure[win_content_child_num].data.word.text, lv_label_get_text(label_file_management_label),len);
            data_structure[win_content_child_num].data.word.size = word_size;
            data_structure[win_content_child_num].data.word.space = word_space;
            data_structure[win_content_child_num].data.word.italic_bold = data_structure[win_content_child_num].data.word.info.style;
            data_structure[win_content_child_num].type = TYPE_WORD;
            printf("text=%s\n\r", data_structure[win_content_child_num].data.word.text);

            lv_obj_update_layout(win_content);
        }

        lv_obj_del(file_management_win);
        lv_obj_del(file_management_head_bg);
        lv_obj_del(label_file_management);
        lv_obj_del(label_file_management_label);
        lv_obj_del(file_management_middle_bg);
        lv_obj_del(img_file_management_text);
        lv_obj_del(label_file_management_text);
        lv_obj_del(label_file_management_text_label);

        lv_obj_del(img_file_management_typeface);
        lv_obj_del(label_file_management_typeface);
        lv_obj_del(label_file_management_typeface_label);

        lv_obj_del(img_file_management_word_space);
        lv_obj_del(label_file_management_word_space);
        lv_obj_del(label_file_management_word_space_label);

        lv_obj_del(img_file_management_word_size);
        lv_obj_del(label_file_management_word_size);
        lv_obj_del(label_file_management_word_size_label);

        lv_obj_del(img_file_management_spin);
        lv_obj_del(label_file_management_spin);
        lv_obj_del(label_btn_addition_text_spin);

        //lv_obj_del(img_file_management_width);
        //lv_obj_del(label_file_management_width);
        //lv_obj_del(label_file_management_width_label);

        lv_obj_del(img_file_management_bold);
        lv_obj_del(label_file_management_bold);
        lv_obj_del(sw_file_management_bold);

        lv_obj_del(img_management_line_italic);
        lv_obj_del(label_management_line_italic);
        lv_obj_del(sw_management_line_italic);

        lv_obj_del(file_management_bottom_bg);
        lv_obj_del(label_file_management_return);
        lv_obj_del(imgbtn_file_management_get_back);
        lv_obj_del(imgbtn_file_management_confirm);
        lv_obj_del(label_file_management_confirm);

        lv_obj_del(btn_file_management_text);
        lv_obj_del(btn_file_management_typeface);
        lv_obj_del(btn_file_management_word_space_label);
        lv_obj_del(btn_file_management_word_size_label);
        lv_obj_del(btn_addition_text_spin);
    }
}



//文本界面，默认字体，思源1
//新建的时候，先收集数据
//再依次更新
static void modification_text_return_event_cb(lv_event_t* e)
{
    lv_event_code_t code;
    code = lv_event_get_code(e);

    if (code == LV_EVENT_CLICKED)
    {
        printf("modification_text_return_event_cb\n\r");
        buzzer_enable = 1;
        lv_obj_del(file_management_win);
        lv_obj_del(file_management_head_bg);
        //lv_obj_del(label_file_management_total_output);
        lv_obj_del(label_file_management);
        //lv_obj_del(label_file_management_date);
        //lv_obj_del(label_file_management_time);
        //lv_obj_del(img_file_management_battery_level);
        lv_obj_del(label_file_management_label);
        lv_obj_del(file_management_middle_bg);
        lv_obj_del(img_file_management_text);
        lv_obj_del(label_file_management_text);
        lv_obj_del(label_file_management_text_label);

        lv_obj_del(img_file_management_typeface);
        lv_obj_del(label_file_management_typeface);
        lv_obj_del(label_file_management_typeface_label);

        lv_obj_del(img_file_management_word_space);
        lv_obj_del(label_file_management_word_space);
        lv_obj_del(label_file_management_word_space_label);

        lv_obj_del(img_file_management_word_size);
        lv_obj_del(label_file_management_word_size);
        lv_obj_del(label_file_management_word_size_label);

        lv_obj_del(img_file_management_spin);
        lv_obj_del(label_file_management_spin);
        lv_obj_del(label_btn_addition_text_spin);

        //lv_obj_del(img_file_management_width);
        //lv_obj_del(label_file_management_width);
        //lv_obj_del(label_file_management_width_label);

        lv_obj_del(img_file_management_bold);
        lv_obj_del(label_file_management_bold);
        lv_obj_del(sw_file_management_bold);

        lv_obj_del(img_management_line_italic);
        lv_obj_del(label_management_line_italic);
        lv_obj_del(sw_management_line_italic);

        lv_obj_del(file_management_bottom_bg);
        lv_obj_del(label_file_management_return);
        lv_obj_del(imgbtn_file_management_get_back);
        lv_obj_del(imgbtn_file_management_confirm);
        lv_obj_del(label_file_management_confirm);

        lv_obj_del(btn_file_management_text);
        lv_obj_del(btn_file_management_typeface);
        lv_obj_del(btn_file_management_word_space_label);
        lv_obj_del(btn_file_management_word_size_label);
        lv_obj_del(btn_addition_text_spin);
    }
}



static void modification_text(void)
{
    char tempBuf[32]={0};

    printf("modification_text\n");
    file_management_win = lv_obj_create(lv_scr_act());
    lv_obj_set_size(file_management_win, 480, 272);
    lv_obj_align(file_management_win, LV_ALIGN_TOP_LEFT, 0, 0);
    lv_obj_set_style_border_width(file_management_win, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
    lv_obj_set_style_radius(file_management_win, 0, LV_STATE_DEFAULT); /* 设置圆角 */

    file_management_head_bg = lv_obj_create(lv_scr_act());
    lv_obj_set_size(file_management_head_bg, 480, 24);
    lv_obj_align(file_management_head_bg, LV_ALIGN_TOP_LEFT, 0, 0);
    lv_obj_set_style_border_width(file_management_head_bg, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
    lv_obj_set_style_radius(file_management_head_bg, 0, LV_STATE_DEFAULT); /* 设置圆角 */
    lv_obj_set_style_bg_color(file_management_head_bg, lv_color_hex(0x28536a), LV_STATE_DEFAULT);
    lv_obj_remove_style(file_management_head_bg, 0, LV_PART_SCROLLBAR);

    LV_FONT_DECLARE(heiFont16_1);
    label_file_management = lv_label_create(lv_scr_act());
    lv_obj_set_style_text_font(label_file_management, &heiFont16_1, LV_STATE_DEFAULT);
    lv_obj_set_style_text_color(label_file_management, lv_color_hex(0xFFFFFF), LV_STATE_DEFAULT);
    if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
    {
        lv_label_set_text(label_file_management,  "文本");
    }
    else if(system_data.system.language == LANGUAGE_ENGLISH)
    {
        lv_label_set_text(label_file_management, "Text");
    }
    lv_obj_align(label_file_management, LV_ALIGN_TOP_LEFT, 200, 4);

    LV_FONT_DECLARE(heiFont16_1);
    label_file_management_label = lv_label_create(lv_scr_act());
    lv_obj_set_width(label_file_management_label, 480);
    lv_obj_set_height(label_file_management_label, 108);
    lv_obj_set_style_text_font(label_file_management_label, &heiFont16_1, LV_STATE_DEFAULT);
    lv_obj_set_style_text_color(label_file_management_label, lv_color_hex(0x1C1C1C), LV_STATE_DEFAULT);
    lv_label_set_text(label_file_management_label, data_structure[g_modification_id].data.word.text);
    lv_obj_align(label_file_management_label, LV_ALIGN_TOP_LEFT, 0, 24);
   
    file_management_middle_bg = lv_obj_create(lv_scr_act());
    lv_obj_set_size(file_management_middle_bg, 480, 140);
    lv_obj_align(file_management_middle_bg, LV_ALIGN_TOP_LEFT, 0, 132);
    lv_obj_set_style_border_width(file_management_middle_bg, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
    lv_obj_set_style_radius(file_management_middle_bg, 0, LV_STATE_DEFAULT); /* 设置圆角 */
    lv_obj_set_style_bg_color(file_management_middle_bg, lv_color_hex(0x1fadd3), LV_STATE_DEFAULT);

    LV_IMG_DECLARE(text);
    img_file_management_text = lv_img_create(lv_scr_act());
    lv_img_set_src(img_file_management_text, &text);
    lv_obj_align(img_file_management_text, LV_ALIGN_TOP_LEFT, 10, 134);

    LV_FONT_DECLARE(heiFont16_1);
    label_file_management_text = lv_label_create(lv_scr_act());
    lv_obj_set_style_text_font(label_file_management_text, &heiFont16_1, LV_STATE_DEFAULT);
    lv_obj_set_style_text_color(label_file_management_text, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
    if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
    {
        lv_label_set_text(label_file_management_text,  "文本");
    }
    else if(system_data.system.language == LANGUAGE_ENGLISH)
    {
        lv_label_set_text(label_file_management_text, "Text");
    }
    lv_obj_align(label_file_management_text, LV_ALIGN_TOP_LEFT, 45, 139);

    LV_FONT_DECLARE(heiFont16_1);
    btn_file_management_text = lv_btn_create(lv_scr_act());
    lv_obj_set_size(btn_file_management_text, 125, 24);
    lv_obj_align(btn_file_management_text, LV_ALIGN_TOP_LEFT, 95, 136);
    lv_obj_set_style_border_width(btn_file_management_text, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
    lv_obj_set_style_radius(btn_file_management_text, 0, LV_STATE_DEFAULT); /* 设置圆角 */
    lv_obj_set_style_bg_color(btn_file_management_text, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
    label_file_management_text_label = lv_label_create(btn_file_management_text);
    lv_obj_set_style_text_font(label_file_management_text_label, &heiFont16_1, LV_STATE_DEFAULT);
    lv_obj_set_style_text_color(label_file_management_text_label, lv_color_hex(0x1C1C1C), LV_STATE_DEFAULT);
    lv_label_set_text(label_file_management_text_label, data_structure[g_modification_id].data.word.text);
    lv_obj_align(label_file_management_text_label, LV_ALIGN_CENTER, 0, 0);
    lv_obj_set_style_border_width(label_file_management_text_label, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
    lv_obj_set_style_border_color(label_file_management_text_label, lv_color_hex(0x8a8a8a), LV_STATE_DEFAULT); /* 设置边框颜色 */
    lv_obj_set_style_border_opa(label_file_management_text_label, 100, LV_STATE_DEFAULT); /* 设置边框透明度 */
    lv_obj_set_style_radius(label_file_management_text_label, 0, LV_STATE_DEFAULT); /* 设置圆角 */
    lv_obj_set_style_bg_opa(label_file_management_text_label, LV_OPA_COVER, LV_PART_MAIN);
    lv_obj_set_style_bg_color(label_file_management_text_label, lv_color_hex(0xffffff), LV_PART_MAIN);
    lv_obj_add_event_cb(btn_file_management_text, btn_modification_text_event_cb, LV_EVENT_CLICKED, NULL);


    LV_IMG_DECLARE(typeface);
    img_file_management_typeface = lv_img_create(lv_scr_act());
    lv_img_set_src(img_file_management_typeface, &typeface);
    lv_obj_align(img_file_management_typeface, LV_ALIGN_TOP_LEFT, 10, 162);

    LV_FONT_DECLARE(heiFont16_1);
    label_file_management_typeface = lv_label_create(lv_scr_act());
    lv_obj_set_style_text_font(label_file_management_typeface, &heiFont16_1, LV_STATE_DEFAULT);
    lv_obj_set_style_text_color(label_file_management_typeface, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
    if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
    {
        lv_label_set_text(label_file_management_typeface,  "字体");
    }
    else if(system_data.system.language == LANGUAGE_ENGLISH)
    {
        lv_label_set_text(label_file_management_typeface, "Typeface");
    }
    lv_obj_align(label_file_management_typeface, LV_ALIGN_TOP_LEFT, 45, 167);


    LV_FONT_DECLARE(heiFont16_1);
    btn_file_management_typeface = lv_btn_create(lv_scr_act());
    lv_obj_set_size(btn_file_management_typeface, 125, 24);
    lv_obj_align(btn_file_management_typeface, LV_ALIGN_TOP_LEFT, 95, 164);
    lv_obj_set_style_border_width(btn_file_management_typeface, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
    lv_obj_set_style_radius(btn_file_management_typeface, 0, LV_STATE_DEFAULT); /* 设置圆角 */
    lv_obj_set_style_bg_color(btn_file_management_typeface, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
    label_file_management_typeface_label = lv_label_create(btn_file_management_typeface);
    lv_obj_set_style_text_font(label_file_management_typeface_label, &heiFont16_1, LV_STATE_DEFAULT);
    lv_obj_set_style_text_color(label_file_management_typeface_label, lv_color_hex(0x1C1C1C), LV_STATE_DEFAULT);
    lv_label_set_text(label_file_management_typeface_label, typeface_name[data_structure[g_modification_id].data.word.typeface]);
    lv_obj_align(label_file_management_typeface_label, LV_ALIGN_CENTER, 0, 0);
    lv_obj_set_style_border_width(label_file_management_typeface_label, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
    lv_obj_set_style_border_color(label_file_management_typeface_label, lv_color_hex(0x8a8a8a), LV_STATE_DEFAULT); /* 设置边框颜色 */
    lv_obj_set_style_border_opa(label_file_management_typeface_label, 100, LV_STATE_DEFAULT); /* 设置边框透明度 */
    lv_obj_set_style_radius(label_file_management_typeface_label, 0, LV_STATE_DEFAULT); /* 设置圆角 */
    lv_obj_set_style_bg_opa(label_file_management_typeface_label, LV_OPA_COVER, LV_PART_MAIN);
    lv_obj_set_style_bg_color(label_file_management_typeface_label, lv_color_hex(0xffffff), LV_PART_MAIN);
    lv_obj_add_event_cb(btn_file_management_typeface, btn_file_management_typeface_event_cb, LV_EVENT_CLICKED, NULL);


    LV_IMG_DECLARE(word_space);
    img_file_management_word_space = lv_img_create(lv_scr_act());
    lv_img_set_src(img_file_management_word_space, &word_space);
    lv_obj_align(img_file_management_word_space, LV_ALIGN_TOP_LEFT, 250, 134);

    LV_FONT_DECLARE(heiFont16_1);
    label_file_management_word_space = lv_label_create(lv_scr_act());
    lv_obj_set_style_text_font(label_file_management_word_space, &heiFont16_1, LV_STATE_DEFAULT);
    lv_obj_set_style_text_color(label_file_management_word_space, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
    if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
    {
        lv_label_set_text(label_file_management_word_space,  "间隔");
    }
    else if(system_data.system.language == LANGUAGE_ENGLISH)
    {
        lv_label_set_text(label_file_management_word_space, "Space");
    }
    lv_obj_align(label_file_management_word_space, LV_ALIGN_TOP_LEFT, 285, 139);


    LV_FONT_DECLARE(heiFont16_1);
    btn_file_management_word_space_label = lv_btn_create(lv_scr_act());
    lv_obj_set_size(btn_file_management_word_space_label, 125, 24);
    lv_obj_align(btn_file_management_word_space_label, LV_ALIGN_TOP_LEFT, 338, 136);
    lv_obj_set_style_border_width(btn_file_management_word_space_label, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
    lv_obj_set_style_radius(btn_file_management_word_space_label, 0, LV_STATE_DEFAULT); /* 设置圆角 */
    lv_obj_set_style_bg_color(btn_file_management_word_space_label, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
    label_file_management_word_space_label = lv_label_create(btn_file_management_word_space_label);
    lv_obj_set_style_text_font(label_file_management_word_space_label, &heiFont16_1, LV_STATE_DEFAULT);
    lv_obj_set_style_text_color(label_file_management_word_space_label, lv_color_hex(0x1C1C1C), LV_STATE_DEFAULT);
    sprintf(tempBuf,"%d",data_structure[g_modification_id].data.word.space);
    lv_label_set_text(label_file_management_word_space_label, tempBuf);
    lv_obj_align(label_file_management_word_space_label, LV_ALIGN_CENTER, 0, 0);
    lv_obj_set_style_border_width(label_file_management_word_space_label, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
    lv_obj_set_style_border_color(label_file_management_word_space_label, lv_color_hex(0x8a8a8a), LV_STATE_DEFAULT); /* 设置边框颜色 */
    lv_obj_set_style_border_opa(label_file_management_word_space_label, 100, LV_STATE_DEFAULT); /* 设置边框透明度 */
    lv_obj_set_style_radius(label_file_management_word_space_label, 0, LV_STATE_DEFAULT); /* 设置圆角 */
    lv_obj_set_style_bg_opa(label_file_management_word_space_label, LV_OPA_COVER, LV_PART_MAIN);
    lv_obj_set_style_bg_color(label_file_management_word_space_label, lv_color_hex(0xffffff), LV_PART_MAIN);
    lv_obj_add_event_cb(btn_file_management_word_space_label, btn_file_management_word_space_event_cb, LV_EVENT_CLICKED, NULL);


    LV_IMG_DECLARE(word_size);
    img_file_management_word_size = lv_img_create(lv_scr_act());
    lv_img_set_src(img_file_management_word_size, &word_size);
    lv_obj_align(img_file_management_word_size, LV_ALIGN_TOP_LEFT, 10, 190);

    LV_FONT_DECLARE(heiFont16_1);
    label_file_management_word_size = lv_label_create(lv_scr_act());
    lv_obj_set_style_text_font(label_file_management_word_size, &heiFont16_1, LV_STATE_DEFAULT);
    lv_obj_set_style_text_color(label_file_management_word_size, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
    if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
    {
        lv_label_set_text(label_file_management_word_size,  "字号");
    }
    else if(system_data.system.language == LANGUAGE_ENGLISH)
    {
        lv_label_set_text(label_file_management_word_size, "Size");
    }
    lv_obj_align(label_file_management_word_size, LV_ALIGN_TOP_LEFT, 45, 195);


    LV_FONT_DECLARE(heiFont16_1);
    btn_file_management_word_size_label = lv_btn_create(lv_scr_act());
    lv_obj_set_size(btn_file_management_word_size_label, 125, 24);
    lv_obj_align(btn_file_management_word_size_label, LV_ALIGN_TOP_LEFT, 95, 192);
    lv_obj_set_style_border_width(btn_file_management_word_size_label, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
    lv_obj_set_style_radius(btn_file_management_word_size_label, 0, LV_STATE_DEFAULT); /* 设置圆角 */
    lv_obj_set_style_bg_color(btn_file_management_word_size_label, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
    label_file_management_word_size_label = lv_label_create(btn_file_management_word_size_label);
    lv_obj_set_style_text_font(label_file_management_word_size_label, &heiFont16_1, LV_STATE_DEFAULT);
    lv_obj_set_style_text_color(label_file_management_word_size_label, lv_color_hex(0x1C1C1C), LV_STATE_DEFAULT);
    sprintf(tempBuf,"%d",data_structure[g_modification_id].data.word.size);
    lv_label_set_text(label_file_management_word_size_label, tempBuf);
    lv_obj_align(label_file_management_word_size_label, LV_ALIGN_CENTER, 0, 0);
    lv_obj_set_style_border_width(label_file_management_word_size_label, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
    lv_obj_set_style_border_color(label_file_management_word_size_label, lv_color_hex(0x8a8a8a), LV_STATE_DEFAULT); /* 设置边框颜色 */
    lv_obj_set_style_border_opa(label_file_management_word_size_label, 100, LV_STATE_DEFAULT); /* 设置边框透明度 */
    lv_obj_set_style_radius(label_file_management_word_size_label, 0, LV_STATE_DEFAULT); /* 设置圆角 */
    lv_obj_set_style_bg_opa(label_file_management_word_size_label, LV_OPA_COVER, LV_PART_MAIN);
    lv_obj_set_style_bg_color(label_file_management_word_size_label, lv_color_hex(0xffffff), LV_PART_MAIN);
    lv_obj_add_event_cb(btn_file_management_word_size_label, btn_file_management_word_size_event_cb, LV_EVENT_CLICKED, NULL);

    LV_IMG_DECLARE(spin);
    img_file_management_spin = lv_img_create(lv_scr_act());
    lv_img_set_src(img_file_management_spin, &spin);
    //lv_obj_align(img_file_management_spin, LV_ALIGN_TOP_LEFT, 250, 190);
    lv_obj_align(img_file_management_spin, LV_ALIGN_TOP_LEFT, 250, 162);

    LV_FONT_DECLARE(heiFont16_1);
    label_file_management_spin = lv_label_create(lv_scr_act());
    lv_obj_set_style_text_font(label_file_management_spin, &heiFont16_1, LV_STATE_DEFAULT);
    lv_obj_set_style_text_color(label_file_management_spin, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
    if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
    {
        lv_label_set_text(label_file_management_spin,  "旋转");
    }
    else if(system_data.system.language == LANGUAGE_ENGLISH)
    {
        lv_label_set_text(label_file_management_spin, "Spin");
    }
    lv_obj_align(label_file_management_spin, LV_ALIGN_TOP_LEFT, 285, 167);


    LV_FONT_DECLARE(heiFont16_1);
    btn_addition_text_spin = lv_btn_create(lv_scr_act());
    lv_obj_set_size(btn_addition_text_spin, 125, 24);
    lv_obj_align(btn_addition_text_spin, LV_ALIGN_TOP_LEFT, 338, 164);
    lv_obj_set_style_border_width(btn_addition_text_spin, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
    lv_obj_set_style_radius(btn_addition_text_spin, 0, LV_STATE_DEFAULT); /* 设置圆角 */
    lv_obj_set_style_bg_color(btn_addition_text_spin, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
    label_btn_addition_text_spin = lv_label_create(btn_addition_text_spin);
    lv_obj_set_style_text_font(label_btn_addition_text_spin, &heiFont16_1, LV_STATE_DEFAULT);
    lv_obj_set_style_text_color(label_btn_addition_text_spin, lv_color_hex(0x1C1C1C), LV_STATE_DEFAULT);
    sprintf(tempBuf,"%d",data_structure[g_modification_id].data.word.spin);
    lv_label_set_text(label_btn_addition_text_spin, tempBuf);
    lv_obj_align(label_btn_addition_text_spin, LV_ALIGN_CENTER, 0, 0);
    lv_obj_set_style_border_width(label_btn_addition_text_spin, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
    lv_obj_set_style_border_color(label_btn_addition_text_spin, lv_color_hex(0x8a8a8a), LV_STATE_DEFAULT); /* 设置边框颜色 */
    lv_obj_set_style_border_opa(label_btn_addition_text_spin, 100, LV_STATE_DEFAULT); /* 设置边框透明度 */
    lv_obj_set_style_radius(label_btn_addition_text_spin, 0, LV_STATE_DEFAULT); /* 设置圆角 */
    lv_obj_set_style_bg_opa(label_btn_addition_text_spin, LV_OPA_COVER, LV_PART_MAIN);
    lv_obj_set_style_bg_color(label_btn_addition_text_spin, lv_color_hex(0xffffff), LV_PART_MAIN);
    lv_obj_add_event_cb(btn_addition_text_spin, btn_addition_text_spin_event_cb, LV_EVENT_CLICKED, NULL);


    LV_IMG_DECLARE(bold);
    img_file_management_bold = lv_img_create(lv_scr_act());
    lv_img_set_src(img_file_management_bold, &bold);
    lv_obj_align(img_file_management_bold, LV_ALIGN_TOP_LEFT, 250, 218);

    LV_FONT_DECLARE(heiFont16_1);
    label_file_management_bold = lv_label_create(lv_scr_act());
    lv_obj_set_style_text_font(label_file_management_bold, &heiFont16_1, LV_STATE_DEFAULT);
    lv_obj_set_style_text_color(label_file_management_bold, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
    if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
    {
        lv_label_set_text(label_file_management_bold,  "粗体");
    }
    else if(system_data.system.language == LANGUAGE_ENGLISH)
    {
        lv_label_set_text(label_file_management_bold, "Bold");
    }
    lv_obj_align(label_file_management_bold, LV_ALIGN_TOP_LEFT, 285, 223);

    sw_file_management_bold = lv_switch_create(lv_scr_act());
    lv_obj_set_pos(sw_file_management_bold, 343, 220);
    lv_obj_set_width(sw_file_management_bold, 48);
    lv_obj_set_height(sw_file_management_bold, 23);
    lv_obj_set_style_bg_color(sw_file_management_bold, lv_color_hex(0x00ff00), LV_STATE_CHECKED | LV_PART_INDICATOR);
    lv_obj_add_event_cb(sw_file_management_bold, sw_addition_bold_event_cb, LV_EVENT_CLICKED, NULL);

    if ((data_structure[g_modification_id].data.word.italic_bold & FT_FONT_STYLE_BOLD) == FT_FONT_STYLE_BOLD)
    {
        lv_obj_add_state(sw_file_management_bold, LV_STATE_CHECKED);
    }
    else
    {
        lv_obj_clear_state(sw_file_management_bold, LV_STATE_CHECKED);
    }

    LV_IMG_DECLARE(italic);
    img_management_line_italic = lv_img_create(lv_scr_act());
    lv_img_set_src(img_management_line_italic, &italic);
    lv_obj_align(img_management_line_italic, LV_ALIGN_TOP_LEFT, 10, 218);

    LV_FONT_DECLARE(heiFont16_1);
    label_management_line_italic = lv_label_create(lv_scr_act());
    lv_obj_set_style_text_font(label_management_line_italic, &heiFont16_1, LV_STATE_DEFAULT);
    lv_obj_set_style_text_color(label_management_line_italic, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
    if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
    {
        lv_label_set_text(label_management_line_italic,  "斜体");
    }
    else if(system_data.system.language == LANGUAGE_ENGLISH)
    {
        lv_label_set_text(label_management_line_italic, "Italic");
    }
    lv_obj_align(label_management_line_italic, LV_ALIGN_TOP_LEFT, 45, 223);

    sw_management_line_italic = lv_switch_create(lv_scr_act());
    lv_obj_set_pos(sw_management_line_italic, 95, 220);
    lv_obj_set_width(sw_management_line_italic, 48);
    lv_obj_set_height(sw_management_line_italic, 23);
    lv_obj_set_style_bg_color(sw_management_line_italic, lv_color_hex(0x00ff00), LV_STATE_CHECKED | LV_PART_INDICATOR);
    lv_obj_add_event_cb(sw_management_line_italic, sw_addition_bold_event_cb, LV_EVENT_CLICKED, NULL);

    if ((data_structure[g_modification_id].data.word.italic_bold & FT_FONT_STYLE_ITALIC) == FT_FONT_STYLE_ITALIC)
    {
        lv_obj_add_state(sw_management_line_italic, LV_STATE_CHECKED);
    }
    else
    {
        lv_obj_clear_state(sw_management_line_italic, LV_STATE_CHECKED);
    }


    file_management_bottom_bg = lv_obj_create(lv_scr_act());
    lv_obj_set_size(file_management_bottom_bg, 480, 24);
    lv_obj_align(file_management_bottom_bg, LV_ALIGN_TOP_LEFT, 0, 248);
    lv_obj_set_style_border_width(file_management_bottom_bg, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
    lv_obj_set_style_radius(file_management_bottom_bg, 0, LV_STATE_DEFAULT); /* 设置圆角 */
    lv_obj_set_style_bg_color(file_management_bottom_bg, lv_color_hex(0x28536a), LV_STATE_DEFAULT);
    lv_obj_remove_style(file_management_bottom_bg, 0, LV_PART_SCROLLBAR);


    LV_IMG_DECLARE(get_back);
    imgbtn_file_management_get_back = lv_imgbtn_create(lv_scr_act());
    lv_imgbtn_set_src(imgbtn_file_management_get_back, LV_IMGBTN_STATE_RELEASED, NULL, &get_back, NULL);
    lv_obj_set_size(imgbtn_file_management_get_back, get_back.header.w, get_back.header.h);
    lv_obj_align(imgbtn_file_management_get_back, LV_ALIGN_TOP_LEFT, 180, 250);
    lv_obj_add_event_cb(imgbtn_file_management_get_back, modification_text_return_event_cb, LV_EVENT_CLICKED, NULL);


    LV_FONT_DECLARE(heiFont16_1);
    label_file_management_return = lv_label_create(lv_scr_act());
    lv_obj_set_style_text_font(label_file_management_return, &heiFont16_1, LV_STATE_DEFAULT);
    lv_obj_set_style_text_color(label_file_management_return, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
    if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
    {
        lv_label_set_text(label_file_management_return,  "返回");
    }
    else if(system_data.system.language == LANGUAGE_ENGLISH)
    {
        lv_label_set_text(label_file_management_return, "Return");
    }
    lv_obj_align(label_file_management_return, LV_ALIGN_TOP_LEFT, 140, 252);

    LV_IMG_DECLARE(confirm);
    imgbtn_file_management_confirm = lv_imgbtn_create(lv_scr_act());
    lv_imgbtn_set_src(imgbtn_file_management_confirm, LV_IMGBTN_STATE_RELEASED, NULL, &confirm, NULL);
    lv_obj_set_size(imgbtn_file_management_confirm, confirm.header.w, confirm.header.h);
    lv_obj_align(imgbtn_file_management_confirm, LV_ALIGN_TOP_LEFT, 250, 250);
    lv_obj_add_event_cb(imgbtn_file_management_confirm, modification_text_confirm_event_cb, LV_EVENT_CLICKED, NULL);

    LV_FONT_DECLARE(heiFont16_1);
    label_file_management_confirm = lv_label_create(lv_scr_act());
    lv_obj_set_style_text_font(label_file_management_confirm, &heiFont16_1, LV_STATE_DEFAULT);
    lv_obj_set_style_text_color(label_file_management_confirm, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
    if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
    {
        lv_label_set_text(label_file_management_confirm,  "确定");
    }
    else if(system_data.system.language == LANGUAGE_ENGLISH)
    {
        lv_label_set_text(label_file_management_confirm, "Confirm");
    }
    lv_obj_align(label_file_management_confirm, LV_ALIGN_TOP_LEFT, 277, 252);   
}



static void btn_modification_QR_code_return_event_cb(lv_event_t* e)
{
    lv_event_code_t code;
    code = lv_event_get_code(e);
    if (code == LV_EVENT_CLICKED)
    {
        printf("btn_modification_QR_code_return_event_cb\n");
        buzzer_enable = 1;
        lv_obj_del(btn_addition_QR_code_confirm);
        lv_obj_del(label_addition_QR_code_confirm);
        lv_obj_del(btn_addition_QR_code_return);
        lv_obj_del(label_addition_QR_code_return);
        lv_obj_del(obj_addition_QR_code_bottom_bg);
        lv_obj_del(sw_addition_QR_code_border);
        lv_obj_del(label_addition_QR_code_border);
        lv_obj_del(img_addition_QR_code_border);
        lv_obj_del(label_btn_addition_QR_code_width);
        lv_obj_del(btn_addition_QR_code_width);
        lv_obj_del(label_addition_QR_code_width);
        lv_obj_del(img_addition_QR_code_width);
        lv_obj_del(label_btn_addition_QR_code_bar_code);
        lv_obj_del(btn_addition_QR_code_bar_code);
        lv_obj_del(label_addition_QR_code_bar_code);
        lv_obj_del(img_addition_QR_code_bar_code);
        lv_obj_del(sw_addition_QR_code_figure);
        lv_obj_del(label_addition_QR_code_figure);
        lv_obj_del(img_addition_QR_code_figure);
        lv_obj_del(label_btn_addition_QR_code_height);
        lv_obj_del(btn_addition_QR_code_height);
        lv_obj_del(label_addition_QR_code_height);
        lv_obj_del(img_addition_QR_code_height);
        lv_obj_del(label_btn_addition_QR_code_QR);
        lv_obj_del(btn_addition_QR_code_QR);
        lv_obj_del(label_addition_QR_code_QR);
        lv_obj_del(img_addition_QR_code);
        lv_obj_del(label_btn_addition_QR_code_text);
        lv_obj_del(btn_addition_QR_code_text);
        lv_obj_del(label_addition_QR_code_text);
        lv_obj_del(img_addition_QR_code_text);
        lv_obj_del(addition_QR_code_middle_bg_1);
        lv_obj_del(addition_QR_code_middle_bg);
        lv_obj_del(label_addition_QR_code_head);
        lv_obj_del(addition_QR_code_head_bg);
    }
}




static void btn_modification_QR_code_confirm_event_cb(lv_event_t* e)
{
    lv_event_code_t code;
    int win_content_child_num = 0;
    struct zint_symbol* my_symbol = NULL;
    int str_len;
    //int width_len;
    int height_len;
    int width, height, channels;
    unsigned char* pdata = NULL; 
    unsigned char* pnew_data = NULL;
    lv_obj_t* img = NULL;
    char bmp_name[100] = {0};
    char bmp_name_1[128] = {0};
    unsigned char *data = NULL;
    int success;
    lv_img_header_t header;
    lv_res_t res;

    code = lv_event_get_code(e);
    if (code == LV_EVENT_CLICKED)
    {
        printf("btn_modification_QR_code_confirm_event_cb\n\r");
        buzzer_enable = 1;
        //在主界面显示二维码
        str_len = strlen(lv_label_get_text(label_btn_addition_QR_code_text));
        printf("str_len=%u\n\r", str_len);

        if(str_len > 0) 
        {
            lv_obj_t* temp_obj = lv_obj_get_child(win_content,g_modification_id);

            win_content_child_num = g_modification_id;

            //lv_obj_set_style_bg_opa(temp_obj, LV_OPA_TRANSP, 0);
            //lv_obj_set_style_border_width(temp_obj, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */

            //lv_obj_add_event_cb(temp_obj, drag_event_handler, LV_EVENT_PRESSING, NULL);
            //lv_obj_add_event_cb(temp_obj, drag_event_handler, LV_EVENT_FOCUSED, NULL);
            //lv_obj_add_event_cb(temp_obj, drag_event_handler, LV_EVENT_DEFOCUSED, NULL);
            //lv_obj_clear_flag(temp_obj, LV_OBJ_FLAG_SCROLLABLE);

            printf("QR_or_bar_code_flag=%u\n\r",QR_or_bar_code_flag);
            printf("QR_code_type=%u\n\r",QR_code_type);
            printf("bar_code_type=%u\n\r",bar_code_type);

            memcpy(data_structure[win_content_child_num].data.qr_bar.text,lv_label_get_text(label_btn_addition_QR_code_text),strlen(lv_label_get_text(label_btn_addition_QR_code_text))+ 1);
    
            if (QR_or_bar_code_flag == 0)
            {
                my_symbol = ZBarcode_Create();

                data_structure[win_content_child_num].data.qr_bar.type = QR_or_bar_code_flag;
                data_structure[win_content_child_num].data.qr_bar.symbology = QR_code_type;
                data_structure[win_content_child_num].type = TYPE_QR;

                switch (QR_code_type)
                {
                    case 0:
                    default:

                        height_len = atoi(lv_label_get_text(label_btn_addition_QR_code_height));

                        if (height_len > QR_BAR_MAX_HIGHT)
                        {
                            height_len = QR_BAR_MAX_HIGHT;
                        }
                        else if (height_len < QR_BAR_MIN_HIGHT)
                        {
                            height_len = QR_BAR_MIN_HIGHT;
                        }

                        printf("height_len=%u\n\r",height_len);

                        data_structure[win_content_child_num].data.qr_bar.height = height_len;

                        my_symbol->symbology = BARCODE_QRCODE;
                        my_symbol->scale = 1;
                        my_symbol->option_1 = 2; //容错级别

                        if(str_len < 20)
                        {
                            my_symbol->option_2 = 1;
                        }
                        else if(str_len < 38)
                        {
                            my_symbol->option_2 = 2;
                        }
                        else if(str_len < 61)
                        {
                            my_symbol->option_2 = 3;
                        }
                        else if(str_len < 90)
                        {
                            my_symbol->option_2 = 4;
                        }
                        else if(str_len < 122)
                        {
                            my_symbol->option_2 = 5;
                        }

                        memcpy(data_structure[win_content_child_num].data.qr_bar.text,lv_label_get_text(label_btn_addition_QR_code_text),str_len);

                        //figure_borders = 0;
#if 0
                        if(lv_obj_has_state(sw_addition_QR_code_figure, LV_STATE_CHECKED) == 1)
                        {
                            my_symbol->show_hrt = 1;
                            memcpy(my_symbol->text,lv_label_get_text(label_btn_addition_QR_code_text),strlen(lv_label_get_text(label_btn_addition_QR_code_text))+ 1);
                            //figure_borders |= 0x01;
                            data_structure[win_content_child_num].data.qr_bar.figure = 1;
                        }
#endif

                        if (lv_obj_has_state(sw_addition_QR_code_border, LV_STATE_CHECKED) == 1)
                        {
                            my_symbol->output_options = BARCODE_BOX;
                            my_symbol->whitespace_width = 3;
                            my_symbol-> whitespace_height = 3; 
                            my_symbol-> border_width = 2;   /* Size of border in X-dimensions */
                            //figure_borders |= 0x02;
                            data_structure[win_content_child_num].data.qr_bar.borders = 1;
                        }

                        strcpy(my_symbol->outfile, "out.bmp");
                        ZBarcode_Encode(my_symbol, (unsigned char *)lv_label_get_text(label_btn_addition_QR_code_text), 0);

                        ZBarcode_Print(my_symbol, 0);
                        //ZBarcode_Delete(my_symbol);

                        pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                        printf("width=%d\n\r", width);
                        printf("height=%d\n\r", height);
                        printf("channels=%d\n\r", channels);
            
                        my_symbol->scale = (float)((float)150.0*(float)height_len/(float)QR_BAR_MAX_HIGHT/(float)width);
                         //  my_symbol->scale = (float)height_len/(float)height;
                        printf("scale=%f\n\r",(double)my_symbol->scale);
   
                        strcpy(my_symbol->outfile, "out.bmp");
                        ZBarcode_Encode(my_symbol, (unsigned char *)lv_label_get_text(label_btn_addition_QR_code_text), 0);

                        ZBarcode_Print(my_symbol, 0);
                        ZBarcode_Delete(my_symbol);
                        stbi_image_free(pdata);
                
                        pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                        printf("width=%d\n\r", width);
                        printf("height=%d\n\r", height);
                        printf("channels=%d\n\r", channels);

                        lv_obj_set_size(temp_obj, width, height);

                        pnew_data = (unsigned char*)lv_mem_alloc(width * height * 4); // 为32位数据分配内存
                        if (!pnew_data) 
                        {
                            fprintf(stderr, "Memory allocation failed\n");
                            stbi_image_free(pdata);
                            return;
                        }
                        else
                        {
                            printf("lv_mem_alloc ok\n\r");
                        }

                        for (int y = 0; y < height; y++) 
                        {
                            for (int x = 0; x < width; x++) 
                            {
                                int index = y * width + x; // 计算当前像素在原始数据中的索引
                                unsigned char color = pdata[index]; // 获取当前像素的灰度值（0或255）
                                // 映射到RGBA值

                                if (color == 0)
                                {
                                    pnew_data[index * 4 + 0] = 0; // R
                                    pnew_data[index * 4 + 1] = 0; // G
                                    pnew_data[index * 4 + 2] = 0; // B
                                    pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                                }
                                else
                                {
                                    pnew_data[index * 4 + 0] = 255; // R
                                    pnew_data[index * 4 + 1] = 255; // G
                                    pnew_data[index * 4 + 2] = 255; // B
                                    pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                                }
                            }
                        }
                        sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.bmp",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                        stbi_write_bmp(bmp_name, width, height, 4, pnew_data);
                        // 使用data进行图像处理...
                        lv_mem_free(pnew_data);
                        stbi_image_free(pdata); // 释放内存

                        lv_obj_del(lv_obj_get_child(temp_obj,0));

                        data = stbi_load(bmp_name, &width, &height, &channels, 0);
                        if (!data) 
                        {
                            printf("错误：无法加载图片 %s\n", bmp_name);
                        }
                        printf("图片加载成功：%dx%d，%d 通道\n", width, height, channels);

                        sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.png",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                        
                        success = stbi_write_png(bmp_name, width, height, channels, data, width * channels);
                        if (!success) 
                        {
                            printf("错误：保存 PNG 失败\n");
                        } 
                        else
                        {
                            printf("PNG 保存成功：%s\n", bmp_name);
                        }

                        // 释放内存
                        stbi_image_free(data);

                        //显示图像
                        img = lv_img_create(temp_obj);
                        sprintf(bmp_name_1,"A:%s",bmp_name);
                        lv_img_set_src(img, bmp_name_1);
                        lv_obj_center(img);

                        res = lv_img_decoder_get_info(bmp_name_1, &header);  // 直接传入文件路径

                        if (res == LV_RES_OK)
                        {
                            printf("PNG: %dx%d\n", header.w, header.h);
                        }
                        else
                        {
                            printf("lv_img_decoder_get_info error\n");
                        }

                        lv_img_set_zoom(img,data_structure[win_content_child_num].data.qr_bar.size);

                        width = header.w * data_structure[win_content_child_num].data.qr_bar.size / 256;
                        height = header.h * data_structure[win_content_child_num].data.qr_bar.size / 256;

                        lv_obj_set_size(temp_obj, width, height);

                        lv_obj_align(temp_obj, LV_ALIGN_OUT_TOP_LEFT, data_structure[win_content_child_num].x, data_structure[win_content_child_num].y);

                        break;
                    case 1:
                      
#if 0
                        width_len = atoi(lv_label_get_text(label_btn_addition_QR_code_width));

                        if (width_len > 100)
                        {
                            width_len = 100;
                        }
                        else if (width_len < 50)
                        {
                            width_len = 50;
                        }

                        printf("width_len=%u\n\r",width_len);

                        data_structure[win_content_child_num].data.qr_bar.width = width_len;
#endif
                        my_symbol->symbology = BARCODE_PDF417;

                        height_len = atoi(lv_label_get_text(label_btn_addition_QR_code_height));

                        if (height_len > QR_BAR_MAX_HIGHT)
                        {
                            height_len = QR_BAR_MAX_HIGHT;
                        }
                        else if (height_len < QR_BAR_MIN_HIGHT)
                        {
                            height_len = QR_BAR_MIN_HIGHT;
                        }

                        printf("height_len=%u\n\r",height_len);

                        data_structure[win_content_child_num].data.qr_bar.height = height_len;

                        my_symbol->scale = 1;

                        memcpy(data_structure[win_content_child_num].data.qr_bar.text,lv_label_get_text(label_btn_addition_QR_code_text),str_len);
#if 0
                        if(lv_obj_has_state(sw_addition_QR_code_figure, LV_STATE_CHECKED) == 1)
                        {
                            my_symbol->show_hrt = 1;
                            memcpy(my_symbol->text,lv_label_get_text(label_btn_addition_QR_code_text),strlen(lv_label_get_text(label_btn_addition_QR_code_text))+ 1);
                            //figure_borders |= 0x01;
                            data_structure[win_content_child_num].data.qr_bar.figure = 1;
                        }
#endif
                        if (lv_obj_has_state(sw_addition_QR_code_border, LV_STATE_CHECKED) == 1)
                        {
                            my_symbol->output_options = BARCODE_BOX;
                            my_symbol->whitespace_width = 3;
                            my_symbol-> whitespace_height = 3; 
                            my_symbol-> border_width = 2;   /* Size of border in X-dimensions */
                            //figure_borders |= 0x02;
                            data_structure[win_content_child_num].data.qr_bar.borders = 1;
                        }

                        strcpy(my_symbol->outfile, "out.bmp");
                        ZBarcode_Encode(my_symbol, (unsigned char *)lv_label_get_text(label_btn_addition_QR_code_text), 0);

                        ZBarcode_Print(my_symbol, 0);
                        //ZBarcode_Delete(my_symbol);

            
                        pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                        printf("width=%d\n\r", width);
                        printf("height=%d\n\r", height);
                        printf("channels=%d\n\r", channels);
            
                        my_symbol->scale = (float)((float)150.0*(float)height_len/(float)QR_BAR_MAX_HIGHT/(float)height);
                         //  my_symbol->scale = (float)height_len/(float)height;
                        printf("scale=%f\n\r", (double)my_symbol->scale);
   
                        strcpy(my_symbol->outfile, "out.bmp");
                        ZBarcode_Encode(my_symbol, (unsigned char *)lv_label_get_text(label_btn_addition_QR_code_text), 0);

                        ZBarcode_Print(my_symbol, 0);
                        ZBarcode_Delete(my_symbol);
                        stbi_image_free(pdata);
                
                        pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                        printf("width=%d\n\r", width);
                        printf("height=%d\n\r", height);
                        printf("channels=%d\n\r", channels);

                        lv_obj_set_size(temp_obj, width, height);

                        pnew_data = (unsigned char*)lv_mem_alloc(width * height * 4); // 为32位数据分配内存
                        if (!pnew_data) 
                        {
                            fprintf(stderr, "Memory allocation failed\n");
                            stbi_image_free(pdata);
                            return;
                        }
                        else
                        {
                            printf("lv_mem_alloc ok\n\r");
                        }

                        for (int y = 0; y < height; y++) 
                        {
                            for (int x = 0; x < width; x++) 
                            {
                                int index = y * width + x; // 计算当前像素在原始数据中的索引
                                unsigned char color = pdata[index]; // 获取当前像素的灰度值（0或255）
                                // 映射到RGBA值

                                if (color == 0)
                                {
                                    pnew_data[index * 4 + 0] = 0; // R
                                    pnew_data[index * 4 + 1] = 0; // G
                                    pnew_data[index * 4 + 2] = 0; // B
                                    pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                                }
                                else
                                {
                                    pnew_data[index * 4 + 0] = 255; // R
                                    pnew_data[index * 4 + 1] = 255; // G
                                    pnew_data[index * 4 + 2] = 255; // B
                                    pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                                }
                            }
                        }

                        sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.bmp",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                        stbi_write_bmp(bmp_name, width, height, 4, pnew_data);
                        // 使用data进行图像处理...
                        lv_mem_free(pnew_data);
                        stbi_image_free(pdata); // 释放内存


                        lv_obj_del(lv_obj_get_child(temp_obj,0));

                        data = stbi_load(bmp_name, &width, &height, &channels, 0);
                        if (!data) 
                        {
                            printf("错误：无法加载图片 %s\n", bmp_name);
                        }
                        printf("图片加载成功：%dx%d，%d 通道\n", width, height, channels);

                        sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.png",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                        
                        success = stbi_write_png(bmp_name, width, height, channels, data, width * channels);
                        if (!success) 
                        {
                            printf("错误：保存 PNG 失败\n");
                        } 
                        else
                        {
                            printf("PNG 保存成功：%s\n", bmp_name);
                        }

                        // 释放内存
                        stbi_image_free(data);

                        //显示图像
                        img = lv_img_create(temp_obj);
                        sprintf(bmp_name_1,"A:%s",bmp_name);
                        lv_img_set_src(img, bmp_name_1);
                        lv_obj_center(img);

                        res = lv_img_decoder_get_info(bmp_name_1, &header);  // 直接传入文件路径

                        if (res == LV_RES_OK)
                        {
                            printf("PNG: %dx%d\n", header.w, header.h);
                        }
                        else
                        {
                            printf("lv_img_decoder_get_info error\n");
                        }

                        lv_img_set_zoom(img,data_structure[win_content_child_num].data.qr_bar.size);

                        width = header.w * data_structure[win_content_child_num].data.qr_bar.size / 256;
                        height = header.h * data_structure[win_content_child_num].data.qr_bar.size / 256;

                        lv_obj_set_size(temp_obj, width, height);

                        lv_obj_align(temp_obj, LV_ALIGN_OUT_TOP_LEFT, data_structure[win_content_child_num].x, data_structure[win_content_child_num].y);

                        break;
                    case 2:
                        my_symbol->symbology = BARCODE_DATAMATRIX;

                        height_len = atoi(lv_label_get_text(label_btn_addition_QR_code_height));

                        if (height_len > QR_BAR_MAX_HIGHT)
                        {
                            height_len = QR_BAR_MAX_HIGHT;
                        }
                        else if (height_len < QR_BAR_MIN_HIGHT)
                        {
                            height_len = QR_BAR_MIN_HIGHT;
                        }

                        printf("height_len=%u\n\r",height_len);

                        data_structure[win_content_child_num].data.qr_bar.height = height_len;

                        my_symbol->scale = 1;

                        memcpy(data_structure[win_content_child_num].data.qr_bar.text,lv_label_get_text(label_btn_addition_QR_code_text),str_len);
#if 0
                        if(lv_obj_has_state(sw_addition_QR_code_figure, LV_STATE_CHECKED) == 1)
                        {
                            my_symbol->show_hrt = 1;
                            memcpy(my_symbol->text,lv_label_get_text(label_btn_addition_QR_code_text),strlen(lv_label_get_text(label_btn_addition_QR_code_text))+ 1);
                            //figure_borders |= 0x01;
                            data_structure[win_content_child_num].data.qr_bar.figure = 1;
                        }
#endif
                        if (lv_obj_has_state(sw_addition_QR_code_border, LV_STATE_CHECKED) == 1)
                        {
                            my_symbol->output_options = BARCODE_BOX;
                            my_symbol->whitespace_width = 3;
                            my_symbol-> whitespace_height = 3; 
                            my_symbol-> border_width = 2;   /* Size of border in X-dimensions */
                            //figure_borders |= 0x02;
                            data_structure[win_content_child_num].data.qr_bar.borders = 1;
                        }

                        strcpy(my_symbol->outfile, "out.bmp");
                        ZBarcode_Encode(my_symbol, (unsigned char *)lv_label_get_text(label_btn_addition_QR_code_text), 0);

                        ZBarcode_Print(my_symbol, 0);
                        //ZBarcode_Delete(my_symbol);

                        pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                        printf("width=%d\n\r", width);
                        printf("height=%d\n\r", height);
                        printf("channels=%d\n\r", channels);
            
                        my_symbol->scale = (float)((float)150.0*(float)height_len/(float)QR_BAR_MAX_HIGHT/(float)height);
                         //  my_symbol->scale = (float)height_len/(float)height;
                        printf("scale=%f\n\r",(double)my_symbol->scale);
   
                        strcpy(my_symbol->outfile, "out.bmp");
                        ZBarcode_Encode(my_symbol, (unsigned char *)lv_label_get_text(label_btn_addition_QR_code_text), 0);

                        ZBarcode_Print(my_symbol, 0);
                        ZBarcode_Delete(my_symbol);
                        stbi_image_free(pdata);
                
                        pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                        printf("width=%d\n\r", width);
                        printf("height=%d\n\r", height);
                        printf("channels=%d\n\r", channels);

                        lv_obj_set_size(temp_obj, width, height);

                        pnew_data = (unsigned char*)lv_mem_alloc(width * height * 4); // 为32位数据分配内存
                        if (!pnew_data) 
                        {
                            fprintf(stderr, "Memory allocation failed\n");
                            stbi_image_free(pdata);
                            return;
                        }
                        else
                        {
                            printf("lv_mem_alloc ok\n\r");
                        }

                        for (int y = 0; y < height; y++) 
                        {
                            for (int x = 0; x < width; x++) 
                            {
                                int index = y * width + x; // 计算当前像素在原始数据中的索引
                                unsigned char color = pdata[index]; // 获取当前像素的灰度值（0或255）
                                // 映射到RGBA值

                                if (color == 0)
                                {
                                    pnew_data[index * 4 + 0] = 0; // R
                                    pnew_data[index * 4 + 1] = 0; // G
                                    pnew_data[index * 4 + 2] = 0; // B
                                    pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                                }
                                else
                                {
                                    pnew_data[index * 4 + 0] = 255; // R
                                    pnew_data[index * 4 + 1] = 255; // G
                                    pnew_data[index * 4 + 2] = 255; // B
                                    pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                                }
                            }
                        }

                        sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.bmp",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                        stbi_write_bmp(bmp_name, width, height, 4, pnew_data);
                        // 使用data进行图像处理...
                        lv_mem_free(pnew_data);
                        stbi_image_free(pdata); // 释放内存


                        lv_obj_del(lv_obj_get_child(temp_obj,0));

                        data = stbi_load(bmp_name, &width, &height, &channels, 0);
                        if (!data) 
                        {
                            printf("错误：无法加载图片 %s\n", bmp_name);
                        }
                        printf("图片加载成功：%dx%d，%d 通道\n", width, height, channels);

                        sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.png",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                        
                        success = stbi_write_png(bmp_name, width, height, channels, data, width * channels);
                        if (!success) 
                        {
                            printf("错误：保存 PNG 失败\n");
                        } 
                        else
                        {
                            printf("PNG 保存成功：%s\n", bmp_name);
                        }

                        // 释放内存
                        stbi_image_free(data);

                        //显示图像
                        img = lv_img_create(temp_obj);
                        sprintf(bmp_name_1,"A:%s",bmp_name);
                        lv_img_set_src(img, bmp_name_1);
                        lv_obj_center(img);

                        res = lv_img_decoder_get_info(bmp_name_1, &header);  // 直接传入文件路径

                        if (res == LV_RES_OK)
                        {
                            printf("PNG: %dx%d\n", header.w, header.h);
                        }
                        else
                        {
                            printf("lv_img_decoder_get_info error\n");
                        }

                        lv_img_set_zoom(img,data_structure[win_content_child_num].data.qr_bar.size);

                        width = header.w * data_structure[win_content_child_num].data.qr_bar.size / 256;
                        height = header.h * data_structure[win_content_child_num].data.qr_bar.size / 256;

                        lv_obj_set_size(temp_obj, width, height);

                        lv_obj_align(temp_obj, LV_ALIGN_OUT_TOP_LEFT, data_structure[win_content_child_num].x, data_structure[win_content_child_num].y);

                        break;
                    case 3:
                        my_symbol->symbology = BARCODE_HANXIN;

                        height_len = atoi(lv_label_get_text(label_btn_addition_QR_code_height));

                        if (height_len > QR_BAR_MAX_HIGHT)
                        {
                            height_len = QR_BAR_MAX_HIGHT;
                        }
                        else if (height_len < QR_BAR_MIN_HIGHT)
                        {
                            height_len = QR_BAR_MIN_HIGHT;
                        }

                        printf("height_len=%u\n\r",height_len);

                        data_structure[win_content_child_num].data.qr_bar.height = height_len;

                        my_symbol->scale = 1;

                        memcpy(data_structure[win_content_child_num].data.qr_bar.text,lv_label_get_text(label_btn_addition_QR_code_text),str_len);

                        //figure_borders = 0;
#if 0
                        if(lv_obj_has_state(sw_addition_QR_code_figure, LV_STATE_CHECKED) == 1)
                        {
                            my_symbol->show_hrt = 1;
                            memcpy(my_symbol->text,lv_label_get_text(label_btn_addition_QR_code_text),strlen(lv_label_get_text(label_btn_addition_QR_code_text))+ 1);
                            //figure_borders |= 0x01;
                            data_structure[win_content_child_num].data.qr_bar.figure = 1;
                        }
#endif
                        if (lv_obj_has_state(sw_addition_QR_code_border, LV_STATE_CHECKED) == 1)
                        {
                            my_symbol->output_options = BARCODE_BOX;
                            my_symbol->whitespace_width = 3;
                            my_symbol-> whitespace_height = 3; 
                            my_symbol-> border_width = 2;   /* Size of border in X-dimensions */
                            //figure_borders |= 0x02;
                            data_structure[win_content_child_num].data.qr_bar.borders = 1;
                        }

                        strcpy(my_symbol->outfile, "out.bmp");
                        ZBarcode_Encode(my_symbol, (unsigned char *)lv_label_get_text(label_btn_addition_QR_code_text), 0);

                        ZBarcode_Print(my_symbol, 0);
                        //ZBarcode_Delete(my_symbol);

                        pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                        printf("width=%d\n\r", width);
                        printf("height=%d\n\r", height);
                        printf("channels=%d\n\r", channels);
            
                        my_symbol->scale = (float)((float)150.0*(float)height_len/(float)QR_BAR_MAX_HIGHT/(float)height);
                      // my_symbol->scale = (float)height_len/(float)height;
                        printf("scale=%f\n\r",(double)my_symbol->scale);
   
                        strcpy(my_symbol->outfile, "out.bmp");
                        ZBarcode_Encode(my_symbol, (unsigned char *)lv_label_get_text(label_btn_addition_QR_code_text), 0);

                        ZBarcode_Print(my_symbol, 0);
                        ZBarcode_Delete(my_symbol);
                        stbi_image_free(pdata);
                
                        pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                        printf("width=%d\n\r", width);
                        printf("height=%d\n\r", height);
                        printf("channels=%d\n\r", channels);

                        lv_obj_set_size(temp_obj, width, height);

                        pnew_data = (unsigned char*)lv_mem_alloc(width * height * 4); // 为32位数据分配内存
                        if (!pnew_data) 
                        {
                            fprintf(stderr, "Memory allocation failed\n");
                            stbi_image_free(pdata);
                            return;
                        }
                        else
                        {
                            printf("lv_mem_alloc ok\n\r");
                        }

                        for (int y = 0; y < height; y++) 
                        {
                            for (int x = 0; x < width; x++) 
                            {
                                int index = y * width + x; // 计算当前像素在原始数据中的索引
                                unsigned char color = pdata[index]; // 获取当前像素的灰度值（0或255）
                                // 映射到RGBA值

                                if (color == 0)
                                {
                                    pnew_data[index * 4 + 0] = 0; // R
                                    pnew_data[index * 4 + 1] = 0; // G
                                    pnew_data[index * 4 + 2] = 0; // B
                                    pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                                }
                                else
                                {
                                    pnew_data[index * 4 + 0] = 255; // R
                                    pnew_data[index * 4 + 1] = 255; // G
                                    pnew_data[index * 4 + 2] = 255; // B
                                    pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                                }
                            }
                        }

                        sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.bmp",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                        stbi_write_bmp(bmp_name, width, height, 4, pnew_data);
                        // 使用data进行图像处理...
                        lv_mem_free(pnew_data);
                        stbi_image_free(pdata); // 释放内存

                        lv_obj_del(lv_obj_get_child(temp_obj,0));

                        data = stbi_load(bmp_name, &width, &height, &channels, 0);
                        if (!data) 
                        {
                            printf("错误：无法加载图片 %s\n", bmp_name);
                        }
                        printf("图片加载成功：%dx%d，%d 通道\n", width, height, channels);

                        sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.png",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                        
                        success = stbi_write_png(bmp_name, width, height, channels, data, width * channels);
                        if (!success) 
                        {
                            printf("错误：保存 PNG 失败\n");
                        } 
                        else
                        {
                            printf("PNG 保存成功：%s\n", bmp_name);
                        }

                        // 释放内存
                        stbi_image_free(data);

                        //显示图像
                        img = lv_img_create(temp_obj);
                        sprintf(bmp_name_1,"A:%s",bmp_name);
                        lv_img_set_src(img, bmp_name_1);
                        lv_obj_center(img);

                        res = lv_img_decoder_get_info(bmp_name_1, &header);  // 直接传入文件路径

                        if (res == LV_RES_OK)
                        {
                            printf("PNG: %dx%d\n", header.w, header.h);
                        }
                        else
                        {
                            printf("lv_img_decoder_get_info error\n");
                        }

                        lv_img_set_zoom(img,data_structure[win_content_child_num].data.qr_bar.size);

                        width = header.w * data_structure[win_content_child_num].data.qr_bar.size / 256;
                        height = header.h * data_structure[win_content_child_num].data.qr_bar.size / 256;

                        lv_obj_set_size(temp_obj, width, height);

                        lv_obj_align(temp_obj, LV_ALIGN_OUT_TOP_LEFT, data_structure[win_content_child_num].x, data_structure[win_content_child_num].y);

                        break;
                }
            }
            else
            {
                
                data_structure[win_content_child_num].data.qr_bar.type = QR_or_bar_code_flag;
                data_structure[win_content_child_num].data.qr_bar.symbology = bar_code_type;
                data_structure[win_content_child_num].type = TYPE_BAR;
                my_symbol = ZBarcode_Create();
                switch (bar_code_type)
                {
                    case 0:
                    default:
                        my_symbol->symbology = BARCODE_CODE39;

                        height_len = atoi(lv_label_get_text(label_btn_addition_QR_code_height));

                        if (height_len > QR_BAR_MAX_HIGHT)
                        {
                            height_len = QR_BAR_MAX_HIGHT;
                        }
                        else if (height_len < QR_BAR_MIN_HIGHT)
                        {
                            height_len = QR_BAR_MIN_HIGHT;
                        }

                        printf("height_len=%u\n\r",height_len);

                        data_structure[win_content_child_num].data.qr_bar.height = height_len;

                        my_symbol->scale = 1;

                        memcpy(data_structure[win_content_child_num].data.qr_bar.text,lv_label_get_text(label_btn_addition_QR_code_text),str_len);

                        if(lv_obj_has_state(sw_addition_QR_code_figure, LV_STATE_CHECKED) == 1)
                        {
                            my_symbol->show_hrt = 1;
                            memcpy(my_symbol->text,lv_label_get_text(label_btn_addition_QR_code_text),strlen(lv_label_get_text(label_btn_addition_QR_code_text))+ 1);
                            //figure_borders |= 0x01;
                            data_structure[win_content_child_num].data.qr_bar.figure = 1;
                        }
                        else
                        {
                             my_symbol->show_hrt = 0;
                        }



                        if (lv_obj_has_state(sw_addition_QR_code_border, LV_STATE_CHECKED) == 1)
                        {
                            my_symbol->output_options = BARCODE_BOX;
                            my_symbol->whitespace_width = 3;
                            my_symbol-> whitespace_height = 3; 
                            my_symbol-> border_width = 2;   /* Size of border in X-dimensions */
                            //figure_borders |= 0x02;
                            data_structure[win_content_child_num].data.qr_bar.borders = 1;
                        }


                        strcpy(my_symbol->outfile, "out.bmp");
                        ZBarcode_Encode(my_symbol, (unsigned char *)lv_label_get_text(label_btn_addition_QR_code_text), 0);

                        ZBarcode_Print(my_symbol, 0);
                        //ZBarcode_Delete(my_symbol);

                        pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                        printf("width=%d\n\r", width);
                        printf("height=%d\n\r", height);
                        printf("channels=%d\n\r", channels);
            
                        my_symbol->scale = (float)((float)150.0*(float)height_len/(float)QR_BAR_MAX_HIGHT/(float)height);
                       //  my_symbol->scale = (float)height_len/(float)height;
                        printf("scale=%f\n\r", (double)my_symbol->scale);
   
                        strcpy(my_symbol->outfile, "out.bmp");
                        ZBarcode_Encode(my_symbol, (unsigned char *)lv_label_get_text(label_btn_addition_QR_code_text), 0);

                        ZBarcode_Print(my_symbol, 0);
                        ZBarcode_Delete(my_symbol);
                        stbi_image_free(pdata);
                
                        pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                        printf("width=%d\n\r", width);
                        printf("height=%d\n\r", height);
                        printf("channels=%d\n\r", channels);

                        lv_obj_set_size(temp_obj, width, height);

                        pnew_data = (unsigned char*)lv_mem_alloc(width * height * 4); // 为32位数据分配内存
                        if (!pnew_data) 
                        {
                            fprintf(stderr, "Memory allocation failed\n");
                            stbi_image_free(pdata);
                            return;
                        }
                        else
                        {
                            printf("lv_mem_alloc ok\n\r");
                        }

                        for (int y = 0; y < height; y++) 
                        {
                            for (int x = 0; x < width; x++) 
                            {
                                int index = y * width + x; // 计算当前像素在原始数据中的索引
                                unsigned char color = pdata[index]; // 获取当前像素的灰度值（0或255）
                                // 映射到RGBA值

                                if (color == 0)
                                {
                                    pnew_data[index * 4 + 0] = 0; // R
                                    pnew_data[index * 4 + 1] = 0; // G
                                    pnew_data[index * 4 + 2] = 0; // B
                                    pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                                }
                                else
                                {
                                    pnew_data[index * 4 + 0] = 255; // R
                                    pnew_data[index * 4 + 1] = 255; // G
                                    pnew_data[index * 4 + 2] = 255; // B
                                    pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                                }
                            }
                        }
#if 0
                        stbi_write_bmp("QR_bar_code.bmp", width, height, 4, pnew_data);
                        // 使用data进行图像处理...
                        lv_mem_free(pnew_data);
                        stbi_image_free(pdata); // 释放内存

                        //显示图像
                        img = lv_img_create(temp_obj);
                        lv_img_set_src(img, "A:/root/QR_bar_code.bmp");
                        lv_obj_center(img);
#endif

                        sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.bmp",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                        stbi_write_bmp(bmp_name, width, height, 4, pnew_data);
                        // 使用data进行图像处理...
                        lv_mem_free(pnew_data);
                        stbi_image_free(pdata); // 释放内存


                        lv_obj_del(lv_obj_get_child(temp_obj,0));
                        data = stbi_load(bmp_name, &width, &height, &channels, 0);
                        if (!data) 
                        {
                            printf("错误：无法加载图片 %s\n", bmp_name);
                        }
                        printf("图片加载成功：%dx%d，%d 通道\n", width, height, channels);

                        sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.png",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                        
                        success = stbi_write_png(bmp_name, width, height, channels, data, width * channels);
                        if (!success) 
                        {
                            printf("错误：保存 PNG 失败\n");
                        } 
                        else
                        {
                            printf("PNG 保存成功：%s\n", bmp_name);
                        }

                        // 释放内存
                        stbi_image_free(data);

                        //显示图像
                        img = lv_img_create(temp_obj);
                        sprintf(bmp_name_1,"A:%s",bmp_name);
                        lv_img_set_src(img, bmp_name_1);
                        lv_obj_center(img);

                        res = lv_img_decoder_get_info(bmp_name_1, &header);  // 直接传入文件路径

                        if (res == LV_RES_OK)
                        {
                            printf("PNG: %dx%d\n", header.w, header.h);
                        }
                        else
                        {
                            printf("lv_img_decoder_get_info error\n");
                        }

                        lv_img_set_zoom(img,data_structure[win_content_child_num].data.qr_bar.size);

                        width = header.w * data_structure[win_content_child_num].data.qr_bar.size / 256;
                        height = header.h * data_structure[win_content_child_num].data.qr_bar.size / 256;

                        lv_obj_set_size(temp_obj, width, height);

                        lv_obj_align(temp_obj, LV_ALIGN_OUT_TOP_LEFT, data_structure[win_content_child_num].x, data_structure[win_content_child_num].y);

                        break;
                    case 1:
                        my_symbol->symbology = BARCODE_CODE128;
                        height_len = atoi(lv_label_get_text(label_btn_addition_QR_code_height));

                        if (height_len > QR_BAR_MAX_HIGHT)
                        {
                            height_len = QR_BAR_MAX_HIGHT;
                        }
                        else if (height_len < QR_BAR_MIN_HIGHT)
                        {
                            height_len = QR_BAR_MIN_HIGHT;
                        }

                        printf("height_len=%u\n\r",height_len);

                        data_structure[win_content_child_num].data.qr_bar.height = height_len;

                        my_symbol->scale = 1;

                        memcpy(data_structure[win_content_child_num].data.qr_bar.text,lv_label_get_text(label_btn_addition_QR_code_text),str_len);
                
                        if(lv_obj_has_state(sw_addition_QR_code_figure, LV_STATE_CHECKED) == 1)
                        {
                            my_symbol->show_hrt = 1;
                            memcpy(my_symbol->text,lv_label_get_text(label_btn_addition_QR_code_text),strlen(lv_label_get_text(label_btn_addition_QR_code_text))+ 1);
                            //figure_borders |= 0x01;
                            data_structure[win_content_child_num].data.qr_bar.figure = 1;
                        }
                        else
                        {
                             my_symbol->show_hrt = 0;
                        }

                        if (lv_obj_has_state(sw_addition_QR_code_border, LV_STATE_CHECKED) == 1)
                        {
                            my_symbol->output_options = BARCODE_BOX;
                            my_symbol->whitespace_width = 3;
                            my_symbol-> whitespace_height = 3; 
                            my_symbol-> border_width = 2;   /* Size of border in X-dimensions */
                            //figure_borders |= 0x02;
                            data_structure[win_content_child_num].data.qr_bar.borders = 1;
                        }

                        strcpy(my_symbol->outfile, "out.bmp");
                        ZBarcode_Encode(my_symbol, (unsigned char *)lv_label_get_text(label_btn_addition_QR_code_text), 0);

                        ZBarcode_Print(my_symbol, 0);
                        //ZBarcode_Delete(my_symbol);

                        pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                        printf("width=%d\n\r", width);
                        printf("height=%d\n\r", height);
                        printf("channels=%d\n\r", channels);
            
                        my_symbol->scale = (float)((float)150.0*(float)height_len/(float)QR_BAR_MAX_HIGHT/(float)height);
                     //   my_symbol->scale = (float)height_len/(float)height;
                        printf("scale=%f\n\r",(double)my_symbol->scale);
   
                        strcpy(my_symbol->outfile, "out.bmp");
                        ZBarcode_Encode(my_symbol, (unsigned char *)lv_label_get_text(label_btn_addition_QR_code_text), 0);

                        ZBarcode_Print(my_symbol, 0);
                        ZBarcode_Delete(my_symbol);
                        stbi_image_free(pdata);
                
                        pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                        printf("width=%d\n\r", width);
                        printf("height=%d\n\r", height);
                        printf("channels=%d\n\r", channels);

                        lv_obj_set_size(temp_obj, width, height);

                        pnew_data = (unsigned char*)lv_mem_alloc(width * height * 4); // 为32位数据分配内存
                        if (!pnew_data) 
                        {
                            fprintf(stderr, "Memory allocation failed\n");
                            stbi_image_free(pdata);
                            return;
                        }
                        else
                        {
                            printf("lv_mem_alloc ok\n\r");
                        }

                        for (int y = 0; y < height; y++) 
                        {
                            for (int x = 0; x < width; x++) 
                            {
                                int index = y * width + x; // 计算当前像素在原始数据中的索引
                                unsigned char color = pdata[index]; // 获取当前像素的灰度值（0或255）
                                // 映射到RGBA值

                                if (color == 0)
                                {
                                    pnew_data[index * 4 + 0] = 0; // R
                                    pnew_data[index * 4 + 1] = 0; // G
                                    pnew_data[index * 4 + 2] = 0; // B
                                    pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                                }
                                else
                                {
                                    pnew_data[index * 4 + 0] = 255; // R
                                    pnew_data[index * 4 + 1] = 255; // G
                                    pnew_data[index * 4 + 2] = 255; // B
                                    pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                                }
                            }
                        }

#if 0
                        stbi_write_bmp("QR_bar_code.bmp", width, height, 4, pnew_data);
                        // 使用data进行图像处理...
                        lv_mem_free(pnew_data);
                        stbi_image_free(pdata); // 释放内存

                        //显示图像
                        img = lv_img_create(temp_obj);
                        lv_img_set_src(img, "A:/root/QR_bar_code.bmp");
                        lv_obj_center(img);
#endif

                        sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.bmp",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                        stbi_write_bmp(bmp_name, width, height, 4, pnew_data);
                        // 使用data进行图像处理...
                        lv_mem_free(pnew_data);
                        stbi_image_free(pdata); // 释放内存


                        lv_obj_del(lv_obj_get_child(temp_obj,0));

                        data = stbi_load(bmp_name, &width, &height, &channels, 0);
                        if (!data) 
                        {
                            printf("错误：无法加载图片 %s\n", bmp_name);
                        }
                        printf("图片加载成功：%dx%d，%d 通道\n", width, height, channels);

                        sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.png",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                        
                        success = stbi_write_png(bmp_name, width, height, channels, data, width * channels);
                        if (!success) 
                        {
                            printf("错误：保存 PNG 失败\n");
                        } 
                        else
                        {
                            printf("PNG 保存成功：%s\n", bmp_name);
                        }

                        // 释放内存
                        stbi_image_free(data);

                        //显示图像
                        img = lv_img_create(temp_obj);
                        sprintf(bmp_name_1,"A:%s",bmp_name);
                        lv_img_set_src(img, bmp_name_1);
                        lv_obj_center(img);

                        res = lv_img_decoder_get_info(bmp_name_1, &header);  // 直接传入文件路径

                        if (res == LV_RES_OK)
                        {
                            printf("PNG: %dx%d\n", header.w, header.h);
                        }
                        else
                        {
                            printf("lv_img_decoder_get_info error\n");
                        }

                        lv_img_set_zoom(img,data_structure[win_content_child_num].data.qr_bar.size);

                        width = header.w * data_structure[win_content_child_num].data.qr_bar.size / 256;
                        height = header.h * data_structure[win_content_child_num].data.qr_bar.size / 256;

                        lv_obj_set_size(temp_obj, width, height);

                        lv_obj_align(temp_obj, LV_ALIGN_OUT_TOP_LEFT, data_structure[win_content_child_num].x, data_structure[win_content_child_num].y);

                        break;
                    case 2:
                    case 3:
                        my_symbol->symbology = BARCODE_EANX;

                        height_len = atoi(lv_label_get_text(label_btn_addition_QR_code_height));

                        if (height_len > QR_BAR_MAX_HIGHT)
                        {
                            height_len = QR_BAR_MAX_HIGHT;
                        }
                        else if (height_len < QR_BAR_MIN_HIGHT)
                        {
                            height_len = QR_BAR_MIN_HIGHT;
                        }

                        printf("height_len=%u\n\r",height_len);

                        data_structure[win_content_child_num].data.qr_bar.height = height_len;

                        my_symbol->scale = 1;

                        memcpy(data_structure[win_content_child_num].data.qr_bar.text,lv_label_get_text(label_btn_addition_QR_code_text),str_len);

                        if(lv_obj_has_state(sw_addition_QR_code_figure, LV_STATE_CHECKED) == 1)
                        {
                            my_symbol->show_hrt = 1;
                            memcpy(my_symbol->text,lv_label_get_text(label_btn_addition_QR_code_text),strlen(lv_label_get_text(label_btn_addition_QR_code_text))+ 1);
                            //figure_borders |= 0x01;
                            data_structure[win_content_child_num].data.qr_bar.figure = 1;
                        }
                        else
                        {
                             my_symbol->show_hrt = 0;
                        }

                        if (lv_obj_has_state(sw_addition_QR_code_border, LV_STATE_CHECKED) == 1)
                        {
                            my_symbol->output_options = BARCODE_BOX;
                            my_symbol->whitespace_width = 3;
                            my_symbol-> whitespace_height = 3; 
                            my_symbol-> border_width = 2;   /* Size of border in X-dimensions */
                            //figure_borders |= 0x02;
                            data_structure[win_content_child_num].data.qr_bar.borders = 1;
                        }

                        strcpy(my_symbol->outfile, "out.bmp");
                        ZBarcode_Encode(my_symbol, (unsigned char *)lv_label_get_text(label_btn_addition_QR_code_text), 0);

                        ZBarcode_Print(my_symbol, 0);
                        //ZBarcode_Delete(my_symbol);

                        pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                        printf("width=%d\n\r", width);
                        printf("height=%d\n\r", height);
                        printf("channels=%d\n\r", channels);
            
                        my_symbol->scale = (float)((float)150.0*(float)height_len/(float)QR_BAR_MAX_HIGHT/(float)height);
                       //  my_symbol->scale = (float)height_len/(float)height;
                        printf("scale=%f\n\r",(double)my_symbol->scale);
   
                        strcpy(my_symbol->outfile, "out.bmp");
                        ZBarcode_Encode(my_symbol, (unsigned char *)lv_label_get_text(label_btn_addition_QR_code_text), 0);

                        ZBarcode_Print(my_symbol, 0);
                        ZBarcode_Delete(my_symbol);
                        stbi_image_free(pdata);
                
                        pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                        printf("width=%d\n\r", width);
                        printf("height=%d\n\r", height);
                        printf("channels=%d\n\r", channels);

                        lv_obj_set_size(temp_obj, width, height);

                        pnew_data = (unsigned char*)lv_mem_alloc(width * height * 4); // 为32位数据分配内存
                        if (!pnew_data) 
                        {
                            fprintf(stderr, "Memory allocation failed\n");
                            stbi_image_free(pdata);
                            return;
                        }
                        else
                        {
                            printf("lv_mem_alloc ok\n\r");
                        }

                        for (int y = 0; y < height; y++) 
                        {
                            for (int x = 0; x < width; x++) 
                            {
                                int index = y * width + x; // 计算当前像素在原始数据中的索引
                                unsigned char color = pdata[index]; // 获取当前像素的灰度值（0或255）
                                // 映射到RGBA值

                                if (color == 0)
                                {
                                    pnew_data[index * 4 + 0] = 0; // R
                                    pnew_data[index * 4 + 1] = 0; // G
                                    pnew_data[index * 4 + 2] = 0; // B
                                    pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                                }
                                else
                                {
                                    pnew_data[index * 4 + 0] = 255; // R
                                    pnew_data[index * 4 + 1] = 255; // G
                                    pnew_data[index * 4 + 2] = 255; // B
                                    pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                                }
                            }
                        }
#if 0
                        stbi_write_bmp("QR_bar_code.bmp", width, height, 4, pnew_data);
                        // 使用data进行图像处理...
                        lv_mem_free(pnew_data);
                        stbi_image_free(pdata); // 释放内存

                        //显示图像
                        img = lv_img_create(temp_obj);
                        lv_img_set_src(img, "A:/root/QR_bar_code.bmp");
                        lv_obj_center(img);
#endif

                        sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.bmp",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                        stbi_write_bmp(bmp_name, width, height, 4, pnew_data);
                        // 使用data进行图像处理...
                        lv_mem_free(pnew_data);
                        stbi_image_free(pdata); // 释放内存


                        lv_obj_del(lv_obj_get_child(temp_obj,0));

                        data = stbi_load(bmp_name, &width, &height, &channels, 0);
                        if (!data) 
                        {
                            printf("错误：无法加载图片 %s\n", bmp_name);
                        }
                        printf("图片加载成功：%dx%d，%d 通道\n", width, height, channels);

                        sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.png",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                        
                        success = stbi_write_png(bmp_name, width, height, channels, data, width * channels);
                        if (!success) 
                        {
                            printf("错误：保存 PNG 失败\n");
                        } 
                        else
                        {
                            printf("PNG 保存成功：%s\n", bmp_name);
                        }

                        // 释放内存
                        stbi_image_free(data);

                        //显示图像
                        img = lv_img_create(temp_obj);
                        sprintf(bmp_name_1,"A:%s",bmp_name);
                        lv_img_set_src(img, bmp_name_1);
                        lv_obj_center(img);

                        res = lv_img_decoder_get_info(bmp_name_1, &header);  // 直接传入文件路径

                        if (res == LV_RES_OK)
                        {
                            printf("PNG: %dx%d\n", header.w, header.h);
                        }
                        else
                        {
                            printf("lv_img_decoder_get_info error\n");
                        }

                        lv_img_set_zoom(img,data_structure[win_content_child_num].data.qr_bar.size);

                        width = header.w * data_structure[win_content_child_num].data.qr_bar.size / 256;
                        height = header.h * data_structure[win_content_child_num].data.qr_bar.size / 256;

                        lv_obj_set_size(temp_obj, width, height);

                        lv_obj_align(temp_obj, LV_ALIGN_OUT_TOP_LEFT, data_structure[win_content_child_num].x, data_structure[win_content_child_num].y);

                        break;
                    case 4:
                        my_symbol->symbology = BARCODE_EAN128;
                        my_symbol->input_mode |= GS1PARENS_MODE;
                        height_len = atoi(lv_label_get_text(label_btn_addition_QR_code_height));

                        if (height_len > QR_BAR_MAX_HIGHT)
                        {
                            height_len = QR_BAR_MAX_HIGHT;
                        }
                        else if (height_len < QR_BAR_MIN_HIGHT)
                        {
                            height_len = QR_BAR_MIN_HIGHT;
                        }

                        printf("height_len=%u\n\r",height_len);

                        data_structure[win_content_child_num].data.qr_bar.height = height_len;

                        my_symbol->scale = 1;

                        //memcpy(data_structure[win_content_child_num].data.qr_bar.text,lv_label_get_text(label_btn_addition_QR_code_text),str_len);

                        memcpy(data_structure[win_content_child_num].data.qr_bar.text,lv_label_get_text(label_btn_addition_QR_code_text),str_len);
                 
                        if(lv_obj_has_state(sw_addition_QR_code_figure, LV_STATE_CHECKED) == 1)
                        {
                            my_symbol->show_hrt = 1;
                            memcpy(my_symbol->text,lv_label_get_text(label_btn_addition_QR_code_text),strlen(lv_label_get_text(label_btn_addition_QR_code_text))+ 1);
                            //figure_borders |= 0x01;
                            data_structure[win_content_child_num].data.qr_bar.figure = 1;
                        }
                        else
                        {
                             my_symbol->show_hrt = 0;
                        }

                        if (lv_obj_has_state(sw_addition_QR_code_border, LV_STATE_CHECKED) == 1)
                        {
                            my_symbol->output_options = BARCODE_BOX;
                            my_symbol->whitespace_width = 3;
                            my_symbol-> whitespace_height = 3; 
                            my_symbol-> border_width = 2;   /* Size of border in X-dimensions */
                            //figure_borders |= 0x02;
                            data_structure[win_content_child_num].data.qr_bar.borders = 1;
                        }
                        strcpy(my_symbol->outfile, "out.bmp");

                        ZBarcode_Encode(my_symbol, (unsigned char *)lv_label_get_text(label_btn_addition_QR_code_text), 0);
                        //ZBarcode_Encode(my_symbol, (unsigned char *)"(01)98898765432106(3202)012345(15)991231", 0);

                        ZBarcode_Print(my_symbol, 0);
                        //ZBarcode_Delete(my_symbol);

                        pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                        printf("width=%d\n\r", width);
                        printf("height=%d\n\r", height);
                        printf("channels=%d\n\r", channels);
            
                       // my_symbol->scale = (float)((float)118.0*(float)height_len/(float)100.0/(float)height);

                        my_symbol->scale = (float)((float)118.0*(float)height_len/(float)QR_BAR_MAX_HIGHT/(float)height);
                       
                        printf("scale=%f\n\r", (double)my_symbol->scale);
   
                        strcpy(my_symbol->outfile, "out.bmp");
                        ZBarcode_Encode(my_symbol, (unsigned char *)lv_label_get_text(label_btn_addition_QR_code_text), 0);

                        ZBarcode_Print(my_symbol, 0);
                        ZBarcode_Delete(my_symbol);
                        stbi_image_free(pdata);
                
                        pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                        printf("width=%d\n\r", width);
                        printf("height=%d\n\r", height);
                        printf("channels=%d\n\r", channels);

                        lv_obj_set_size(temp_obj, width, height);

                        pnew_data = (unsigned char*)lv_mem_alloc(width * height * 4); // 为32位数据分配内存
                        if (!pnew_data) 
                        {
                            fprintf(stderr, "Memory allocation failed\n");
                            stbi_image_free(pdata);
                            return;
                        }
                        else
                        {
                            printf("lv_mem_alloc ok\n\r");
                        }

                        for (int y = 0; y < height; y++) 
                        {
                            for (int x = 0; x < width; x++) 
                            {
                                int index = y * width + x; // 计算当前像素在原始数据中的索引
                                unsigned char color = pdata[index]; // 获取当前像素的灰度值（0或255）
                                // 映射到RGBA值

                                if (color == 0)
                                {
                                    pnew_data[index * 4 + 0] = 0; // R
                                    pnew_data[index * 4 + 1] = 0; // G
                                    pnew_data[index * 4 + 2] = 0; // B
                                    pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                                }
                                else
                                {
                                    pnew_data[index * 4 + 0] = 255; // R
                                    pnew_data[index * 4 + 1] = 255; // G
                                    pnew_data[index * 4 + 2] = 255; // B
                                    pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                                }
                            }
                        }
#if 0
                        stbi_write_bmp("QR_bar_code.bmp", width, height, 4, pnew_data);
                        // 使用data进行图像处理...
                        lv_mem_free(pnew_data);
                        stbi_image_free(pdata); // 释放内存

                        //显示图像
                        img = lv_img_create(temp_obj);
                        lv_img_set_src(img, "A:/root/QR_bar_code.bmp");
                        lv_obj_center(img);
#endif

                        sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.bmp",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                        stbi_write_bmp(bmp_name, width, height, 4, pnew_data);
                        // 使用data进行图像处理...
                        lv_mem_free(pnew_data);
                        stbi_image_free(pdata); // 释放内存


                        lv_obj_del(lv_obj_get_child(temp_obj,0));

                        data = stbi_load(bmp_name, &width, &height, &channels, 0);
                        if (!data) 
                        {
                            printf("错误：无法加载图片 %s\n", bmp_name);
                        }
                        printf("图片加载成功：%dx%d，%d 通道\n", width, height, channels);

                        sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.png",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                        
                        success = stbi_write_png(bmp_name, width, height, channels, data, width * channels);
                        if (!success) 
                        {
                            printf("错误：保存 PNG 失败\n");
                        } 
                        else
                        {
                            printf("PNG 保存成功：%s\n", bmp_name);
                        }

                        // 释放内存
                        stbi_image_free(data);

                        //显示图像
                        img = lv_img_create(temp_obj);
                        sprintf(bmp_name_1,"A:%s",bmp_name);
                        lv_img_set_src(img, bmp_name_1);
                        lv_obj_center(img);

                        res = lv_img_decoder_get_info(bmp_name_1, &header);  // 直接传入文件路径

                        if (res == LV_RES_OK)
                        {
                            printf("PNG: %dx%d\n", header.w, header.h);
                        }
                        else
                        {
                            printf("lv_img_decoder_get_info error\n");
                        }

                        lv_img_set_zoom(img,data_structure[win_content_child_num].data.qr_bar.size);

                        width = header.w * data_structure[win_content_child_num].data.qr_bar.size / 256;
                        height = header.h * data_structure[win_content_child_num].data.qr_bar.size / 256;

                        lv_obj_set_size(temp_obj, width, height);

                        lv_obj_align(temp_obj, LV_ALIGN_OUT_TOP_LEFT, data_structure[win_content_child_num].x, data_structure[win_content_child_num].y);

                        break;
                    case 5:
                        my_symbol->symbology = BARCODE_UPCA;

                        height_len = atoi(lv_label_get_text(label_btn_addition_QR_code_height));

                        if (height_len > QR_BAR_MAX_HIGHT)
                        {
                            height_len = QR_BAR_MAX_HIGHT;
                        }
                        else if (height_len < QR_BAR_MIN_HIGHT)
                        {
                            height_len = QR_BAR_MIN_HIGHT;
                        }

                        printf("height_len=%u\n\r",height_len);

                        data_structure[win_content_child_num].data.qr_bar.height = height_len;

                        my_symbol->scale = 1;

                        memcpy(data_structure[win_content_child_num].data.qr_bar.text,lv_label_get_text(label_btn_addition_QR_code_text),str_len);

                        if(lv_obj_has_state(sw_addition_QR_code_figure, LV_STATE_CHECKED) == 1)
                        {
                            my_symbol->show_hrt = 1;
                            memcpy(my_symbol->text,lv_label_get_text(label_btn_addition_QR_code_text),strlen(lv_label_get_text(label_btn_addition_QR_code_text))+ 1);
                            //figure_borders |= 0x01;
                            data_structure[win_content_child_num].data.qr_bar.figure = 1;
                        }
                        else
                        {
                             my_symbol->show_hrt = 0;
                        }

                        if (lv_obj_has_state(sw_addition_QR_code_border, LV_STATE_CHECKED) == 1)
                        {
                            my_symbol->output_options = BARCODE_BOX;
                            my_symbol->whitespace_width = 3;
                            my_symbol-> whitespace_height = 3; 
                            my_symbol-> border_width = 2;   /* Size of border in X-dimensions */
                            //figure_borders |= 0x02;
                            data_structure[win_content_child_num].data.qr_bar.borders = 1;
                        }

                        strcpy(my_symbol->outfile, "out.bmp");
                        ZBarcode_Encode(my_symbol, (unsigned char *)lv_label_get_text(label_btn_addition_QR_code_text), 0);

                        ZBarcode_Print(my_symbol, 0);
                        //ZBarcode_Delete(my_symbol);

                        pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                        printf("width=%d\n\r", width);
                        printf("height=%d\n\r", height);
                        printf("channels=%d\n\r", channels);
            
                        my_symbol->scale = (float)((float)150.0*(float)height_len/(float)QR_BAR_MAX_HIGHT/(float)height);
                        // my_symbol->scale = (float)height_len/(float)height;
                        printf("scale=%f\n\r", (double)my_symbol->scale);
   
                        strcpy(my_symbol->outfile, "out.bmp");
                        ZBarcode_Encode(my_symbol, (unsigned char *)lv_label_get_text(label_btn_addition_QR_code_text), 0);

                        ZBarcode_Print(my_symbol, 0);
                        ZBarcode_Delete(my_symbol);
                        stbi_image_free(pdata);
                
                        pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                        printf("width=%d\n\r", width);
                        printf("height=%d\n\r", height);
                        printf("channels=%d\n\r", channels);

                        lv_obj_set_size(temp_obj, width, height);

                        pnew_data = (unsigned char*)lv_mem_alloc(width * height * 4); // 为32位数据分配内存
                        if (!pnew_data) 
                        {
                            fprintf(stderr, "Memory allocation failed\n");
                            stbi_image_free(pdata);
                            return;
                        }
                        else
                        {
                            printf("lv_mem_alloc ok\n\r");
                        }

                        for (int y = 0; y < height; y++) 
                        {
                            for (int x = 0; x < width; x++) 
                            {
                                int index = y * width + x; // 计算当前像素在原始数据中的索引
                                unsigned char color = pdata[index]; // 获取当前像素的灰度值（0或255）
                                // 映射到RGBA值

                                if (color == 0)
                                {
                                    pnew_data[index * 4 + 0] = 0; // R
                                    pnew_data[index * 4 + 1] = 0; // G
                                    pnew_data[index * 4 + 2] = 0; // B
                                    pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                                }
                                else
                                {
                                    pnew_data[index * 4 + 0] = 255; // R
                                    pnew_data[index * 4 + 1] = 255; // G
                                    pnew_data[index * 4 + 2] = 255; // B
                                    pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                                }
                            }
                        }

#if 0
                        stbi_write_bmp("QR_bar_code.bmp", width, height, 4, pnew_data);
                        // 使用data进行图像处理...
                        lv_mem_free(pnew_data);
                        stbi_image_free(pdata); // 释放内存

                        //显示图像
                        img = lv_img_create(temp_obj);
                        lv_img_set_src(img, "A:/root/QR_bar_code.bmp");
                        lv_obj_center(img);
#endif

                        sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.bmp",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                        stbi_write_bmp(bmp_name, width, height, 4, pnew_data);
                        // 使用data进行图像处理...
                        lv_mem_free(pnew_data);
                        stbi_image_free(pdata); // 释放内存


                        lv_obj_del(lv_obj_get_child(temp_obj,0));

                        data = stbi_load(bmp_name, &width, &height, &channels, 0);
                        if (!data) 
                        {
                            printf("错误：无法加载图片 %s\n", bmp_name);
                        }
                        printf("图片加载成功：%dx%d，%d 通道\n", width, height, channels);

                        sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.png",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                        
                        success = stbi_write_png(bmp_name, width, height, channels, data, width * channels);
                        if (!success) 
                        {
                            printf("错误：保存 PNG 失败\n");
                        } 
                        else
                        {
                            printf("PNG 保存成功：%s\n", bmp_name);
                        }

                        // 释放内存
                        stbi_image_free(data);

                        //显示图像
                        img = lv_img_create(temp_obj);
                        sprintf(bmp_name_1,"A:%s",bmp_name);
                        lv_img_set_src(img, bmp_name_1);
                        lv_obj_center(img);

                        res = lv_img_decoder_get_info(bmp_name_1, &header);  // 直接传入文件路径

                        if (res == LV_RES_OK)
                        {
                            printf("PNG: %dx%d\n", header.w, header.h);
                        }
                        else
                        {
                            printf("lv_img_decoder_get_info error\n");
                        }

                        lv_img_set_zoom(img,data_structure[win_content_child_num].data.qr_bar.size);

                        width = header.w * data_structure[win_content_child_num].data.qr_bar.size / 256;
                        height = header.h * data_structure[win_content_child_num].data.qr_bar.size / 256;

                        lv_obj_set_size(temp_obj, width, height);

                        lv_obj_align(temp_obj, LV_ALIGN_OUT_TOP_LEFT, data_structure[win_content_child_num].x, data_structure[win_content_child_num].y);


                        break;
                    case 6:
                        my_symbol->symbology = BARCODE_UPCE;

                        height_len = atoi(lv_label_get_text(label_btn_addition_QR_code_height));

                        if (height_len > QR_BAR_MAX_HIGHT)
                        {
                            height_len = QR_BAR_MAX_HIGHT;
                        }
                        else if (height_len < QR_BAR_MIN_HIGHT)
                        {
                            height_len = QR_BAR_MIN_HIGHT;
                        }

                        printf("height_len=%u\n\r",height_len);

                        data_structure[win_content_child_num].data.qr_bar.height = height_len;

                        my_symbol->scale = 1;

                        memcpy(data_structure[win_content_child_num].data.qr_bar.text,lv_label_get_text(label_btn_addition_QR_code_text),str_len);

                        if(lv_obj_has_state(sw_addition_QR_code_figure, LV_STATE_CHECKED) == 1)
                        {
                            my_symbol->show_hrt = 1;
                            memcpy(my_symbol->text,lv_label_get_text(label_btn_addition_QR_code_text),strlen(lv_label_get_text(label_btn_addition_QR_code_text))+ 1);
                            //figure_borders |= 0x01;
                            data_structure[win_content_child_num].data.qr_bar.figure = 1;
                        }
                        else
                        {
                             my_symbol->show_hrt = 0;
                        }

                        if (lv_obj_has_state(sw_addition_QR_code_border, LV_STATE_CHECKED) == 1)
                        {
                            my_symbol->output_options = BARCODE_BOX;
                            my_symbol->whitespace_width = 3;
                            my_symbol-> whitespace_height = 3; 
                            my_symbol-> border_width = 2;   /* Size of border in X-dimensions */
                            //figure_borders |= 0x02;
                            data_structure[win_content_child_num].data.qr_bar.borders = 1;
                        }

                        strcpy(my_symbol->outfile, "out.bmp");
                        ZBarcode_Encode(my_symbol, (unsigned char *)lv_label_get_text(label_btn_addition_QR_code_text), 0);

                        ZBarcode_Print(my_symbol, 0);
                        //ZBarcode_Delete(my_symbol);

                        pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                        printf("width=%d\n\r", width);
                        printf("height=%d\n\r", height);
                        printf("channels=%d\n\r", channels);
            
                        my_symbol->scale = (float)((float)150.0*(float)height_len/(float)QR_BAR_MAX_HIGHT/(float)height);
                       //   my_symbol->scale = (float)height_len/(float)height;
                        printf("scale=%f\n\r", (double)my_symbol->scale);
   
                        strcpy(my_symbol->outfile, "out.bmp");
                        ZBarcode_Encode(my_symbol, (unsigned char *)lv_label_get_text(label_btn_addition_QR_code_text), 0);

                        ZBarcode_Print(my_symbol, 0);
                        ZBarcode_Delete(my_symbol);
                        stbi_image_free(pdata);
                
                        pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                        printf("width=%d\n\r", width);
                        printf("height=%d\n\r", height);
                        printf("channels=%d\n\r", channels);

                        lv_obj_set_size(temp_obj, width, height);

                        pnew_data = (unsigned char*)lv_mem_alloc(width * height * 4); // 为32位数据分配内存
                        if (!pnew_data) 
                        {
                            fprintf(stderr, "Memory allocation failed\n");
                            stbi_image_free(pdata);
                            return;
                        }
                        else
                        {
                            printf("lv_mem_alloc ok\n\r");
                        }

                        for (int y = 0; y < height; y++) 
                        {
                            for (int x = 0; x < width; x++) 
                            {
                                int index = y * width + x; // 计算当前像素在原始数据中的索引
                                unsigned char color = pdata[index]; // 获取当前像素的灰度值（0或255）
                                // 映射到RGBA值

                                if (color == 0)
                                {
                                    pnew_data[index * 4 + 0] = 0; // R
                                    pnew_data[index * 4 + 1] = 0; // G
                                    pnew_data[index * 4 + 2] = 0; // B
                                    pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                                }
                                else
                                {
                                    pnew_data[index * 4 + 0] = 255; // R
                                    pnew_data[index * 4 + 1] = 255; // G
                                    pnew_data[index * 4 + 2] = 255; // B
                                    pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                                }
                            }
                        }

#if 0
                        stbi_write_bmp("QR_bar_code.bmp", width, height, 4, pnew_data);
                        // 使用data进行图像处理...
                        lv_mem_free(pnew_data);
                        stbi_image_free(pdata); // 释放内存

                        //显示图像
                        img = lv_img_create(temp_obj);
                        lv_img_set_src(img, "A:/root/QR_bar_code.bmp");
                        lv_obj_center(img);        
#endif

                        sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.bmp",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                        stbi_write_bmp(bmp_name, width, height, 4, pnew_data);
                        // 使用data进行图像处理...
                        lv_mem_free(pnew_data);
                        stbi_image_free(pdata); // 释放内存

                        lv_obj_del(lv_obj_get_child(temp_obj,0));

                        data = stbi_load(bmp_name, &width, &height, &channels, 0);
                        if (!data) 
                        {
                            printf("错误：无法加载图片 %s\n", bmp_name);
                        }
                        printf("图片加载成功：%dx%d，%d 通道\n", width, height, channels);

                        sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.png",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                        
                        success = stbi_write_png(bmp_name, width, height, channels, data, width * channels);
                        if (!success) 
                        {
                            printf("错误：保存 PNG 失败\n");
                        } 
                        else
                        {
                            printf("PNG 保存成功：%s\n", bmp_name);
                        }

                        // 释放内存
                        stbi_image_free(data);

                        //显示图像
                        img = lv_img_create(temp_obj);
                        sprintf(bmp_name_1,"A:%s",bmp_name);
                        lv_img_set_src(img, bmp_name_1);
                        lv_obj_center(img);

                        res = lv_img_decoder_get_info(bmp_name_1, &header);  // 直接传入文件路径

                        if (res == LV_RES_OK)
                        {
                            printf("PNG: %dx%d\n", header.w, header.h);
                        }
                        else
                        {
                            printf("lv_img_decoder_get_info error\n");
                        }

                        lv_img_set_zoom(img,data_structure[win_content_child_num].data.qr_bar.size);

                        width = header.w * data_structure[win_content_child_num].data.qr_bar.size / 256;
                        height = header.h * data_structure[win_content_child_num].data.qr_bar.size / 256;

                        lv_obj_set_size(temp_obj, width, height);

                        lv_obj_align(temp_obj, LV_ALIGN_OUT_TOP_LEFT, data_structure[win_content_child_num].x, data_structure[win_content_child_num].y);

                        break;
                    case 7:
                        my_symbol->symbology = BARCODE_ITF14;

                        height_len = atoi(lv_label_get_text(label_btn_addition_QR_code_height));

                        if (height_len > QR_BAR_MAX_HIGHT)
                        {
                            height_len = QR_BAR_MAX_HIGHT;
                        }
                        else if (height_len < QR_BAR_MIN_HIGHT)
                        {
                            height_len = QR_BAR_MIN_HIGHT;
                        }

                        printf("height_len=%u\n\r",height_len);

                        data_structure[win_content_child_num].data.qr_bar.height = height_len;

                        my_symbol->scale = 1;

                        memcpy(data_structure[win_content_child_num].data.qr_bar.text,lv_label_get_text(label_btn_addition_QR_code_text),str_len);

                        if(lv_obj_has_state(sw_addition_QR_code_figure, LV_STATE_CHECKED) == 1)
                        {
                            my_symbol->show_hrt = 1;
                            memcpy(my_symbol->text,lv_label_get_text(label_btn_addition_QR_code_text),strlen(lv_label_get_text(label_btn_addition_QR_code_text))+ 1);
                            //figure_borders |= 0x01;
                            data_structure[win_content_child_num].data.qr_bar.figure = 1;
                        }
                        else
                        {
                             my_symbol->show_hrt = 0;
                        }

                        if (lv_obj_has_state(sw_addition_QR_code_border, LV_STATE_CHECKED) == 1)
                        {
                            my_symbol->output_options = BARCODE_BOX;
                            my_symbol->whitespace_width = 3;
                            my_symbol-> whitespace_height = 3; 
                            my_symbol-> border_width = 2;   /* Size of border in X-dimensions */
                            //figure_borders |= 0x02;
                            data_structure[win_content_child_num].data.qr_bar.borders = 1;
                        }

                        strcpy(my_symbol->outfile, "out.bmp");
                        ZBarcode_Encode(my_symbol, (unsigned char *)lv_label_get_text(label_btn_addition_QR_code_text), 0);

                        ZBarcode_Print(my_symbol, 0);
                        //ZBarcode_Delete(my_symbol);

                        pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                        printf("width=%d\n\r", width);
                        printf("height=%d\n\r", height);
                        printf("channels=%d\n\r", channels);
            
                        my_symbol->scale = (float)((float)150.0*(float)height_len/(float)QR_BAR_MAX_HIGHT/(float)height);
                       //  my_symbol->scale = (float)height_len/(float)height;
                        printf("scale=%f\n\r", (double)my_symbol->scale);
   
                        strcpy(my_symbol->outfile, "out.bmp");
                        ZBarcode_Encode(my_symbol, (unsigned char *)lv_label_get_text(label_btn_addition_QR_code_text), 0);

                        ZBarcode_Print(my_symbol, 0);
                        ZBarcode_Delete(my_symbol);
                        stbi_image_free(pdata);
                
                        pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                        printf("width=%d\n\r", width);
                        printf("height=%d\n\r", height);
                        printf("channels=%d\n\r", channels);

                        lv_obj_set_size(temp_obj, width, height);

                        pnew_data = (unsigned char*)lv_mem_alloc(width * height * 4); // 为32位数据分配内存
                        if (!pnew_data) 
                        {
                            fprintf(stderr, "Memory allocation failed\n");
                            stbi_image_free(pdata);
                            return;
                        }
                        else
                        {
                            printf("lv_mem_alloc ok\n\r");
                        }

                        for (int y = 0; y < height; y++) 
                        {
                            for (int x = 0; x < width; x++) 
                            {
                                int index = y * width + x; // 计算当前像素在原始数据中的索引
                                unsigned char color = pdata[index]; // 获取当前像素的灰度值（0或255）
                                // 映射到RGBA值

                                if (color == 0)
                                {
                                    pnew_data[index * 4 + 0] = 0; // R
                                    pnew_data[index * 4 + 1] = 0; // G
                                    pnew_data[index * 4 + 2] = 0; // B
                                    pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                                }
                                else
                                {
                                    pnew_data[index * 4 + 0] = 255; // R
                                    pnew_data[index * 4 + 1] = 255; // G
                                    pnew_data[index * 4 + 2] = 255; // B
                                    pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                                }
                            }
                        }

#if 0
                        stbi_write_bmp("QR_bar_code.bmp", width, height, 4, pnew_data);
                        // 使用data进行图像处理...
                        lv_mem_free(pnew_data);
                        stbi_image_free(pdata); // 释放内存

                        //显示图像
                        img = lv_img_create(temp_obj);
                        lv_img_set_src(img, "A:/root/QR_bar_code.bmp");
                        lv_obj_center(img);
#endif
                        sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.bmp",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                        stbi_write_bmp(bmp_name, width, height, 4, pnew_data);
                        // 使用data进行图像处理...
                        lv_mem_free(pnew_data);
                        stbi_image_free(pdata); // 释放内存


                        lv_obj_del(lv_obj_get_child(temp_obj,0));

                        data = stbi_load(bmp_name, &width, &height, &channels, 0);
                        if (!data) 
                        {
                            printf("错误：无法加载图片 %s\n", bmp_name);
                        }
                        printf("图片加载成功：%dx%d，%d 通道\n", width, height, channels);

                        sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.png",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                        
                        success = stbi_write_png(bmp_name, width, height, channels, data, width * channels);
                        if (!success) 
                        {
                            printf("错误：保存 PNG 失败\n");
                        } 
                        else
                        {
                            printf("PNG 保存成功：%s\n", bmp_name);
                        }

                        // 释放内存
                        stbi_image_free(data);

                        //显示图像
                        img = lv_img_create(temp_obj);
                        sprintf(bmp_name_1,"A:%s",bmp_name);
                        lv_img_set_src(img, bmp_name_1);
                        lv_obj_center(img);

                        res = lv_img_decoder_get_info(bmp_name_1, &header);  // 直接传入文件路径

                        if (res == LV_RES_OK)
                        {
                            printf("PNG: %dx%d\n", header.w, header.h);
                        }
                        else
                        {
                            printf("lv_img_decoder_get_info error\n");
                        }

                        lv_img_set_zoom(img,data_structure[win_content_child_num].data.qr_bar.size);

                        width = header.w * data_structure[win_content_child_num].data.qr_bar.size / 256;
                        height = header.h * data_structure[win_content_child_num].data.qr_bar.size / 256;

                        lv_obj_set_size(temp_obj, width, height);

                        lv_obj_align(temp_obj, LV_ALIGN_OUT_TOP_LEFT, data_structure[win_content_child_num].x, data_structure[win_content_child_num].y);

                        break;
                    case 8:
                        my_symbol->symbology = BARCODE_C25INTER;

                        height_len = atoi(lv_label_get_text(label_btn_addition_QR_code_height));

                        if (height_len > QR_BAR_MAX_HIGHT)
                        {
                            height_len = QR_BAR_MAX_HIGHT;
                        }
                        else if (height_len < QR_BAR_MIN_HIGHT)
                        {
                            height_len = QR_BAR_MIN_HIGHT;
                        }

                        printf("height_len=%u\n\r",height_len);

                        data_structure[win_content_child_num].data.qr_bar.height = height_len;

                        my_symbol->scale = 1;

                        memcpy(data_structure[win_content_child_num].data.qr_bar.text,lv_label_get_text(label_btn_addition_QR_code_text),str_len);

                        if(lv_obj_has_state(sw_addition_QR_code_figure, LV_STATE_CHECKED) == 1)
                        {
                            my_symbol->show_hrt = 1;
                            memcpy(my_symbol->text,lv_label_get_text(label_btn_addition_QR_code_text),strlen(lv_label_get_text(label_btn_addition_QR_code_text))+ 1);
                            //figure_borders |= 0x01;
                            data_structure[win_content_child_num].data.qr_bar.figure = 1;
                        }
                        else
                        {
                             my_symbol->show_hrt = 0;
                        }

                        if (lv_obj_has_state(sw_addition_QR_code_border, LV_STATE_CHECKED) == 1)
                        {
                            my_symbol->output_options = BARCODE_BOX;
                            my_symbol->whitespace_width = 3;
                            my_symbol-> whitespace_height = 3; 
                            my_symbol-> border_width = 2;   /* Size of border in X-dimensions */
                            //figure_borders |= 0x02;
                            data_structure[win_content_child_num].data.qr_bar.borders = 1;
                        }

                        strcpy(my_symbol->outfile, "out.bmp");
                        ZBarcode_Encode(my_symbol, (unsigned char *)lv_label_get_text(label_btn_addition_QR_code_text), 0);

                        ZBarcode_Print(my_symbol, 0);
                        //ZBarcode_Delete(my_symbol);

                        pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                        printf("width=%d\n\r", width);
                        printf("height=%d\n\r", height);
                        printf("channels=%d\n\r", channels);
            
                        my_symbol->scale = (float)((float)150.0*(float)height_len/(float)QR_BAR_MAX_HIGHT/(float)height);
                      //  my_symbol->scale = (float)height_len/(float)height;
                        printf("scale=%f\n\r", (double)my_symbol->scale);
   
                        strcpy(my_symbol->outfile, "out.bmp");
                        ZBarcode_Encode(my_symbol, (unsigned char *)lv_label_get_text(label_btn_addition_QR_code_text), 0);

                        ZBarcode_Print(my_symbol, 0);
                        ZBarcode_Delete(my_symbol);
                        stbi_image_free(pdata);
                
                        pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                        printf("width=%d\n\r", width);
                        printf("height=%d\n\r", height);
                        printf("channels=%d\n\r", channels);

                        lv_obj_set_size(temp_obj, width, height);

                        pnew_data = (unsigned char*)lv_mem_alloc(width * height * 4); // 为32位数据分配内存
                        if (!pnew_data) 
                        {
                            fprintf(stderr, "Memory allocation failed\n");
                            stbi_image_free(pdata);
                            return;
                        }
                        else
                        {
                            printf("lv_mem_alloc ok\n\r");
                        }

                        for (int y = 0; y < height; y++) 
                        {
                            for (int x = 0; x < width; x++) 
                            {
                                int index = y * width + x; // 计算当前像素在原始数据中的索引
                                unsigned char color = pdata[index]; // 获取当前像素的灰度值（0或255）
                                // 映射到RGBA值

                                if (color == 0)
                                {
                                    pnew_data[index * 4 + 0] = 0; // R
                                    pnew_data[index * 4 + 1] = 0; // G
                                    pnew_data[index * 4 + 2] = 0; // B
                                    pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                                }
                                else
                                {
                                    pnew_data[index * 4 + 0] = 255; // R
                                    pnew_data[index * 4 + 1] = 255; // G
                                    pnew_data[index * 4 + 2] = 255; // B
                                    pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                                }
                            }
                        }
#if 0
                        stbi_write_bmp("QR_bar_code.bmp", width, height, 4, pnew_data);
                        // 使用data进行图像处理...
                        lv_mem_free(pnew_data);
                        stbi_image_free(pdata); // 释放内存

                        //显示图像
                        img = lv_img_create(temp_obj);
                        lv_img_set_src(img, "A:/root/QR_bar_code.bmp");
                        lv_obj_center(img);
#endif
                        sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.bmp",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                        stbi_write_bmp(bmp_name, width, height, 4, pnew_data);
                        // 使用data进行图像处理...
                        lv_mem_free(pnew_data);
                        stbi_image_free(pdata); // 释放内存


                        lv_obj_del(lv_obj_get_child(temp_obj,0));

                        data = stbi_load(bmp_name, &width, &height, &channels, 0);
                        if (!data) 
                        {
                            printf("错误：无法加载图片 %s\n", bmp_name);
                        }
                        printf("图片加载成功：%dx%d，%d 通道\n", width, height, channels);

                        sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.png",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                        
                        success = stbi_write_png(bmp_name, width, height, channels, data, width * channels);
                        if (!success) 
                        {
                            printf("错误：保存 PNG 失败\n");
                        } 
                        else
                        {
                            printf("PNG 保存成功：%s\n", bmp_name);
                        }

                        // 释放内存
                        stbi_image_free(data);

                        //显示图像
                        img = lv_img_create(temp_obj);
                        sprintf(bmp_name_1,"A:%s",bmp_name);
                        lv_img_set_src(img, bmp_name_1);
                        lv_obj_center(img);

                        res = lv_img_decoder_get_info(bmp_name_1, &header);  // 直接传入文件路径

                        if (res == LV_RES_OK)
                        {
                            printf("PNG: %dx%d\n", header.w, header.h);
                        }
                        else
                        {
                            printf("lv_img_decoder_get_info error\n");
                        }

                        lv_img_set_zoom(img,data_structure[win_content_child_num].data.qr_bar.size);

                        width = header.w * data_structure[win_content_child_num].data.qr_bar.size / 256;
                        height = header.h * data_structure[win_content_child_num].data.qr_bar.size / 256;

                        lv_obj_set_size(temp_obj, width, height);

                        lv_obj_align(temp_obj, LV_ALIGN_OUT_TOP_LEFT, data_structure[win_content_child_num].x, data_structure[win_content_child_num].y);

                        break;
                    case 9:
                        my_symbol->symbology = BARCODE_EAN14;

                        height_len = atoi(lv_label_get_text(label_btn_addition_QR_code_height));

                        if (height_len > QR_BAR_MAX_HIGHT)
                        {
                            height_len = QR_BAR_MAX_HIGHT;
                        }
                        else if (height_len < QR_BAR_MIN_HIGHT)
                        {
                            height_len = QR_BAR_MIN_HIGHT;
                        }

                        printf("height_len=%u\n\r",height_len);

                        data_structure[win_content_child_num].data.qr_bar.height = height_len;

                        my_symbol->scale = 1;

                        memcpy(data_structure[win_content_child_num].data.qr_bar.text,lv_label_get_text(label_btn_addition_QR_code_text),str_len);

                        if(lv_obj_has_state(sw_addition_QR_code_figure, LV_STATE_CHECKED) == 1)
                        {
                            my_symbol->show_hrt = 1;
                            memcpy(my_symbol->text,lv_label_get_text(label_btn_addition_QR_code_text),strlen(lv_label_get_text(label_btn_addition_QR_code_text))+ 1);
                            //figure_borders |= 0x01;
                            data_structure[win_content_child_num].data.qr_bar.figure = 1;
                        }
                        else
                        {
                             my_symbol->show_hrt = 0;
                        }

                        if (lv_obj_has_state(sw_addition_QR_code_border, LV_STATE_CHECKED) == 1)
                        {
                            my_symbol->output_options = BARCODE_BOX;
                            my_symbol->whitespace_width = 3;
                            my_symbol-> whitespace_height = 3; 
                            my_symbol-> border_width = 2;   /* Size of border in X-dimensions */
                            //figure_borders |= 0x02;
                            data_structure[win_content_child_num].data.qr_bar.borders = 1;
                        }

                        strcpy(my_symbol->outfile, "out.bmp");
                        ZBarcode_Encode(my_symbol, (unsigned char *)lv_label_get_text(label_btn_addition_QR_code_text), 0);

                        ZBarcode_Print(my_symbol, 0);
                        //ZBarcode_Delete(my_symbol);

                        pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                        printf("width=%d\n\r", width);
                        printf("height=%d\n\r", height);
                        printf("channels=%d\n\r", channels);
            
                        my_symbol->scale = (float)((float)150.0*(float)height_len/(float)QR_BAR_MAX_HIGHT/(float)height);
                        // my_symbol->scale = (float)height_len/(float)height;
                        printf("scale=%f\n\r",(double) my_symbol->scale);
   
                        strcpy(my_symbol->outfile, "out.bmp");
                        ZBarcode_Encode(my_symbol, (unsigned char *)lv_label_get_text(label_btn_addition_QR_code_text), 0);

                        ZBarcode_Print(my_symbol, 0);
                        ZBarcode_Delete(my_symbol);
                        stbi_image_free(pdata);
                
                        pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                        printf("width=%d\n\r", width);
                        printf("height=%d\n\r", height);
                        printf("channels=%d\n\r", channels);

                        lv_obj_set_size(temp_obj, width, height);

                        pnew_data = (unsigned char*)lv_mem_alloc(width * height * 4); // 为32位数据分配内存
                        if (!pnew_data) 
                        {
                            fprintf(stderr, "Memory allocation failed\n");
                            stbi_image_free(pdata);
                            return;
                        }
                        else
                        {
                            printf("lv_mem_alloc ok\n\r");
                        }

                        for (int y = 0; y < height; y++) 
                        {
                            for (int x = 0; x < width; x++) 
                            {
                                int index = y * width + x; // 计算当前像素在原始数据中的索引
                                unsigned char color = pdata[index]; // 获取当前像素的灰度值（0或255）
                                // 映射到RGBA值

                                if (color == 0)
                                {
                                    pnew_data[index * 4 + 0] = 0; // R
                                    pnew_data[index * 4 + 1] = 0; // G
                                    pnew_data[index * 4 + 2] = 0; // B
                                    pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                                }
                                else
                                {
                                    pnew_data[index * 4 + 0] = 255; // R
                                    pnew_data[index * 4 + 1] = 255; // G
                                    pnew_data[index * 4 + 2] = 255; // B
                                    pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                                }
                            }
                        }

#if 0
                        stbi_write_bmp("QR_bar_code.bmp", width, height, 4, pnew_data);
                        // 使用data进行图像处理...
                        lv_mem_free(pnew_data);
                        stbi_image_free(pdata); // 释放内存

                        //显示图像
                        img = lv_img_create(temp_obj);
                        lv_img_set_src(img, "A:/root/QR_bar_code.bmp");
                        lv_obj_center(img);
#endif

                        sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.bmp",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                        stbi_write_bmp(bmp_name, width, height, 4, pnew_data);
                        // 使用data进行图像处理...
                        lv_mem_free(pnew_data);
                        stbi_image_free(pdata); // 释放内存


                        lv_obj_del(lv_obj_get_child(temp_obj,0));

                        data = stbi_load(bmp_name, &width, &height, &channels, 0);
                        if (!data) 
                        {
                            printf("错误：无法加载图片 %s\n", bmp_name);
                        }
                        printf("图片加载成功：%dx%d，%d 通道\n", width, height, channels);

                        sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.png",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                        
                        success = stbi_write_png(bmp_name, width, height, channels, data, width * channels);
                        if (!success) 
                        {
                            printf("错误：保存 PNG 失败\n");
                        } 
                        else
                        {
                            printf("PNG 保存成功：%s\n", bmp_name);
                        }

                        // 释放内存
                        stbi_image_free(data);

                        //显示图像
                        img = lv_img_create(temp_obj);
                        sprintf(bmp_name_1,"A:%s",bmp_name);
                        lv_img_set_src(img, bmp_name_1);
                        lv_obj_center(img);

                        res = lv_img_decoder_get_info(bmp_name_1, &header);  // 直接传入文件路径

                        if (res == LV_RES_OK)
                        {
                            printf("PNG: %dx%d\n", header.w, header.h);
                        }
                        else
                        {
                            printf("lv_img_decoder_get_info error\n");
                        }

                        lv_img_set_zoom(img,data_structure[win_content_child_num].data.qr_bar.size);

                        width = header.w * data_structure[win_content_child_num].data.qr_bar.size / 256;
                        height = header.h * data_structure[win_content_child_num].data.qr_bar.size / 256;

                        lv_obj_set_size(temp_obj, width, height);

                        lv_obj_align(temp_obj, LV_ALIGN_OUT_TOP_LEFT, data_structure[win_content_child_num].x, data_structure[win_content_child_num].y);

                        break;
                }
            }
        }

        lv_obj_del(btn_addition_QR_code_confirm);
        lv_obj_del(label_addition_QR_code_confirm);
        lv_obj_del(btn_addition_QR_code_return);
        lv_obj_del(label_addition_QR_code_return);
        lv_obj_del(obj_addition_QR_code_bottom_bg);
        lv_obj_del(sw_addition_QR_code_border);
        lv_obj_del(label_addition_QR_code_border);
        lv_obj_del(img_addition_QR_code_border);
        lv_obj_del(label_btn_addition_QR_code_width);
        lv_obj_del(btn_addition_QR_code_width);
        lv_obj_del(label_addition_QR_code_width);
        lv_obj_del(img_addition_QR_code_width);
        lv_obj_del(label_btn_addition_QR_code_bar_code);
        lv_obj_del(btn_addition_QR_code_bar_code);
        lv_obj_del(label_addition_QR_code_bar_code);
        lv_obj_del(img_addition_QR_code_bar_code);
        lv_obj_del(sw_addition_QR_code_figure);
        lv_obj_del(label_addition_QR_code_figure);
        lv_obj_del(img_addition_QR_code_figure);
        lv_obj_del(label_btn_addition_QR_code_height);
        lv_obj_del(btn_addition_QR_code_height);
        lv_obj_del(label_addition_QR_code_height);
        lv_obj_del(img_addition_QR_code_height);
        lv_obj_del(label_btn_addition_QR_code_QR);
        lv_obj_del(btn_addition_QR_code_QR);
        lv_obj_del(label_addition_QR_code_QR);
        lv_obj_del(img_addition_QR_code);
        lv_obj_del(label_btn_addition_QR_code_text);
        lv_obj_del(btn_addition_QR_code_text);
        lv_obj_del(label_addition_QR_code_text);
        lv_obj_del(img_addition_QR_code_text);
        lv_obj_del(addition_QR_code_middle_bg_1);
        lv_obj_del(addition_QR_code_middle_bg);
        lv_obj_del(label_addition_QR_code_head);
        lv_obj_del(addition_QR_code_head_bg);
    }
}


static void modification_QR_code(void)
{
    char tempBuf[32]={0};

    printf("modification_QR_code\n");
    buzzer_enable = 1;
    addition_QR_code_head_bg = lv_obj_create(lv_scr_act());
    lv_obj_set_size(addition_QR_code_head_bg, 480, 24);
    lv_obj_align(addition_QR_code_head_bg, LV_ALIGN_TOP_LEFT, 0, 0);
    lv_obj_set_style_border_width(addition_QR_code_head_bg, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
    lv_obj_set_style_radius(addition_QR_code_head_bg, 0, LV_STATE_DEFAULT); /* 设置圆角 */
    lv_obj_set_style_bg_color(addition_QR_code_head_bg, lv_color_hex(0x28536a), LV_STATE_DEFAULT);
    lv_obj_remove_style(addition_QR_code_head_bg, 0, LV_PART_SCROLLBAR);

    LV_FONT_DECLARE(heiFont16_1);
    label_addition_QR_code_head = lv_label_create(lv_scr_act());
    lv_obj_set_style_text_font(label_addition_QR_code_head, &heiFont16_1, LV_STATE_DEFAULT);
    lv_obj_set_style_text_color(label_addition_QR_code_head, lv_color_hex(0xFFFFFF), LV_STATE_DEFAULT);

    if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
    {
        lv_label_set_text(label_addition_QR_code_head,  "二维码");
    }
    else if(system_data.system.language == LANGUAGE_ENGLISH)
    {
        lv_label_set_text(label_addition_QR_code_head, "QR code");
    }
    lv_obj_align(label_addition_QR_code_head, LV_ALIGN_TOP_LEFT, 200, 4);


    addition_QR_code_middle_bg = lv_obj_create(lv_scr_act());
    lv_obj_set_size(addition_QR_code_middle_bg, 480, 100);
    lv_obj_align(addition_QR_code_middle_bg, LV_ALIGN_TOP_LEFT, 0, 24);
    lv_obj_set_style_border_width(addition_QR_code_middle_bg, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
    lv_obj_set_style_radius(addition_QR_code_middle_bg, 0, LV_STATE_DEFAULT); /* 设置圆角 */
    lv_obj_set_style_bg_color(addition_QR_code_middle_bg, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
    lv_obj_remove_style(addition_QR_code_middle_bg, 0, LV_PART_SCROLLBAR);


    addition_QR_code_middle_bg_1 = lv_obj_create(lv_scr_act());
    lv_obj_set_size(addition_QR_code_middle_bg_1, 480, 124);
    lv_obj_align(addition_QR_code_middle_bg_1, LV_ALIGN_TOP_LEFT, 0, 124);
    lv_obj_set_style_border_width(addition_QR_code_middle_bg_1, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
    lv_obj_set_style_radius(addition_QR_code_middle_bg_1, 0, LV_STATE_DEFAULT); /* 设置圆角 */
    lv_obj_set_style_bg_color(addition_QR_code_middle_bg_1, lv_color_hex(0x1fadd3), LV_STATE_DEFAULT);
    lv_obj_remove_style(addition_QR_code_middle_bg_1, 0, LV_PART_SCROLLBAR);


    LV_IMG_DECLARE(text);
    img_addition_QR_code_text = lv_img_create(lv_scr_act());
    lv_img_set_src(img_addition_QR_code_text, &text);
    lv_obj_align(img_addition_QR_code_text, LV_ALIGN_TOP_LEFT, 10, 130);

    LV_FONT_DECLARE(heiFont16_1);
    label_addition_QR_code_text = lv_label_create(lv_scr_act());
    lv_obj_set_style_text_font(label_addition_QR_code_text, &heiFont16_1, LV_STATE_DEFAULT);
    lv_obj_set_style_text_color(label_addition_QR_code_text, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
    if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
    {
        lv_label_set_text(label_addition_QR_code_text,  "文本");
    }
    else if(system_data.system.language == LANGUAGE_ENGLISH)
    {
        lv_label_set_text(label_addition_QR_code_text, "Text");
    }
    lv_obj_align(label_addition_QR_code_text, LV_ALIGN_TOP_LEFT, 46, 134);


    LV_FONT_DECLARE(heiFont16_1);
    btn_addition_QR_code_text = lv_btn_create(lv_scr_act());
    lv_obj_set_size(btn_addition_QR_code_text, 360, 24);
    lv_obj_align(btn_addition_QR_code_text, LV_ALIGN_TOP_LEFT, 100, 130);
    lv_obj_set_style_border_width(btn_addition_QR_code_text, 1, LV_STATE_DEFAULT); /* 设置边框宽度 */
    lv_obj_set_style_border_color(btn_addition_QR_code_text, lv_color_hex(0xaaaaaa), LV_STATE_DEFAULT); /* 设置边框颜色 */
    lv_obj_set_style_radius(btn_addition_QR_code_text, 10, LV_STATE_DEFAULT); /* 设置圆角 */
    lv_obj_set_style_bg_color(btn_addition_QR_code_text, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
    label_btn_addition_QR_code_text = lv_label_create(btn_addition_QR_code_text);
    lv_obj_set_style_text_font(label_btn_addition_QR_code_text, &heiFont16_1, LV_STATE_DEFAULT);
    lv_obj_set_style_text_color(label_btn_addition_QR_code_text, lv_color_hex(0x000000), LV_STATE_DEFAULT);
    lv_label_set_text(label_btn_addition_QR_code_text, data_structure[g_modification_id].data.qr_bar.text);
    lv_obj_align(label_btn_addition_QR_code_text, LV_ALIGN_CENTER, 0, 0);
    lv_obj_set_style_border_opa(label_btn_addition_QR_code_text, 100, LV_STATE_DEFAULT); /* 设置边框透明度 */
    lv_obj_set_style_radius(label_btn_addition_QR_code_text, 0, LV_STATE_DEFAULT); /* 设置圆角 */
    lv_obj_set_style_bg_opa(label_btn_addition_QR_code_text, LV_OPA_COVER, LV_PART_MAIN);
    lv_obj_set_style_bg_color(label_btn_addition_QR_code_text, lv_color_hex(0xffffff), LV_PART_MAIN);
    lv_obj_add_event_cb(btn_addition_QR_code_text, btn_addition_QR_code_text_event_cb, LV_EVENT_CLICKED, NULL);

    LV_IMG_DECLARE(qr_code);
    img_addition_QR_code = lv_img_create(lv_scr_act());
    lv_img_set_src(img_addition_QR_code, &qr_code);
    lv_obj_align(img_addition_QR_code, LV_ALIGN_TOP_LEFT, 10, 160);

    LV_FONT_DECLARE(heiFont16_1);
    label_addition_QR_code_QR = lv_label_create(lv_scr_act());
    lv_obj_set_style_text_font(label_addition_QR_code_QR, &heiFont16_1, LV_STATE_DEFAULT);
    lv_obj_set_style_text_color(label_addition_QR_code_QR, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
    if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
    {
        lv_label_set_text(label_addition_QR_code_QR,  "二维码");
    }
    else if(system_data.system.language == LANGUAGE_ENGLISH)
    {
        lv_label_set_text(label_addition_QR_code_QR, "QR code");
    }
    lv_obj_align(label_addition_QR_code_QR, LV_ALIGN_TOP_LEFT, 46, 164);

    LV_FONT_DECLARE(heiFont16_1);
    btn_addition_QR_code_QR = lv_btn_create(lv_scr_act());
    lv_obj_set_size(btn_addition_QR_code_QR, 100, 24);
    lv_obj_align(btn_addition_QR_code_QR, LV_ALIGN_TOP_LEFT,100, 160);
    lv_obj_set_style_border_width(btn_addition_QR_code_QR, 1, LV_STATE_DEFAULT); /* 设置边框宽度 */
    lv_obj_set_style_border_color(btn_addition_QR_code_QR, lv_color_hex(0x000000), LV_STATE_DEFAULT); /* 设置边框颜色 */
    lv_obj_set_style_radius(btn_addition_QR_code_QR, 10, LV_STATE_DEFAULT); /* 设置圆角 */
    lv_obj_set_style_bg_color(btn_addition_QR_code_QR, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
    label_btn_addition_QR_code_QR = lv_label_create(btn_addition_QR_code_QR);
    lv_obj_set_style_text_font(label_btn_addition_QR_code_QR, &heiFont16_1, LV_STATE_DEFAULT);
    lv_obj_set_style_text_color(label_btn_addition_QR_code_QR, lv_color_hex(0x000000), LV_STATE_DEFAULT);


    if(data_structure[g_modification_id].type == TYPE_QR)
    {
        lv_label_set_text(label_btn_addition_QR_code_QR,  QR_code_name[data_structure[g_modification_id].data.qr_bar.symbology]);  
        QR_or_bar_code_flag = 0;
        QR_code_type = data_structure[g_modification_id].data.qr_bar.symbology;
    }
    else
    {
       lv_label_set_text(label_btn_addition_QR_code_QR, "");  
       QR_or_bar_code_flag = 1;
       bar_code_type = data_structure[g_modification_id].data.qr_bar.symbology;
    }
   
    lv_obj_align(label_btn_addition_QR_code_QR, LV_ALIGN_CENTER, 0, 0);
    lv_obj_set_style_border_width(label_btn_addition_QR_code_QR, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
    lv_obj_set_style_border_color(label_btn_addition_QR_code_QR, lv_color_hex(0x000000), LV_STATE_DEFAULT); /* 设置边框颜色 */
    lv_obj_set_style_border_opa(label_btn_addition_QR_code_QR, 100, LV_STATE_DEFAULT); /* 设置边框透明度 */
    lv_obj_set_style_radius(label_btn_addition_QR_code_QR, 0, LV_STATE_DEFAULT); /* 设置圆角 */
    lv_obj_set_style_bg_opa(label_btn_addition_QR_code_QR, LV_OPA_COVER, LV_PART_MAIN);
    lv_obj_set_style_bg_color(label_btn_addition_QR_code_QR, lv_color_hex(0xffffff), LV_PART_MAIN);
    lv_obj_add_event_cb(btn_addition_QR_code_QR, btn_addition_QR_code_QR_event_cb, LV_EVENT_CLICKED, NULL);


    LV_IMG_DECLARE(word_size);
    img_addition_QR_code_height = lv_img_create(lv_scr_act());
    lv_img_set_src(img_addition_QR_code_height, &word_size);
    lv_obj_align(img_addition_QR_code_height, LV_ALIGN_TOP_LEFT, 10, 190);

    LV_FONT_DECLARE(heiFont16_1);
    label_addition_QR_code_height = lv_label_create(lv_scr_act());
    lv_obj_set_style_text_font(label_addition_QR_code_height, &heiFont16_1, LV_STATE_DEFAULT);
    lv_obj_set_style_text_color(label_addition_QR_code_height, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
    if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
    {
        lv_label_set_text(label_addition_QR_code_height,  "高度");
    }
    else if(system_data.system.language == LANGUAGE_ENGLISH)
    {
        lv_label_set_text(label_addition_QR_code_height, "Height");
    }
    lv_obj_align(label_addition_QR_code_height, LV_ALIGN_TOP_LEFT, 46, 194);

    LV_FONT_DECLARE(heiFont16_1);
    btn_addition_QR_code_height = lv_btn_create(lv_scr_act());
    lv_obj_set_size(btn_addition_QR_code_height, 100, 24);
    lv_obj_align(btn_addition_QR_code_height, LV_ALIGN_TOP_LEFT, 100, 190);
    lv_obj_set_style_border_width(btn_addition_QR_code_height, 1, LV_STATE_DEFAULT); /* 设置边框宽度 */
    lv_obj_set_style_border_color(btn_addition_QR_code_height, lv_color_hex(0x000000), LV_STATE_DEFAULT); /* 设置边框颜色 */
    lv_obj_set_style_radius(btn_addition_QR_code_height, 10, LV_STATE_DEFAULT); /* 设置圆角 */
    lv_obj_set_style_bg_color(btn_addition_QR_code_height, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
    label_btn_addition_QR_code_height = lv_label_create(btn_addition_QR_code_height);
    lv_obj_set_style_text_font(label_btn_addition_QR_code_height, &heiFont16_1, LV_STATE_DEFAULT);
    lv_obj_set_style_text_color(label_btn_addition_QR_code_height, lv_color_hex(0x000000), LV_STATE_DEFAULT);
    sprintf(tempBuf,"%d",data_structure[g_modification_id].data.qr_bar.height);
    lv_label_set_text(label_btn_addition_QR_code_height, tempBuf);
    lv_obj_align(label_btn_addition_QR_code_height, LV_ALIGN_CENTER, 0, 0);
    lv_obj_set_style_border_width(label_btn_addition_QR_code_height, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
    lv_obj_set_style_border_color(label_btn_addition_QR_code_height, lv_color_hex(0x000000), LV_STATE_DEFAULT); /* 设置边框颜色 */
    lv_obj_set_style_border_opa(label_btn_addition_QR_code_height, 100, LV_STATE_DEFAULT); /* 设置边框透明度 */
    lv_obj_set_style_radius(label_btn_addition_QR_code_height, 0, LV_STATE_DEFAULT); /* 设置圆角 */
    lv_obj_set_style_bg_opa(label_btn_addition_QR_code_height, LV_OPA_COVER, LV_PART_MAIN);
    lv_obj_set_style_bg_color(label_btn_addition_QR_code_height, lv_color_hex(0xffffff), LV_PART_MAIN);
    lv_obj_add_event_cb(btn_addition_QR_code_height, btn_addition_QR_code_height_event_cb, LV_EVENT_CLICKED, NULL);


    LV_IMG_DECLARE(figure);
    img_addition_QR_code_figure = lv_img_create(lv_scr_act());
    lv_img_set_src(img_addition_QR_code_figure, &figure);
    lv_obj_align(img_addition_QR_code_figure, LV_ALIGN_TOP_LEFT, 10, 220);

    LV_FONT_DECLARE(heiFont16_1);
    label_addition_QR_code_figure = lv_label_create(lv_scr_act());
    lv_obj_set_style_text_font(label_addition_QR_code_figure, &heiFont16_1, LV_STATE_DEFAULT);
    lv_obj_set_style_text_color(label_addition_QR_code_figure, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
    if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
    {
        lv_label_set_text(label_addition_QR_code_figure,  "数字");
    }
    else if(system_data.system.language == LANGUAGE_ENGLISH)
    {
        lv_label_set_text(label_addition_QR_code_figure, "Figure");
    }
    lv_obj_align(label_addition_QR_code_figure, LV_ALIGN_TOP_LEFT, 46, 224);


    sw_addition_QR_code_figure = lv_switch_create(lv_scr_act());
    lv_obj_set_pos(sw_addition_QR_code_figure, 100, 220);
    lv_obj_set_width(sw_addition_QR_code_figure, 48);
    lv_obj_set_height(sw_addition_QR_code_figure, 23);
    lv_obj_set_style_bg_color(sw_addition_QR_code_figure, lv_color_hex(0x00ff00), LV_STATE_CHECKED | LV_PART_INDICATOR);
    lv_obj_add_event_cb(sw_addition_QR_code_figure, sw_addition_QR_code_border_event_cb, LV_EVENT_ALL, NULL);



    LV_IMG_DECLARE(bar_code);
    img_addition_QR_code_bar_code = lv_img_create(lv_scr_act());
    lv_img_set_src(img_addition_QR_code_bar_code, &bar_code);
    lv_obj_align(img_addition_QR_code_bar_code, LV_ALIGN_TOP_LEFT, 240, 160);

    LV_FONT_DECLARE(heiFont16_1);
    label_addition_QR_code_bar_code = lv_label_create(lv_scr_act());
    lv_obj_set_style_text_font(label_addition_QR_code_bar_code, &heiFont16_1, LV_STATE_DEFAULT);
    lv_obj_set_style_text_color(label_addition_QR_code_bar_code, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
    if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
    {
        lv_label_set_text(label_addition_QR_code_bar_code,  "条形码");
    }
    else if(system_data.system.language == LANGUAGE_ENGLISH)
    {
        lv_label_set_text(label_addition_QR_code_bar_code, "Bar code");
    }
    lv_obj_align(label_addition_QR_code_bar_code, LV_ALIGN_TOP_LEFT, 276, 164);

    LV_FONT_DECLARE(heiFont16_1);
    btn_addition_QR_code_bar_code = lv_btn_create(lv_scr_act());
    lv_obj_set_size(btn_addition_QR_code_bar_code, 100, 24);
    lv_obj_align(btn_addition_QR_code_bar_code, LV_ALIGN_TOP_LEFT, 330, 160);
    lv_obj_set_style_border_width(btn_addition_QR_code_bar_code, 1, LV_STATE_DEFAULT); /* 设置边框宽度 */
    lv_obj_set_style_border_color(btn_addition_QR_code_bar_code, lv_color_hex(0x000000), LV_STATE_DEFAULT); /* 设置边框颜色 */
    lv_obj_set_style_radius(btn_addition_QR_code_bar_code, 10, LV_STATE_DEFAULT); /* 设置圆角 */
    lv_obj_set_style_bg_color(btn_addition_QR_code_bar_code, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
    label_btn_addition_QR_code_bar_code = lv_label_create(btn_addition_QR_code_bar_code);
    lv_obj_set_style_text_font(label_btn_addition_QR_code_bar_code, &heiFont16_1, LV_STATE_DEFAULT);
    lv_obj_set_style_text_color(label_btn_addition_QR_code_bar_code, lv_color_hex(0x000000), LV_STATE_DEFAULT);
    if(data_structure[g_modification_id].type == TYPE_BAR)
    {
        lv_label_set_text(label_btn_addition_QR_code_bar_code,  bar_code_name[data_structure[g_modification_id].data.qr_bar.symbology]); 
        
    }
    else
    {
        lv_label_set_text(label_btn_addition_QR_code_bar_code, "");  
    }

    lv_obj_align(label_btn_addition_QR_code_bar_code, LV_ALIGN_CENTER, 0, 0);
    lv_obj_set_style_border_width(label_btn_addition_QR_code_bar_code, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
    lv_obj_set_style_border_color(label_btn_addition_QR_code_bar_code, lv_color_hex(0x000000), LV_STATE_DEFAULT); /* 设置边框颜色 */
    lv_obj_set_style_border_opa(label_btn_addition_QR_code_bar_code, 100, LV_STATE_DEFAULT); /* 设置边框透明度 */
    lv_obj_set_style_radius(label_btn_addition_QR_code_bar_code, 0, LV_STATE_DEFAULT); /* 设置圆角 */
    lv_obj_set_style_bg_opa(label_btn_addition_QR_code_bar_code, LV_OPA_COVER, LV_PART_MAIN);
    lv_obj_set_style_bg_color(label_btn_addition_QR_code_bar_code, lv_color_hex(0xffffff), LV_PART_MAIN);
    lv_obj_add_event_cb(btn_addition_QR_code_bar_code, btn_addition_QR_code_bar_code_event_cb, LV_EVENT_CLICKED, NULL);


    LV_IMG_DECLARE(width);
    img_addition_QR_code_width = lv_img_create(lv_scr_act());
    lv_img_set_src(img_addition_QR_code_width, &width);
    lv_obj_align(img_addition_QR_code_width, LV_ALIGN_TOP_LEFT, 240, 190);

    LV_FONT_DECLARE(heiFont16_1);
    label_addition_QR_code_width = lv_label_create(lv_scr_act());
    lv_obj_set_style_text_font(label_addition_QR_code_width, &heiFont16_1, LV_STATE_DEFAULT);
    lv_obj_set_style_text_color(label_addition_QR_code_width, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
    if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
    {
        lv_label_set_text(label_addition_QR_code_width,  "宽度");
    }
    else if(system_data.system.language == LANGUAGE_ENGLISH)
    {
        lv_label_set_text(label_addition_QR_code_width, "Width");
    }
    lv_obj_align(label_addition_QR_code_width, LV_ALIGN_TOP_LEFT, 276, 194);

    LV_FONT_DECLARE(heiFont16_1);
    btn_addition_QR_code_width = lv_btn_create(lv_scr_act());
    lv_obj_set_size(btn_addition_QR_code_width, 100, 24);
    lv_obj_align(btn_addition_QR_code_width, LV_ALIGN_TOP_LEFT, 330, 190);
    lv_obj_set_style_border_width(btn_addition_QR_code_width, 1, LV_STATE_DEFAULT); /* 设置边框宽度 */
    lv_obj_set_style_border_color(btn_addition_QR_code_width, lv_color_hex(0x000000), LV_STATE_DEFAULT); /* 设置边框颜色 */
    lv_obj_set_style_radius(btn_addition_QR_code_width, 10, LV_STATE_DEFAULT); /* 设置圆角 */
    lv_obj_set_style_bg_color(btn_addition_QR_code_width, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
    label_btn_addition_QR_code_width = lv_label_create(btn_addition_QR_code_width);
    lv_obj_set_style_text_font(label_btn_addition_QR_code_width, &heiFont16_1, LV_STATE_DEFAULT);
    lv_obj_set_style_text_color(label_btn_addition_QR_code_width, lv_color_hex(0x000000), LV_STATE_DEFAULT);
    sprintf(tempBuf,"%d",data_structure[g_modification_id].data.qr_bar.width);
    lv_label_set_text(label_btn_addition_QR_code_width, tempBuf);
    lv_obj_align(label_btn_addition_QR_code_width, LV_ALIGN_CENTER, 0, 0);
    lv_obj_set_style_border_width(label_btn_addition_QR_code_width, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
    lv_obj_set_style_border_color(label_btn_addition_QR_code_width, lv_color_hex(0x000000), LV_STATE_DEFAULT); /* 设置边框颜色 */
    lv_obj_set_style_border_opa(label_btn_addition_QR_code_width, 100, LV_STATE_DEFAULT); /* 设置边框透明度 */
    lv_obj_set_style_radius(label_btn_addition_QR_code_width, 0, LV_STATE_DEFAULT); /* 设置圆角 */
    lv_obj_set_style_bg_opa(label_btn_addition_QR_code_width, LV_OPA_COVER, LV_PART_MAIN);
    lv_obj_set_style_bg_color(label_btn_addition_QR_code_width, lv_color_hex(0xffffff), LV_PART_MAIN);
    lv_obj_add_event_cb(btn_addition_QR_code_width, btn_addition_QR_code_width_event_cb, LV_EVENT_CLICKED, NULL);


    LV_IMG_DECLARE(border);
    img_addition_QR_code_border = lv_img_create(lv_scr_act());
    lv_img_set_src(img_addition_QR_code_border, &border);
    lv_obj_align(img_addition_QR_code_border, LV_ALIGN_TOP_LEFT, 240, 220);

    LV_FONT_DECLARE(heiFont16_1);
    label_addition_QR_code_border = lv_label_create(lv_scr_act());
    lv_obj_set_style_text_font(label_addition_QR_code_border, &heiFont16_1, LV_STATE_DEFAULT);
    lv_obj_set_style_text_color(label_addition_QR_code_border, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
    if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
    {
        lv_label_set_text(label_addition_QR_code_border,  "边框");
    }
    else if(system_data.system.language == LANGUAGE_ENGLISH)
    {
        lv_label_set_text(label_addition_QR_code_border, "Border");
    }
    lv_obj_align(label_addition_QR_code_border, LV_ALIGN_TOP_LEFT, 276, 224);


    sw_addition_QR_code_border = lv_switch_create(lv_scr_act());
    lv_obj_set_pos(sw_addition_QR_code_border, 330, 220);
    lv_obj_set_width(sw_addition_QR_code_border, 48);
    lv_obj_set_height(sw_addition_QR_code_border, 23);
    lv_obj_set_style_bg_color(sw_addition_QR_code_border, lv_color_hex(0x00ff00), LV_STATE_CHECKED | LV_PART_INDICATOR);
    lv_obj_add_event_cb(sw_addition_QR_code_border, sw_addition_QR_code_border_event_cb, LV_EVENT_ALL, NULL);

    obj_addition_QR_code_bottom_bg = lv_obj_create(lv_scr_act());
    lv_obj_set_size(obj_addition_QR_code_bottom_bg, 480, 24);
    lv_obj_align(obj_addition_QR_code_bottom_bg, LV_ALIGN_TOP_LEFT, 0, 248);
    lv_obj_set_style_border_width(obj_addition_QR_code_bottom_bg, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
    lv_obj_set_style_radius(obj_addition_QR_code_bottom_bg, 0, LV_STATE_DEFAULT); /* 设置圆角 */
    lv_obj_set_style_bg_color(obj_addition_QR_code_bottom_bg, lv_color_hex(0x28536a), LV_STATE_DEFAULT);
    lv_obj_remove_style(obj_addition_QR_code_bottom_bg, 0, LV_PART_SCROLLBAR);

    
    LV_FONT_DECLARE(heiFont16_1);
    label_addition_QR_code_return = lv_label_create(lv_scr_act());
    lv_obj_set_style_text_font(label_addition_QR_code_return, &heiFont16_1, LV_STATE_DEFAULT);
    lv_obj_set_style_text_color(label_addition_QR_code_return, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
    if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
    {
        lv_label_set_text(label_addition_QR_code_return,  "返回");
    }
    else if(system_data.system.language == LANGUAGE_ENGLISH)
    {
        lv_label_set_text(label_addition_QR_code_return, "Return");
    }
    lv_obj_align(label_addition_QR_code_return, LV_ALIGN_TOP_LEFT, 140, 252);

    LV_IMG_DECLARE(get_back);
    btn_addition_QR_code_return = lv_imgbtn_create(lv_scr_act());
    lv_imgbtn_set_src(btn_addition_QR_code_return, LV_IMGBTN_STATE_RELEASED, NULL, &get_back, NULL);
    lv_obj_set_size(btn_addition_QR_code_return, get_back.header.w, get_back.header.h);
    lv_obj_align(btn_addition_QR_code_return, LV_ALIGN_TOP_LEFT, 180, 250);
    lv_obj_add_event_cb(btn_addition_QR_code_return, btn_modification_QR_code_return_event_cb, LV_EVENT_CLICKED, NULL);

    LV_IMG_DECLARE(confirm);
    btn_addition_QR_code_confirm = lv_imgbtn_create(lv_scr_act());
    lv_imgbtn_set_src(btn_addition_QR_code_confirm, LV_IMGBTN_STATE_RELEASED, NULL, &confirm, NULL);
    lv_obj_set_size(btn_addition_QR_code_confirm, get_back.header.w, get_back.header.h);
    lv_obj_align(btn_addition_QR_code_confirm, LV_ALIGN_TOP_LEFT, 250, 250);
    lv_obj_add_event_cb(btn_addition_QR_code_confirm, btn_modification_QR_code_confirm_event_cb, LV_EVENT_CLICKED, NULL);

    LV_FONT_DECLARE(heiFont16_1);
    label_addition_QR_code_confirm = lv_label_create(lv_scr_act());
    lv_obj_set_style_text_font(label_addition_QR_code_confirm, &heiFont16_1, LV_STATE_DEFAULT);
    lv_obj_set_style_text_color(label_addition_QR_code_confirm, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
    if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
    {
        lv_label_set_text(label_addition_QR_code_confirm,  "确定");
    }
    else if(system_data.system.language == LANGUAGE_ENGLISH)
    {
        lv_label_set_text(label_addition_QR_code_confirm, "Confirm");
    }
    lv_obj_align(label_addition_QR_code_confirm, LV_ALIGN_TOP_LEFT, 277, 252); 

    update_preview_QR_bar_code();
}





//文本界面，默认字体，思源1
//新建的时候，先收集数据
//再依次更新
static void button_modification_date_time_confirm_event_cb(lv_event_t* e)
{
    lv_event_code_t code;
    code = lv_event_get_code(e);
    //char temp_typeface[128] = { 0 };
    int i = 0;
    int word_space = 0;
    int word_size = 0;
    //int x_size = 0;
    //int y_size = 0;
    int win_content_child_num = 0;
    //char tempString[128] = { 0 };

    if (code == LV_EVENT_CLICKED)
    {
        printf("button_date_time_confirm_event_cb\n");
        buzzer_enable = 1;

        //lv_style_reset(&data_structure[g_modification_id].data.date_time.style);
        //lv_ft_font_destroy(data_structure[g_modification_id].data.date_time.info.font);

        int len = strlen(lv_label_get_text(label_addition_date_middle));
        printf("len=%u\n\r", len);

        win_content_child_num = g_modification_id;

        if (len > 0)
        {
            lv_obj_t* temp_obj = lv_obj_get_child(win_content,g_modification_id);

            for (i = 0; i < TYPEFACE_NUMBER; i++)
            {
                if (strncmp(lv_label_get_text(label_btn_addition_date_typeface), typeface_name[i], strlen(lv_label_get_text(label_btn_addition_date_typeface))) == 0)
                {
                    break;
                }
            }

            printf("i=%d\n\r",i);

            //sprintf(temp_typeface, "/media/%s", typeface_buf[i]);
            data_structure[win_content_child_num].data.date_time.typeface = i;

            //info.name = "./lvgl/src/extra/libs/freetype/arial.ttf";
            //info.name = "./lvgl/src/extra/libs/freetype/simsun.ttc";
            //sprintf(temp_typeface, "./lvgl/src/extra/libs/freetype/%s", typeface_buf[SOURCE_HAN_SERIF_CN_REGULAR_1]);
            //printf("%s\n", temp_typeface);

            //data_structure[win_content_child_num].data.date_time.info.name = temp_typeface;

            word_size = atoi(lv_label_get_text(label_btn_addition_date_word_size));

            if (word_size < 12)
            {
                word_size = 12;
            }

            if (word_size > WORD_MAX_SIZE)
            {
                word_size = WORD_MAX_SIZE;
            }

            printf("word_size=%u\n\r",word_size);

            data_structure[win_content_child_num].data.date_time.info.weight = word_size;

            data_structure[win_content_child_num].data.date_time.spin = atoi(lv_label_get_text(label_btn_addition_date_spin));

            printf("spin=%u\n\r", data_structure[win_content_child_num].data.date_time.spin);

            data_structure[win_content_child_num].data.date_time.info.style = FT_FONT_STYLE_NORMAL;

            if (lv_obj_has_state(sw_addition_date_italic, LV_STATE_CHECKED) == 1)
            {
                data_structure[win_content_child_num].data.date_time.info.style |= FT_FONT_STYLE_ITALIC;
            }

            if (lv_obj_has_state(sw_addition_date_bold, LV_STATE_CHECKED) == 1)
            {
                data_structure[win_content_child_num].data.date_time.info.style |= FT_FONT_STYLE_BOLD;
            }

            printf("style=%u\n\r", data_structure[win_content_child_num].data.date_time.info.style);

            word_space = atoi(lv_label_get_text(label_btn_addition_date_word_space));

            if (word_space < 0)
            {
                word_space = 0;
            }

            if (word_space > WORD_MAX_SIZE)
            {
                word_space = WORD_MAX_SIZE;
            }

            printf("word_space=%u\n\r", word_space);

            //lv_ft_font_init(&data_structure[win_content_child_num].data.date_time.info);
            //lv_point_t text_size;
            //lv_txt_get_size(&text_size, lv_label_get_text(label_addition_date_middle), data_structure[win_content_child_num].data.date_time.info.font, 0, 0, LV_COORD_MAX, LV_TEXT_FLAG_NONE);

            lv_font_t* temp_font = font_list_get(i, word_size, data_structure[win_content_child_num].data.date_time.info.style);
            lv_point_t text_size;
            lv_txt_get_size(&text_size, lv_label_get_text(label_addition_date_middle), temp_font, word_space, 0, LV_COORD_MAX, LV_TEXT_FLAG_NONE);

            //lv_obj_set_style_bg_opa(temp_obj, LV_OPA_TRANSP, 0);
            //lv_obj_set_style_border_width(temp_obj, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */

            //lv_obj_add_event_cb(temp_obj, drag_event_handler, LV_EVENT_PRESSING, NULL);
            //lv_obj_add_event_cb(temp_obj, drag_event_handler, LV_EVENT_FOCUSED, NULL);
            //lv_obj_add_event_cb(temp_obj, drag_event_handler, LV_EVENT_DEFOCUSED, NULL);
            //lv_obj_clear_flag(temp_obj, LV_OBJ_FLAG_SCROLLABLE);

            lv_style_init(&data_structure[win_content_child_num].data.date_time.style);
            lv_style_set_text_font(&data_structure[win_content_child_num].data.date_time.style, temp_font);

            printf("x=%u y=%u\n\r", text_size.x, text_size.y);

            lv_obj_set_size(temp_obj, text_size.x, text_size.y);
            lv_obj_set_style_transform_angle(temp_obj, data_structure[win_content_child_num].data.date_time.spin * 10, 0);

            if (data_structure[win_content_child_num].data.date_time.spin != 0)
            {
                lv_obj_align(temp_obj, LV_ALIGN_TOP_LEFT, 200, 70);
            }

            lv_style_set_text_letter_space(&data_structure[win_content_child_num].data.date_time.style, word_space);
            lv_obj_del(lv_obj_get_child(temp_obj,0));

            lv_obj_t* label1 = lv_label_create(temp_obj);
            lv_obj_add_style(label1, &data_structure[win_content_child_num].data.date_time.style, 0);
            lv_label_set_text(label1, lv_label_get_text(label_addition_date_middle));
            lv_obj_center(label1);
            strncpy(data_structure[win_content_child_num].data.date_time.text, lv_label_get_text(label_addition_date_middle), len);
            data_structure[win_content_child_num].data.date_time.size = word_size;
            data_structure[win_content_child_num].data.date_time.space = word_space;
            data_structure[win_content_child_num].data.date_time.italic_bold = data_structure[win_content_child_num].data.date_time.info.style;
            printf("italic_bold=%d\n\r", data_structure[win_content_child_num].data.date_time.italic_bold);
            printf("text=%s\n\r", data_structure[win_content_child_num].data.date_time.text);
            data_structure[win_content_child_num].data.date_time.date_or_time = date_or_time_flag;

            if(date_or_time_flag == 0)
            {
                 data_structure[win_content_child_num].data.date_time.date_or_time_type = g_date_type;
            }
            else if(date_or_time_flag == 2)
            {
                 data_structure[win_content_child_num].data.date_time.date_or_time_type = g_date_type;
                 data_structure[win_content_child_num].data.date_time.year = validity_date.year;
                 data_structure[win_content_child_num].data.date_time.month = validity_date.month;
                 data_structure[win_content_child_num].data.date_time.day = validity_date.day;
            }
            else
            {
                data_structure[win_content_child_num].data.date_time.date_or_time_type = g_time_type;
            }
                      
            data_structure[win_content_child_num].type = TYPE_DATE;
        }
        
        lv_obj_del(label_addition_date_time_confirm);
        lv_obj_del(imgbtn_addition_date_time_confirm);
        lv_obj_del(imgbtn_addition_date_time_return);
        lv_obj_del(label_addition_date_time_return);
        lv_obj_del(addition_date_bottom_bg);
        lv_obj_del(sw_addition_date_italic);
        lv_obj_del(label_addition_date_italic);
        lv_obj_del(img_addition_date_italic);
        lv_obj_del(sw_addition_date_bold);
        lv_obj_del(label_addition_date_bold);
        lv_obj_del(img_btn_addition_date_bold);
        lv_obj_del(label_btn_addition_date_spin);
        lv_obj_del(btn_addition_date_spin);
        lv_obj_del(label_addition_date_spin);
        lv_obj_del(img_addition_date_spin);

        lv_obj_del(label_btn_addition_date_word_space);
        lv_obj_del(btn_addition_date_word_space);
        lv_obj_del(label_addition_date_word_space);
        lv_obj_del(img_addition_date_word_space);
        lv_obj_del(label_btn_addition_date_word_size);
        lv_obj_del(btn_addition_date_word_size);
        lv_obj_del(label_addition_date_word_size);
        lv_obj_del(img_addition_date_word_size);
        lv_obj_del(label_btn_addition_date_typeface);
        lv_obj_del(btn_addition_date_typeface);
        lv_obj_del(label_addition_date_typeface);
        lv_obj_del(img_addition_date_typeface);
        lv_obj_del(label_btn_label_addition_time);
        lv_obj_del(btn_label_addition_time);
        lv_obj_del(label_addition_time);
        lv_obj_del(img_addition_time);
        lv_obj_del(label_btn_addition_date_text);
        lv_obj_del(btn_addition_date_text);
        lv_obj_del(label_addition_date_text);
        lv_obj_del(img_addition_date_text);
        lv_obj_del(addition_date_middle_bg);
        lv_obj_del(label_addition_date_middle_bg);
        lv_obj_del(label_addition_date_middle);
        lv_obj_del(label_addition_date_head);
        lv_obj_del(addition_date_head_bg);

    }
}



static void button_modification_date_time_return_event_cb(lv_event_t* e)
{
    lv_event_code_t code;
    code = lv_event_get_code(e);

    if (code == LV_EVENT_CLICKED)
    {
        printf("button_modification_date_time_return_event_cb\n");
        buzzer_enable = 1;
        lv_obj_del(label_addition_date_time_confirm);
        lv_obj_del(imgbtn_addition_date_time_confirm);
        lv_obj_del(imgbtn_addition_date_time_return);
        lv_obj_del(label_addition_date_time_return);
        lv_obj_del(addition_date_bottom_bg);
        lv_obj_del(sw_addition_date_italic);
        lv_obj_del(label_addition_date_italic);
        lv_obj_del(img_addition_date_italic);
        lv_obj_del(sw_addition_date_bold);
        lv_obj_del(label_addition_date_bold);
        lv_obj_del(img_btn_addition_date_bold);
        lv_obj_del(label_btn_addition_date_spin);
        lv_obj_del(btn_addition_date_spin);
        lv_obj_del(label_addition_date_spin);
        lv_obj_del(img_addition_date_spin);

        lv_obj_del(label_btn_addition_date_word_space);
        lv_obj_del(btn_addition_date_word_space);
        lv_obj_del(label_addition_date_word_space);
        lv_obj_del(img_addition_date_word_space);
        lv_obj_del(label_btn_addition_date_word_size);
        lv_obj_del(btn_addition_date_word_size);
        lv_obj_del(label_addition_date_word_size);
        lv_obj_del(img_addition_date_word_size);
        lv_obj_del(label_btn_addition_date_typeface);
        lv_obj_del(btn_addition_date_typeface);
        lv_obj_del(label_addition_date_typeface);
        lv_obj_del(img_addition_date_typeface);
        lv_obj_del(label_btn_label_addition_time);
        lv_obj_del(btn_label_addition_time);
        lv_obj_del(label_addition_time);
        lv_obj_del(img_addition_time);
        lv_obj_del(label_btn_addition_date_text);
        lv_obj_del(btn_addition_date_text);
        lv_obj_del(label_addition_date_text);
        lv_obj_del(img_addition_date_text);
        lv_obj_del(addition_date_middle_bg);
        lv_obj_del(label_addition_date_middle_bg);
        lv_obj_del(label_addition_date_middle);
        lv_obj_del(label_addition_date_head);
        lv_obj_del(addition_date_head_bg);
    }
}




/*
10,134,45,139,95,136    250,134,285,139,338,136
10,162,45,167,95,164
10,190,45,195,95,192
*/

static void modification_date(void)
{
    //lv_event_code_t code;
    char date_time_str[128]={0};
    int now_year = 0;
    int now_month = 0;
    int now_day = 0;
    int end_year = 0;
    int end_month = 0;
    int end_day = 0;

    printf("modification_date\n\r");

    flag_modification_or_addition = 1;

    addition_date_head_bg = lv_obj_create(lv_scr_act());
    lv_obj_set_size(addition_date_head_bg, 480, 24);
    lv_obj_align(addition_date_head_bg, LV_ALIGN_TOP_LEFT, 0, 0);
    lv_obj_set_style_border_width(addition_date_head_bg, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
    lv_obj_set_style_radius(addition_date_head_bg, 0, LV_STATE_DEFAULT); /* 设置圆角 */
    lv_obj_set_style_bg_color(addition_date_head_bg, lv_color_hex(0x28536a), LV_STATE_DEFAULT);
    lv_obj_remove_style(addition_date_head_bg, 0, LV_PART_SCROLLBAR);

    LV_FONT_DECLARE(heiFont16_1);
    label_addition_date_head = lv_label_create(lv_scr_act());
    lv_obj_set_style_text_font(label_addition_date_head, &heiFont16_1, LV_STATE_DEFAULT);
    lv_obj_set_style_text_color(label_addition_date_head, lv_color_hex(0xFFFFFF), LV_STATE_DEFAULT);
    if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
    {
        lv_label_set_text(label_addition_date_head,  "日期和时间");
    }
    else if(system_data.system.language == LANGUAGE_ENGLISH)
    {
        lv_label_set_text(label_addition_date_head, "Date & Time");
    }
    lv_obj_align(label_addition_date_head, LV_ALIGN_TOP_LEFT, 200, 4);


    label_addition_date_middle_bg = lv_obj_create(lv_scr_act());
    lv_obj_set_size(label_addition_date_middle_bg, 480, 140);
    lv_obj_align(label_addition_date_middle_bg, LV_ALIGN_TOP_LEFT, 0, 24);
    lv_obj_set_style_border_width(label_addition_date_middle_bg, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
    lv_obj_set_style_radius(label_addition_date_middle_bg, 0, LV_STATE_DEFAULT); /* 设置圆角 */
    lv_obj_set_style_bg_color(label_addition_date_middle_bg, lv_color_hex(0xffffff), LV_STATE_DEFAULT);


    LV_FONT_DECLARE(heiFont16_1);
    label_addition_date_middle = lv_label_create(lv_scr_act());
    lv_obj_set_width(label_addition_date_middle, 480);
    lv_obj_set_height(label_addition_date_middle, 108);
    lv_obj_set_style_text_font(label_addition_date_middle, &heiFont16_1, LV_STATE_DEFAULT);
    lv_obj_set_style_text_color(label_addition_date_middle, lv_color_hex(0x000000), LV_STATE_DEFAULT);
    //lv_label_set_text(label_addition_date_middle, data_structure[g_modification_id].data.date_time.text);
    lv_obj_set_style_bg_color(label_addition_date_middle, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
    lv_obj_align(label_addition_date_middle, LV_ALIGN_TOP_LEFT, 0, 24);


    addition_date_middle_bg = lv_obj_create(lv_scr_act());
    lv_obj_set_size(addition_date_middle_bg, 480, 140);
    lv_obj_align(addition_date_middle_bg, LV_ALIGN_TOP_LEFT, 0, 132);
    lv_obj_set_style_border_width(addition_date_middle_bg, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
    lv_obj_set_style_radius(addition_date_middle_bg, 0, LV_STATE_DEFAULT); /* 设置圆角 */
    lv_obj_set_style_bg_color(addition_date_middle_bg, lv_color_hex(0x1fadd3), LV_STATE_DEFAULT);

    LV_IMG_DECLARE(date);
    img_addition_date_text = lv_img_create(lv_scr_act());
    lv_img_set_src(img_addition_date_text, &date);
    lv_obj_align(img_addition_date_text, LV_ALIGN_TOP_LEFT, 10, 134);

    LV_FONT_DECLARE(heiFont16_1);
    label_addition_date_text = lv_label_create(lv_scr_act());
    lv_obj_set_style_text_font(label_addition_date_text, &heiFont16_1, LV_STATE_DEFAULT);
    lv_obj_set_style_text_color(label_addition_date_text, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
    if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
    {
        lv_label_set_text(label_addition_date_text,  "日期");
    }
    else if(system_data.system.language == LANGUAGE_ENGLISH)
    {
        lv_label_set_text(label_addition_date_text, "Date");
    }
    lv_obj_align(label_addition_date_text, LV_ALIGN_TOP_LEFT, 45, 139);

    LV_FONT_DECLARE(heiFont16_1);
    btn_addition_date_text = lv_btn_create(lv_scr_act());
    lv_obj_set_size(btn_addition_date_text, 125, 24);
    lv_obj_align(btn_addition_date_text, LV_ALIGN_TOP_LEFT, 95, 136);
    lv_obj_set_style_border_width(btn_addition_date_text, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
    lv_obj_set_style_radius(btn_addition_date_text, 0, LV_STATE_DEFAULT); /* 设置圆角 */
    lv_obj_set_style_bg_color(btn_addition_date_text, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
    label_btn_addition_date_text = lv_label_create(btn_addition_date_text);
    lv_obj_set_style_text_font(label_btn_addition_date_text, &heiFont16_1, LV_STATE_DEFAULT);
    lv_obj_set_style_text_color(label_btn_addition_date_text, lv_color_hex(0x1C1C1C), LV_STATE_DEFAULT);
            
    printf("date_or_time=%d\n\r",data_structure[g_modification_id].data.date_time.date_or_time);
    printf("date_or_time_type=%d\n\r",data_structure[g_modification_id].data.date_time.date_or_time_type);
    if(data_structure[g_modification_id].data.date_time.date_or_time == 0)
    {
        switch(data_structure[g_modification_id].data.date_time.date_or_time_type)
        {
            case 0:
                sprintf(date_time_str, "%04d/%02d/%02d", 2000 + g_system_time[0], g_system_time[1], g_system_time[2]);
                break;
            case 1:
                sprintf(date_time_str, "%02d/%02d/%02d", g_system_time[0], g_system_time[1], g_system_time[2]);
                break;
            case 2:
                sprintf(date_time_str, "%04d-%02d-%02d", 2000 + g_system_time[0], g_system_time[1], g_system_time[2]);
                break;
            case 3:
                sprintf(date_time_str, "%02d-%02d-%02d", g_system_time[0], g_system_time[1], g_system_time[2]);
                break;
            case 4:
                sprintf(date_time_str, "%04d.%02d.%02d", 2000 + g_system_time[0], g_system_time[1], g_system_time[2]);
                break;
            case 5:
                sprintf(date_time_str, "%02d.%02d.%02d", g_system_time[0], g_system_time[1], g_system_time[2]);
                break;
            case 6:
                sprintf(date_time_str, "%02d/%02d/%04d", g_system_time[2],  g_system_time[1], 2000 + g_system_time[0]);
                break;
            case 7:
                sprintf(date_time_str, "%02d/%02d/%02d", g_system_time[2],  g_system_time[1], g_system_time[0]);
                break;
            case 8:
                sprintf(date_time_str, "%02d-%02d-%04d", g_system_time[2],  g_system_time[1], 2000 + g_system_time[0]);
                break;
            case 9:
                sprintf(date_time_str, "%02d-%02d-%02d", g_system_time[2],  g_system_time[1], g_system_time[0]);
                break;
            case 10:
                sprintf(date_time_str, "%02d.%02d.%04d", g_system_time[2],  g_system_time[1], 2000 + g_system_time[0]);
                break;
            case 11:
                sprintf(date_time_str, "%02d.%02d.%02d", g_system_time[2],  g_system_time[1], g_system_time[0]);
                break;
            case 12:
                sprintf(date_time_str, "%04d年%02d月%02d日", 2000 + g_system_time[0], g_system_time[1], g_system_time[2]);
                break;
            case 13:
                sprintf(date_time_str, "%02d年%02d月%02d日", g_system_time[0], g_system_time[1], g_system_time[2]);
                break;
            case 14:
                sprintf(date_time_str, "%s",data_structure[g_modification_id].data.date_time.text);
                break;
            case 15:
                sprintf(date_time_str, "延期");
                break;
        }

        lv_label_set_text(label_addition_date_middle, date_time_str);
        lv_label_set_text(label_btn_addition_date_text, date_time_str);
    }
    else if(data_structure[g_modification_id].data.date_time.date_or_time == 2)
    {
        now_year = 2000 + g_system_time[0];
        now_month = g_system_time[1];
        now_day =  g_system_time[2];

        calculateExpiryDate(now_year,now_month,now_day,data_structure[g_modification_id].data.date_time.year,data_structure[g_modification_id].data.date_time.month,data_structure[g_modification_id].data.date_time.day,&end_year,&end_month,&end_day);

        switch(data_structure[g_modification_id].data.date_time.date_or_time_type)
        {
            case 0:
                sprintf(date_time_str, "%04d/%02d/%02d", end_year, end_month, now_day);
                break;
            case 1:
                sprintf(date_time_str, "%02d/%02d/%02d", end_year%100, end_month, now_day);
                break;
            case 2:
                sprintf(date_time_str, "%04d-%02d-%02d", end_year, end_month, now_day);
                break;
            case 3:
                sprintf(date_time_str, "%02d-%02d-%02d", end_year%100, end_month, now_day);
                break;
            case 4:
                sprintf(date_time_str, "%04d.%02d.%02d", end_year, end_month, now_day);
                break;
            case 5:
                sprintf(date_time_str, "%02d.%02d.%02d", end_year%100, end_month, now_day);
                break;
            case 6:
                sprintf(date_time_str, "%02d/%02d/%04d", now_day,  end_month, end_year);
                break;
            case 7:
                sprintf(date_time_str, "%02d/%02d/%02d", now_day,  end_month, end_year%100);
                break;
            case 8:
                sprintf(date_time_str, "%02d-%02d-%04d", now_day,  end_month, end_year);
                break;
            case 9:
                sprintf(date_time_str, "%02d-%02d-%02d", now_day,  end_month, end_year%100);
                break;
            case 10:
                sprintf(date_time_str, "%02d.%02d.%04d", now_day,  end_month, end_year);
                break;
            case 11:
                sprintf(date_time_str, "%02d.%02d.%02d", now_day,  end_month, end_year%100);
                break;
            case 12:
                sprintf(date_time_str, "%04d年%02d月%02d日", end_year, end_month, now_day);
                break;
            case 13:
                sprintf(date_time_str, "%02d年%02d月%02d日", end_year%100, end_month, now_day);
                break;
            case 14:
                sprintf(date_time_str, "%s",data_structure[g_modification_id].data.date_time.text);
                break;
            case 15:
                sprintf(date_time_str, "延期");
                break;
        }

        lv_label_set_text(label_addition_date_middle, date_time_str);
        lv_label_set_text(label_btn_addition_date_text, date_time_str);
    }
    else
    {
        lv_label_set_text(label_btn_addition_date_text, "");
    }  

    lv_obj_align(label_btn_addition_date_text, LV_ALIGN_CENTER, 0, 0);
    lv_obj_set_style_border_width(label_btn_addition_date_text, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
    lv_obj_set_style_border_color(label_btn_addition_date_text, lv_color_hex(0x8a8a8a), LV_STATE_DEFAULT); /* 设置边框颜色 */
    lv_obj_set_style_border_opa(label_btn_addition_date_text, 100, LV_STATE_DEFAULT); /* 设置边框透明度 */
    lv_obj_set_style_radius(label_btn_addition_date_text, 0, LV_STATE_DEFAULT); /* 设置圆角 */
    lv_obj_set_style_bg_opa(label_btn_addition_date_text, LV_OPA_COVER, LV_PART_MAIN);
    lv_obj_set_style_bg_color(label_btn_addition_date_text, lv_color_hex(0xffffff), LV_PART_MAIN);
    lv_obj_add_event_cb(btn_addition_date_text, btn_addition_date_text_event_cb, LV_EVENT_CLICKED, NULL);


    LV_IMG_DECLARE(typeface);
    img_addition_date_typeface = lv_img_create(lv_scr_act());
    lv_img_set_src(img_addition_date_typeface, &typeface);
    lv_obj_align(img_addition_date_typeface, LV_ALIGN_TOP_LEFT, 10, 162);

    LV_FONT_DECLARE(heiFont16_1);
    label_addition_date_typeface = lv_label_create(lv_scr_act());
    lv_obj_set_style_text_font(label_addition_date_typeface, &heiFont16_1, LV_STATE_DEFAULT);
    lv_obj_set_style_text_color(label_addition_date_typeface, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
    if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
    {
        lv_label_set_text(label_addition_date_typeface,  "字体");
    }
    else if(system_data.system.language == LANGUAGE_ENGLISH)
    {
        lv_label_set_text(label_addition_date_typeface, "typeface");
    }
    lv_obj_align(label_addition_date_typeface, LV_ALIGN_TOP_LEFT, 45, 167);

    LV_FONT_DECLARE(heiFont16_1);
    btn_addition_date_typeface = lv_btn_create(lv_scr_act());
    lv_obj_set_size(btn_addition_date_typeface, 125, 24);
    lv_obj_align(btn_addition_date_typeface, LV_ALIGN_TOP_LEFT, 95, 164);
    lv_obj_set_style_border_width(btn_addition_date_typeface, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
    lv_obj_set_style_radius(btn_addition_date_typeface, 0, LV_STATE_DEFAULT); /* 设置圆角 */
    lv_obj_set_style_bg_color(btn_addition_date_typeface, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
    label_btn_addition_date_typeface = lv_label_create(btn_addition_date_typeface);
    lv_obj_set_style_text_font(label_btn_addition_date_typeface, &heiFont16_1, LV_STATE_DEFAULT);
    lv_obj_set_style_text_color(label_btn_addition_date_typeface, lv_color_hex(0x1C1C1C), LV_STATE_DEFAULT);
    lv_label_set_text(label_btn_addition_date_typeface,typeface_name[data_structure[g_modification_id].data.date_time.typeface]);
    lv_obj_align(label_btn_addition_date_typeface, LV_ALIGN_CENTER, 0, 0);
    lv_obj_set_style_border_width(label_btn_addition_date_typeface, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
    lv_obj_set_style_border_color(label_btn_addition_date_typeface, lv_color_hex(0x8a8a8a), LV_STATE_DEFAULT); /* 设置边框颜色 */
    lv_obj_set_style_border_opa(label_btn_addition_date_typeface, 100, LV_STATE_DEFAULT); /* 设置边框透明度 */
    lv_obj_set_style_radius(label_btn_addition_date_typeface, 0, LV_STATE_DEFAULT); /* 设置圆角 */
    lv_obj_set_style_bg_opa(label_btn_addition_date_typeface, LV_OPA_COVER, LV_PART_MAIN);
    lv_obj_set_style_bg_color(label_btn_addition_date_typeface, lv_color_hex(0xffffff), LV_PART_MAIN);
    lv_obj_add_event_cb(btn_addition_date_typeface, btn_date_time_typeface_event_cb, LV_EVENT_CLICKED, NULL);


    LV_IMG_DECLARE(word_size);
    img_addition_date_word_size = lv_img_create(lv_scr_act());
    lv_img_set_src(img_addition_date_word_size, &word_size);
    lv_obj_align(img_addition_date_word_size, LV_ALIGN_TOP_LEFT, 10, 190);

    LV_FONT_DECLARE(heiFont16_1);
    label_addition_date_word_size = lv_label_create(lv_scr_act());
    lv_obj_set_style_text_font(label_addition_date_word_size, &heiFont16_1, LV_STATE_DEFAULT);
    lv_obj_set_style_text_color(label_addition_date_word_size, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
    if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
    {
        lv_label_set_text(label_addition_date_word_size,  "字号");
    }
    else if(system_data.system.language == LANGUAGE_ENGLISH)
    {
        lv_label_set_text(label_addition_date_word_size, "Size");
    }
    lv_obj_align(label_addition_date_word_size, LV_ALIGN_TOP_LEFT, 45, 195);


    LV_FONT_DECLARE(heiFont16_1);
    btn_addition_date_word_size = lv_btn_create(lv_scr_act());
    lv_obj_set_size(btn_addition_date_word_size, 125, 24);
    lv_obj_align(btn_addition_date_word_size, LV_ALIGN_TOP_LEFT, 95, 192);
    lv_obj_set_style_border_width(btn_addition_date_word_size, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
    lv_obj_set_style_radius(btn_addition_date_word_size, 0, LV_STATE_DEFAULT); /* 设置圆角 */
    lv_obj_set_style_bg_color(btn_addition_date_word_size, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
    label_btn_addition_date_word_size = lv_label_create(btn_addition_date_word_size);
    lv_obj_set_style_text_font(label_btn_addition_date_word_size, &heiFont16_1, LV_STATE_DEFAULT);
    lv_obj_set_style_text_color(label_btn_addition_date_word_size, lv_color_hex(0x1C1C1C), LV_STATE_DEFAULT);
    sprintf(date_time_str,"%d",data_structure[g_modification_id].data.date_time.size);
    lv_label_set_text(label_btn_addition_date_word_size, date_time_str);
    lv_obj_align(label_btn_addition_date_word_size, LV_ALIGN_CENTER, 0, 0);
    lv_obj_set_style_border_width(label_btn_addition_date_word_size, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
    lv_obj_set_style_border_color(label_btn_addition_date_word_size, lv_color_hex(0x8a8a8a), LV_STATE_DEFAULT); /* 设置边框颜色 */
    lv_obj_set_style_border_opa(label_btn_addition_date_word_size, 100, LV_STATE_DEFAULT); /* 设置边框透明度 */
    lv_obj_set_style_radius(label_btn_addition_date_word_size, 0, LV_STATE_DEFAULT); /* 设置圆角 */
    lv_obj_set_style_bg_opa(label_btn_addition_date_word_size, LV_OPA_COVER, LV_PART_MAIN);
    lv_obj_set_style_bg_color(label_btn_addition_date_word_size, lv_color_hex(0xffffff), LV_PART_MAIN);
    lv_obj_add_event_cb(btn_addition_date_word_size, btn_date_time_word_size_event_cb, LV_EVENT_CLICKED, NULL);


    LV_IMG_DECLARE(italic);
    img_addition_date_italic = lv_img_create(lv_scr_act());
    lv_img_set_src(img_addition_date_italic, &italic);
    lv_obj_align(img_addition_date_italic, LV_ALIGN_TOP_LEFT, 10, 218);

    LV_FONT_DECLARE(heiFont16_1);
    label_addition_date_italic = lv_label_create(lv_scr_act());
    lv_obj_set_style_text_font(label_addition_date_italic, &heiFont16_1, LV_STATE_DEFAULT);
    lv_obj_set_style_text_color(label_addition_date_italic, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
    if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
    {
        lv_label_set_text(label_addition_date_italic,  "斜体");
    }
    else if(system_data.system.language == LANGUAGE_ENGLISH)
    {
        lv_label_set_text(label_addition_date_italic, "Italic");
    }
    lv_obj_align(label_addition_date_italic, LV_ALIGN_TOP_LEFT, 45, 223);

    sw_addition_date_italic = lv_switch_create(lv_scr_act());
    lv_obj_set_pos(sw_addition_date_italic, 95, 220);
    lv_obj_set_width(sw_addition_date_italic, 48);
    lv_obj_set_height(sw_addition_date_italic, 23);
    lv_obj_set_style_bg_color(sw_addition_date_italic, lv_color_hex(0x00ff00), LV_STATE_CHECKED | LV_PART_INDICATOR);
    lv_obj_add_event_cb(sw_addition_date_italic, sw_addition_bold_event_cb, LV_EVENT_CLICKED, NULL);

    if((data_structure[g_modification_id].data.date_time.italic_bold & FT_FONT_STYLE_ITALIC) == FT_FONT_STYLE_ITALIC)
    {
        lv_obj_add_state(sw_addition_date_italic, LV_STATE_CHECKED);
    }
    else
    {
        lv_obj_clear_state(sw_addition_date_italic, LV_STATE_CHECKED);
    }


    LV_IMG_DECLARE(date_time);
    img_addition_time = lv_img_create(lv_scr_act());
    lv_img_set_src(img_addition_time, &date_time);
    lv_obj_align(img_addition_time, LV_ALIGN_TOP_LEFT, 250, 134);

    LV_FONT_DECLARE(heiFont16_1);
    label_addition_time = lv_label_create(lv_scr_act());
    lv_obj_set_style_text_font(label_addition_time, &heiFont16_1, LV_STATE_DEFAULT);
    lv_obj_set_style_text_color(label_addition_time, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
    if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
    {
        lv_label_set_text(label_addition_time, "时间");
    }
    else if(system_data.system.language == LANGUAGE_ENGLISH)
    {
        lv_label_set_text(label_addition_time, "Time");
    }
    lv_obj_align(label_addition_time, LV_ALIGN_TOP_LEFT, 285, 139);


    LV_FONT_DECLARE(heiFont16_1);
    btn_label_addition_time = lv_btn_create(lv_scr_act());
    lv_obj_set_size(btn_label_addition_time, 125, 24);
    lv_obj_align(btn_label_addition_time, LV_ALIGN_TOP_LEFT, 338, 136);
    lv_obj_set_style_border_width(btn_label_addition_time, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
    lv_obj_set_style_radius(btn_label_addition_time, 0, LV_STATE_DEFAULT); /* 设置圆角 */
    lv_obj_set_style_bg_color(btn_label_addition_time, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
    label_btn_label_addition_time = lv_label_create(btn_label_addition_time);
    lv_obj_set_style_text_font(label_btn_label_addition_time, &heiFont16_1, LV_STATE_DEFAULT);
    lv_obj_set_style_text_color(label_btn_label_addition_time, lv_color_hex(0x1C1C1C), LV_STATE_DEFAULT);


    printf("date_or_time=%d\n\r",data_structure[g_modification_id].data.date_time.date_or_time);
    printf("date_or_time_type=%d\n\r",data_structure[g_modification_id].data.date_time.date_or_time_type);
    if(data_structure[g_modification_id].data.date_time.date_or_time == 0)
    {
        lv_label_set_text(label_btn_label_addition_time, "");
    }
    else
    {
        switch(data_structure[g_modification_id].data.date_time.date_or_time_type)
        {
            case 0:
                sprintf(date_time_str, "%02d:%02d:%02d", g_system_time[3], g_system_time[4], g_system_time[5]);
                break;
            case 1:
                sprintf(date_time_str, "%02d:%02d", g_system_time[3], g_system_time[4]);
                break;
            case 2:
                if (g_system_time[3] > 12)
                {
                    sprintf(date_time_str, "%02d:%02d:%02d PM", g_system_time[3] - 12, g_system_time[4], g_system_time[5]);
                }
                else
                {
                    sprintf(date_time_str, "%02d:%02d:%02d AM", g_system_time[3], g_system_time[4], g_system_time[5]);
                }
                break;
            case 3:
                if (g_system_time[3] > 12)
                {
                    sprintf(date_time_str, "%02d:%02d PM", g_system_time[3] - 12, g_system_time[4]);
                }
                else
                {
                    sprintf(date_time_str, "%02d:%02d AM", g_system_time[3], g_system_time[4]);
                }
                break;
            case 4:
                sprintf(date_time_str, "%02d时%02d分%02d秒", g_system_time[3], g_system_time[4], g_system_time[5]);
                break;
            case 5:
                sprintf(date_time_str, "%s",data_structure[g_modification_id].data.date_time.text);
                break;
            case 6:
                sprintf(date_time_str, "延期");
                break;
        }  
        lv_label_set_text(label_addition_date_middle, date_time_str);
        lv_label_set_text(label_btn_label_addition_time, date_time_str);
    }  

    lv_obj_align(label_btn_label_addition_time, LV_ALIGN_CENTER, 0, 0);
    lv_obj_set_style_border_width(label_btn_label_addition_time, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
    lv_obj_set_style_border_color(label_btn_label_addition_time, lv_color_hex(0x8a8a8a), LV_STATE_DEFAULT); /* 设置边框颜色 */
    lv_obj_set_style_border_opa(label_btn_label_addition_time, 100, LV_STATE_DEFAULT); /* 设置边框透明度 */
    lv_obj_set_style_radius(label_btn_label_addition_time, 0, LV_STATE_DEFAULT); /* 设置圆角 */
    lv_obj_set_style_bg_opa(label_btn_label_addition_time, LV_OPA_COVER, LV_PART_MAIN);
    lv_obj_set_style_bg_color(label_btn_label_addition_time, lv_color_hex(0xffffff), LV_PART_MAIN);
    lv_obj_add_event_cb(btn_label_addition_time, btn_addition_time_event_cb, LV_EVENT_CLICKED, NULL);

    LV_IMG_DECLARE(word_space);
    img_addition_date_word_space = lv_img_create(lv_scr_act());
    lv_img_set_src(img_addition_date_word_space, &word_space);
    lv_obj_align(img_addition_date_word_space, LV_ALIGN_TOP_LEFT, 250, 162);

    LV_FONT_DECLARE(heiFont16_1);
    label_addition_date_word_space = lv_label_create(lv_scr_act());
    lv_obj_set_style_text_font(label_addition_date_word_space, &heiFont16_1, LV_STATE_DEFAULT);
    lv_obj_set_style_text_color(label_addition_date_word_space, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
    if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
    {
        lv_label_set_text(label_addition_date_word_space, "间距");
    }
    else if(system_data.system.language == LANGUAGE_ENGLISH)
    {
        lv_label_set_text(label_addition_date_word_space, "Space");
    }
    lv_obj_align(label_addition_date_word_space, LV_ALIGN_TOP_LEFT, 285, 167);


    LV_FONT_DECLARE(heiFont16_1);
    btn_addition_date_word_space = lv_btn_create(lv_scr_act());
    lv_obj_set_size(btn_addition_date_word_space, 125, 24);
    lv_obj_align(btn_addition_date_word_space, LV_ALIGN_TOP_LEFT, 338, 164);
    lv_obj_set_style_border_width(btn_addition_date_word_space, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
    lv_obj_set_style_radius(btn_addition_date_word_space, 0, LV_STATE_DEFAULT); /* 设置圆角 */
    lv_obj_set_style_bg_color(btn_addition_date_word_space, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
    label_btn_addition_date_word_space = lv_label_create(btn_addition_date_word_space);
    lv_obj_set_style_text_font(label_btn_addition_date_word_space, &heiFont16_1, LV_STATE_DEFAULT);
    lv_obj_set_style_text_color(label_btn_addition_date_word_space, lv_color_hex(0x1C1C1C), LV_STATE_DEFAULT);
    sprintf(date_time_str,"%d",data_structure[g_modification_id].data.date_time.space);
    lv_label_set_text(label_btn_addition_date_word_space, date_time_str);
    lv_obj_align(label_btn_addition_date_word_space, LV_ALIGN_CENTER, 0, 0);
    lv_obj_set_style_border_width(label_btn_addition_date_word_space, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
    lv_obj_set_style_border_color(label_btn_addition_date_word_space, lv_color_hex(0x8a8a8a), LV_STATE_DEFAULT); /* 设置边框颜色 */
    lv_obj_set_style_border_opa(label_btn_addition_date_word_space, 100, LV_STATE_DEFAULT); /* 设置边框透明度 */
    lv_obj_set_style_radius(label_btn_addition_date_word_space, 0, LV_STATE_DEFAULT); /* 设置圆角 */
    lv_obj_set_style_bg_opa(label_btn_addition_date_word_space, LV_OPA_COVER, LV_PART_MAIN);
    lv_obj_set_style_bg_color(label_btn_addition_date_word_space, lv_color_hex(0xffffff), LV_PART_MAIN);
    lv_obj_add_event_cb(btn_addition_date_word_space, btn_date_time_word_space_event_cb, LV_EVENT_CLICKED, NULL);

    LV_IMG_DECLARE(spin);
    img_addition_date_spin = lv_img_create(lv_scr_act());
    lv_img_set_src(img_addition_date_spin, &spin);
    lv_obj_align(img_addition_date_spin, LV_ALIGN_TOP_LEFT, 250, 190);

    LV_FONT_DECLARE(heiFont16_1);
    label_addition_date_spin = lv_label_create(lv_scr_act());
    lv_obj_set_style_text_font(label_addition_date_spin, &heiFont16_1, LV_STATE_DEFAULT);
    lv_obj_set_style_text_color(label_addition_date_spin, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
    if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
    {
        lv_label_set_text(label_addition_date_spin, "旋转");
    }
    else if(system_data.system.language == LANGUAGE_ENGLISH)
    {
        lv_label_set_text(label_addition_date_spin, "Spin");
    }
    lv_obj_align(label_addition_date_spin, LV_ALIGN_TOP_LEFT, 285, 195);

    LV_FONT_DECLARE(heiFont16_1);
    btn_addition_date_spin = lv_btn_create(lv_scr_act());
    lv_obj_set_size(btn_addition_date_spin, 125, 24);
    lv_obj_align(btn_addition_date_spin, LV_ALIGN_TOP_LEFT, 338, 192);
    lv_obj_set_style_border_width(btn_addition_date_spin, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
    lv_obj_set_style_radius(btn_addition_date_spin, 0, LV_STATE_DEFAULT); /* 设置圆角 */
    lv_obj_set_style_bg_color(btn_addition_date_spin, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
    label_btn_addition_date_spin = lv_label_create(btn_addition_date_spin);
    lv_obj_set_style_text_font(label_btn_addition_date_spin, &heiFont16_1, LV_STATE_DEFAULT);
    lv_obj_set_style_text_color(label_btn_addition_date_spin, lv_color_hex(0x1C1C1C), LV_STATE_DEFAULT);
    sprintf(date_time_str,"%d",data_structure[g_modification_id].data.date_time.spin);
    lv_label_set_text(label_btn_addition_date_spin, date_time_str);
    lv_obj_align(label_btn_addition_date_spin, LV_ALIGN_CENTER, 0, 0);
    lv_obj_set_style_border_width(label_btn_addition_date_spin, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
    lv_obj_set_style_border_color(label_btn_addition_date_spin, lv_color_hex(0x8a8a8a), LV_STATE_DEFAULT); /* 设置边框颜色 */
    lv_obj_set_style_border_opa(label_btn_addition_date_spin, 100, LV_STATE_DEFAULT); /* 设置边框透明度 */
    lv_obj_set_style_radius(label_btn_addition_date_spin, 0, LV_STATE_DEFAULT); /* 设置圆角 */
    lv_obj_set_style_bg_opa(label_btn_addition_date_spin, LV_OPA_COVER, LV_PART_MAIN);
    lv_obj_set_style_bg_color(label_btn_addition_date_spin, lv_color_hex(0xffffff), LV_PART_MAIN);
    lv_obj_add_event_cb(btn_addition_date_spin, btn_addition_date_spin_event_cb, LV_EVENT_CLICKED, NULL);


    LV_IMG_DECLARE(bold);
    img_btn_addition_date_bold = lv_img_create(lv_scr_act());
    lv_img_set_src(img_btn_addition_date_bold, &bold);
    lv_obj_align(img_btn_addition_date_bold, LV_ALIGN_TOP_LEFT, 250, 218);

    LV_FONT_DECLARE(heiFont16_1);
    label_addition_date_bold = lv_label_create(lv_scr_act());
    lv_obj_set_style_text_font(label_addition_date_bold, &heiFont16_1, LV_STATE_DEFAULT);
    lv_obj_set_style_text_color(label_addition_date_bold, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
    if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
    {
        lv_label_set_text(label_addition_date_bold, "粗体");
    }
    else if(system_data.system.language == LANGUAGE_ENGLISH)
    {
        lv_label_set_text(label_addition_date_bold, "Bold");
    }
    lv_obj_align(label_addition_date_bold, LV_ALIGN_TOP_LEFT, 285, 223);

    sw_addition_date_bold = lv_switch_create(lv_scr_act());
    lv_obj_set_pos(sw_addition_date_bold, 343, 220);
    lv_obj_set_width(sw_addition_date_bold, 48);
    lv_obj_set_height(sw_addition_date_bold, 23);
    lv_obj_set_style_bg_color(sw_addition_date_bold, lv_color_hex(0x00ff00), LV_STATE_CHECKED | LV_PART_INDICATOR);
    lv_obj_add_event_cb(sw_addition_date_bold, sw_addition_bold_event_cb, LV_EVENT_CLICKED, NULL);


    if((data_structure[g_modification_id].data.date_time.italic_bold & FT_FONT_STYLE_BOLD) == FT_FONT_STYLE_BOLD)
    {
        lv_obj_add_state(sw_addition_date_bold, LV_STATE_CHECKED);
    }
    else
    {
        lv_obj_clear_state(sw_addition_date_bold, LV_STATE_CHECKED);
    }        

    addition_date_bottom_bg = lv_obj_create(lv_scr_act());
    lv_obj_set_size(addition_date_bottom_bg, 480, 24);
    lv_obj_align(addition_date_bottom_bg, LV_ALIGN_TOP_LEFT, 0, 248);
    lv_obj_set_style_border_width(addition_date_bottom_bg, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
    lv_obj_set_style_radius(addition_date_bottom_bg, 0, LV_STATE_DEFAULT); /* 设置圆角 */
    lv_obj_set_style_bg_color(addition_date_bottom_bg, lv_color_hex(0x28536a), LV_STATE_DEFAULT);
    lv_obj_remove_style(addition_date_bottom_bg, 0, LV_PART_SCROLLBAR);


    LV_FONT_DECLARE(heiFont16_1);
    label_addition_date_time_return = lv_label_create(lv_scr_act());
    lv_obj_set_style_text_font(label_addition_date_time_return, &heiFont16_1, LV_STATE_DEFAULT);
    lv_obj_set_style_text_color(label_addition_date_time_return, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
    if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
    {
        lv_label_set_text(label_addition_date_time_return, "返回");
    }
    else if(system_data.system.language == LANGUAGE_ENGLISH)
    {
        lv_label_set_text(label_addition_date_time_return, "Return");
    }
    lv_obj_align(label_addition_date_time_return, LV_ALIGN_TOP_LEFT, 140, 252);


    LV_IMG_DECLARE(get_back);
    imgbtn_addition_date_time_return = lv_imgbtn_create(lv_scr_act());
    lv_imgbtn_set_src(imgbtn_addition_date_time_return, LV_IMGBTN_STATE_RELEASED, NULL, &get_back, NULL);
    lv_obj_set_size(imgbtn_addition_date_time_return, get_back.header.w, get_back.header.h);
    lv_obj_align(imgbtn_addition_date_time_return, LV_ALIGN_TOP_LEFT, 180, 250);
    lv_obj_add_event_cb(imgbtn_addition_date_time_return, button_modification_date_time_return_event_cb, LV_EVENT_CLICKED, NULL);

    LV_IMG_DECLARE(confirm);
    imgbtn_addition_date_time_confirm = lv_imgbtn_create(lv_scr_act());
    lv_imgbtn_set_src(imgbtn_addition_date_time_confirm, LV_IMGBTN_STATE_RELEASED, NULL, &confirm, NULL);
    lv_obj_set_size(imgbtn_addition_date_time_confirm, get_back.header.w, get_back.header.h);
    lv_obj_align(imgbtn_addition_date_time_confirm, LV_ALIGN_TOP_LEFT, 250, 250);
    lv_obj_add_event_cb(imgbtn_addition_date_time_confirm, button_modification_date_time_confirm_event_cb, LV_EVENT_CLICKED, NULL);

    LV_FONT_DECLARE(heiFont16_1);
    label_addition_date_time_confirm = lv_label_create(lv_scr_act());
    lv_obj_set_style_text_font(label_addition_date_time_confirm, &heiFont16_1, LV_STATE_DEFAULT);
    lv_obj_set_style_text_color(label_addition_date_time_confirm, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
    if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
    {
        lv_label_set_text(label_addition_date_time_confirm, "确定");
    }
    else if(system_data.system.language == LANGUAGE_ENGLISH)
    {
        lv_label_set_text(label_addition_date_time_confirm, "Confirm");
    }
    lv_obj_align(label_addition_date_time_confirm, LV_ALIGN_TOP_LEFT, 277, 252);
}







static void imgbtn_modification_picture_confirm_event_cb(lv_event_t* e)
{
    lv_event_code_t code;
    code = lv_event_get_code(e);
    int win_content_child_num = 0;
    //char tempString[128] = { 0 };
    char picture_name[100] = { 0 };
    int width, height, channels;

    if (code == LV_EVENT_CLICKED)
    {
        printf("imgbtn_modification_picture_confirm_event_cb\n");

        buzzer_enable = 1;

        win_content_child_num = g_modification_id;

        lv_obj_t* temp_obj = lv_obj_get_child(win_content,g_modification_id);

        lv_obj_del(lv_obj_get_child(temp_obj,0));

        // 假设你有一个图片对象
        lv_obj_t* img_obj = lv_img_create(temp_obj);
        sprintf(data_structure[win_content_child_num].data.picture.text_1, "/mnt/%s.%s", lv_table_get_cell_value(table_addition_picture_1, g_row, 0), lv_table_get_cell_value(table_addition_picture_1, g_row, 1));
       
        if(strcmp(data_structure[win_content_child_num].data.picture.text_1,"png") != 0)
        {

            unsigned char *data = stbi_load(data_structure[win_content_child_num].data.picture.text_1, &width, &height, &channels, 0);
            if (!data) 
            {
                printf("错误：无法加载图片 %s\n", data_structure[win_content_child_num].data.picture.text_1);
            }

            printf("图片加载成功：%dx%d，%d 通道\n", width, height, channels);


            sprintf(data_structure[win_content_child_num].data.picture.text_2,"%s.png",lv_table_get_cell_value(table_addition_picture_1, g_row, 0));

            // 步骤 2：将数据保存为 PNG
            int success = stbi_write_png(data_structure[win_content_child_num].data.picture.text_2, width, height, channels, data, width * channels);
            if (!success) 
            {
                printf("错误：保存 PNG 失败\n");
            } 
            else 
            {
                printf("PNG 保存成功：%s\n", data_structure[win_content_child_num].data.picture.text_2);
            }

            sprintf(picture_name, "A:%s", data_structure[win_content_child_num].data.picture.text_2);

            stbi_image_free(data);
        }
        else
        {
            sprintf(picture_name, "A:%s", data_structure[win_content_child_num].data.picture.text_1);
        }
        
        lv_img_set_src(img_obj, picture_name);
        lv_obj_center(img_obj);
        lv_img_header_t header;
        lv_res_t res = lv_img_decoder_get_info(picture_name, &header);  // 直接传入文件路径

        if (res == LV_RES_OK)
        {
            printf("PNG: %dx%d\n", header.w, header.h);
        }
        else
        {
            printf("lv_img_decoder_get_info error\n");
        }

        lv_img_set_zoom(img_obj,data_structure[win_content_child_num].data.picture.size);

        width = header.w * data_structure[win_content_child_num].data.picture.size / 256;
        height = header.h * data_structure[win_content_child_num].data.picture.size / 256;

        lv_obj_set_size(temp_obj, width, height);
        lv_obj_align(temp_obj, LV_ALIGN_OUT_TOP_LEFT, data_structure[win_content_child_num].x, data_structure[win_content_child_num].y);      
    

        lv_obj_del(obj_addition_picture_head_bg);
        lv_obj_del(label_addition_picture_head);
        lv_obj_del(obj_addition_picture_preview_bg);
        lv_obj_del(obj_addition_picture_btn_bg);
        lv_obj_del(table_addition_picture);
        lv_obj_del(table_addition_picture_1);
        lv_obj_del(win_content_typeface);
        lv_obj_del(obj_addition_table_bg);
        lv_obj_del(typeface_slider_bg);
        lv_obj_del(left_stop_img_typeface);
        lv_obj_del(right_stop_img_typeface);
        lv_obj_del(btn_addition_picture_delete);
        lv_obj_del(btn_addition_picture_open);
        lv_obj_del(img_addition_picture_search);
        lv_obj_del(label_addition_picture_search);
        lv_obj_del(label_btn_addition_picture_search);
        lv_obj_del(btn_addition_picture_search);
        lv_obj_del(obj_addition_picture_bottom_bg);
        lv_obj_del(label_addition_picture_return);
        lv_obj_del(imgbtn_addition_picture_return);
        lv_obj_del(imgbtn_addition_picture_confirm);
        lv_obj_del(label_addition_picture_confirm);

        lv_obj_del(slider_typeface);
    }
}



static void imgbtn_modification_picture_return_event_cb(lv_event_t* e)
{
    lv_event_code_t code;
    code = lv_event_get_code(e);
    if (code == LV_EVENT_CLICKED)
    {
        printf("imgbtn_modification_picture_return_event_cb\n");

        buzzer_enable = 1;

        lv_obj_del(obj_addition_picture_head_bg);
        lv_obj_del(label_addition_picture_head);
        lv_obj_del(obj_addition_picture_preview_bg);
        lv_obj_del(obj_addition_picture_btn_bg);
        lv_obj_del(table_addition_picture);
        lv_obj_del(table_addition_picture_1);
        lv_obj_del(win_content_typeface);
        lv_obj_del(obj_addition_table_bg);
        lv_obj_del(typeface_slider_bg);
        lv_obj_del(left_stop_img_typeface);
        lv_obj_del(right_stop_img_typeface);
        lv_obj_del(btn_addition_picture_delete);
        lv_obj_del(btn_addition_picture_open);
        lv_obj_del(img_addition_picture_search);
        lv_obj_del(label_addition_picture_search);
        lv_obj_del(label_btn_addition_picture_search);
        lv_obj_del(btn_addition_picture_search);
        lv_obj_del(obj_addition_picture_bottom_bg);
        lv_obj_del(label_addition_picture_return);
        lv_obj_del(imgbtn_addition_picture_return);
        lv_obj_del(imgbtn_addition_picture_confirm);
        lv_obj_del(label_addition_picture_confirm);

        lv_obj_del(slider_typeface);
    }
}





static void modification_picture(void)
{
    char file_name[100]={0};

    printf("modification_picture\n");
    buzzer_enable = 1;
    obj_addition_picture_head_bg = lv_obj_create(lv_scr_act());
    lv_obj_set_size(obj_addition_picture_head_bg, 480, 24);
    lv_obj_align(obj_addition_picture_head_bg, LV_ALIGN_TOP_LEFT, 0, 0);
    lv_obj_set_style_border_width(obj_addition_picture_head_bg, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
    lv_obj_set_style_radius(obj_addition_picture_head_bg, 0, LV_STATE_DEFAULT); /* 设置圆角 */
    lv_obj_set_style_bg_color(obj_addition_picture_head_bg, lv_color_hex(0x28536a), LV_STATE_DEFAULT);
    lv_obj_remove_style(obj_addition_picture_head_bg, 0, LV_PART_SCROLLBAR);

    LV_FONT_DECLARE(heiFont16_1);
    label_addition_picture_head = lv_label_create(lv_scr_act());
    lv_obj_set_style_text_font(label_addition_picture_head, &heiFont16_1, LV_STATE_DEFAULT);
    lv_obj_set_style_text_color(label_addition_picture_head, lv_color_hex(0xFFFFFF), LV_STATE_DEFAULT);
    if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
    {
        lv_label_set_text(label_addition_picture_head,  "图片");
    }
    else if(system_data.system.language == LANGUAGE_ENGLISH)
    {
        lv_label_set_text(label_addition_picture_head, "Picture");
    }
    lv_obj_align(label_addition_picture_head, LV_ALIGN_TOP_LEFT, 200, 4);


    obj_addition_picture_preview_bg = lv_obj_create(lv_scr_act());
    lv_obj_set_size(obj_addition_picture_preview_bg, 160, 150);
    lv_obj_align(obj_addition_picture_preview_bg, LV_ALIGN_TOP_LEFT, 0, 24);
    lv_obj_set_style_border_width(obj_addition_picture_preview_bg, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
    lv_obj_set_style_radius(obj_addition_picture_preview_bg, 0, LV_STATE_DEFAULT); /* 设置圆角 */
    lv_obj_set_style_bg_color(obj_addition_picture_preview_bg, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
    lv_obj_remove_style(obj_addition_picture_preview_bg, 0, LV_PART_SCROLLBAR);


    obj_addition_picture_btn_bg = lv_obj_create(lv_scr_act());
    lv_obj_set_size(obj_addition_picture_btn_bg, 160, 98);
    lv_obj_align(obj_addition_picture_btn_bg, LV_ALIGN_TOP_LEFT, 0, 174);
    lv_obj_set_style_border_width(obj_addition_picture_btn_bg, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
    lv_obj_set_style_radius(obj_addition_picture_btn_bg, 0, LV_STATE_DEFAULT); /* 设置圆角 */
    lv_obj_set_style_bg_color(obj_addition_picture_btn_bg, lv_color_hex(0x1fadd3), LV_STATE_DEFAULT);
    lv_obj_remove_style(obj_addition_picture_btn_bg, 0, LV_PART_SCROLLBAR);

    static lv_style_t table_cell_style;
    lv_style_init(&table_cell_style);
    lv_style_set_pad_all(&table_cell_style, 2); // 设置所有方向的填充为5像素

    table_addition_picture = lv_table_create(lv_scr_act());
    LV_FONT_DECLARE(heiFont16_1);
    lv_obj_add_style(table_addition_picture, &table_cell_style, LV_PART_ITEMS); // 应用样式到表格的单元格部分
    lv_obj_align(table_addition_picture, LV_ALIGN_TOP_LEFT, 160, 24);
    lv_obj_set_style_text_font(table_addition_picture, &heiFont16_1, LV_STATE_DEFAULT);

    if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
    {
        lv_table_set_cell_value(table_addition_picture, 0, 0, "名称");
        lv_table_set_cell_value(table_addition_picture, 0, 1, "类型");
        //lv_table_set_cell_value(table_addition_picture, 0, 2, "大小");
        lv_table_set_cell_value(table_addition_picture, 0, 2, "时间");
    }
    else if(system_data.system.language == LANGUAGE_ENGLISH)
    {
        lv_table_set_cell_value(table_addition_picture, 0, 0, "Name");
        lv_table_set_cell_value(table_addition_picture, 0, 1, "Type");
        //lv_table_set_cell_value(table_addition_picture, 0, 2, "Size");
        lv_table_set_cell_value(table_addition_picture, 0, 2, "Time");
    }
    lv_table_set_col_width(table_addition_picture, 0, 166);
    lv_table_set_col_width(table_addition_picture, 1, 50);
    //lv_table_set_col_width(table_addition_picture, 2, 56);
    lv_table_set_col_width(table_addition_picture, 2, 81);

    obj_addition_table_bg = lv_obj_create(lv_scr_act());
    lv_obj_set_size(obj_addition_table_bg, 300, 198);
    lv_obj_align(obj_addition_table_bg, LV_ALIGN_TOP_LEFT, 160, 48);
    lv_obj_set_style_border_width(obj_addition_table_bg, 1, LV_STATE_DEFAULT); /* 设置边框宽度 */
    lv_obj_set_style_radius(obj_addition_table_bg, 0, LV_STATE_DEFAULT); /* 设置圆角 */
    lv_obj_set_style_bg_color(obj_addition_table_bg, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
    lv_obj_remove_style(obj_addition_table_bg, 0, LV_PART_SCROLLBAR);

    win_content_typeface = lv_obj_create(obj_addition_table_bg);
    lv_obj_set_size(win_content_typeface, 300, 500);
    lv_obj_align(win_content_typeface, LV_ALIGN_TOP_LEFT, -16, -16);
    lv_obj_set_style_bg_color(win_content_typeface, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
    lv_obj_set_style_border_width(win_content_typeface, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
    lv_obj_set_style_border_color(win_content_typeface, lv_color_hex(0xcccccc), LV_STATE_DEFAULT); /* 设置边框颜色 */
    lv_obj_clear_flag(win_content_typeface, LV_OBJ_FLAG_SCROLLABLE);
    lv_obj_set_style_radius(win_content_typeface, 0, LV_STATE_DEFAULT); /* 设置圆角 */
    lv_obj_set_style_pad_all(win_content_typeface, 0, LV_STATE_DEFAULT);

    table_addition_picture_1 = lv_table_create(win_content_typeface);
    LV_FONT_DECLARE(heiFont16_1);
    lv_obj_add_style(table_addition_picture_1, &table_cell_style, LV_PART_ITEMS); // 应用样式到表格的单元格部分
    lv_obj_align(table_addition_picture_1, LV_ALIGN_TOP_LEFT, 0, 0);
    lv_obj_set_style_text_font(table_addition_picture_1, &heiFont16_1, LV_STATE_DEFAULT);

    lv_table_set_col_width(table_addition_picture_1, 0, 160);
    lv_table_set_col_width(table_addition_picture_1, 1, 45);
    //lv_table_set_col_width(table_addition_picture_1, 2, 55);
    lv_table_set_col_width(table_addition_picture_1, 2, 89);


#if 0
        //PICTURE_DATA
        lv_fs_dir_t mysd_3;
        if (lv_fs_dir_open(&mysd_3, "/mnt") == LV_FS_RES_OK)
        {
            printf("lv_fs_dir_open ok\n");
         
            while (lv_fs_dir_read(&mysd_3, file_name) == LV_FS_RES_OK)
            {
                printf("%s\n", file_name);
            }
            lv_fs_dir_close(&mysd_3);
        }
        else
        {
            printf("lv_fs_dir_open error\n");
        }
#endif


    //list_directory_contents(D:/test_sd);
    DIR *dir;
    struct dirent *entry;
    struct stat file_stat;
    char path[300];
    unsigned char picture_count = 0;
    int picture_type = 0;
    char created_time[20] ={0};
    //char size_str[20]; // 存储转换后的字符串
    char image_name[50]; // 存储提取的图片名称

    dir = opendir("/mnt");
    if (dir == NULL) 
    {
        perror("opendir");
        exit(EXIT_FAILURE);
    }

    while ((entry = readdir(dir)) != NULL) 
    {
        snprintf(path, sizeof(path), "/mnt/%s", entry->d_name);
        if ((stat(path, &file_stat) == -1)||(file_stat.st_size > 500 *1024))
        {
            perror("stat");
            continue;
        }

        if ((S_ISREG(file_stat.st_mode))&&(picture_count < USB_PICTURE_NUMBER))
        {  
            // 只处理普通文件
            if (is_image_file(entry->d_name)) 
            {
                print_file_info(entry->d_name, &file_stat);
                get_image_name(entry->d_name, image_name, sizeof(image_name));
                lv_table_set_cell_value(table_addition_picture_1, picture_count, 0, image_name);
                picture_type = get_image_file_type(entry->d_name);
                printf("picture_type=%d\n\r",picture_type);
                switch(picture_type)
                {
                    case 0:
                        lv_table_set_cell_value(table_addition_picture_1, picture_count, 1, "jpg");
                        break;
                    case 1:
                        lv_table_set_cell_value(table_addition_picture_1, picture_count, 1, "jpeg");
                        break;
                    case 2:
                        lv_table_set_cell_value(table_addition_picture_1, picture_count, 1, "png");
                        break;
                    case 3:
                        lv_table_set_cell_value(table_addition_picture_1, picture_count, 1, "gif");
                        break;
                    case 4:
                        lv_table_set_cell_value(table_addition_picture_1, picture_count, 1, "bmp");
                        break;
                }
                //size_to_human_readable(file_stat.st_size, size_str, sizeof(size_str));
                //printf("size_str=%s\n\r",size_str);
                //lv_table_set_cell_value(table_addition_picture_1, picture_count, 2, size_str);
                format_time(ctime(&file_stat.st_ctime), created_time);
                printf("created_time=%s\n\r",created_time);
                lv_table_set_cell_value(table_addition_picture_1, picture_count, 2, created_time);
                //memcpy(usb_picture,entry->d_name,strlen(entry->d_name) + 1);

                if(isSubstring(data_structure[g_modification_id].data.picture.text_1,entry->d_name))
                {
                    g_row = picture_count;
                }
                picture_count++;
            }
        }
    }

    closedir(dir);

    //printf("%s\n\r", lv_table_get_cell_value(table_addition_picture_1,0,0));
    //sprintf(file_name,"A:/mnt/%s.%s", lv_table_get_cell_value(table_addition_picture_1, g_row, 0), lv_table_get_cell_value(table_addition_picture_1, g_row, 1));

    //显示图片
    picture_img = lv_img_create(obj_addition_picture_preview_bg);
    printf("text_1=%s\n\r",data_structure[g_modification_id].data.picture.text_1);
    sprintf(file_name,"A:%s", data_structure[g_modification_id].data.picture.text_1);
    printf("file_name=%s\n\r",file_name);

    lv_img_set_src(picture_img, file_name);

    lv_obj_add_event_cb(table_addition_picture_1, picture_draw_event_cb, LV_EVENT_DRAW_PART_BEGIN, NULL);
    lv_obj_add_event_cb(table_addition_picture_1, picture_change_event_cb, LV_EVENT_PRESSED, NULL);


    typeface_slider_bg = lv_obj_create(lv_scr_act());
    lv_obj_set_size(typeface_slider_bg, 20, 224);
    lv_obj_align(typeface_slider_bg, LV_ALIGN_TOP_LEFT, 460, 24);
    lv_obj_set_style_border_width(typeface_slider_bg, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
    lv_obj_set_style_border_color(typeface_slider_bg, lv_color_hex(0xaaaaaa), LV_STATE_DEFAULT); /* 设置边框颜色 */
    lv_obj_set_style_radius(typeface_slider_bg, 0, LV_STATE_DEFAULT); /* 设置圆角 */
    lv_obj_set_style_bg_color(typeface_slider_bg, lv_color_hex(0xaaaaaa), LV_STATE_DEFAULT);

    //左滑块停止
    LV_IMG_DECLARE(left_stop_typeface);
    left_stop_img_typeface = lv_img_create(lv_scr_act());
    lv_img_set_src(left_stop_img_typeface, &left_stop_typeface);
    lv_obj_align(left_stop_img_typeface, LV_ALIGN_TOP_LEFT, 460, 228);

    slider_show_picture();

    //右滑块停止
    LV_IMG_DECLARE(right_stop_typeface);
    right_stop_img_typeface = lv_img_create(lv_scr_act());
    lv_img_set_src(right_stop_img_typeface, &right_stop_typeface);
    lv_obj_align(right_stop_img_typeface, LV_ALIGN_TOP_LEFT, 460, 24);

    LV_IMG_DECLARE(picture_delete);
    btn_addition_picture_delete = lv_imgbtn_create(lv_scr_act());
    lv_imgbtn_set_src(btn_addition_picture_delete, LV_IMGBTN_STATE_RELEASED, NULL, &picture_delete, NULL);
    lv_obj_set_size(btn_addition_picture_delete, picture_delete.header.w, picture_delete.header.h);
    lv_obj_align(btn_addition_picture_delete, LV_ALIGN_TOP_LEFT, 10, 180);
    lv_obj_add_event_cb(btn_addition_picture_delete, btn_addition_picture_delete_event_cb, LV_EVENT_CLICKED, NULL);


    LV_IMG_DECLARE(open_25_1);
    btn_addition_picture_open = lv_imgbtn_create(lv_scr_act());
    lv_imgbtn_set_src(btn_addition_picture_open, LV_IMGBTN_STATE_RELEASED, NULL, &open_25_1, NULL);
    lv_obj_set_size(btn_addition_picture_open, open_25_1.header.w, open_25_1.header.h);
    lv_obj_align(btn_addition_picture_open, LV_ALIGN_TOP_LEFT, 90, 180);
    lv_obj_add_event_cb(btn_addition_picture_open, imgbtn_modification_picture_confirm_event_cb, LV_EVENT_CLICKED, NULL);


    LV_IMG_DECLARE(search);
    img_addition_picture_search = lv_img_create(lv_scr_act());
    lv_img_set_src(img_addition_picture_search, &search);
    lv_obj_align(img_addition_picture_search, LV_ALIGN_TOP_LEFT, 10, 218);

    LV_FONT_DECLARE(heiFont16_1);
    label_addition_picture_search = lv_label_create(lv_scr_act());
    lv_obj_set_style_text_font(label_addition_picture_search, &heiFont16_1, LV_STATE_DEFAULT);
    lv_obj_set_style_text_color(label_addition_picture_search, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
    if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
    {
        lv_label_set_text(label_addition_picture_search,  "搜索");
    }
    else if(system_data.system.language == LANGUAGE_ENGLISH)
    {
        lv_label_set_text(label_addition_picture_search, "Search");
    }
    lv_obj_align(label_addition_picture_search, LV_ALIGN_TOP_LEFT, 42, 222);


    LV_FONT_DECLARE(heiFont16_1);
    btn_addition_picture_search = lv_btn_create(lv_scr_act());
    lv_obj_set_size(btn_addition_picture_search, 70, 24);
    lv_obj_align(btn_addition_picture_search, LV_ALIGN_TOP_LEFT, 82, 218);
    lv_obj_set_style_border_width(btn_addition_picture_search, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
    lv_obj_set_style_radius(btn_addition_picture_search, 10, LV_STATE_DEFAULT); /* 设置圆角 */
    lv_obj_set_style_bg_color(btn_addition_picture_search, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
    label_btn_addition_picture_search = lv_label_create(btn_addition_picture_search);
    lv_obj_set_style_text_font(label_btn_addition_picture_search, &heiFont16_1, LV_STATE_DEFAULT);
    lv_obj_set_style_text_color(label_btn_addition_picture_search, lv_color_hex(0x1C1C1C), LV_STATE_DEFAULT);
    lv_label_set_text(label_btn_addition_picture_search, "");
    lv_obj_align(label_btn_addition_picture_search, LV_ALIGN_CENTER, 0, 0);
    lv_obj_set_style_border_width(label_btn_addition_picture_search, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
    lv_obj_set_style_border_color(label_btn_addition_picture_search, lv_color_hex(0x8a8a8a), LV_STATE_DEFAULT); /* 设置边框颜色 */
    lv_obj_set_style_border_opa(label_btn_addition_picture_search, 100, LV_STATE_DEFAULT); /* 设置边框透明度 */
    lv_obj_set_style_radius(label_btn_addition_picture_search, 0, LV_STATE_DEFAULT); /* 设置圆角 */
    lv_obj_set_style_bg_opa(label_btn_addition_picture_search, LV_OPA_COVER, LV_PART_MAIN);
    lv_obj_set_style_bg_color(label_btn_addition_picture_search, lv_color_hex(0xffffff), LV_PART_MAIN);
    lv_obj_add_event_cb(btn_addition_picture_search, btn_addition_picture_search_event_cb, LV_EVENT_CLICKED, NULL);

    obj_addition_picture_bottom_bg = lv_obj_create(lv_scr_act());
    lv_obj_set_size(obj_addition_picture_bottom_bg, 480, 24);
    lv_obj_align(obj_addition_picture_bottom_bg, LV_ALIGN_TOP_LEFT, 0, 248);
    lv_obj_set_style_border_width(obj_addition_picture_bottom_bg, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
    lv_obj_set_style_radius(obj_addition_picture_bottom_bg, 0, LV_STATE_DEFAULT); /* 设置圆角 */
    lv_obj_set_style_bg_color(obj_addition_picture_bottom_bg, lv_color_hex(0x28536a), LV_STATE_DEFAULT);
    lv_obj_remove_style(obj_addition_picture_bottom_bg, 0, LV_PART_SCROLLBAR);


    LV_FONT_DECLARE(heiFont16_1);
    label_addition_picture_return = lv_label_create(lv_scr_act());
    lv_obj_set_style_text_font(label_addition_picture_return, &heiFont16_1, LV_STATE_DEFAULT);
    lv_obj_set_style_text_color(label_addition_picture_return, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
    if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
    {
        lv_label_set_text(label_addition_picture_return, "返回");
    }
    else if(system_data.system.language == LANGUAGE_ENGLISH)
    {
        lv_label_set_text(label_addition_picture_return, "Return");
    }
    lv_obj_align(label_addition_picture_return, LV_ALIGN_TOP_LEFT, 140, 252);


    LV_IMG_DECLARE(get_back);
    imgbtn_addition_picture_return = lv_imgbtn_create(lv_scr_act());
    lv_imgbtn_set_src(imgbtn_addition_picture_return, LV_IMGBTN_STATE_RELEASED, NULL, &get_back, NULL);
    lv_obj_set_size(imgbtn_addition_picture_return, get_back.header.w, get_back.header.h);
    lv_obj_align(imgbtn_addition_picture_return, LV_ALIGN_TOP_LEFT, 180, 250);
    lv_obj_add_event_cb(imgbtn_addition_picture_return, imgbtn_modification_picture_return_event_cb, LV_EVENT_CLICKED, NULL);

    LV_IMG_DECLARE(confirm);
    imgbtn_addition_picture_confirm = lv_imgbtn_create(lv_scr_act());
    lv_imgbtn_set_src(imgbtn_addition_picture_confirm, LV_IMGBTN_STATE_RELEASED, NULL, &confirm, NULL);
    lv_obj_set_size(imgbtn_addition_picture_confirm, get_back.header.w, get_back.header.h);
    lv_obj_align(imgbtn_addition_picture_confirm, LV_ALIGN_TOP_LEFT, 250, 250);
    lv_obj_add_event_cb(imgbtn_addition_picture_confirm, imgbtn_modification_picture_confirm_event_cb, LV_EVENT_CLICKED, NULL);

    LV_FONT_DECLARE(heiFont16_1);
    label_addition_picture_confirm = lv_label_create(lv_scr_act());
    lv_obj_set_style_text_font(label_addition_picture_confirm, &heiFont16_1, LV_STATE_DEFAULT);
    lv_obj_set_style_text_color(label_addition_picture_confirm, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
    if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
    {
        lv_label_set_text(label_addition_picture_confirm, "确定");
    }
    else if(system_data.system.language == LANGUAGE_ENGLISH)
    {
        lv_label_set_text(label_addition_picture_confirm, "Confirm");
    }
    lv_obj_align(label_addition_picture_confirm, LV_ALIGN_TOP_LEFT, 277, 252);
}



static void button_modification_icon_confirm_event_cb(lv_event_t* e)
{
    lv_event_code_t code;
    int i, win_content_child_num;
    code = lv_event_get_code(e);
    if (code == LV_EVENT_CLICKED)
    {
        printf("button_modification_icon_confirm_event_cb\n\r");

        buzzer_enable = 1;

        win_content_child_num = g_modification_id;

        lv_obj_t* temp_obj = lv_obj_get_child(win_content,g_modification_id);

        //lv_obj_set_style_bg_opa(temp_obj, LV_OPA_TRANSP, 0);
        //lv_obj_set_style_border_width(temp_obj, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */

        //lv_obj_add_event_cb(temp_obj, drag_event_handler, LV_EVENT_PRESSING, NULL);
        //lv_obj_add_event_cb(temp_obj, drag_event_handler, LV_EVENT_FOCUSED, NULL);
        //lv_obj_add_event_cb(temp_obj, drag_event_handler, LV_EVENT_DEFOCUSED, NULL);
        //lv_obj_clear_flag(temp_obj, LV_OBJ_FLAG_SCROLLABLE);

        lv_obj_del(lv_obj_get_child(temp_obj,0));  

        lv_obj_t* img = lv_img_create(temp_obj);
        lv_img_set_src(img, &icon_buf[g_icon_type]);
        printf("w=%d\n\r", icon_buf[g_icon_type].header.w);
        printf("h=%d\n\r", icon_buf[g_icon_type].header.h);
        lv_obj_set_size(temp_obj, icon_buf[g_icon_type].header.w, icon_buf[g_icon_type].header.h);
        lv_obj_center(img);
        data_structure[win_content_child_num].data.icon.type = g_icon_type;
        data_structure[win_content_child_num].data.icon.size = 256;
        data_structure[win_content_child_num].type = TYPE_ICON;
        

        lv_obj_del(file_management_head_bg);
        lv_obj_del(label_file_management);

        for (i = 0; i < 98; i++)
        {
            lv_obj_del(lv_obj_get_child(typeface_obj[i].obj_typeface_btn, 0));
            lv_obj_del(typeface_obj[i].obj_typeface_btn);
        }

        lv_obj_del(win_content_typeface);
        lv_obj_del(win_obj_typeface);
        lv_obj_del(typeface_slider_bg);
        lv_obj_del(left_stop_img_typeface);
        lv_obj_del(slider_typeface);
        lv_obj_del(right_stop_img_typeface);
        lv_obj_del(keyboard_bg);
        lv_obj_del(label_typeface_return);
        lv_obj_del(btn_typeface_return);
        lv_obj_del(btn_typeface_confirm);
        lv_obj_del(label_typeface_confirm);
    }
}



static void button_modification_icon_return_event_cb(lv_event_t* e)
{
    lv_event_code_t code;
    int i;
    code = lv_event_get_code(e);
    if (code == LV_EVENT_CLICKED)
    {
        printf("button_modification_icon_return_event_cb\n\r");
        buzzer_enable = 1;
        lv_obj_del(file_management_head_bg);
        lv_obj_del(label_file_management);

        for (i = 0; i < 98; i++)
        {
            lv_obj_del(lv_obj_get_child(typeface_obj[i].obj_typeface_btn, 0));
            lv_obj_del(typeface_obj[i].obj_typeface_btn);
        }

        lv_obj_del(win_content_typeface);
        lv_obj_del(win_obj_typeface);
        lv_obj_del(typeface_slider_bg);
        lv_obj_del(left_stop_img_typeface);
        lv_obj_del(slider_typeface);
        lv_obj_del(right_stop_img_typeface);
        lv_obj_del(keyboard_bg);
        lv_obj_del(label_typeface_return);
        lv_obj_del(btn_typeface_return);
        lv_obj_del(btn_typeface_confirm);
        lv_obj_del(label_typeface_confirm);
    }
}



static void modification_icon(void)
{
    //int len = 0;
    int i;
    //int offset_address = 6;
    //int line_num = 8;
    int size_wide = 50;
    int size_high = 67;

    printf("modification_icon\n");

    //显示图标50*67
    file_management_head_bg = lv_obj_create(lv_scr_act());
    lv_obj_set_size(file_management_head_bg, 480, 24);
    lv_obj_align(file_management_head_bg, LV_ALIGN_TOP_LEFT, 0, 0);
    lv_obj_set_style_border_width(file_management_head_bg, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
    lv_obj_set_style_radius(file_management_head_bg, 0, LV_STATE_DEFAULT); /* 设置圆角 */
    lv_obj_set_style_bg_color(file_management_head_bg, lv_color_hex(0x28536a), LV_STATE_DEFAULT);
    lv_obj_remove_style(file_management_head_bg, 0, LV_PART_SCROLLBAR);


    LV_FONT_DECLARE(heiFont16_1);
    label_file_management = lv_label_create(lv_scr_act());
    lv_obj_set_style_text_font(label_file_management, &heiFont16_1, LV_STATE_DEFAULT);
    lv_obj_set_style_text_color(label_file_management, lv_color_hex(0xFFFFFF), LV_STATE_DEFAULT);
    if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
    {
        lv_label_set_text(label_file_management, "标识");
    }
    else if(system_data.system.language == LANGUAGE_ENGLISH)
    {
        lv_label_set_text(label_file_management, "Icon");
    }
    lv_obj_align(label_file_management, LV_ALIGN_TOP_LEFT, 200, 4);


    win_obj_typeface = lv_obj_create(lv_scr_act());
    lv_obj_align(win_obj_typeface, LV_ALIGN_TOP_LEFT, 0, 24);
    lv_obj_set_size(win_obj_typeface, 480, 224);
    lv_obj_set_style_bg_color(win_obj_typeface, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
    lv_obj_set_style_bg_opa(win_obj_typeface, LV_OPA_COVER, LV_STATE_DEFAULT);
    lv_obj_set_style_border_width(win_obj_typeface, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
    lv_obj_set_style_border_color(win_obj_typeface, lv_color_hex(0xcccccc), LV_STATE_DEFAULT); /* 设置边框颜色 */
    lv_obj_clear_flag(win_obj_typeface, LV_OBJ_FLAG_SCROLLABLE);
    lv_obj_set_style_radius(win_obj_typeface, 0, LV_STATE_DEFAULT); /* 设置圆角 */


    win_content_typeface = lv_obj_create(win_obj_typeface);
    lv_obj_set_size(win_content_typeface, 460, 960);
    lv_obj_align(win_content_typeface, LV_ALIGN_TOP_LEFT, -15, -15);
    lv_obj_set_style_bg_color(win_content_typeface, lv_color_hex(0x00F5FF), LV_STATE_DEFAULT);
    lv_obj_set_style_border_width(win_content_typeface, 2, LV_STATE_DEFAULT); /* 设置边框宽度 */
    lv_obj_set_style_border_color(win_content_typeface, lv_color_hex(0xcccccc), LV_STATE_DEFAULT); /* 设置边框颜色 */
    lv_obj_clear_flag(win_content_typeface, LV_OBJ_FLAG_SCROLLABLE);
    lv_obj_set_style_radius(win_content_typeface, 0, LV_STATE_DEFAULT); /* 设置圆角 */
    lv_obj_set_style_pad_all(win_content_typeface, 0, LV_STATE_DEFAULT);


    typeface_slider_bg = lv_obj_create(lv_scr_act());
    lv_obj_set_size(typeface_slider_bg, 20, 224);
    lv_obj_align(typeface_slider_bg, LV_ALIGN_TOP_LEFT, 460, 24);
    lv_obj_set_style_border_width(typeface_slider_bg, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
    lv_obj_set_style_border_color(typeface_slider_bg, lv_color_hex(0xaaaaaa), LV_STATE_DEFAULT); /* 设置边框颜色 */
    lv_obj_set_style_radius(typeface_slider_bg, 0, LV_STATE_DEFAULT); /* 设置圆角 */
    lv_obj_set_style_bg_color(typeface_slider_bg, lv_color_hex(0xaaaaaa), LV_STATE_DEFAULT);

    //左滑块停止
    LV_IMG_DECLARE(left_stop_typeface);
    left_stop_img_typeface = lv_img_create(lv_scr_act());
    lv_img_set_src(left_stop_img_typeface, &left_stop_typeface);
    lv_obj_align(left_stop_img_typeface, LV_ALIGN_TOP_LEFT, 460, 228);

    slider_show_icon();

    //右滑块停止
    LV_IMG_DECLARE(right_stop_typeface);
    right_stop_img_typeface = lv_img_create(lv_scr_act());
    lv_img_set_src(right_stop_img_typeface, &right_stop_typeface);
    lv_obj_align(right_stop_img_typeface, LV_ALIGN_TOP_LEFT, 460, 24);

    g_icon_type = data_structure[g_modification_id].data.icon.type;

    for (i = 0; i < 98; i++)
    {
        typeface_obj[i].obj_typeface_btn = lv_btn_create(win_content_typeface);
        lv_obj_set_size(typeface_obj[i].obj_typeface_btn, size_wide, size_high);
        lv_obj_align(typeface_obj[i].obj_typeface_btn, LV_ALIGN_TOP_LEFT, (i % 8 + 1) * 6 + (i % 8) * size_wide, (i / 8 + 1) * 6 + i / 8 * size_high);
        lv_obj_set_style_border_width(typeface_obj[i].obj_typeface_btn, 0, LV_PART_MAIN); /* 设置边框宽度 */
        lv_obj_set_style_border_color(typeface_obj[i].obj_typeface_btn, lv_color_hex(0xff0000), LV_PART_MAIN); /* 设置边框颜色 */
        lv_obj_set_style_radius(typeface_obj[i].obj_typeface_btn, 5, LV_PART_MAIN); /* 设置圆角 */
        lv_obj_set_style_bg_color(typeface_obj[i].obj_typeface_btn, lv_color_hex(0xffffff), LV_PART_MAIN);
        lv_obj_set_style_shadow_width(typeface_obj[i].obj_typeface_btn, 0, LV_PART_MAIN);
        lv_obj_add_event_cb(typeface_obj[i].obj_typeface_btn, button_icon_event_cb, LV_EVENT_ALL, NULL);


        //LV_IMG_DECLARE(upward);
        lv_obj_t* img = lv_img_create(typeface_obj[i].obj_typeface_btn);
        //lv_img_set_src(img, &upward);
        if (i < 98)
        {
            lv_img_set_src(img, &icon_buf[i]);
        }
        else
        {
            lv_img_set_src(img, &icon_buf[0]);
        }

        if (i == 2)
        {
            lv_img_set_zoom(img, 80);
        }
        else if (i == 6)
        {
            lv_img_set_zoom(img, 80);
        }
        else if (i == 9)
        {
            lv_img_set_zoom(img, 30);
        }
        else if (i == 11)
        {
            lv_img_set_zoom(img, 80);
        }
        else if (i == 15)
        {
            lv_img_set_zoom(img, 80);
        }
        else if (i == 19)
        {
            lv_img_set_zoom(img, 80);
        }
        else if (i == 23)
        {
            lv_img_set_zoom(img, 80);
        }
        else if (i == 27)
        {
            lv_img_set_zoom(img, 80);
        }
        else if (i == 31)
        {
            lv_img_set_zoom(img, 80);
        }
        else if (i == 35)
        {
            lv_img_set_zoom(img, 80);
        }
        else if((i > 36)&&(i < 44))
        {
            lv_img_set_zoom(img, 80);
        }
        else if (i == 45)
        {
            lv_img_set_zoom(img, 70);
        }
        else if ((i > 45) && (i < 50))
        {
            lv_img_set_zoom(img, 80);
        }
        else if (i == 57)
        {
            lv_img_set_zoom(img, 70);
        }
        else if (i == 59)
        {
            lv_img_set_zoom(img, 70);
        }
        else if (i == 60)
        {
            lv_img_set_zoom(img, 40);
        }
        else if (i == 61)
        {
            lv_img_set_zoom(img, 80);
        }
        else if (i == 62)
        {
            lv_img_set_zoom(img, 80);
        }
        else if (i == 63)
        {
            lv_img_set_zoom(img, 60);
        }
        else if (i == 64)
        {
            lv_img_set_zoom(img, 60);
        }
        else if (i == 65)
        {
            lv_img_set_zoom(img, 80);
        }
        else if (i == 66)
        {
            lv_img_set_zoom(img, 70);
        }
        else if (i == 67)
        {
            lv_img_set_zoom(img, 55);
        }
        else if (i == 68)
        {
            lv_img_set_zoom(img, 25);
        }
        else if (i == 69)
        {
            lv_img_set_zoom(img, 50);
        }
        else if (i == 70)
        {
            lv_img_set_zoom(img, 85);
        }
        else if (i == 71)
        {
            lv_img_set_zoom(img, 80);
        }
        else if (i == 72)
        {
            lv_img_set_zoom(img, 70);
        }
        else if (i == 73)
        {
            lv_img_set_zoom(img, 70);
        }
        else if (i == 74)
        {
            lv_img_set_zoom(img, 70);
        }
        else if (i == 75)
        {
            lv_img_set_zoom(img, 50);
        }
        else if (i == 76)
        {
            lv_img_set_zoom(img, 70);
        }
        else if (i == 77)
        {
            lv_img_set_zoom(img, 70);
        }
        else if (i == 78)
        {
            lv_img_set_zoom(img, 70);
        }
        else if (i == 80)
        {
            lv_img_set_zoom(img, 60);
        }
        else if (i == 81)
        {
            lv_img_set_zoom(img, 45);
        }
        else if (i == 82)
        {
            lv_img_set_zoom(img, 45);
        }
        else if (i == 83)
        {
            lv_img_set_zoom(img, 60);
        }
        else if (i == 84)
        {
            lv_img_set_zoom(img, 60);
        }
        else if (i == 85)
        {
            lv_img_set_zoom(img, 70);
        }
        else if (i == 86)
        {
            lv_img_set_zoom(img, 70);
        }
        else if (i == 87)
        {
            lv_img_set_zoom(img, 55);
        }
        else if (i == 88)
        {
            lv_img_set_zoom(img, 35);
        }
        else if (i == 89)
        {
            lv_img_set_zoom(img, 80);
        }
        else if (i == 90)
        {
            lv_img_set_zoom(img, 65);
        }
        else if (i == 91)
        {
            lv_img_set_zoom(img, 70);
        }
        else if (i == 92)
        {
            lv_img_set_zoom(img, 70);
        }
        else if (i == 93)
        {
            lv_img_set_zoom(img, 80);
        }
        else if (i == 94)
        {
            lv_img_set_zoom(img, 80);
        }
        else if (i == 95)
        {
            lv_img_set_zoom(img, 80);
        }
        else if (i == 96)
        {
            lv_img_set_zoom(img, 80);
        }
        else if (i == 97)
        {
            lv_img_set_zoom(img, 80);
        }
        else
        {
            lv_img_set_zoom(img, 100);
        }
        lv_obj_align(img, LV_ALIGN_CENTER, 0, 0);
    }

    keyboard_bg = lv_obj_create(lv_scr_act());
    lv_obj_set_size(keyboard_bg, 480, 24);
    lv_obj_align(keyboard_bg, LV_ALIGN_TOP_LEFT, 0, 248);
    lv_obj_set_style_border_width(keyboard_bg, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
    lv_obj_set_style_radius(keyboard_bg, 0, LV_STATE_DEFAULT); /* 设置圆角 */
    lv_obj_set_style_bg_color(keyboard_bg, lv_color_hex(0x28536a), LV_STATE_DEFAULT);
    lv_obj_remove_style(keyboard_bg, 0, LV_PART_SCROLLBAR);


    LV_FONT_DECLARE(heiFont16_1);
    label_typeface_return = lv_label_create(lv_scr_act());
    lv_obj_set_style_text_font(label_typeface_return, &heiFont16_1, LV_STATE_DEFAULT);
    lv_obj_set_style_text_color(label_typeface_return, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
    if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
    {
        lv_label_set_text(label_typeface_return, "返回");
    }
    else if(system_data.system.language == LANGUAGE_ENGLISH)
    {
        lv_label_set_text(label_typeface_return, "Return");
    }
    lv_obj_align(label_typeface_return, LV_ALIGN_TOP_LEFT, 140, 252);

    LV_IMG_DECLARE(get_back);
    btn_typeface_return = lv_imgbtn_create(lv_scr_act());
    lv_imgbtn_set_src(btn_typeface_return, LV_IMGBTN_STATE_RELEASED, NULL, &get_back, NULL);
    lv_obj_set_size(btn_typeface_return, get_back.header.w, get_back.header.h);
    lv_obj_align(btn_typeface_return, LV_ALIGN_TOP_LEFT, 180, 250);
    lv_obj_add_event_cb(btn_typeface_return, button_modification_icon_return_event_cb, LV_EVENT_CLICKED, NULL);


    LV_IMG_DECLARE(confirm);
    btn_typeface_confirm = lv_imgbtn_create(lv_scr_act());
    lv_imgbtn_set_src(btn_typeface_confirm, LV_IMGBTN_STATE_RELEASED, NULL, &confirm, NULL);
    lv_obj_set_size(btn_typeface_confirm, get_back.header.w, get_back.header.h);
    lv_obj_align(btn_typeface_confirm, LV_ALIGN_TOP_LEFT, 250, 250);
    lv_obj_add_event_cb(btn_typeface_confirm, button_modification_icon_confirm_event_cb, LV_EVENT_CLICKED, NULL);

    LV_FONT_DECLARE(heiFont16_1);
    label_typeface_confirm = lv_label_create(lv_scr_act());
    lv_obj_set_style_text_font(label_typeface_confirm, &heiFont16_1, LV_STATE_DEFAULT);
    lv_obj_set_style_text_color(label_typeface_confirm, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
    if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
    {
        lv_label_set_text(label_typeface_confirm, "确定");
    }
    else if(system_data.system.language == LANGUAGE_ENGLISH)
    {
        lv_label_set_text(label_typeface_confirm, "Confirm");
    }
    lv_obj_align(label_typeface_confirm, LV_ALIGN_TOP_LEFT, 277, 252);
    
}


static void btn_modification_count_return_event_cb(lv_event_t* e)
{
    lv_event_code_t code;
    code = lv_event_get_code(e);

    if (code == LV_EVENT_CLICKED)
    {
        printf("btn_modification_count_return_event_cb\n");
        buzzer_enable = 1;

        lv_obj_del(addition_count_head_bg);
        lv_obj_del(label_addition_count_head);
        lv_obj_del(img_addition_count_law);
        lv_obj_del(label_addition_count_law);
        lv_obj_del(dropdown_addition_count_law);
        lv_obj_del(img_addition_count_repetition);
        lv_obj_del(label_addition_count_times_repetition);
        lv_obj_del(label_btn_addition_count_times_repetition);
        lv_obj_del(btn_addition_count_times_repetition);
        lv_obj_del(img_addition_count_typeface);
        lv_obj_del(label_addition_count_typeface);
        lv_obj_del(label_btn_addition_count_typeface);
        lv_obj_del(btn_addition_count_typeface);
        lv_obj_del(img_addition_count_size);
        lv_obj_del(label_addition_count_size);
        lv_obj_del(label_btn_addition_count_size);
        lv_obj_del(btn_addition_count_size);
        lv_obj_del(img_addition_count_space);
        lv_obj_del(label_addition_count_space);
        lv_obj_del(label_btn_addition_count_space);
        lv_obj_del(btn_addition_count_space);
        lv_obj_del(img_addition_count_lead_zero);
        lv_obj_del(label_addition_count_lead_zero);
        lv_obj_del(dropdown_addition_count_lead_zero);
        lv_obj_del(img_addition_count_current_value);
        lv_obj_del(label_addition_count_current_value);
        lv_obj_del(label_btn_addition_count_current_value);
        lv_obj_del(btn_addition_count_current_value);
        lv_obj_del(img_addition_count_minimum);
        lv_obj_del(label_addition_count_minimum);
        lv_obj_del(label_btn_addition_count_minimum);
        lv_obj_del(btn_addition_count_minimum);
        lv_obj_del(img_addition_count_maximum);
        lv_obj_del(label_addition_count_maximum);
        lv_obj_del(label_btn_addition_count_maximum);
        lv_obj_del(btn_addition_count_maximum);
        lv_obj_del(img_addition_count_step);
        lv_obj_del(label_addition_count_step);
        lv_obj_del(label_btn_addition_count_step);
        lv_obj_del(btn_addition_count_step);
        lv_obj_del(obj_addition_count_middle_bg);
        lv_obj_del(label_addition_count_preview);
        lv_obj_del(obj_addition_count_middle_bg_1);

        lv_obj_del(obj_addition_count_bottom_bg);
        lv_obj_del(label_addition_count_return);
        lv_obj_del(imgbtn_addition_count_return);
        lv_obj_del(imgbtn_addition_count_confirm);
        lv_obj_del(label_addition_count_confirm);
    }
}




static void btn_modification_count_confirm_event_cb(lv_event_t* e)
{
    lv_event_code_t code;
    code = lv_event_get_code(e);
    //char temp_typeface[128] = { 0 };
    int i = 0;
    int word_space = 0;
    int word_size = 0;
    //int x_size = 0;
    //int y_size = 0;
    int win_content_child_num = 0;
    char tempString[32] = { 0 };

    if (code == LV_EVENT_CLICKED)
    {
        printf("btn_modification_count_confirm_event_cb\n");

        buzzer_enable = 1;
        win_content_child_num = g_modification_id;

        lv_style_reset(&data_structure[g_modification_id].data.count.style);
        //lv_ft_font_destroy(data_structure[g_modification_id].data.count.info.font);

        //保存所有数据
        data_structure[win_content_child_num].data.count.law = lv_dropdown_get_selected(dropdown_addition_count_law);
        data_structure[win_content_child_num].data.count.repetition = atoi(lv_label_get_text(label_btn_addition_count_times_repetition));

        lv_obj_t* temp_obj = lv_obj_get_child(win_content,g_modification_id);

        for (i = 0; i < TYPEFACE_NUMBER; i++)
        {
            if (strncmp(lv_label_get_text(label_btn_addition_count_typeface), typeface_name[i], strlen(lv_label_get_text(label_btn_addition_count_typeface))) == 0)
            {
                break;
            }
        }

        printf("i=%d\n", i);

        //sprintf(temp_typeface, "/media/%s", typeface_buf[i]);
        data_structure[win_content_child_num].data.count.typeface = i;
        //printf("%s\n", temp_typeface);
        //data_structure[win_content_child_num].data.count.info.name = temp_typeface;
        word_size = atoi(lv_label_get_text(label_btn_addition_count_size));

        if (word_size < 12)
        {
            word_size = 12;
        }

        if (word_size > 200)
        {
            word_size = 200;
        }

        data_structure[win_content_child_num].data.count.info.weight = word_size;

        data_structure[win_content_child_num].data.count.info.style = FT_FONT_STYLE_NORMAL;

        //lv_ft_font_init(&data_structure[win_content_child_num].data.count.info);
        lv_font_t* temp_font = font_list_get(i, word_size, 0);

        //当前值
        data_structure[win_content_child_num].data.count.current_value = atoi(lv_label_get_text(label_btn_addition_count_current_value));
        //最小值
        data_structure[win_content_child_num].data.count.minimum = atoi(lv_label_get_text(label_btn_addition_count_minimum));
        //最大值
        data_structure[win_content_child_num].data.count.maximum = atoi(lv_label_get_text(label_btn_addition_count_maximum));
        //前置0
        data_structure[win_content_child_num].data.count.lead_zero = lv_dropdown_get_selected(dropdown_addition_count_lead_zero);
        //步进值
        data_structure[win_content_child_num].data.count.step = atoi(lv_label_get_text(label_btn_addition_count_step));

        printf("lead_zero=%d\n\r", data_structure[win_content_child_num].data.count.lead_zero);
        printf("law=%d\n\r", data_structure[win_content_child_num].data.count.law);

        //确定显示值的位数
        //递增
        if (data_structure[win_content_child_num].data.count.law == 0)
        {
            if (data_structure[win_content_child_num].data.count.current_value < data_structure[win_content_child_num].data.count.minimum)
            {
                data_structure[win_content_child_num].data.count.current_value = data_structure[win_content_child_num].data.count.minimum;
            }
            else if(data_structure[win_content_child_num].data.count.current_value > data_structure[win_content_child_num].data.count.maximum)
            {
                data_structure[win_content_child_num].data.count.current_value = data_structure[win_content_child_num].data.count.maximum;
            }

            if (data_structure[win_content_child_num].data.count.lead_zero == 0)
            {
                formatNumberWithLeadingZeros(data_structure[win_content_child_num].data.count.current_value, data_structure[win_content_child_num].data.count.maximum, tempString);
            }
            else
            {
                sprintf(tempString, "%d", data_structure[win_content_child_num].data.count.current_value);
            }
        }
        else
        {
            if (data_structure[win_content_child_num].data.count.current_value < data_structure[win_content_child_num].data.count.minimum)
            {
                data_structure[win_content_child_num].data.count.current_value = data_structure[win_content_child_num].data.count.minimum;
            }
            else if (data_structure[win_content_child_num].data.count.current_value > data_structure[win_content_child_num].data.count.maximum)
            {
                data_structure[win_content_child_num].data.count.current_value = data_structure[win_content_child_num].data.count.maximum;
            }

            if (data_structure[win_content_child_num].data.count.lead_zero == 0)
            {
                formatNumberWithLeadingZeros(data_structure[win_content_child_num].data.count.current_value, data_structure[win_content_child_num].data.count.maximum, tempString);
            }
            else
            {
                sprintf(tempString, "%d", data_structure[win_content_child_num].data.count.current_value);
            }       
        }

        printf("tempString=%s\n\r", tempString);

        word_space = atoi(lv_label_get_text(label_btn_addition_count_space));

        if (word_space < 0)
        {
            word_space = 0;
        }

        if (word_space > 100)
        {
            word_space = 100;
        }

        lv_point_t text_size;
        lv_txt_get_size(&text_size, tempString, temp_font, word_space, 0, LV_COORD_MAX, LV_TEXT_FLAG_NONE);

        //lv_obj_set_style_bg_opa(temp_obj, LV_OPA_TRANSP, 0);
        //lv_obj_set_style_border_width(temp_obj, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */

        //lv_obj_add_event_cb(temp_obj, drag_event_handler, LV_EVENT_PRESSING, NULL);
        //lv_obj_add_event_cb(temp_obj, drag_event_handler, LV_EVENT_FOCUSED, NULL);
        //lv_obj_add_event_cb(temp_obj, drag_event_handler, LV_EVENT_DEFOCUSED, NULL);
        //lv_obj_clear_flag(temp_obj, LV_OBJ_FLAG_SCROLLABLE);

        lv_style_init(&data_structure[win_content_child_num].data.count.style);
        lv_style_set_text_font(&data_structure[win_content_child_num].data.count.style, temp_font);

        printf("x=%u y=%u\n\r", text_size.x, text_size.y);
        lv_obj_set_size(temp_obj, text_size.x, text_size.y);

        lv_style_set_text_letter_space(&data_structure[win_content_child_num].data.count.style, word_space);

        lv_obj_del(lv_obj_get_child(temp_obj,0));

        lv_obj_t* label1 = lv_label_create(temp_obj);
        lv_obj_add_style(label1, &data_structure[win_content_child_num].data.count.style, 0);
        lv_label_set_text(label1, tempString);
        lv_obj_center(label1);
        data_structure[win_content_child_num].data.count.size = word_size;
        data_structure[win_content_child_num].data.count.space = word_space;
        data_structure[win_content_child_num].type = TYPE_COUNT;
        

        lv_obj_del(addition_count_head_bg);
        lv_obj_del(label_addition_count_head);
        lv_obj_del(img_addition_count_law);
        lv_obj_del(label_addition_count_law);
        lv_obj_del(dropdown_addition_count_law);
        lv_obj_del(img_addition_count_repetition);
        lv_obj_del(label_addition_count_times_repetition);
        lv_obj_del(label_btn_addition_count_times_repetition);
        lv_obj_del(btn_addition_count_times_repetition);
        lv_obj_del(img_addition_count_typeface);
        lv_obj_del(label_addition_count_typeface);
        lv_obj_del(label_btn_addition_count_typeface);
        lv_obj_del(btn_addition_count_typeface);
        lv_obj_del(img_addition_count_size);
        lv_obj_del(label_addition_count_size);
        lv_obj_del(label_btn_addition_count_size);
        lv_obj_del(btn_addition_count_size);
        lv_obj_del(img_addition_count_space);
        lv_obj_del(label_addition_count_space);
        lv_obj_del(label_btn_addition_count_space);
        lv_obj_del(btn_addition_count_space);
        lv_obj_del(img_addition_count_lead_zero);
        lv_obj_del(label_addition_count_lead_zero);
        lv_obj_del(dropdown_addition_count_lead_zero);
        lv_obj_del(img_addition_count_current_value);
        lv_obj_del(label_addition_count_current_value);
        lv_obj_del(label_btn_addition_count_current_value);
        lv_obj_del(btn_addition_count_current_value);
        lv_obj_del(img_addition_count_minimum);
        lv_obj_del(label_addition_count_minimum);
        lv_obj_del(label_btn_addition_count_minimum);
        lv_obj_del(btn_addition_count_minimum);
        lv_obj_del(img_addition_count_maximum);
        lv_obj_del(label_addition_count_maximum);
        lv_obj_del(label_btn_addition_count_maximum);
        lv_obj_del(btn_addition_count_maximum);
        lv_obj_del(img_addition_count_step);
        lv_obj_del(label_addition_count_step);
        lv_obj_del(label_btn_addition_count_step);
        lv_obj_del(btn_addition_count_step);
        lv_obj_del(obj_addition_count_middle_bg);
        lv_obj_del(label_addition_count_preview);
        lv_obj_del(obj_addition_count_middle_bg_1);

        lv_obj_del(obj_addition_count_bottom_bg);
        lv_obj_del(label_addition_count_return);
        lv_obj_del(imgbtn_addition_count_return);
        lv_obj_del(imgbtn_addition_count_confirm);
        lv_obj_del(label_addition_count_confirm);
    }
}




static void modification_count(void)
{
    char tempBuf[128]={0};
    char* opts_addition_count_law;
    char* opts_addition_count_lead_zero;

    printf("modification_count\n");
    addition_count_head_bg = lv_obj_create(lv_scr_act());
    lv_obj_set_size(addition_count_head_bg, 480, 24);
    lv_obj_align(addition_count_head_bg, LV_ALIGN_TOP_LEFT, 0, 0);
    lv_obj_set_style_border_width(addition_count_head_bg, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
    lv_obj_set_style_radius(addition_count_head_bg, 0, LV_STATE_DEFAULT); /* 设置圆角 */
    lv_obj_set_style_bg_color(addition_count_head_bg, lv_color_hex(0x28536a), LV_STATE_DEFAULT);
    lv_obj_remove_style(addition_count_head_bg, 0, LV_PART_SCROLLBAR);


    LV_FONT_DECLARE(heiFont16_1);
    label_addition_count_head = lv_label_create(lv_scr_act());
    lv_obj_set_style_text_font(label_addition_count_head, &heiFont16_1, LV_STATE_DEFAULT);
    lv_obj_set_style_text_color(label_addition_count_head, lv_color_hex(0xFFFFFF), LV_STATE_DEFAULT);
    if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
    {
        lv_label_set_text(label_addition_count_head,  "计数");
    }
    else if(system_data.system.language == LANGUAGE_ENGLISH)
    {
        lv_label_set_text(label_addition_count_head, "Count");
    }
    lv_obj_align(label_addition_count_head, LV_ALIGN_TOP_LEFT, 200, 4);


    obj_addition_count_middle_bg = lv_obj_create(lv_scr_act());
    lv_obj_set_size(obj_addition_count_middle_bg, 480, 224);
    lv_obj_align(obj_addition_count_middle_bg, LV_ALIGN_TOP_LEFT, 0, 24);
    lv_obj_set_style_border_width(obj_addition_count_middle_bg, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
    lv_obj_set_style_radius(obj_addition_count_middle_bg, 0, LV_STATE_DEFAULT); /* 设置圆角 */
    lv_obj_set_style_bg_color(obj_addition_count_middle_bg, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
    lv_obj_set_style_pad_all(obj_addition_count_middle_bg, 0, LV_STATE_DEFAULT);


    obj_addition_count_middle_bg_1 = lv_obj_create(lv_scr_act());
    lv_obj_set_size(obj_addition_count_middle_bg_1, 480, 40);
    lv_obj_align(obj_addition_count_middle_bg_1, LV_ALIGN_TOP_LEFT, 0, 24);
    lv_obj_set_style_border_width(obj_addition_count_middle_bg_1, 2, LV_STATE_DEFAULT); /* 设置边框宽度 */
    lv_obj_set_style_border_color(obj_addition_count_middle_bg_1, lv_color_hex(0x000000), LV_STATE_DEFAULT); /* 设置边框颜色 */
    lv_obj_set_style_radius(obj_addition_count_middle_bg_1, 0, LV_STATE_DEFAULT); /* 设置圆角 */
    lv_obj_set_style_bg_color(obj_addition_count_middle_bg_1, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
    lv_obj_set_style_pad_all(obj_addition_count_middle_bg_1, 0, LV_STATE_DEFAULT);


    LV_FONT_DECLARE(heiFont16_1);
    label_addition_count_preview = lv_label_create(obj_addition_count_middle_bg_1);
    lv_obj_set_style_text_font(label_addition_count_preview, &heiFont16_1, LV_STATE_DEFAULT);
    lv_obj_set_style_text_color(label_addition_count_preview, lv_color_hex(0x000000), LV_STATE_DEFAULT);
    lv_label_set_text(label_addition_count_preview,data_structure[g_modification_id].data.count.text);
    lv_obj_set_style_border_width(label_addition_count_preview, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
    lv_obj_set_style_border_color(label_addition_count_preview, lv_color_hex(0x000000), LV_STATE_DEFAULT); /* 设置边框颜色 */
    lv_obj_set_style_border_opa(label_addition_count_preview, 100, LV_STATE_DEFAULT); /* 设置边框透明度 */
    lv_obj_align(label_addition_count_preview, LV_ALIGN_CENTER, 0, 0);


    LV_IMG_DECLARE(law);
    img_addition_count_law = lv_img_create(obj_addition_count_middle_bg);
    lv_img_set_src(img_addition_count_law, &law);
    lv_obj_align(img_addition_count_law, LV_ALIGN_TOP_LEFT, 15, 48);

    LV_FONT_DECLARE(heiFont16_1);
    label_addition_count_law = lv_label_create(obj_addition_count_middle_bg);
    lv_obj_set_style_text_font(label_addition_count_law, &heiFont16_1, LV_STATE_DEFAULT);
    lv_obj_set_style_text_color(label_addition_count_law, lv_color_hex(0x000000), LV_STATE_DEFAULT);
    if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
    {
        lv_label_set_text(label_addition_count_law,  "规律");
    }
    else if(system_data.system.language == LANGUAGE_ENGLISH)
    {
        lv_label_set_text(label_addition_count_law, "Law");
    }
    lv_obj_align(label_addition_count_law, LV_ALIGN_TOP_LEFT, 50, 54);


    if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
    {
        opts_addition_count_law = "递增\n递减";
    }
    else if(system_data.system.language == LANGUAGE_ENGLISH)
    {
        opts_addition_count_law = "Increase\nDecrease";
    }
    else
    {
        opts_addition_count_law = "递增\n递减";
    } 
    dropdown_addition_count_law = lv_dropdown_create(obj_addition_count_middle_bg);
    lv_obj_set_style_border_width(dropdown_addition_count_law, 1, LV_STATE_DEFAULT); /* 设置边框宽度 */
    lv_obj_set_style_radius(dropdown_addition_count_law, 10, LV_STATE_DEFAULT); /* 设置圆角 */
    lv_obj_set_style_border_color(dropdown_addition_count_law, lv_color_hex(0x000000), LV_STATE_DEFAULT); /* 设置边框颜色 */
    lv_dropdown_set_options_static(dropdown_addition_count_law, opts_addition_count_law);
    lv_obj_align(dropdown_addition_count_law, LV_ALIGN_TOP_LEFT, 115, 44);
    lv_obj_set_style_width(dropdown_addition_count_law, 110, LV_STATE_DEFAULT);
    LV_FONT_DECLARE(heiFont14);
    lv_obj_set_style_text_font(dropdown_addition_count_law, &heiFont14, LV_STATE_DEFAULT);
    lv_obj_set_style_height(dropdown_addition_count_law, 33, LV_STATE_DEFAULT);
    lv_obj_t* opts_addition_count_law_list = lv_dropdown_get_list(dropdown_addition_count_law);
    lv_obj_set_style_text_font(opts_addition_count_law_list, &heiFont14, 0);   // 设置新的字体
    LV_IMG_DECLARE(dropdown);
    lv_dropdown_set_symbol(dropdown_addition_count_law, &dropdown);
    lv_obj_add_event_cb(dropdown_addition_count_law, dropdown_addition_count_law_event_handler, LV_EVENT_ALL, NULL);

    lv_dropdown_set_selected(dropdown_addition_count_law, data_structure[g_modification_id].data.count.law); 

    LV_IMG_DECLARE(repetition);
    img_addition_count_repetition = lv_img_create(obj_addition_count_middle_bg);
    lv_img_set_src(img_addition_count_repetition, &repetition);
    lv_obj_align(img_addition_count_repetition, LV_ALIGN_TOP_LEFT, 15, 83);

    LV_FONT_DECLARE(heiFont16_1);
    label_addition_count_times_repetition = lv_label_create(obj_addition_count_middle_bg);
    lv_obj_set_style_text_font(label_addition_count_times_repetition, &heiFont16_1, LV_STATE_DEFAULT);
    lv_obj_set_style_text_color(label_addition_count_times_repetition, lv_color_hex(0x000000), LV_STATE_DEFAULT);
    if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
    {
        lv_label_set_text(label_addition_count_times_repetition,  "重复");
    }
    else if(system_data.system.language == LANGUAGE_ENGLISH)
    {
        lv_label_set_text(label_addition_count_times_repetition, "Repetition");
    }
    lv_obj_align(label_addition_count_times_repetition, LV_ALIGN_TOP_LEFT, 50, 89);

    LV_FONT_DECLARE(heiFont16_1);
    btn_addition_count_times_repetition = lv_btn_create(obj_addition_count_middle_bg);
    lv_obj_set_size(btn_addition_count_times_repetition, 110, 30);
    lv_obj_align(btn_addition_count_times_repetition, LV_ALIGN_TOP_LEFT, 115, 81);
    lv_obj_set_style_border_width(btn_addition_count_times_repetition, 1, LV_STATE_DEFAULT); /* 设置边框宽度 */
    lv_obj_set_style_radius(btn_addition_count_times_repetition, 10, LV_STATE_DEFAULT); /* 设置圆角 */
    lv_obj_set_style_bg_color(btn_addition_count_times_repetition, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
    label_btn_addition_count_times_repetition = lv_label_create(btn_addition_count_times_repetition);
    lv_obj_set_style_text_font(label_btn_addition_count_times_repetition, &heiFont16_1, LV_STATE_DEFAULT);
    lv_obj_set_style_text_color(label_btn_addition_count_times_repetition, lv_color_hex(0x1C1C1C), LV_STATE_DEFAULT);
    sprintf(tempBuf,"%d",data_structure[g_modification_id].data.count.repetition); 
    lv_label_set_text(label_btn_addition_count_times_repetition, tempBuf);
    lv_obj_align(label_btn_addition_count_times_repetition, LV_ALIGN_CENTER, 0, 0);
    lv_obj_set_style_border_width(label_btn_addition_count_times_repetition, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
    lv_obj_set_style_border_color(label_btn_addition_count_times_repetition, lv_color_hex(0x8a8a8a), LV_STATE_DEFAULT); /* 设置边框颜色 */
    lv_obj_set_style_border_opa(label_btn_addition_count_times_repetition, 100, LV_STATE_DEFAULT); /* 设置边框透明度 */
    lv_obj_set_style_radius(label_btn_addition_count_times_repetition, 0, LV_STATE_DEFAULT); /* 设置圆角 */
    lv_obj_set_style_bg_opa(label_btn_addition_count_times_repetition, LV_OPA_COVER, LV_PART_MAIN);
    lv_obj_set_style_bg_color(label_btn_addition_count_times_repetition, lv_color_hex(0xffffff), LV_PART_MAIN);
    lv_obj_add_event_cb(btn_addition_count_times_repetition, btn_addition_count_times_repetition_mode_event_cb, LV_EVENT_CLICKED, NULL);


    LV_IMG_DECLARE(typeface);
    img_addition_count_typeface = lv_img_create(obj_addition_count_middle_bg);
    lv_img_set_src(img_addition_count_typeface, &typeface);
    lv_obj_align(img_addition_count_typeface, LV_ALIGN_TOP_LEFT, 15, 119);


    LV_FONT_DECLARE(heiFont16_1);
    label_addition_count_typeface = lv_label_create(obj_addition_count_middle_bg);
    lv_obj_set_style_text_font(label_addition_count_typeface, &heiFont16_1, LV_STATE_DEFAULT);
    lv_obj_set_style_text_color(label_addition_count_typeface, lv_color_hex(0x000000), LV_STATE_DEFAULT);
    if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
    {
        lv_label_set_text(label_addition_count_typeface,  "字体");
    }
    else if(system_data.system.language == LANGUAGE_ENGLISH)
    {
        lv_label_set_text(label_addition_count_typeface, "Typeface");
    }
    lv_obj_align(label_addition_count_typeface, LV_ALIGN_TOP_LEFT, 50, 124);


    LV_FONT_DECLARE(heiFont16_1);
    btn_addition_count_typeface = lv_btn_create(obj_addition_count_middle_bg);
    lv_obj_set_size(btn_addition_count_typeface, 110, 30);
    lv_obj_align(btn_addition_count_typeface, LV_ALIGN_TOP_LEFT, 115, 116);
    lv_obj_set_style_border_width(btn_addition_count_typeface, 1, LV_STATE_DEFAULT); /* 设置边框宽度 */
    lv_obj_set_style_radius(btn_addition_count_typeface, 10, LV_STATE_DEFAULT); /* 设置圆角 */
    lv_obj_set_style_bg_color(btn_addition_count_typeface, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
    label_btn_addition_count_typeface = lv_label_create(btn_addition_count_typeface);
    lv_obj_set_style_text_font(label_btn_addition_count_typeface, &heiFont16_1, LV_STATE_DEFAULT);
    lv_obj_set_style_text_color(label_btn_addition_count_typeface, lv_color_hex(0x1C1C1C), LV_STATE_DEFAULT);
    lv_label_set_text(label_btn_addition_count_typeface, typeface_name[data_structure[g_modification_id].data.count.typeface]);
    lv_obj_align(label_btn_addition_count_typeface, LV_ALIGN_CENTER, 0, 0);
    lv_obj_set_style_border_width(label_btn_addition_count_typeface, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
    lv_obj_set_style_border_color(label_btn_addition_count_typeface, lv_color_hex(0x8a8a8a), LV_STATE_DEFAULT); /* 设置边框颜色 */
    lv_obj_set_style_border_opa(label_btn_addition_count_typeface, 100, LV_STATE_DEFAULT); /* 设置边框透明度 */
    lv_obj_set_style_radius(label_btn_addition_count_typeface, 0, LV_STATE_DEFAULT); /* 设置圆角 */
    lv_obj_set_style_bg_opa(label_btn_addition_count_typeface, LV_OPA_COVER, LV_PART_MAIN);
    lv_obj_set_style_bg_color(label_btn_addition_count_typeface, lv_color_hex(0xffffff), LV_PART_MAIN);
    lv_obj_add_event_cb(btn_addition_count_typeface, btn_addition_count_typeface_event_cb, LV_EVENT_CLICKED, NULL);


    LV_IMG_DECLARE(word_size);
    img_addition_count_size = lv_img_create(obj_addition_count_middle_bg);
    lv_img_set_src(img_addition_count_size, &word_size);
    lv_obj_align(img_addition_count_size, LV_ALIGN_TOP_LEFT, 15, 154);


    LV_FONT_DECLARE(heiFont16_1);
    label_addition_count_size = lv_label_create(obj_addition_count_middle_bg);
    lv_obj_set_style_text_font(label_addition_count_size, &heiFont16_1, LV_STATE_DEFAULT);
    lv_obj_set_style_text_color(label_addition_count_size, lv_color_hex(0x000000), LV_STATE_DEFAULT);
    if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
    {
        lv_label_set_text(label_addition_count_size,  "字号");
    }
    else if(system_data.system.language == LANGUAGE_ENGLISH)
    {
        lv_label_set_text(label_addition_count_size, "Size");
    }
    lv_obj_align(label_addition_count_size, LV_ALIGN_TOP_LEFT, 50, 159);

    LV_FONT_DECLARE(heiFont16_1);
    btn_addition_count_size = lv_btn_create(obj_addition_count_middle_bg);
    lv_obj_set_size(btn_addition_count_size, 110, 30);
    lv_obj_align(btn_addition_count_size, LV_ALIGN_TOP_LEFT, 115, 151);
    lv_obj_set_style_border_width(btn_addition_count_size, 1, LV_STATE_DEFAULT); /* 设置边框宽度 */
    lv_obj_set_style_radius(btn_addition_count_size, 10, LV_STATE_DEFAULT); /* 设置圆角 */
    lv_obj_set_style_bg_color(btn_addition_count_size, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
    label_btn_addition_count_size = lv_label_create(btn_addition_count_size);
    lv_obj_set_style_text_font(label_btn_addition_count_size, &heiFont16_1, LV_STATE_DEFAULT);
    lv_obj_set_style_text_color(label_btn_addition_count_size, lv_color_hex(0x1C1C1C), LV_STATE_DEFAULT);
    sprintf(tempBuf,"%d",data_structure[g_modification_id].data.count.size);
    lv_label_set_text(label_btn_addition_count_size, tempBuf);
    lv_obj_align(label_btn_addition_count_size, LV_ALIGN_CENTER, 0, 0);
    lv_obj_set_style_border_width(label_btn_addition_count_size, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
    lv_obj_set_style_border_color(label_btn_addition_count_size, lv_color_hex(0x8a8a8a), LV_STATE_DEFAULT); /* 设置边框颜色 */
    lv_obj_set_style_border_opa(label_btn_addition_count_size, 100, LV_STATE_DEFAULT); /* 设置边框透明度 */
    lv_obj_set_style_radius(label_btn_addition_count_size, 0, LV_STATE_DEFAULT); /* 设置圆角 */
    lv_obj_set_style_bg_opa(label_btn_addition_count_size, LV_OPA_COVER, LV_PART_MAIN);
    lv_obj_set_style_bg_color(label_btn_addition_count_size, lv_color_hex(0xffffff), LV_PART_MAIN);
    lv_obj_add_event_cb(btn_addition_count_size, btn_addition_count_size_event_cb, LV_EVENT_CLICKED, NULL);


    LV_IMG_DECLARE(word_space);
    img_addition_count_space = lv_img_create(obj_addition_count_middle_bg);
    lv_img_set_src(img_addition_count_space, &word_space);
    lv_obj_align(img_addition_count_space, LV_ALIGN_TOP_LEFT, 15, 188);


    LV_FONT_DECLARE(heiFont16_1);
    label_addition_count_space = lv_label_create(obj_addition_count_middle_bg);
    lv_obj_set_style_text_font(label_addition_count_space, &heiFont16_1, LV_STATE_DEFAULT);
    lv_obj_set_style_text_color(label_addition_count_space, lv_color_hex(0x000000), LV_STATE_DEFAULT);
    if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
    {
        lv_label_set_text(label_addition_count_space,  "间距");
    }
    else if(system_data.system.language == LANGUAGE_ENGLISH)
    {
        lv_label_set_text(label_addition_count_space, "Space");
    }
    lv_obj_align(label_addition_count_space, LV_ALIGN_TOP_LEFT, 50, 194);


    LV_FONT_DECLARE(heiFont16_1);
    btn_addition_count_space = lv_btn_create(obj_addition_count_middle_bg);
    lv_obj_set_size(btn_addition_count_space, 110, 30);
    lv_obj_align(btn_addition_count_space, LV_ALIGN_TOP_LEFT, 115, 186);
    lv_obj_set_style_border_width(btn_addition_count_space, 1, LV_STATE_DEFAULT); /* 设置边框宽度 */
    lv_obj_set_style_radius(btn_addition_count_space, 10, LV_STATE_DEFAULT); /* 设置圆角 */
    lv_obj_set_style_bg_color(btn_addition_count_space, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
    label_btn_addition_count_space = lv_label_create(btn_addition_count_space);
    lv_obj_set_style_text_font(label_btn_addition_count_space, &heiFont16_1, LV_STATE_DEFAULT);
    lv_obj_set_style_text_color(label_btn_addition_count_space, lv_color_hex(0x1C1C1C), LV_STATE_DEFAULT);
    sprintf(tempBuf,"%d",data_structure[g_modification_id].data.count.space);
    lv_label_set_text(label_btn_addition_count_space, tempBuf);
    lv_obj_align(label_btn_addition_count_space, LV_ALIGN_CENTER, 0, 0);
    lv_obj_set_style_border_width(label_btn_addition_count_space, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
    lv_obj_set_style_border_color(label_btn_addition_count_space, lv_color_hex(0x8a8a8a), LV_STATE_DEFAULT); /* 设置边框颜色 */
    lv_obj_set_style_border_opa(label_btn_addition_count_space, 100, LV_STATE_DEFAULT); /* 设置边框透明度 */
    lv_obj_set_style_radius(label_btn_addition_count_space, 0, LV_STATE_DEFAULT); /* 设置圆角 */
    lv_obj_set_style_bg_opa(label_btn_addition_count_space, LV_OPA_COVER, LV_PART_MAIN);
    lv_obj_set_style_bg_color(label_btn_addition_count_space, lv_color_hex(0xffffff), LV_PART_MAIN);
    lv_obj_add_event_cb(btn_addition_count_space, btn_addition_count_space_event_cb, LV_EVENT_CLICKED, NULL);


    LV_IMG_DECLARE(lead_zero);
    img_addition_count_lead_zero = lv_img_create(obj_addition_count_middle_bg);
    lv_img_set_src(img_addition_count_lead_zero, &lead_zero);
    lv_obj_align(img_addition_count_lead_zero, LV_ALIGN_TOP_LEFT, 255, 48);

    LV_FONT_DECLARE(heiFont16_1);
    label_addition_count_lead_zero = lv_label_create(obj_addition_count_middle_bg);
    lv_obj_set_style_text_font(label_addition_count_lead_zero, &heiFont16_1, LV_STATE_DEFAULT);
    lv_obj_set_style_text_color(label_addition_count_lead_zero, lv_color_hex(0x000000), LV_STATE_DEFAULT);
    if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
    {
        lv_label_set_text(label_addition_count_lead_zero,  "前置零");
    }
    else if(system_data.system.language == LANGUAGE_ENGLISH)
    {
        lv_label_set_text(label_addition_count_lead_zero, "Lead zero");
    }
    lv_obj_align(label_addition_count_lead_zero, LV_ALIGN_TOP_LEFT, 290, 54);

    if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
    {
        opts_addition_count_lead_zero = "显示\n隐藏";
    }
    else if(system_data.system.language == LANGUAGE_ENGLISH)
    {
        opts_addition_count_lead_zero = "Show\nHide";
    }
    else
    {
        opts_addition_count_lead_zero = "显示\n隐藏";
    }

    dropdown_addition_count_lead_zero = lv_dropdown_create(obj_addition_count_middle_bg);
    lv_obj_set_style_border_width(dropdown_addition_count_lead_zero, 1, LV_STATE_DEFAULT); /* 设置边框宽度 */
    lv_obj_set_style_radius(dropdown_addition_count_lead_zero, 10, LV_STATE_DEFAULT); /* 设置圆角 */
    lv_obj_set_style_border_color(dropdown_addition_count_lead_zero, lv_color_hex(0x000000), LV_STATE_DEFAULT); /* 设置边框颜色 */
    lv_dropdown_set_options_static(dropdown_addition_count_lead_zero, opts_addition_count_lead_zero);
    lv_obj_align(dropdown_addition_count_lead_zero, LV_ALIGN_TOP_LEFT, 355, 44);
    lv_obj_set_style_width(dropdown_addition_count_lead_zero, 110, LV_STATE_DEFAULT);
    LV_FONT_DECLARE(heiFont14);
    lv_obj_set_style_text_font(dropdown_addition_count_lead_zero, &heiFont14, LV_STATE_DEFAULT);
    lv_obj_set_style_height(dropdown_addition_count_lead_zero, 33, LV_STATE_DEFAULT);
    lv_obj_t* opts_addition_count_lead_zero_list = lv_dropdown_get_list(dropdown_addition_count_lead_zero);
    lv_obj_set_style_text_font(opts_addition_count_lead_zero_list, &heiFont14, 0);   // 设置新的字体
    LV_IMG_DECLARE(dropdown);
    lv_dropdown_set_symbol(dropdown_addition_count_lead_zero, &dropdown);
    lv_obj_add_event_cb(dropdown_addition_count_lead_zero, dropdown_addition_count_lead_zero_event_handler, LV_EVENT_ALL, NULL);

    lv_dropdown_set_selected(dropdown_addition_count_lead_zero, data_structure[g_modification_id].data.count.lead_zero); 

    LV_IMG_DECLARE(current_value);
    img_addition_count_current_value = lv_img_create(obj_addition_count_middle_bg);
    lv_img_set_src(img_addition_count_current_value, &current_value);
    lv_obj_align(img_addition_count_current_value, LV_ALIGN_TOP_LEFT, 255, 83);


    LV_FONT_DECLARE(heiFont16_1);
    label_addition_count_current_value = lv_label_create(obj_addition_count_middle_bg);
    lv_obj_set_style_text_font(label_addition_count_current_value, &heiFont16_1, LV_STATE_DEFAULT);
    lv_obj_set_style_text_color(label_addition_count_current_value, lv_color_hex(0x000000), LV_STATE_DEFAULT);
    if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
    {
        lv_label_set_text(label_addition_count_current_value,  "当前值");
    }
    else if(system_data.system.language == LANGUAGE_ENGLISH)
    {
        lv_label_set_text(label_addition_count_current_value, "Current value");
    }
    lv_obj_align(label_addition_count_current_value, LV_ALIGN_TOP_LEFT, 290, 89);

    LV_FONT_DECLARE(heiFont16_1);
    btn_addition_count_current_value = lv_btn_create(obj_addition_count_middle_bg);
    lv_obj_set_size(btn_addition_count_current_value, 110, 30);
    lv_obj_align(btn_addition_count_current_value, LV_ALIGN_TOP_LEFT, 355, 81);
    lv_obj_set_style_border_width(btn_addition_count_current_value, 1, LV_STATE_DEFAULT); /* 设置边框宽度 */
    lv_obj_set_style_radius(btn_addition_count_current_value, 10, LV_STATE_DEFAULT); /* 设置圆角 */
    lv_obj_set_style_bg_color(btn_addition_count_current_value, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
    label_btn_addition_count_current_value = lv_label_create(btn_addition_count_current_value);
    lv_obj_set_style_text_font(label_btn_addition_count_current_value, &heiFont16_1, LV_STATE_DEFAULT);
    lv_obj_set_style_text_color(label_btn_addition_count_current_value, lv_color_hex(0x1C1C1C), LV_STATE_DEFAULT);
    sprintf(tempBuf,"%d",data_structure[g_modification_id].data.count.current_value);
    lv_label_set_text(label_btn_addition_count_current_value, tempBuf);
    lv_obj_align(label_btn_addition_count_current_value, LV_ALIGN_CENTER, 0, 0);
    lv_obj_set_style_border_width(label_btn_addition_count_current_value, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
    lv_obj_set_style_border_color(label_btn_addition_count_current_value, lv_color_hex(0x8a8a8a), LV_STATE_DEFAULT); /* 设置边框颜色 */
    lv_obj_set_style_border_opa(label_btn_addition_count_current_value, 100, LV_STATE_DEFAULT); /* 设置边框透明度 */
    lv_obj_set_style_radius(label_btn_addition_count_current_value, 0, LV_STATE_DEFAULT); /* 设置圆角 */
    lv_obj_set_style_bg_opa(label_btn_addition_count_current_value, LV_OPA_COVER, LV_PART_MAIN);
    lv_obj_set_style_bg_color(label_btn_addition_count_current_value, lv_color_hex(0xffffff), LV_PART_MAIN);
    lv_obj_add_event_cb(btn_addition_count_current_value, btn_addition_count_current_value_event_cb, LV_EVENT_CLICKED, NULL);

    LV_IMG_DECLARE(minimum);
    img_addition_count_minimum = lv_img_create(obj_addition_count_middle_bg);
    lv_img_set_src(img_addition_count_minimum, &minimum);
    lv_obj_align(img_addition_count_minimum, LV_ALIGN_TOP_LEFT, 255, 119);


    LV_FONT_DECLARE(heiFont16_1);
    label_addition_count_minimum = lv_label_create(obj_addition_count_middle_bg);
    lv_obj_set_style_text_font(label_addition_count_minimum, &heiFont16_1, LV_STATE_DEFAULT);
    lv_obj_set_style_text_color(label_addition_count_minimum, lv_color_hex(0x000000), LV_STATE_DEFAULT);
    if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
    {
        lv_label_set_text(label_addition_count_minimum,  "最小值");
    }
    else if(system_data.system.language == LANGUAGE_ENGLISH)
    {
        lv_label_set_text(label_addition_count_minimum, "Minimum");
    }
    lv_obj_align(label_addition_count_minimum, LV_ALIGN_TOP_LEFT, 290, 124);

    LV_FONT_DECLARE(heiFont16_1);
    btn_addition_count_minimum = lv_btn_create(obj_addition_count_middle_bg);
    lv_obj_set_size(btn_addition_count_minimum, 110, 30);
    lv_obj_align(btn_addition_count_minimum, LV_ALIGN_TOP_LEFT, 355, 116);
    lv_obj_set_style_border_width(btn_addition_count_minimum, 1, LV_STATE_DEFAULT); /* 设置边框宽度 */
    lv_obj_set_style_radius(btn_addition_count_minimum, 10, LV_STATE_DEFAULT); /* 设置圆角 */
    lv_obj_set_style_bg_color(btn_addition_count_minimum, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
    label_btn_addition_count_minimum = lv_label_create(btn_addition_count_minimum);
    lv_obj_set_style_text_font(label_btn_addition_count_minimum, &heiFont16_1, LV_STATE_DEFAULT);
    lv_obj_set_style_text_color(label_btn_addition_count_minimum, lv_color_hex(0x1C1C1C), LV_STATE_DEFAULT);
    sprintf(tempBuf,"%d",data_structure[g_modification_id].data.count.minimum);
    lv_label_set_text(label_btn_addition_count_minimum, tempBuf);
    lv_obj_align(label_btn_addition_count_minimum, LV_ALIGN_CENTER, 0, 0);
    lv_obj_set_style_border_width(label_btn_addition_count_minimum, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
    lv_obj_set_style_border_color(label_btn_addition_count_minimum, lv_color_hex(0x8a8a8a), LV_STATE_DEFAULT); /* 设置边框颜色 */
    lv_obj_set_style_border_opa(label_btn_addition_count_minimum, 100, LV_STATE_DEFAULT); /* 设置边框透明度 */
    lv_obj_set_style_radius(label_btn_addition_count_minimum, 0, LV_STATE_DEFAULT); /* 设置圆角 */
    lv_obj_set_style_bg_opa(label_btn_addition_count_minimum, LV_OPA_COVER, LV_PART_MAIN);
    lv_obj_set_style_bg_color(label_btn_addition_count_minimum, lv_color_hex(0xffffff), LV_PART_MAIN);
    lv_obj_add_event_cb(btn_addition_count_minimum, btn_addition_count_minimum_event_cb, LV_EVENT_CLICKED, NULL);


    LV_IMG_DECLARE(maximum);
    img_addition_count_maximum = lv_img_create(obj_addition_count_middle_bg);
    lv_img_set_src(img_addition_count_maximum, &maximum);
    lv_obj_align(img_addition_count_maximum, LV_ALIGN_TOP_LEFT, 255, 153);


    LV_FONT_DECLARE(heiFont16_1);
    label_addition_count_maximum = lv_label_create(obj_addition_count_middle_bg);
    lv_obj_set_style_text_font(label_addition_count_maximum, &heiFont16_1, LV_STATE_DEFAULT);
    lv_obj_set_style_text_color(label_addition_count_maximum, lv_color_hex(0x000000), LV_STATE_DEFAULT);
    if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
    {
        lv_label_set_text(label_addition_count_maximum,  "最大值");
    }
    else if(system_data.system.language == LANGUAGE_ENGLISH)
    {
        lv_label_set_text(label_addition_count_maximum, "Maximum");
    }
    lv_obj_align(label_addition_count_maximum, LV_ALIGN_TOP_LEFT, 290, 159);


    LV_FONT_DECLARE(heiFont16_1);
    btn_addition_count_maximum = lv_btn_create(obj_addition_count_middle_bg);
    lv_obj_set_size(btn_addition_count_maximum, 110, 30);
    lv_obj_align(btn_addition_count_maximum, LV_ALIGN_TOP_LEFT, 355, 151);
    lv_obj_set_style_border_width(btn_addition_count_maximum, 1, LV_STATE_DEFAULT); /* 设置边框宽度 */
    lv_obj_set_style_radius(btn_addition_count_maximum, 10, LV_STATE_DEFAULT); /* 设置圆角 */
    lv_obj_set_style_bg_color(btn_addition_count_maximum, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
    label_btn_addition_count_maximum = lv_label_create(btn_addition_count_maximum);
    lv_obj_set_style_text_font(label_btn_addition_count_maximum, &heiFont16_1, LV_STATE_DEFAULT);
    lv_obj_set_style_text_color(label_btn_addition_count_maximum, lv_color_hex(0x1C1C1C), LV_STATE_DEFAULT);
    sprintf(tempBuf,"%d",data_structure[g_modification_id].data.count.maximum);
    lv_label_set_text(label_btn_addition_count_maximum, tempBuf);
    lv_obj_align(label_btn_addition_count_maximum, LV_ALIGN_CENTER, 0, 0);
    lv_obj_set_style_border_width(label_btn_addition_count_maximum, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
    lv_obj_set_style_border_color(label_btn_addition_count_maximum, lv_color_hex(0x8a8a8a), LV_STATE_DEFAULT); /* 设置边框颜色 */
    lv_obj_set_style_border_opa(label_btn_addition_count_maximum, 100, LV_STATE_DEFAULT); /* 设置边框透明度 */
    lv_obj_set_style_radius(label_btn_addition_count_maximum, 0, LV_STATE_DEFAULT); /* 设置圆角 */
    lv_obj_set_style_bg_opa(label_btn_addition_count_maximum, LV_OPA_COVER, LV_PART_MAIN);
    lv_obj_set_style_bg_color(label_btn_addition_count_maximum, lv_color_hex(0xffffff), LV_PART_MAIN);
    lv_obj_add_event_cb(btn_addition_count_maximum, btn_addition_count_maximum_event_cb, LV_EVENT_CLICKED, NULL);



    LV_IMG_DECLARE(step);
    img_addition_count_step = lv_img_create(obj_addition_count_middle_bg);
    lv_img_set_src(img_addition_count_step, &step);
    lv_obj_align(img_addition_count_step, LV_ALIGN_TOP_LEFT, 255, 188);

    LV_FONT_DECLARE(heiFont16_1);
    label_addition_count_step = lv_label_create(obj_addition_count_middle_bg);
    lv_obj_set_style_text_font(label_addition_count_step, &heiFont16_1, LV_STATE_DEFAULT);
    lv_obj_set_style_text_color(label_addition_count_step, lv_color_hex(0x000000), LV_STATE_DEFAULT);
    if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
    {
        lv_label_set_text(label_addition_count_step,  "步进值");
    }
    else if(system_data.system.language == LANGUAGE_ENGLISH)
    {
        lv_label_set_text(label_addition_count_step, "Step");
    }
    lv_obj_align(label_addition_count_step, LV_ALIGN_TOP_LEFT, 290, 194);

    LV_FONT_DECLARE(heiFont16_1);
    btn_addition_count_step = lv_btn_create(obj_addition_count_middle_bg);
    lv_obj_set_size(btn_addition_count_step, 110, 30);
    lv_obj_align(btn_addition_count_step, LV_ALIGN_TOP_LEFT, 355, 186);
    lv_obj_set_style_border_width(btn_addition_count_step, 1, LV_STATE_DEFAULT); /* 设置边框宽度 */
    lv_obj_set_style_radius(btn_addition_count_step, 10, LV_STATE_DEFAULT); /* 设置圆角 */
    lv_obj_set_style_bg_color(btn_addition_count_step, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
    label_btn_addition_count_step = lv_label_create(btn_addition_count_step);
    lv_obj_set_style_text_font(label_btn_addition_count_step, &heiFont16_1, LV_STATE_DEFAULT);
    lv_obj_set_style_text_color(label_btn_addition_count_step, lv_color_hex(0x1C1C1C), LV_STATE_DEFAULT);
    sprintf(tempBuf,"%d",data_structure[g_modification_id].data.count.step);
    lv_label_set_text(label_btn_addition_count_step, tempBuf);
    lv_obj_align(label_btn_addition_count_step, LV_ALIGN_CENTER, 0, 0);
    lv_obj_set_style_border_width(label_btn_addition_count_step, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
    lv_obj_set_style_border_color(label_btn_addition_count_step, lv_color_hex(0x8a8a8a), LV_STATE_DEFAULT); /* 设置边框颜色 */
    lv_obj_set_style_border_opa(label_btn_addition_count_step, 100, LV_STATE_DEFAULT); /* 设置边框透明度 */
    lv_obj_set_style_radius(label_btn_addition_count_step, 0, LV_STATE_DEFAULT); /* 设置圆角 */
    lv_obj_set_style_bg_opa(label_btn_addition_count_step, LV_OPA_COVER, LV_PART_MAIN);
    lv_obj_set_style_bg_color(label_btn_addition_count_step, lv_color_hex(0xffffff), LV_PART_MAIN);
    lv_obj_add_event_cb(btn_addition_count_step, btn_addition_count_step_event_cb, LV_EVENT_CLICKED, NULL);



    obj_addition_count_bottom_bg = lv_obj_create(lv_scr_act());
    lv_obj_set_size(obj_addition_count_bottom_bg, 480, 24);
    lv_obj_align(obj_addition_count_bottom_bg, LV_ALIGN_TOP_LEFT, 0, 248);
    lv_obj_set_style_border_width(obj_addition_count_bottom_bg, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
    lv_obj_set_style_radius(obj_addition_count_bottom_bg, 0, LV_STATE_DEFAULT); /* 设置圆角 */
    lv_obj_set_style_bg_color(obj_addition_count_bottom_bg, lv_color_hex(0x28536a), LV_STATE_DEFAULT);
    lv_obj_remove_style(obj_addition_count_bottom_bg, 0, LV_PART_SCROLLBAR);


    LV_FONT_DECLARE(heiFont16_1);
    label_addition_count_return = lv_label_create(lv_scr_act());
    lv_obj_set_style_text_font(label_addition_count_return, &heiFont16_1, LV_STATE_DEFAULT);
    lv_obj_set_style_text_color(label_addition_count_return, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
    if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
    {
        lv_label_set_text(label_addition_count_return,  "返回");
    }
    else if(system_data.system.language == LANGUAGE_ENGLISH)
    {
        lv_label_set_text(label_addition_count_return, "return");
    }
    lv_obj_align(label_addition_count_return, LV_ALIGN_TOP_LEFT, 140, 252);


    LV_IMG_DECLARE(get_back);
    imgbtn_addition_count_return = lv_imgbtn_create(lv_scr_act());
    lv_imgbtn_set_src(imgbtn_addition_count_return, LV_IMGBTN_STATE_RELEASED, NULL, &get_back, NULL);
    lv_obj_set_size(imgbtn_addition_count_return, get_back.header.w, get_back.header.h);
    lv_obj_align(imgbtn_addition_count_return, LV_ALIGN_TOP_LEFT, 180, 250);
    lv_obj_add_event_cb(imgbtn_addition_count_return, btn_modification_count_return_event_cb, LV_EVENT_CLICKED, NULL);

    LV_IMG_DECLARE(confirm);
    imgbtn_addition_count_confirm = lv_imgbtn_create(lv_scr_act());
    lv_imgbtn_set_src(imgbtn_addition_count_confirm, LV_IMGBTN_STATE_RELEASED, NULL, &confirm, NULL);
    lv_obj_set_size(imgbtn_addition_count_confirm, get_back.header.w, get_back.header.h);
    lv_obj_align(imgbtn_addition_count_confirm, LV_ALIGN_TOP_LEFT, 250, 250);
    lv_obj_add_event_cb(imgbtn_addition_count_confirm, btn_modification_count_confirm_event_cb, LV_EVENT_CLICKED, NULL);

    LV_FONT_DECLARE(heiFont16_1);
    label_addition_count_confirm = lv_label_create(lv_scr_act());
    lv_obj_set_style_text_font(label_addition_count_confirm, &heiFont16_1, LV_STATE_DEFAULT);
    lv_obj_set_style_text_color(label_addition_count_confirm, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
    if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
    {
        lv_label_set_text(label_addition_count_confirm,  "确定");
    }
    else if(system_data.system.language == LANGUAGE_ENGLISH)
    {
        lv_label_set_text(label_addition_count_confirm, "Confirm");
    }
    lv_obj_align(label_addition_count_confirm, LV_ALIGN_TOP_LEFT, 277, 252);
}




static void btn_modification_symbol_return_event_cb(lv_event_t* e)
{
    lv_event_code_t code;
    int i;
    code = lv_event_get_code(e);
    if (code == LV_EVENT_CLICKED)
    {
        printf("btn_modification_symbol_return_event_cb\n");
        buzzer_enable = 1;
        for (i = 0; i < SYMBOL_NUMBER; i++)
        {
            lv_obj_del(typeface_obj[i].obj_typeface_label);
            lv_obj_del(typeface_obj[i].obj_typeface_btn);
        }    

        lv_obj_del(win_content_typeface);
        lv_obj_del(win_obj_typeface);
        lv_obj_del(file_management_head_bg);
        lv_obj_del(label_file_management);
        lv_obj_del(keyboard_bg);
        lv_obj_del(label_typeface_return);
        lv_obj_del(label_typeface_confirm);
        lv_obj_del(btn_typeface_return);
        lv_obj_del(btn_typeface_confirm); 
    }
}




static void btn_modification_symbol_confirm_event_cb(lv_event_t* e)
{
    lv_event_code_t code;
    int i;
    int win_content_child_num;
    //char temp_typeface[128] = { 0 };
    code = lv_event_get_code(e);
    if (code == LV_EVENT_CLICKED)
    {
        printf("btn_addition_symbol_confirm_event_cb\n");

        buzzer_enable = 1;

        win_content_child_num = g_modification_id;

        printf("win_content_child_num=%u\n\r", win_content_child_num);

        lv_obj_t* temp_obj =  lv_obj_get_child(win_content,g_modification_id);

        //sprintf(temp_typeface, "/media/%s", typeface_buf[0]);
        data_structure[win_content_child_num].data.word.typeface = 0;
        //info.name = "./lvgl/src/extra/libs/freetype/arial.ttf";
        //info.name = "./lvgl/src/extra/libs/freetype/simsun.ttc";
        //sprintf(temp_typeface, "./lvgl/src/extra/libs/freetype/%s", typeface_buf[SOURCE_HAN_SERIF_CN_REGULAR_1]);
        //printf("%s\n", temp_typeface);

        //data_structure[win_content_child_num].data.word.info.name = temp_typeface;
        data_structure[win_content_child_num].data.word.info.weight = 20;
        data_structure[win_content_child_num].data.word.info.style = FT_FONT_STYLE_NORMAL;
        //lv_ft_font_init(&data_structure[win_content_child_num].data.word.info);
        lv_font_t* temp_font = font_list_get(0, 20, 0);

        lv_point_t text_size;
        lv_txt_get_size(&text_size, g_addition_symbol[g_symbol_flag], temp_font, 0, 0, LV_COORD_MAX, LV_TEXT_FLAG_NONE);
        
        //lv_obj_set_style_bg_opa(temp_obj, LV_OPA_TRANSP, 0);
        //lv_obj_set_style_border_width(temp_obj, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */

        //lv_obj_add_event_cb(temp_obj, drag_event_handler, LV_EVENT_PRESSING, NULL);
        //lv_obj_add_event_cb(temp_obj, drag_event_handler, LV_EVENT_FOCUSED, NULL);
        //lv_obj_add_event_cb(temp_obj, drag_event_handler, LV_EVENT_DEFOCUSED, NULL);
        //lv_obj_clear_flag(temp_obj, LV_OBJ_FLAG_SCROLLABLE);     

        lv_style_init(&data_structure[win_content_child_num].data.word.style);
        lv_style_set_text_font(&data_structure[win_content_child_num].data.word.style, temp_font);

        lv_obj_set_size(temp_obj, text_size.x, text_size.y);   

        lv_obj_del(lv_obj_get_child(temp_obj,0));   

        lv_obj_t* label1 = lv_label_create(temp_obj);
        lv_obj_add_style(label1, &data_structure[win_content_child_num].data.word.style, 0);
        lv_label_set_text(label1, g_addition_symbol[g_symbol_flag]);
        lv_obj_center(label1);
    
        //strncpy(data_structure[win_content_child_num].data.word.text, g_addition_symbol[g_symbol_flag], strlen(g_addition_symbol[g_symbol_flag]));
        snprintf(data_structure[win_content_child_num].data.word.text, sizeof(data_structure[win_content_child_num].data.word.text), "%s", g_addition_symbol[g_symbol_flag]);
     
        data_structure[win_content_child_num].data.word.size = 20;
        printf("text=%s\n\r", data_structure[win_content_child_num].data.word.text);
        data_structure[win_content_child_num].type = TYPE_SYMBOL;

        for (i = 0; i < SYMBOL_NUMBER; i++)
        {
            lv_obj_del(typeface_obj[i].obj_typeface_label);
            lv_obj_del(typeface_obj[i].obj_typeface_btn);
        }    

        lv_obj_del(win_content_typeface);
        lv_obj_del(win_obj_typeface);
        lv_obj_del(file_management_head_bg);
        lv_obj_del(label_file_management);
        lv_obj_del(keyboard_bg);
        lv_obj_del(label_typeface_return);
        lv_obj_del(label_typeface_confirm);
        lv_obj_del(btn_typeface_return);
        lv_obj_del(btn_typeface_confirm); 
    }
}

static void modification_symbol(void)
{
    int i;
    int size_wide = 22;
    int size_high = 24;

    printf("modification_symbol\n");

    file_management_head_bg = lv_obj_create(lv_scr_act());
    lv_obj_set_size(file_management_head_bg, 480, 24);
    lv_obj_align(file_management_head_bg, LV_ALIGN_TOP_LEFT, 0, 0);
    lv_obj_set_style_border_width(file_management_head_bg, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
    lv_obj_set_style_radius(file_management_head_bg, 0, LV_STATE_DEFAULT); /* 设置圆角 */
    lv_obj_set_style_bg_color(file_management_head_bg, lv_color_hex(0x28536a), LV_STATE_DEFAULT);
    lv_obj_remove_style(file_management_head_bg, 0, LV_PART_SCROLLBAR);

    LV_FONT_DECLARE(heiFont16_1);
    label_file_management = lv_label_create(lv_scr_act());
    lv_obj_set_style_text_font(label_file_management, &heiFont16_1, LV_STATE_DEFAULT);
    lv_obj_set_style_text_color(label_file_management, lv_color_hex(0xFFFFFF), LV_STATE_DEFAULT);
    if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
    {
        lv_label_set_text(label_file_management,  "符号");
    }
    else if(system_data.system.language == LANGUAGE_ENGLISH)
    {
        lv_label_set_text(label_file_management, "symbol");
    }
    lv_obj_align(label_file_management, LV_ALIGN_TOP_LEFT, 200, 4);


    win_obj_typeface = lv_obj_create(lv_scr_act());
    lv_obj_align(win_obj_typeface, LV_ALIGN_TOP_LEFT, 0, 24);
    lv_obj_set_size(win_obj_typeface, 480, 224);
    lv_obj_set_style_bg_color(win_obj_typeface, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
    lv_obj_set_style_bg_opa(win_obj_typeface, LV_OPA_COVER, LV_STATE_DEFAULT);
    lv_obj_set_style_border_width(win_obj_typeface, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
    lv_obj_set_style_border_color(win_obj_typeface, lv_color_hex(0xcccccc), LV_STATE_DEFAULT); /* 设置边框颜色 */
    lv_obj_clear_flag(win_obj_typeface, LV_OBJ_FLAG_SCROLLABLE);
    lv_obj_set_style_radius(win_obj_typeface, 0, LV_STATE_DEFAULT); /* 设置圆角 */


    win_content_typeface = lv_obj_create(win_obj_typeface);
    lv_obj_set_size(win_content_typeface, 480, 224);
    lv_obj_align(win_content_typeface, LV_ALIGN_TOP_LEFT, -15, -15);
    lv_obj_set_style_bg_color(win_content_typeface, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
    lv_obj_set_style_border_width(win_content_typeface, 2, LV_STATE_DEFAULT); /* 设置边框宽度 */
    lv_obj_set_style_border_color(win_content_typeface, lv_color_hex(0xcccccc), LV_STATE_DEFAULT); /* 设置边框颜色 */
    lv_obj_clear_flag(win_content_typeface, LV_OBJ_FLAG_SCROLLABLE);
    lv_obj_set_style_radius(win_content_typeface, 0, LV_STATE_DEFAULT); /* 设置圆角 */
    lv_obj_set_style_pad_all(win_content_typeface, 0, LV_STATE_DEFAULT);

    for (i = 0; i < SYMBOL_NUMBER; i++)
    {
        typeface_obj[i].obj_typeface_btn = lv_btn_create(win_content_typeface);
        lv_obj_set_size(typeface_obj[i].obj_typeface_btn, size_wide, size_high);
        lv_obj_align(typeface_obj[i].obj_typeface_btn, LV_ALIGN_TOP_LEFT, (i % 17 + 1) * 5 + (i % 17) * size_wide + 5, (i / 17 + 1) * 6 + i / 17 * size_high);
        lv_obj_set_style_border_width(typeface_obj[i].obj_typeface_btn, 1, LV_PART_MAIN); /* 设置边框宽度 */
        lv_obj_set_style_border_color(typeface_obj[i].obj_typeface_btn, lv_color_hex(0x000000), LV_PART_MAIN); /* 设置边框颜色 */
        lv_obj_set_style_radius(typeface_obj[i].obj_typeface_btn, 0, LV_PART_MAIN); /* 设置圆角 */
        lv_obj_set_style_bg_color(typeface_obj[i].obj_typeface_btn, lv_color_hex(0xffffff), LV_PART_MAIN);
        lv_obj_set_style_shadow_width(typeface_obj[i].obj_typeface_btn, 0, LV_PART_MAIN);
        lv_obj_add_event_cb(typeface_obj[i].obj_typeface_btn, btn_addition_symbol_one_event_cb, LV_EVENT_ALL, NULL);

        LV_FONT_DECLARE(heiFont16_1);
        typeface_obj[i].obj_typeface_label = lv_label_create(typeface_obj[i].obj_typeface_btn);
        lv_obj_set_style_text_font(typeface_obj[i].obj_typeface_label, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(typeface_obj[i].obj_typeface_label, lv_color_hex(0x000000), LV_STATE_DEFAULT);
        lv_label_set_text(typeface_obj[i].obj_typeface_label, g_addition_symbol[i]);
        lv_obj_align(typeface_obj[i].obj_typeface_label, LV_ALIGN_CENTER, 0, 0);
    }


    keyboard_bg = lv_obj_create(lv_scr_act());
    lv_obj_set_size(keyboard_bg, 480, 24);
    lv_obj_align(keyboard_bg, LV_ALIGN_TOP_LEFT, 0, 248);
    lv_obj_set_style_border_width(keyboard_bg, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
    lv_obj_set_style_radius(keyboard_bg, 0, LV_STATE_DEFAULT); /* 设置圆角 */
    lv_obj_set_style_bg_color(keyboard_bg, lv_color_hex(0x28536a), LV_STATE_DEFAULT);
    lv_obj_remove_style(keyboard_bg, 0, LV_PART_SCROLLBAR);


    LV_FONT_DECLARE(heiFont16_1);
    label_typeface_return = lv_label_create(lv_scr_act());
    lv_obj_set_style_text_font(label_typeface_return, &heiFont16_1, LV_STATE_DEFAULT);
    lv_obj_set_style_text_color(label_typeface_return, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
    if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
    {
        lv_label_set_text(label_typeface_return,  "返回");
    }
    else if(system_data.system.language == LANGUAGE_ENGLISH)
    {
        lv_label_set_text(label_typeface_return, "return");
    }
    lv_obj_align(label_typeface_return, LV_ALIGN_TOP_LEFT, 140, 252);

    LV_IMG_DECLARE(get_back);
    btn_typeface_return = lv_imgbtn_create(lv_scr_act());
    lv_imgbtn_set_src(btn_typeface_return, LV_IMGBTN_STATE_RELEASED, NULL, &get_back, NULL);
    lv_obj_set_size(btn_typeface_return, get_back.header.w, get_back.header.h);
    lv_obj_align(btn_typeface_return, LV_ALIGN_TOP_LEFT, 180, 250);
    lv_obj_add_event_cb(btn_typeface_return, btn_modification_symbol_return_event_cb, LV_EVENT_CLICKED, NULL);


    LV_IMG_DECLARE(confirm);
    btn_typeface_confirm = lv_imgbtn_create(lv_scr_act());
    lv_imgbtn_set_src(btn_typeface_confirm, LV_IMGBTN_STATE_RELEASED, NULL, &confirm, NULL);
    lv_obj_set_size(btn_typeface_confirm, get_back.header.w, get_back.header.h);
    lv_obj_align(btn_typeface_confirm, LV_ALIGN_TOP_LEFT, 250, 250);
    lv_obj_add_event_cb(btn_typeface_confirm, btn_modification_symbol_confirm_event_cb, LV_EVENT_CLICKED, NULL);

    LV_FONT_DECLARE(heiFont16_1);
    label_typeface_confirm = lv_label_create(lv_scr_act());
    lv_obj_set_style_text_font(label_typeface_confirm, &heiFont16_1, LV_STATE_DEFAULT);
    lv_obj_set_style_text_color(label_typeface_confirm, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
    if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
    {
        lv_label_set_text(label_typeface_confirm,  "确定");
    }
    else if(system_data.system.language == LANGUAGE_ENGLISH)
    {
        lv_label_set_text(label_typeface_confirm, "Confirm");
    }
    lv_obj_align(label_typeface_confirm, LV_ALIGN_TOP_LEFT, 277, 252);
}






static void button_modification_event_cb(lv_event_t* e)
{
    lv_event_code_t code;
    code = lv_event_get_code(e);

    if((code == LV_EVENT_CLICKED)&& (print_status == 0))
    {
        printf("button_modification_event_cb\n");
        if (temp_focused_obj != NULL)
        {
            buzzer_enable = 1;
            g_modification_id = lv_obj_get_index(temp_focused_obj);

            printf("g_modification_id=%d\n\r",g_modification_id);
            printf("type=%d\n\r", data_structure[g_modification_id].type);

            switch(data_structure[g_modification_id].type)
            {
                case TYPE_WORD:
                {
                    modification_text();
                    break;
                }
                case TYPE_QR:
                case TYPE_BAR:
                {
                    modification_QR_code();
                    break;
                }
                case TYPE_DATE:
                {
                    modification_date();
                    break;
                }
                case TYPE_PITCTURE:
                {
                    modification_picture();
                    break;
                }
                case TYPE_ICON:
                {
                    modification_icon();
                    break;
                }
                case TYPE_COUNT:
                {
                    modification_count();
                    break;
                }
                case TYPE_SYMBOL:
                {
                    modification_symbol();
                    break;
                }
                default:;
            }
        }
    }
}

static void imgbtn_set_tv_bottom_return_event_cb(lv_event_t* e)
{
    lv_event_code_t code;
    code = lv_event_get_code(e);
    if (code == LV_EVENT_CLICKED)
    {
        printf("get_back\n");
        buzzer_enable = 1;
        set_system_time_flag = 0;
        pwm_brightness((int)(100-system_data.system.brightness)*4/5);
      
        lv_obj_del(set_tv);
        lv_obj_del(set_tv_bottom_bg);
        lv_obj_del(set_tv_bottom_return);
        lv_obj_del(imgbtn_set_tv_bottom_return);
        lv_obj_del(imgbtn_set_tv_bottom_confirm);
        lv_obj_del(label_set_tv_bottom_confirm);
    }
}


static void imgbtn_set_tv_bottom_confirm_event_cb(lv_event_t* e)
{
    lv_event_code_t code;
    code = lv_event_get_code(e);
    //int concentration;
    //int width;
    //char buf[12] = { 0 };

    if (code == LV_EVENT_CLICKED)
    {
        printf("imgbtn_set_tv_bottom_confirm_event_cb\n");
        buzzer_enable = 1;
        set_system_time_flag = 0;
        system_data.print.trigger_mode = lv_dropdown_get_selected(trigger_mode);
        system_data.print.nozzle = lv_dropdown_get_selected(nozzle_mode);
        system_data.print.concentration = lv_dropdown_get_selected(concentration_mode);
        system_data.print.width = lv_dropdown_get_selected(width_mode);
        system_data.print.encoder = lv_dropdown_get_selected(encoder_mode);
        system_data.print.print_direction = lv_dropdown_get_selected(print_mode);
        system_data.print.print_voltage = lv_dropdown_get_selected(voltage_mode);
        system_data.print.print_number = lv_dropdown_get_selected(number_continuous_print_mode);
        system_data.print.print_interval = atoi(lv_label_get_text(label_btn_interval_continuous_print_mode));
        system_data.print.trigger_delay = atoi(lv_label_get_text(label_btn_trigger_delay_mode));
        system_data.print.print_speed = atoi(lv_label_get_text(label_btn_label_speed_print_mode));
        system_data.print.flash_set = atoi(lv_label_get_text(label_btn_label_set_print_mode));

        system_data.system.buzzer = lv_dropdown_get_selected(key_sound_mode);
        system_data.system.brightness = lv_slider_get_value(slider_screen_luminance);
        system_data.system.language = lv_dropdown_get_selected(dropdown_language);
        system_data.system.screen_off = lv_dropdown_get_selected(dropdown_breath_plate);


        printf("trigger_mode=%d\n", system_data.print.trigger_mode);
        printf("nozzle=%d\n", system_data.print.nozzle);
        printf("concentration=%d\n", system_data.print.concentration);
        printf("width=%d\n", system_data.print.width);
        printf("encoder=%d\n", system_data.print.encoder);
        printf("print_direction=%d\n", system_data.print.print_direction);
        printf("print_voltage=%d\n", system_data.print.print_voltage);
        printf("print_number=%d\n", system_data.print.print_number);
        printf("print_speed=%d\n", system_data.print.print_speed);
        printf("flash_set=%d\n", system_data.print.flash_set);
        printf("buzzer=%d\n", system_data.system.buzzer);
        printf("brightness=%d\n", system_data.system.brightness);
        printf("language=%d\n", system_data.system.language);
        printf("screen_off=%d\n", system_data.system.screen_off);

        set_system_data();

        pwm_voltage();
        pwm_brightness((int)(100-system_data.system.brightness)*4/5);

        lv_obj_del(set_tv);
        lv_obj_del(set_tv_bottom_bg);
        lv_obj_del(set_tv_bottom_return);
        lv_obj_del(imgbtn_set_tv_bottom_return);
        lv_obj_del(imgbtn_set_tv_bottom_confirm);
        lv_obj_del(label_set_tv_bottom_confirm);
    }
}

static void trigger_mode_event_handler(lv_event_t* e)
{
    lv_event_code_t code = lv_event_get_code(e);
    lv_obj_t* obj = lv_event_get_target(e);
    if (code == LV_EVENT_VALUE_CHANGED)
    {
        char buf[32];
        buzzer_enable = 1;
        lv_dropdown_get_selected_str(obj, buf, sizeof(buf));
        printf("Option: %s", buf);
        if (lv_dropdown_get_selected(obj) == 0)
        {
            lv_dropdown_set_selected(encoder_mode, 0);
        }
        else
        {
            lv_dropdown_set_selected(encoder_mode, 1);
        }
    }
}

static void print_mode_event_handler(lv_event_t* e)
{
    lv_event_code_t code = lv_event_get_code(e);
    lv_obj_t* obj = lv_event_get_target(e);
    if (code == LV_EVENT_VALUE_CHANGED)
    {
        char buf[32];
        buzzer_enable = 1;
        lv_dropdown_get_selected_str(obj, buf, sizeof(buf));
        printf("Option: %s", buf);
    }
}


static void btn_system_date_return_event_cb(lv_event_t* e)
{
    lv_event_code_t code;
    //int i;
    //char temp_str[10] = { 0 };
    code = lv_event_get_code(e);
    if (code == LV_EVENT_CLICKED)
    {
        printf("btn_system_date_return_event_cb\n");
        lv_obj_del(system_date_head_bg);
        lv_obj_del(label_system_date_head);
        lv_obj_del(label_system_date_year_middle);
        lv_obj_del(label_system_date_month_middle);
        lv_obj_del(label_system_date_day_middle);
        lv_obj_del(label_system_date_hour_middle);      
        lv_obj_del(label_system_date_minute_middle);   
        lv_obj_del(label_system_date_second_middle);  
        lv_obj_del(system_date_roller_year);     
        lv_obj_del(system_date_roller_month);         
        lv_obj_del(system_date_roller_day);    
        lv_obj_del(system_date_roller_hour);   
        lv_obj_del(system_date_roller_minute);   
        lv_obj_del(system_date_roller_second);   
        lv_obj_del(system_date_middle_bg);
        lv_obj_del(system_date_bottom_bg);
        lv_obj_del(label_system_date_return);    
        lv_obj_del(btn_system_date_return);    
        lv_obj_del(btn_system_date_confirm);    
        lv_obj_del(label_system_date_confirm);    
    }
}



static void btn_system_date_confirm_event_cb(lv_event_t* e)
{
    lv_event_code_t code;
    //int i=0;
    char temp_str[12] = { 0 };
    char cmd[128]={0};
    unsigned char databuf[16];
    int retvalue;
    code = lv_event_get_code(e);
    if (code == LV_EVENT_CLICKED)
    {
        read_writer_rtc_enable = 0;

        databuf[0] = 0x01;	
        memset(temp_str,0,sizeof(temp_str));
        lv_roller_get_selected_str(system_date_roller_year,temp_str,sizeof(temp_str));
        databuf[1] = atoi(temp_str)%100;	
        memset(temp_str,0,sizeof(temp_str));
        lv_roller_get_selected_str(system_date_roller_month,temp_str,sizeof(temp_str));
        databuf[2] = atoi(temp_str);	
        memset(temp_str,0,sizeof(temp_str));
        lv_roller_get_selected_str(system_date_roller_day,temp_str,sizeof(temp_str));
        databuf[3] = atoi(temp_str);	
        memset(temp_str,0,sizeof(temp_str));
        lv_roller_get_selected_str(system_date_roller_hour,temp_str,sizeof(temp_str));
        databuf[4] = atoi(temp_str);	
        memset(temp_str,0,sizeof(temp_str));
        lv_roller_get_selected_str(system_date_roller_minute,temp_str,sizeof(temp_str));     
        printf("temp_str=%s\n\r",temp_str);
        printf("id=%d\n\r",lv_roller_get_selected(system_date_roller_minute));
        databuf[5] = atoi(temp_str);	
        memset(temp_str,0,sizeof(temp_str));
        lv_roller_get_selected_str(system_date_roller_second,temp_str,sizeof(temp_str));         
        databuf[6] = atoi(temp_str);	
        
        printf("%u %u %u %u %u %u %u\n\r",databuf[0],databuf[1],databuf[2],databuf[3],databuf[4],databuf[5],databuf[6]);


        /* 向/dev/beep文件写入数据 */
        retvalue = write(fd_bm8563, databuf,sizeof(databuf));
        if(retvalue < 0)
        {
            printf("write Control Failed!\r\n");
            //close(fd_bm8563);
            //return -1;
        }

        lv_obj_del(system_date_head_bg);
        lv_obj_del(label_system_date_head);
        lv_obj_del(label_system_date_year_middle);
        lv_obj_del(label_system_date_month_middle);
        lv_obj_del(label_system_date_day_middle);
        lv_obj_del(label_system_date_hour_middle);      
        lv_obj_del(label_system_date_minute_middle);   
        lv_obj_del(label_system_date_second_middle);  
        lv_obj_del(system_date_roller_year);     
        lv_obj_del(system_date_roller_month);         
        lv_obj_del(system_date_roller_day);    
        lv_obj_del(system_date_roller_hour);   
        lv_obj_del(system_date_roller_minute);   
        lv_obj_del(system_date_roller_second);   
        lv_obj_del(system_date_middle_bg);
        lv_obj_del(system_date_bottom_bg);
        lv_obj_del(label_system_date_return);    
        lv_obj_del(btn_system_date_return);    
        lv_obj_del(btn_system_date_confirm);    
        lv_obj_del(label_system_date_confirm);    

        snprintf(cmd, sizeof(cmd), "date -s '%04d-%02d-%02d %02d:%02d:%02d'", 2000+databuf[0],databuf[1],databuf[2], databuf[3],databuf[4],databuf[5]);
        system(cmd);

        read_writer_rtc_enable = 1;
    }
}



static void voltage_mode_event_handler(lv_event_t* e)
{
    lv_event_code_t code = lv_event_get_code(e);
    lv_obj_t* obj = lv_event_get_target(e);
    if (code == LV_EVENT_VALUE_CHANGED)
    {
        char buf[32];
        buzzer_enable = 1;
        lv_dropdown_get_selected_str(obj, buf, sizeof(buf));
        printf("Option: %s", buf);
    }
}

static void width_mode_event_handler(lv_event_t* e)
{
    lv_event_code_t code = lv_event_get_code(e);
    lv_obj_t* obj = lv_event_get_target(e);
    if (code == LV_EVENT_VALUE_CHANGED)
    {
        char buf[32];
        buzzer_enable = 1;
        lv_dropdown_get_selected_str(obj, buf, sizeof(buf));
        printf("Option: %s", buf);
    }
}

static void encoder_mode_event_handler(lv_event_t* e)
{
    lv_event_code_t code = lv_event_get_code(e);
    lv_obj_t* obj = lv_event_get_target(e);
    if (code == LV_EVENT_VALUE_CHANGED)
    {
        char buf[32];
        buzzer_enable = 1;
        lv_dropdown_get_selected_str(obj, buf, sizeof(buf));
        printf("Option: %s", buf);
        if (lv_dropdown_get_selected(obj) == 0)
        {
            lv_dropdown_set_selected(trigger_mode, 0);
        }
        else
        {
            lv_dropdown_set_selected(trigger_mode, 1);
        }
    }
}

static void key_sound_mode_event_handler(lv_event_t* e)
{
    lv_event_code_t code = lv_event_get_code(e);
    lv_obj_t* obj = lv_event_get_target(e);
    if (code == LV_EVENT_VALUE_CHANGED)
    {
        char buf[32];
        buzzer_enable = 1;
        lv_dropdown_get_selected_str(obj, buf, sizeof(buf));
        printf("Option: %s", buf);
    }
}

static void dropdown_language_event_handler(lv_event_t* e)
{
    lv_event_code_t code = lv_event_get_code(e);
    lv_obj_t* obj = lv_event_get_target(e);
    if (code == LV_EVENT_VALUE_CHANGED)
    {
        char buf[32];
        buzzer_enable = 1;
        lv_dropdown_get_selected_str(obj, buf, sizeof(buf));
        printf("Option: %s", buf);
    }
}


static void dropdown_breath_plate_event_handler(lv_event_t* e)
{
    lv_event_code_t code = lv_event_get_code(e);
    lv_obj_t* obj = lv_event_get_target(e);
    if (code == LV_EVENT_VALUE_CHANGED)
    {
        char buf[32];
        buzzer_enable = 1;
        lv_dropdown_get_selected_str(obj, buf, sizeof(buf));
        printf("Option: %s", buf);
    }
}

static void nozzle_mode_event_handler(lv_event_t* e)
{
    lv_event_code_t code = lv_event_get_code(e);
    lv_obj_t* obj = lv_event_get_target(e);
    if (code == LV_EVENT_VALUE_CHANGED)
    {
        char buf[32];
        buzzer_enable = 1;
        lv_dropdown_get_selected_str(obj, buf, sizeof(buf));
        printf("Option: %s", buf);
    }
}


static void concentration_mode_event_handler(lv_event_t* e)
{
    lv_event_code_t code = lv_event_get_code(e);
    lv_obj_t* obj = lv_event_get_target(e);
    if (code == LV_EVENT_VALUE_CHANGED)
    {
        char buf[32];
        buzzer_enable = 1;
        lv_dropdown_get_selected_str(obj, buf, sizeof(buf));
        printf("Option: %s", buf);
    }
}

static void number_continuous_print_mode_event_handler(lv_event_t* e)
{
    lv_event_code_t code = lv_event_get_code(e);
    lv_obj_t* obj = lv_event_get_target(e);
    if (code == LV_EVENT_VALUE_CHANGED)
    {
        char buf[32];
        buzzer_enable = 1;
        lv_dropdown_get_selected_str(obj, buf, sizeof(buf));
        printf("Option: %s", buf);
    }
}


static void  btn_interval_continuous_print_mode_confirm_event_cb(lv_event_t* e)
{
    lv_event_code_t code;
    int i=0;
    char temp_str[12] = { 0 };
    code = lv_event_get_code(e);
    if (code == LV_EVENT_CLICKED)
    {
        printf("btn_interval_continuous_print_mode_confirm_event_cb\n");
        buzzer_enable = 1;
        const char* pwd_txt = lv_textarea_get_text(pwd_text_area);
        if ((pwd_txt != NULL))
        {
            i = atoi(pwd_txt);
            if (i > 250)
            {
                i = 250;
            }
        }

        sprintf(temp_str, "%d", i);
        lv_label_set_text(label_btn_interval_continuous_print_mode, temp_str);

      
        lv_obj_del(typeface_head_bg);
        lv_obj_del(label_typeface_head);
        lv_obj_del(typeface_slider_bg);
        lv_obj_del(pwd_text_area);
        lv_obj_del(pwd_keyboard);

        lv_obj_del(label_typeface_return);
        lv_obj_del(btn_typeface_return);
        lv_obj_del(btn_typeface_confirm);
        lv_obj_del(label_typeface_confirm);
    }
}


static void  btn_interval_continuous_print_mode_return_event_cb(lv_event_t* e)
{
    lv_event_code_t code;

    code = lv_event_get_code(e);
    if (code == LV_EVENT_CLICKED)
    {
        printf("btn_interval_continuous_print_mode_return_event_cb\n");
        buzzer_enable = 1;

        lv_obj_del(typeface_head_bg);
        lv_obj_del(label_typeface_head);
        lv_obj_del(typeface_slider_bg);
        lv_obj_del(pwd_text_area);
        lv_obj_del(pwd_keyboard);

        lv_obj_del(label_typeface_return);
        lv_obj_del(btn_typeface_return);
        lv_obj_del(btn_typeface_confirm);
        lv_obj_del(label_typeface_confirm);
    }
}

static void btn_interval_continuous_print_mode_event_cb(lv_event_t* e)
{
    lv_event_code_t code;

    code = lv_event_get_code(e);
    //int len = 0;
    //int i;
    //int offset_x;
    //int offset_y;
    //int line_num = 5;
    //int size_wide = 85;
    //int size_high = 24;
    //lv_obj_t* obj = lv_event_get_target(e);

    if (code == LV_EVENT_CLICKED)
    {
        printf("btn_file_management_word_space_label\n");
        buzzer_enable = 1;
        typeface_head_bg = lv_obj_create(lv_scr_act());
        lv_obj_set_size(typeface_head_bg, 480, 24);
        lv_obj_align(typeface_head_bg, LV_ALIGN_TOP_LEFT, 0, 0);
        lv_obj_set_style_border_width(typeface_head_bg, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_border_color(typeface_head_bg, lv_color_hex(0x9bcd9b), LV_STATE_DEFAULT); /* 设置边框颜色 */
        lv_obj_set_style_radius(typeface_head_bg, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_color(typeface_head_bg, lv_color_hex(0x1fadd3), LV_STATE_DEFAULT);

        LV_FONT_DECLARE(heiFont16_1);
        label_typeface_head = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_typeface_head, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_typeface_head, lv_color_hex(0xFFFFFF), LV_STATE_DEFAULT);
        lv_obj_align(label_typeface_head, LV_ALIGN_TOP_LEFT, 200, 4);

        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_typeface_head,  "连喷间隔");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_typeface_head, "Continuous spray interval");
        }

        typeface_slider_bg = lv_obj_create(lv_scr_act());
        lv_obj_set_size(typeface_slider_bg, 480, 224);
        lv_obj_align(typeface_slider_bg, LV_ALIGN_TOP_LEFT, 0, 24);
        lv_obj_set_style_border_width(typeface_slider_bg, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_border_color(typeface_slider_bg, lv_color_hex(0xaaaaaa), LV_STATE_DEFAULT); /* 设置边框颜色 */
        lv_obj_set_style_radius(typeface_slider_bg, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_color(typeface_slider_bg, lv_color_hex(0xaaaaaa), LV_STATE_DEFAULT);

        //数字键盘
        pwd_text_area = lv_textarea_create(lv_scr_act());
        if (pwd_text_area == NULL)
        {
            printf("[%s:%d] create pwd_text_area obj failed\n", __FUNCTION__, __LINE__);
            return;
        }

        // 密码框样式
        static lv_style_t pwd_text_style;
        lv_style_init(&pwd_text_style); // 初始化样式
        lv_style_set_radius(&pwd_text_style, 0); // 设置样式的圆角弧度
        lv_style_set_border_width(&pwd_text_style, 1); // 设置边框宽度
        lv_style_set_pad_all(&pwd_text_style, 0); // 设置样式的内部填充
        lv_style_set_text_font(&pwd_text_style, &lv_font_montserrat_18); //设置字体
        //lv_textarea_set_password_mode(pwd_text_area, true); // 文本区域开启密码模式
        lv_textarea_set_max_length(pwd_text_area, 3); // 设置可输入的文本的最大长度
        lv_obj_add_style(pwd_text_area, &pwd_text_style, 0); // 给btn_label添加样式
        lv_obj_set_size(pwd_text_area, 480, 50); // 设置对象大小
        lv_textarea_set_text(pwd_text_area, ""); // 文本框置空
        lv_obj_align(pwd_text_area, LV_ALIGN_TOP_LEFT, 0, 24);

        // 基于键盘背景对象创建密码校验提示标签
        hint_label = lv_label_create(lv_scr_act());
        if (hint_label == NULL)
        {
            printf("[%s:%d] create hint_label obj failed\n", __FUNCTION__, __LINE__);
            return;
        }

        // 密码提示文本样式
        static lv_style_t hint_label_style;
        lv_style_init(&hint_label_style); // 初始化样式
        lv_style_set_radius(&hint_label_style, 0); // 设置样式的圆角弧度
        lv_style_set_border_width(&hint_label_style, 0); //设置边框宽度
        lv_style_set_text_color(&hint_label_style, lv_palette_main(LV_PALETTE_RED));  // 字体颜色设置为红色
        lv_style_set_text_font(&hint_label_style, &lv_font_montserrat_12); //设置字体
        lv_label_set_long_mode(hint_label, LV_LABEL_LONG_SCROLL_CIRCULAR); // 长文本循环滚动
        lv_obj_add_style(hint_label, &hint_label_style, 0); // 给btn_label添加样式
        lv_obj_align(hint_label, LV_ALIGN_TOP_MID, 0, 110); // 顶部居中显示
        lv_label_set_text(hint_label, ""); // 设置文本内容

        // 基于键盘背景对象创建键盘对象
        pwd_keyboard = lv_keyboard_create(lv_scr_act());
        if (pwd_keyboard == NULL)
        {
            printf("[%s:%d] create pwd_keyboard obj failed\n", __FUNCTION__, __LINE__);
            return;
        }

        //键盘样式
        static lv_style_t pwd_kb_style;
        lv_style_init(&pwd_kb_style); // 初始化样式
        lv_style_set_radius(&pwd_kb_style, 5); // 设置样式的圆角弧度
        lv_style_set_border_width(&pwd_kb_style, 0); //设置边框宽度
        lv_style_set_bg_color(&pwd_kb_style, lv_color_hex(0xF98E2D));
        lv_style_set_text_opa(&pwd_kb_style, LV_OPA_COVER);
        lv_style_set_text_font(&pwd_kb_style, &lv_font_montserrat_20); //设置字体
        lv_obj_set_size(pwd_keyboard, 480, 174); //设置键盘大小
        lv_keyboard_set_mode(pwd_keyboard, LV_KEYBOARD_MODE_NUMBER_2); //设置键盘模式为数字键盘
        lv_keyboard_set_map(pwd_keyboard, LV_KEYBOARD_MODE_NUMBER_2, keyboard_map, keyboard_ctrl); // 设置键盘映射
        lv_keyboard_set_textarea(pwd_keyboard, pwd_text_area); // 键盘对象和文本框绑定
        lv_obj_add_style(pwd_keyboard, &pwd_kb_style, 0); // 添加样式
        lv_obj_align(pwd_keyboard, LV_ALIGN_TOP_LEFT, 0, 74);


        LV_FONT_DECLARE(heiFont16_1);
        label_typeface_return = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_typeface_return, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_typeface_return, lv_color_hex(0xffffff), LV_STATE_DEFAULT);

        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_typeface_return,  "返回");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_typeface_return, "Return");
        }
        lv_obj_align(label_typeface_return, LV_ALIGN_TOP_LEFT, 140, 252);

        LV_IMG_DECLARE(get_back);
        btn_typeface_return = lv_imgbtn_create(lv_scr_act());
        lv_imgbtn_set_src(btn_typeface_return, LV_IMGBTN_STATE_RELEASED, NULL, &get_back, NULL);
        lv_obj_set_size(btn_typeface_return, get_back.header.w, get_back.header.h);
        lv_obj_align(btn_typeface_return, LV_ALIGN_TOP_LEFT, 180, 250);
        lv_obj_add_event_cb(btn_typeface_return, btn_interval_continuous_print_mode_return_event_cb, LV_EVENT_CLICKED, NULL);


        LV_IMG_DECLARE(confirm);
        btn_typeface_confirm = lv_imgbtn_create(lv_scr_act());
        lv_imgbtn_set_src(btn_typeface_confirm, LV_IMGBTN_STATE_RELEASED, NULL, &confirm, NULL);
        lv_obj_set_size(btn_typeface_confirm, get_back.header.w, get_back.header.h);
        lv_obj_align(btn_typeface_confirm, LV_ALIGN_TOP_LEFT, 250, 250);
        lv_obj_add_event_cb(btn_typeface_confirm, btn_interval_continuous_print_mode_confirm_event_cb, LV_EVENT_CLICKED, NULL);

        LV_FONT_DECLARE(heiFont16_1);
        label_typeface_confirm = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_typeface_confirm, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_typeface_confirm, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_typeface_confirm,  "确定");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_typeface_confirm, "Confirm");
        }
        lv_obj_align(label_typeface_confirm, LV_ALIGN_TOP_LEFT, 277, 252);
    }
}



static void btn_trigger_delay_mode_confirm_event_cb(lv_event_t* e)
{
    lv_event_code_t code;
    int i=0;
    char temp_str[12] = { 0 };
    code = lv_event_get_code(e);
    if (code == LV_EVENT_CLICKED)
    {
        printf("btn_trigger_delay_mode_confirm_event_cb\n");

        buzzer_enable = 1;

        const char* pwd_txt = lv_textarea_get_text(pwd_text_area);
        if ((pwd_txt != NULL))
        {
            i = atoi(pwd_txt);
            if (i > 250)
            {
                i = 250;
            }
        }

        sprintf(temp_str, "%d", i);
        lv_label_set_text(label_btn_trigger_delay_mode, temp_str);

       
        lv_obj_del(typeface_head_bg);
        lv_obj_del(label_typeface_head);
        lv_obj_del(typeface_slider_bg);
        lv_obj_del(pwd_text_area);
        lv_obj_del(pwd_keyboard);

        lv_obj_del(label_typeface_return);
        lv_obj_del(btn_typeface_return);
        lv_obj_del(btn_typeface_confirm);
        lv_obj_del(label_typeface_confirm);
    }
}


static void btn_trigger_delay_mode_return_event_cb(lv_event_t* e)
{
    lv_event_code_t code;

    code = lv_event_get_code(e);
    if (code == LV_EVENT_CLICKED)
    {
        printf("btn_trigger_delay_mode_return_event_cb\n");

        buzzer_enable = 1;

        lv_obj_del(typeface_head_bg);
        lv_obj_del(label_typeface_head);
        lv_obj_del(typeface_slider_bg);
        lv_obj_del(pwd_text_area);
        lv_obj_del(pwd_keyboard);

        lv_obj_del(label_typeface_return);
        lv_obj_del(btn_typeface_return);
        lv_obj_del(btn_typeface_confirm);
        lv_obj_del(label_typeface_confirm);
    }
}


static void btn_trigger_delay_mode_event_cb(lv_event_t* e)
{
    lv_event_code_t code;

    code = lv_event_get_code(e);
    //int len = 0;
    //int i;
    //int offset_x;
    //int offset_y;
    //int line_num = 5;
   // int size_wide = 85;
    //int size_high = 24;
    //lv_obj_t* obj = lv_event_get_target(e);

    if (code == LV_EVENT_CLICKED)
    {
        printf("btn_trigger_delay_mode_event_cb\n");
        buzzer_enable = 1;
        typeface_head_bg = lv_obj_create(lv_scr_act());
        lv_obj_set_size(typeface_head_bg, 480, 24);
        lv_obj_align(typeface_head_bg, LV_ALIGN_TOP_LEFT, 0, 0);
        lv_obj_set_style_border_width(typeface_head_bg, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_border_color(typeface_head_bg, lv_color_hex(0x9bcd9b), LV_STATE_DEFAULT); /* 设置边框颜色 */
        lv_obj_set_style_radius(typeface_head_bg, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_color(typeface_head_bg, lv_color_hex(0x1fadd3), LV_STATE_DEFAULT);

        LV_FONT_DECLARE(heiFont16_1);
        label_typeface_head = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_typeface_head, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_typeface_head, lv_color_hex(0xFFFFFF), LV_STATE_DEFAULT);
        lv_obj_align(label_typeface_head, LV_ALIGN_TOP_LEFT, 200, 4);

        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_typeface_head,  "触发延迟");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_typeface_head, "Trigger delay");
        }

        typeface_slider_bg = lv_obj_create(lv_scr_act());
        lv_obj_set_size(typeface_slider_bg, 480, 224);
        lv_obj_align(typeface_slider_bg, LV_ALIGN_TOP_LEFT, 0, 24);
        lv_obj_set_style_border_width(typeface_slider_bg, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_border_color(typeface_slider_bg, lv_color_hex(0xaaaaaa), LV_STATE_DEFAULT); /* 设置边框颜色 */
        lv_obj_set_style_radius(typeface_slider_bg, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_color(typeface_slider_bg, lv_color_hex(0xaaaaaa), LV_STATE_DEFAULT);

        //数字键盘
        pwd_text_area = lv_textarea_create(lv_scr_act());
        if (pwd_text_area == NULL)
        {
            printf("[%s:%d] create pwd_text_area obj failed\n", __FUNCTION__, __LINE__);
            return;
        }

        // 密码框样式
        static lv_style_t pwd_text_style;
        lv_style_init(&pwd_text_style); // 初始化样式
        lv_style_set_radius(&pwd_text_style, 0); // 设置样式的圆角弧度
        lv_style_set_border_width(&pwd_text_style, 1); // 设置边框宽度
        lv_style_set_pad_all(&pwd_text_style, 0); // 设置样式的内部填充
        lv_style_set_text_font(&pwd_text_style, &lv_font_montserrat_18); //设置字体
        //lv_textarea_set_password_mode(pwd_text_area, true); // 文本区域开启密码模式
        lv_textarea_set_max_length(pwd_text_area, 3); // 设置可输入的文本的最大长度
        lv_obj_add_style(pwd_text_area, &pwd_text_style, 0); // 给btn_label添加样式
        lv_obj_set_size(pwd_text_area, 480, 50); // 设置对象大小
        lv_textarea_set_text(pwd_text_area, ""); // 文本框置空
        lv_obj_align(pwd_text_area, LV_ALIGN_TOP_LEFT, 0, 24);

        // 基于键盘背景对象创建密码校验提示标签
        hint_label = lv_label_create(lv_scr_act());
        if (hint_label == NULL)
        {
            printf("[%s:%d] create hint_label obj failed\n", __FUNCTION__, __LINE__);
            return;
        }

        // 密码提示文本样式
        static lv_style_t hint_label_style;
        lv_style_init(&hint_label_style); // 初始化样式
        lv_style_set_radius(&hint_label_style, 0); // 设置样式的圆角弧度
        lv_style_set_border_width(&hint_label_style, 0); //设置边框宽度
        lv_style_set_text_color(&hint_label_style, lv_palette_main(LV_PALETTE_RED));  // 字体颜色设置为红色
        lv_style_set_text_font(&hint_label_style, &lv_font_montserrat_12); //设置字体
        lv_label_set_long_mode(hint_label, LV_LABEL_LONG_SCROLL_CIRCULAR); // 长文本循环滚动
        lv_obj_add_style(hint_label, &hint_label_style, 0); // 给btn_label添加样式
        lv_obj_align(hint_label, LV_ALIGN_TOP_MID, 0, 110); // 顶部居中显示
        lv_label_set_text(hint_label, ""); // 设置文本内容

        // 基于键盘背景对象创建键盘对象
        pwd_keyboard = lv_keyboard_create(lv_scr_act());
        if (pwd_keyboard == NULL)
        {
            printf("[%s:%d] create pwd_keyboard obj failed\n", __FUNCTION__, __LINE__);
            return;
        }

        //键盘样式
        static lv_style_t pwd_kb_style;
        lv_style_init(&pwd_kb_style); // 初始化样式
        lv_style_set_radius(&pwd_kb_style, 5); // 设置样式的圆角弧度
        lv_style_set_border_width(&pwd_kb_style, 0); //设置边框宽度
        lv_style_set_bg_color(&pwd_kb_style, lv_color_hex(0xF98E2D));
        lv_style_set_text_opa(&pwd_kb_style, LV_OPA_COVER);
        lv_style_set_text_font(&pwd_kb_style, &lv_font_montserrat_20); //设置字体
        lv_obj_set_size(pwd_keyboard, 480, 174); //设置键盘大小
        lv_keyboard_set_mode(pwd_keyboard, LV_KEYBOARD_MODE_NUMBER_2); //设置键盘模式为数字键盘
        lv_keyboard_set_map(pwd_keyboard, LV_KEYBOARD_MODE_NUMBER_2, keyboard_map, keyboard_ctrl); // 设置键盘映射
        lv_keyboard_set_textarea(pwd_keyboard, pwd_text_area); // 键盘对象和文本框绑定
        lv_obj_add_style(pwd_keyboard, &pwd_kb_style, 0); // 添加样式
        lv_obj_align(pwd_keyboard, LV_ALIGN_TOP_LEFT, 0, 74);


        LV_FONT_DECLARE(heiFont16_1);
        label_typeface_return = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_typeface_return, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_typeface_return, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_typeface_return,  "返回");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_typeface_return, "Return");
        }
        lv_obj_align(label_typeface_return, LV_ALIGN_TOP_LEFT, 140, 252);

        LV_IMG_DECLARE(get_back);
        btn_typeface_return = lv_imgbtn_create(lv_scr_act());
        lv_imgbtn_set_src(btn_typeface_return, LV_IMGBTN_STATE_RELEASED, NULL, &get_back, NULL);
        lv_obj_set_size(btn_typeface_return, get_back.header.w, get_back.header.h);
        lv_obj_align(btn_typeface_return, LV_ALIGN_TOP_LEFT, 180, 250);
        lv_obj_add_event_cb(btn_typeface_return, btn_trigger_delay_mode_return_event_cb, LV_EVENT_CLICKED, NULL);


        LV_IMG_DECLARE(confirm);
        btn_typeface_confirm = lv_imgbtn_create(lv_scr_act());
        lv_imgbtn_set_src(btn_typeface_confirm, LV_IMGBTN_STATE_RELEASED, NULL, &confirm, NULL);
        lv_obj_set_size(btn_typeface_confirm, get_back.header.w, get_back.header.h);
        lv_obj_align(btn_typeface_confirm, LV_ALIGN_TOP_LEFT, 250, 250);
        lv_obj_add_event_cb(btn_typeface_confirm, btn_trigger_delay_mode_confirm_event_cb, LV_EVENT_CLICKED, NULL);

        LV_FONT_DECLARE(heiFont16_1);
        label_typeface_confirm = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_typeface_confirm, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_typeface_confirm, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_typeface_confirm,  "确定");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_typeface_confirm, "Confirm");
        }
        lv_obj_align(label_typeface_confirm, LV_ALIGN_TOP_LEFT, 277, 252);
    }
}

static void btn_set_print_mode_confirm_event_cb(lv_event_t* e)
{
    lv_event_code_t code;
    int i=0;
    char temp_str[12] = { 0 };
    code = lv_event_get_code(e);
    if (code == LV_EVENT_CLICKED)
    {
        printf("btn_set_print_mode_confirm_event_cb\n");
        buzzer_enable = 1;
        const char* pwd_txt = lv_textarea_get_text(pwd_text_area);
        if ((pwd_txt != NULL))
        {
            i = atoi(pwd_txt);
            if (i > 150)
            {
                i = 150;
            }
        }

        sprintf(temp_str, "%d", i);
        lv_label_set_text(label_btn_label_set_print_mode, temp_str);
        lv_obj_del(typeface_head_bg);
        lv_obj_del(label_typeface_head);
        lv_obj_del(typeface_slider_bg);
        lv_obj_del(pwd_text_area);
        lv_obj_del(pwd_keyboard);

        lv_obj_del(label_typeface_return);
        lv_obj_del(btn_typeface_return);
        lv_obj_del(btn_typeface_confirm);
        lv_obj_del(label_typeface_confirm);
    }
}



static void btn_set_print_mode_return_event_cb(lv_event_t* e)
{
    lv_event_code_t code;
    code = lv_event_get_code(e);
    if (code == LV_EVENT_CLICKED)
    {
        printf("btn_set_print_mode_return_event_cb\n");
        buzzer_enable = 1;
        lv_obj_del(typeface_head_bg);
        lv_obj_del(label_typeface_head);
        lv_obj_del(typeface_slider_bg);
        lv_obj_del(pwd_text_area);
        lv_obj_del(pwd_keyboard);

        lv_obj_del(label_typeface_return);
        lv_obj_del(btn_typeface_return);
        lv_obj_del(btn_typeface_confirm);
        lv_obj_del(label_typeface_confirm);
    }
}

static void btn_label_set_print_mode_event_cb(lv_event_t* e)
{
    lv_event_code_t code;

    code = lv_event_get_code(e);
   // int len = 0;
   // int i;
   // int offset_x;
   // int offset_y;
   // int line_num = 5;
    //int size_wide = 85;
  //  int size_high = 24;
    //lv_obj_t* obj = lv_event_get_target(e);

    if (code == LV_EVENT_CLICKED)
    {
        buzzer_enable = 1;
        typeface_head_bg = lv_obj_create(lv_scr_act());
        lv_obj_set_size(typeface_head_bg, 480, 24);
        lv_obj_align(typeface_head_bg, LV_ALIGN_TOP_LEFT, 0, 0);
        lv_obj_set_style_border_width(typeface_head_bg, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_border_color(typeface_head_bg, lv_color_hex(0x9bcd9b), LV_STATE_DEFAULT); /* 设置边框颜色 */
        lv_obj_set_style_radius(typeface_head_bg, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_color(typeface_head_bg, lv_color_hex(0x1fadd3), LV_STATE_DEFAULT);

        LV_FONT_DECLARE(heiFont16_1);
        label_typeface_head = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_typeface_head, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_typeface_head, lv_color_hex(0xFFFFFF), LV_STATE_DEFAULT);
        lv_obj_align(label_typeface_head, LV_ALIGN_TOP_LEFT, 200, 4);
        

        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_typeface_head,  "闪喷设置");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_typeface_head, "Flash spray setting");
        }

        typeface_slider_bg = lv_obj_create(lv_scr_act());
        lv_obj_set_size(typeface_slider_bg, 480, 224);
        lv_obj_align(typeface_slider_bg, LV_ALIGN_TOP_LEFT, 0, 24);
        lv_obj_set_style_border_width(typeface_slider_bg, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_border_color(typeface_slider_bg, lv_color_hex(0xaaaaaa), LV_STATE_DEFAULT); /* 设置边框颜色 */
        lv_obj_set_style_radius(typeface_slider_bg, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_color(typeface_slider_bg, lv_color_hex(0xaaaaaa), LV_STATE_DEFAULT);

        //数字键盘
        pwd_text_area = lv_textarea_create(lv_scr_act());
        if (pwd_text_area == NULL)
        {
            printf("[%s:%d] create pwd_text_area obj failed\n", __FUNCTION__, __LINE__);
            return;
        }

        // 密码框样式
        static lv_style_t pwd_text_style;
        lv_style_init(&pwd_text_style); // 初始化样式
        lv_style_set_radius(&pwd_text_style, 0); // 设置样式的圆角弧度
        lv_style_set_border_width(&pwd_text_style, 1); // 设置边框宽度
        lv_style_set_pad_all(&pwd_text_style, 0); // 设置样式的内部填充
        lv_style_set_text_font(&pwd_text_style, &lv_font_montserrat_18); //设置字体
        //lv_textarea_set_password_mode(pwd_text_area, true); // 文本区域开启密码模式
        lv_textarea_set_max_length(pwd_text_area, 3); // 设置可输入的文本的最大长度
        lv_obj_add_style(pwd_text_area, &pwd_text_style, 0); // 给btn_label添加样式
        lv_obj_set_size(pwd_text_area, 480, 50); // 设置对象大小
        lv_textarea_set_text(pwd_text_area, ""); // 文本框置空
        lv_obj_align(pwd_text_area, LV_ALIGN_TOP_LEFT, 0, 24);

        // 基于键盘背景对象创建密码校验提示标签
        hint_label = lv_label_create(lv_scr_act());
        if (hint_label == NULL)
        {
            printf("[%s:%d] create hint_label obj failed\n", __FUNCTION__, __LINE__);
            return;
        }

        // 密码提示文本样式
        static lv_style_t hint_label_style;
        lv_style_init(&hint_label_style); // 初始化样式
        lv_style_set_radius(&hint_label_style, 0); // 设置样式的圆角弧度
        lv_style_set_border_width(&hint_label_style, 0); //设置边框宽度
        lv_style_set_text_color(&hint_label_style, lv_palette_main(LV_PALETTE_RED));  // 字体颜色设置为红色
        lv_style_set_text_font(&hint_label_style, &lv_font_montserrat_12); //设置字体
        lv_label_set_long_mode(hint_label, LV_LABEL_LONG_SCROLL_CIRCULAR); // 长文本循环滚动
        lv_obj_add_style(hint_label, &hint_label_style, 0); // 给btn_label添加样式
        lv_obj_align(hint_label, LV_ALIGN_TOP_MID, 0, 110); // 顶部居中显示
        lv_label_set_text(hint_label, ""); // 设置文本内容

        // 基于键盘背景对象创建键盘对象
        pwd_keyboard = lv_keyboard_create(lv_scr_act());
        if (pwd_keyboard == NULL)
        {
            printf("[%s:%d] create pwd_keyboard obj failed\n", __FUNCTION__, __LINE__);
            return;
        }

        //键盘样式
        static lv_style_t pwd_kb_style;
        lv_style_init(&pwd_kb_style); // 初始化样式
        lv_style_set_radius(&pwd_kb_style, 5); // 设置样式的圆角弧度
        lv_style_set_border_width(&pwd_kb_style, 0); //设置边框宽度
        lv_style_set_bg_color(&pwd_kb_style, lv_color_hex(0xF98E2D));
        lv_style_set_text_opa(&pwd_kb_style, LV_OPA_COVER);
        lv_style_set_text_font(&pwd_kb_style, &lv_font_montserrat_20); //设置字体
        lv_obj_set_size(pwd_keyboard, 480, 174); //设置键盘大小
        lv_keyboard_set_mode(pwd_keyboard, LV_KEYBOARD_MODE_NUMBER_2); //设置键盘模式为数字键盘
        lv_keyboard_set_map(pwd_keyboard, LV_KEYBOARD_MODE_NUMBER_2, keyboard_map, keyboard_ctrl); // 设置键盘映射
        lv_keyboard_set_textarea(pwd_keyboard, pwd_text_area); // 键盘对象和文本框绑定
        lv_obj_add_style(pwd_keyboard, &pwd_kb_style, 0); // 添加样式
        lv_obj_align(pwd_keyboard, LV_ALIGN_TOP_LEFT, 0, 74);


        LV_FONT_DECLARE(heiFont16_1);
        label_typeface_return = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_typeface_return, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_typeface_return, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_typeface_return,  "返回");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_typeface_return, "Return");
        }
        lv_obj_align(label_typeface_return, LV_ALIGN_TOP_LEFT, 140, 252);

        LV_IMG_DECLARE(get_back);
        btn_typeface_return = lv_imgbtn_create(lv_scr_act());
        lv_imgbtn_set_src(btn_typeface_return, LV_IMGBTN_STATE_RELEASED, NULL, &get_back, NULL);
        lv_obj_set_size(btn_typeface_return, get_back.header.w, get_back.header.h);
        lv_obj_align(btn_typeface_return, LV_ALIGN_TOP_LEFT, 180, 250);
        lv_obj_add_event_cb(btn_typeface_return, btn_set_print_mode_return_event_cb, LV_EVENT_CLICKED, NULL);


        LV_IMG_DECLARE(confirm);
        btn_typeface_confirm = lv_imgbtn_create(lv_scr_act());
        lv_imgbtn_set_src(btn_typeface_confirm, LV_IMGBTN_STATE_RELEASED, NULL, &confirm, NULL);
        lv_obj_set_size(btn_typeface_confirm, get_back.header.w, get_back.header.h);
        lv_obj_align(btn_typeface_confirm, LV_ALIGN_TOP_LEFT, 250, 250);
        lv_obj_add_event_cb(btn_typeface_confirm, btn_set_print_mode_confirm_event_cb, LV_EVENT_CLICKED, NULL);

        LV_FONT_DECLARE(heiFont16_1);
        label_typeface_confirm = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_typeface_confirm, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_typeface_confirm, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_typeface_confirm,  "确定");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_typeface_confirm, "Confirm");
        }
        lv_obj_align(label_typeface_confirm, LV_ALIGN_TOP_LEFT, 277, 252);
    }
}

static void set_tv_print_create(lv_obj_t* parent)
{
    char tempbuf[64]={0};
    char* opts;
    char* opts_print;
    char* opts_encoder;
    char* opts_nozzle;

    printf("set_tv_print_create\n");
    buzzer_enable = 1;
    lv_obj_set_style_pad_all(parent, 0, LV_STATE_DEFAULT);
    lv_obj_clear_flag(parent, LV_OBJ_FLAG_SCROLLABLE);
    lv_obj_t* set_print_obj = lv_obj_create(parent);
    lv_obj_set_size(set_print_obj, 480, 224);
    lv_obj_align(set_print_obj, LV_ALIGN_TOP_LEFT, 0, 0);
    lv_obj_set_style_border_width(set_print_obj, 2, LV_STATE_DEFAULT); /* 设置边框宽度 */
    lv_obj_set_style_radius(set_print_obj, 0, LV_STATE_DEFAULT); /* 设置圆角 */
    lv_obj_set_style_bg_opa(set_print_obj, LV_OPA_TRANSP, LV_PART_MAIN);
    lv_obj_set_style_pad_all(set_print_obj, 0, LV_STATE_DEFAULT);
    lv_obj_clear_flag(set_print_obj, LV_OBJ_FLAG_SCROLLABLE);

    LV_FONT_DECLARE(heiFont16_1);
    label_trigger_mode = lv_label_create(set_print_obj);
    lv_obj_set_style_text_font(label_trigger_mode, &heiFont16_1, LV_STATE_DEFAULT);
    lv_obj_set_style_text_color(label_trigger_mode, lv_color_hex(0x000000), LV_STATE_DEFAULT);
    if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
    {
        lv_label_set_text(label_trigger_mode,  "触发方式");
    }
    else if(system_data.system.language == LANGUAGE_ENGLISH)
    {
        lv_label_set_text(label_trigger_mode, "Trigger mode");
    }
    lv_obj_align(label_trigger_mode, LV_ALIGN_TOP_LEFT, 2, 20);
    if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
    {
        opts = "按键\n光电";
    }
    else if(system_data.system.language == LANGUAGE_ENGLISH)
    {
        opts = "Key\nOptoelectronic";
    }
    else
    {
        opts = "按键\n光电";
    }

    trigger_mode = lv_dropdown_create(set_print_obj);
    lv_obj_set_style_border_width(trigger_mode, 1, LV_STATE_DEFAULT); /* 设置边框宽度 */
    //lv_obj_set_style_radius(trigger_mode, 0, LV_STATE_DEFAULT); /* 设置圆角 */
    lv_dropdown_set_options_static(trigger_mode, opts);
    lv_obj_align(trigger_mode, LV_ALIGN_TOP_LEFT, 70, 10);
    lv_obj_set_style_width(trigger_mode, 85, LV_STATE_DEFAULT);
    LV_FONT_DECLARE(heiFont14);
    lv_obj_set_style_text_font(trigger_mode, &heiFont14, LV_STATE_DEFAULT);
    lv_obj_set_style_height(trigger_mode, 35, LV_STATE_DEFAULT);
    lv_obj_t* trigger_mode_list = lv_dropdown_get_list(trigger_mode);
    lv_obj_set_style_text_font(trigger_mode_list, &heiFont14, 0);   // 设置新的字体
    LV_IMG_DECLARE(dropdown);
    lv_dropdown_set_symbol(trigger_mode, &dropdown);
    lv_obj_add_event_cb(trigger_mode, trigger_mode_event_handler, LV_EVENT_ALL, NULL);

    lv_dropdown_set_selected(trigger_mode, system_data.print.trigger_mode);

    LV_FONT_DECLARE(heiFont16_1);
    label_print_mode = lv_label_create(set_print_obj);
    lv_obj_set_style_text_font(label_print_mode, &heiFont16_1, LV_STATE_DEFAULT);
    lv_obj_set_style_text_color(label_print_mode, lv_color_hex(0x000000), LV_STATE_DEFAULT);
    if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
    {
        lv_label_set_text(label_print_mode, "喷印方向");
    }
    else if(system_data.system.language == LANGUAGE_ENGLISH)
    {
        lv_label_set_text(label_print_mode, "Printing direction");
    }
    lv_obj_align(label_print_mode, LV_ALIGN_TOP_LEFT, 160, 70);
    //正向模式 逆向模式 正倒模式 逆倒模式
    if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
    {
        opts_print = "正向\n逆向\n正倒\n逆倒";
    }
    else if(system_data.system.language == LANGUAGE_ENGLISH)
    {
        opts_print = "Forward\nBackward\nUpright\nReverse";
    }
    else
    {
        opts_print = "正向\n逆向\n正倒\n逆倒";
    }
    print_mode = lv_dropdown_create(set_print_obj);
    lv_obj_set_style_border_width(print_mode, 1, LV_STATE_DEFAULT); /* 设置边框宽度 */
    //lv_obj_set_style_radius(print_mode, 0, LV_STATE_DEFAULT); /* 设置圆角 */
    lv_dropdown_set_options_static(print_mode, opts_print);
    lv_obj_align(print_mode, LV_ALIGN_TOP_LEFT, 230, 60);
    lv_obj_set_style_width(print_mode, 85, LV_STATE_DEFAULT);
    lv_obj_set_style_height(print_mode, 35, LV_STATE_DEFAULT);
    LV_FONT_DECLARE(heiFont14);
    lv_obj_set_style_text_font(print_mode, &heiFont14, LV_STATE_DEFAULT);
    lv_obj_t* print_mode_list = lv_dropdown_get_list(print_mode);
    lv_obj_set_style_text_font(print_mode_list, &heiFont14, 0);   // 设置新的字体
    LV_IMG_DECLARE(dropdown);
    lv_dropdown_set_symbol(print_mode, &dropdown);
    lv_obj_add_event_cb(print_mode, print_mode_event_handler, LV_EVENT_ALL, NULL);

    lv_dropdown_set_selected(print_mode, system_data.print.print_direction);

    LV_FONT_DECLARE(heiFont16_1);
    label_voltage_mode = lv_label_create(set_print_obj);
    lv_obj_set_style_text_font(label_voltage_mode, &heiFont16_1, LV_STATE_DEFAULT);
    lv_obj_set_style_text_color(label_voltage_mode, lv_color_hex(0x000000), LV_STATE_DEFAULT);
    if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
    {
        lv_label_set_text(label_voltage_mode, "打印电压");
    }
    else if(system_data.system.language == LANGUAGE_ENGLISH)
    {
        lv_label_set_text(label_voltage_mode, "Printing voltage");
    }
    lv_obj_align(label_voltage_mode, LV_ALIGN_TOP_LEFT, 160, 120);

    static const char* opts_voltage = "8.0V\n8.2V\n8.4V\n8.6V\n8.8V\n"
        "9.0V\n9.2V\n9.4V\n9.6V\n9.8V\n"
        "10.0V\n10.2V\n10.4V\n10.6V\n10.8V\n"
        "11.0V\n11.2V\n11.4V\n11.6V\n11.8V\n"
        "12.0V\n";

    voltage_mode = lv_dropdown_create(set_print_obj);
    lv_obj_set_style_border_width(voltage_mode, 1, LV_STATE_DEFAULT); /* 设置边框宽度 */
    //lv_obj_set_style_radius(voltage_mode, 0, LV_STATE_DEFAULT); /* 设置圆角 */
    lv_dropdown_set_options_static(voltage_mode, opts_voltage);
    lv_obj_align(voltage_mode, LV_ALIGN_TOP_LEFT, 230, 110);
    lv_obj_set_style_height(voltage_mode, 35, LV_STATE_DEFAULT);
    lv_obj_set_style_width(voltage_mode, 85, LV_STATE_DEFAULT);
    LV_FONT_DECLARE(heiFont14);
    lv_obj_set_style_text_font(voltage_mode, &heiFont14, LV_STATE_DEFAULT);
    lv_obj_t* voltage_mode_list = lv_dropdown_get_list(voltage_mode);
    lv_obj_set_style_text_font(voltage_mode_list, &heiFont14, 0);   // 设置新的字体
    LV_IMG_DECLARE(dropdown);
    lv_dropdown_set_symbol(voltage_mode, &dropdown);
    lv_obj_add_event_cb(voltage_mode, voltage_mode_event_handler, LV_EVENT_ALL, NULL);

    lv_dropdown_set_selected(voltage_mode, system_data.print.print_voltage);

    LV_FONT_DECLARE(heiFont16_1);
    label_width_mode = lv_label_create(set_print_obj);
    lv_obj_set_style_text_font(label_width_mode, &heiFont16_1, LV_STATE_DEFAULT);
    lv_obj_set_style_text_color(label_width_mode, lv_color_hex(0x000000), LV_STATE_DEFAULT);
    if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
    {
        lv_label_set_text(label_width_mode, "字体宽度");
    }
    else if(system_data.system.language == LANGUAGE_ENGLISH)
    {
        lv_label_set_text(label_width_mode, "Set width");
    }
    lv_obj_align(label_width_mode, LV_ALIGN_TOP_LEFT, 2, 170);
    static const char* opts_width = "1\n2\n3\n4\n5\n";
    width_mode = lv_dropdown_create(set_print_obj);
    lv_obj_set_style_border_width(width_mode, 1, LV_STATE_DEFAULT); /* 设置边框宽度 */
    //lv_obj_set_style_radius(width_mode, 0, LV_STATE_DEFAULT); /* 设置圆角 */
    lv_dropdown_set_options_static(width_mode, opts_width);
    lv_obj_align(width_mode, LV_ALIGN_TOP_LEFT, 70,160);
    lv_obj_set_style_width(width_mode, 85, LV_STATE_DEFAULT);
    lv_obj_set_style_height(width_mode, 35, LV_STATE_DEFAULT);
    LV_FONT_DECLARE(heiFont14);
    lv_obj_set_style_text_font(width_mode, &heiFont14, LV_STATE_DEFAULT);
    lv_obj_t* width_mode_list = lv_dropdown_get_list(width_mode);
    lv_obj_set_style_text_font(width_mode_list, &heiFont14, 0);   // 设置新的字体
    LV_IMG_DECLARE(dropdown);
    lv_dropdown_set_symbol(width_mode, &dropdown);
    lv_obj_add_event_cb(width_mode, width_mode_event_handler, LV_EVENT_ALL, NULL);

    lv_dropdown_set_selected(width_mode,system_data.print.width);

    LV_FONT_DECLARE(heiFont16_1);
    label_encoder_mode = lv_label_create(set_print_obj);
    lv_obj_set_style_text_font(label_encoder_mode, &heiFont16_1, LV_STATE_DEFAULT);
    lv_obj_set_style_text_color(label_encoder_mode, lv_color_hex(0x000000), LV_STATE_DEFAULT);
    if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
    {
        lv_label_set_text(label_encoder_mode, "编码器");
    }
    else if(system_data.system.language == LANGUAGE_ENGLISH)
    {
        lv_label_set_text(label_encoder_mode, "Encoder");
    }
    lv_obj_align(label_encoder_mode, LV_ALIGN_TOP_LEFT, 160, 20);
    if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
    {
        opts_encoder = "开启\n关闭\n";
    }
    else if(system_data.system.language == LANGUAGE_ENGLISH)
    {
        opts_encoder = "On\nOff\n";
    }
    else
    {
        opts_encoder = "开启\n关闭\n";
    }
    encoder_mode = lv_dropdown_create(set_print_obj);
    lv_obj_set_style_border_width(encoder_mode, 1, LV_STATE_DEFAULT); /* 设置边框宽度 */
    //lv_obj_set_style_radius(encoder_mode, 0, LV_STATE_DEFAULT); /* 设置圆角 */
    lv_dropdown_set_options_static(encoder_mode, opts_encoder);
    lv_obj_align(encoder_mode, LV_ALIGN_TOP_LEFT, 230, 10);
    lv_obj_set_style_width(encoder_mode, 85, LV_STATE_DEFAULT);
    lv_obj_set_style_height(encoder_mode, 35, LV_STATE_DEFAULT);
    LV_FONT_DECLARE(heiFont14);
    lv_obj_set_style_text_font(encoder_mode, &heiFont14, LV_STATE_DEFAULT);
    lv_obj_t* encoder_mode_list = lv_dropdown_get_list(encoder_mode);
    lv_obj_set_style_text_font(encoder_mode_list, &heiFont14, 0);   // 设置新的字体
    LV_IMG_DECLARE(dropdown);
    lv_dropdown_set_symbol(encoder_mode, &dropdown);
    lv_obj_add_event_cb(encoder_mode, encoder_mode_event_handler, LV_EVENT_ALL, NULL);

    lv_dropdown_set_selected(encoder_mode, system_data.print.encoder);

    LV_FONT_DECLARE(heiFont16_1);
    label_nozzle_mode = lv_label_create(set_print_obj);
    lv_obj_set_style_text_font(label_nozzle_mode, &heiFont16_1, LV_STATE_DEFAULT);
    lv_obj_set_style_text_color(label_nozzle_mode, lv_color_hex(0x000000), LV_STATE_DEFAULT);
    if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
    {
        lv_label_set_text(label_nozzle_mode, "喷头选择");
    }
    else if(system_data.system.language == LANGUAGE_ENGLISH)
    {
        lv_label_set_text(label_nozzle_mode, "Nozzle selection");
    }
    lv_obj_align(label_nozzle_mode, LV_ALIGN_TOP_LEFT, 2, 70);
    if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
    {
        opts_nozzle = "左喷\n右喷";
    }
    else if(system_data.system.language == LANGUAGE_ENGLISH)
    {
        opts_nozzle = "Left\nRight";
    }
    else
    {
        opts_nozzle = "左喷\n右喷";
    }
    nozzle_mode = lv_dropdown_create(set_print_obj);
    lv_obj_set_style_border_width(nozzle_mode, 1, LV_STATE_DEFAULT); /* 设置边框宽度 */
    //lv_obj_set_style_radius(nozzle_mode, 0, LV_STATE_DEFAULT); /* 设置圆角 */
    //lv_obj_set_style_bg_color(nozzle_mode, lv_color_hex(0x28536a), LV_STATE_DEFAULT);
    lv_dropdown_set_options_static(nozzle_mode, opts_nozzle);
    lv_obj_align(nozzle_mode, LV_ALIGN_TOP_LEFT, 70, 60);
    lv_obj_set_style_width(nozzle_mode, 85, LV_STATE_DEFAULT);
    lv_obj_set_style_height(nozzle_mode, 35, LV_STATE_DEFAULT);
    LV_FONT_DECLARE(heiFont14);
    lv_obj_set_style_text_font(nozzle_mode, &heiFont14, LV_STATE_DEFAULT);
    lv_obj_t* nozzle_mode_list = lv_dropdown_get_list(nozzle_mode);
    lv_obj_set_style_text_font(nozzle_mode_list, &heiFont14, 0);   // 设置新的字体
    LV_IMG_DECLARE(dropdown);
    lv_dropdown_set_symbol(nozzle_mode, &dropdown);
    lv_obj_add_event_cb(nozzle_mode, nozzle_mode_event_handler, LV_EVENT_ALL, NULL);

    lv_dropdown_set_selected(nozzle_mode,system_data.print.nozzle);


    LV_FONT_DECLARE(heiFont16_1);
    label_concentration_mode = lv_label_create(set_print_obj);
    lv_obj_set_style_text_font(label_concentration_mode, &heiFont16_1, LV_STATE_DEFAULT);
    lv_obj_set_style_text_color(label_concentration_mode, lv_color_hex(0x000000), LV_STATE_DEFAULT);
    if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
    {
        lv_label_set_text(label_concentration_mode,  "喷墨浓度");
    }
    else if(system_data.system.language == LANGUAGE_ENGLISH)
    {
        lv_label_set_text(label_concentration_mode, "Inkjet concentration");
    }
    lv_obj_align(label_concentration_mode, LV_ALIGN_TOP_LEFT, 2, 120);
    static const char* opts_concentration = "1\n2\n3\n4\n";
    concentration_mode = lv_dropdown_create(set_print_obj);
    lv_obj_set_style_border_width(concentration_mode, 1, LV_STATE_DEFAULT); /* 设置边框宽度 */
    //lv_obj_set_style_radius(concentration_mode, 0, LV_STATE_DEFAULT); /* 设置圆角 */
    lv_dropdown_set_options_static(concentration_mode, opts_concentration);
    lv_obj_align(concentration_mode, LV_ALIGN_TOP_LEFT, 70, 110);
    lv_obj_set_style_width(concentration_mode, 85, LV_STATE_DEFAULT);
    lv_obj_set_style_height(concentration_mode, 35, LV_STATE_DEFAULT);
    LV_FONT_DECLARE(heiFont14);
    lv_obj_set_style_text_font(concentration_mode, &heiFont14, LV_STATE_DEFAULT);
    lv_obj_t* concentration_mode_list = lv_dropdown_get_list(concentration_mode);
    lv_obj_set_style_text_font(concentration_mode_list, &heiFont14, 0);   // 设置新的字体
    LV_IMG_DECLARE(dropdown);
    lv_dropdown_set_symbol(concentration_mode, &dropdown);
    lv_obj_add_event_cb(concentration_mode, concentration_mode_event_handler, LV_EVENT_ALL, NULL);

    lv_dropdown_set_selected(concentration_mode,system_data.print.concentration);

    //连喷次数就是按一下之后滚动，如果连喷次数是1就喷一次，是3就喷三次，以此类推
    LV_FONT_DECLARE(heiFont16_1);
    label_number_continuous_print_mode = lv_label_create(set_print_obj);
    lv_obj_set_style_text_font(label_number_continuous_print_mode, &heiFont16_1, LV_STATE_DEFAULT);
    lv_obj_set_style_text_color(label_number_continuous_print_mode, lv_color_hex(0x000000), LV_STATE_DEFAULT);
    if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
    {
        lv_label_set_text(label_number_continuous_print_mode,  "连喷次数");
    }
    else if(system_data.system.language == LANGUAGE_ENGLISH)
    {
        lv_label_set_text(label_number_continuous_print_mode, "Number of consecutive sprays");
    }
    lv_obj_align(label_number_continuous_print_mode, LV_ALIGN_TOP_LEFT, 160, 170);
    static const char* opts_number_continuous_print = "1\n2\n3\n4\n5\n6\n7\n8\n9\n";
    number_continuous_print_mode = lv_dropdown_create(set_print_obj);
    lv_obj_set_style_border_width(number_continuous_print_mode, 1, LV_STATE_DEFAULT); /* 设置边框宽度 */
    //lv_obj_set_style_radius(number_continuous_print_mode, 0, LV_STATE_DEFAULT); /* 设置圆角 */
    lv_dropdown_set_options_static(number_continuous_print_mode, opts_number_continuous_print);
    lv_obj_align(number_continuous_print_mode, LV_ALIGN_TOP_LEFT, 230, 160);
    lv_obj_set_style_width(number_continuous_print_mode, 85, LV_STATE_DEFAULT);
    lv_obj_set_style_height(number_continuous_print_mode, 35, LV_STATE_DEFAULT);
    LV_FONT_DECLARE(heiFont14);
    lv_obj_set_style_text_font(number_continuous_print_mode, &heiFont14, LV_STATE_DEFAULT);
    lv_obj_t* number_continuous_print_mode_list = lv_dropdown_get_list(number_continuous_print_mode);
    lv_obj_set_style_text_font(number_continuous_print_mode_list, &heiFont14, 0);   // 设置新的字体
    LV_IMG_DECLARE(dropdown);
    lv_dropdown_set_symbol(number_continuous_print_mode, &dropdown);
    lv_obj_add_event_cb(number_continuous_print_mode, number_continuous_print_mode_event_handler, LV_EVENT_ALL, NULL);

    lv_dropdown_set_selected(number_continuous_print_mode, system_data.print.print_number);


    LV_FONT_DECLARE(heiFont16_1);
    label_interval_continuous_print_mode = lv_label_create(set_print_obj);
    lv_obj_set_style_text_font(label_interval_continuous_print_mode, &heiFont16_1, LV_STATE_DEFAULT);
    lv_obj_set_style_text_color(label_interval_continuous_print_mode, lv_color_hex(0x000000), LV_STATE_DEFAULT);
    if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
    {
        lv_label_set_text(label_interval_continuous_print_mode,  "连喷间隔");
    }
    else if(system_data.system.language == LANGUAGE_ENGLISH)
    {
        lv_label_set_text(label_interval_continuous_print_mode, "Continuous spray interval");
    }
    lv_obj_align(label_interval_continuous_print_mode, LV_ALIGN_TOP_LEFT, 318, 20);

    LV_FONT_DECLARE(heiFont16_1);
    btn_interval_continuous_print_mode = lv_btn_create(set_print_obj);
    lv_obj_set_size(btn_interval_continuous_print_mode, 78, 30);
    lv_obj_align(btn_interval_continuous_print_mode, LV_ALIGN_TOP_LEFT, 390, 12);
    lv_obj_set_style_border_width(btn_interval_continuous_print_mode, 1, LV_STATE_DEFAULT); /* 设置边框宽度 */
    lv_obj_set_style_radius(btn_interval_continuous_print_mode, 0, LV_STATE_DEFAULT); /* 设置圆角 */
    lv_obj_set_style_bg_color(btn_interval_continuous_print_mode, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
    label_btn_interval_continuous_print_mode = lv_label_create(btn_interval_continuous_print_mode);
    lv_obj_set_style_text_font(label_btn_interval_continuous_print_mode, &heiFont16_1, LV_STATE_DEFAULT);
    lv_obj_set_style_text_color(label_btn_interval_continuous_print_mode, lv_color_hex(0x1C1C1C), LV_STATE_DEFAULT);
    //lv_label_set_text(label_btn_interval_continuous_print_mode, "");
    lv_obj_align(label_btn_interval_continuous_print_mode, LV_ALIGN_CENTER, 0, 0);
    lv_obj_set_style_border_width(label_btn_interval_continuous_print_mode, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
    lv_obj_set_style_border_color(label_btn_interval_continuous_print_mode, lv_color_hex(0x8a8a8a), LV_STATE_DEFAULT); /* 设置边框颜色 */
    lv_obj_set_style_border_opa(label_btn_interval_continuous_print_mode, 100, LV_STATE_DEFAULT); /* 设置边框透明度 */
    lv_obj_set_style_radius(label_btn_interval_continuous_print_mode, 0, LV_STATE_DEFAULT); /* 设置圆角 */
    lv_obj_set_style_bg_opa(label_btn_interval_continuous_print_mode, LV_OPA_COVER, LV_PART_MAIN);
    lv_obj_set_style_bg_color(label_btn_interval_continuous_print_mode, lv_color_hex(0xffffff), LV_PART_MAIN);
    lv_obj_add_event_cb(btn_interval_continuous_print_mode, btn_interval_continuous_print_mode_event_cb, LV_EVENT_CLICKED, NULL);

    sprintf(tempbuf,"%d", system_data.print.print_interval);
    lv_label_set_text(label_btn_interval_continuous_print_mode, tempbuf);


    LV_FONT_DECLARE(heiFont16_1);
    label_trigger_delay_mode = lv_label_create(set_print_obj);
    lv_obj_set_style_text_font(label_trigger_delay_mode, &heiFont16_1, LV_STATE_DEFAULT);
    lv_obj_set_style_text_color(label_trigger_delay_mode, lv_color_hex(0x000000), LV_STATE_DEFAULT);
    if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
    {
        lv_label_set_text(label_trigger_delay_mode,  "触发延迟");
    }
    else if(system_data.system.language == LANGUAGE_ENGLISH)
    {
        lv_label_set_text(label_trigger_delay_mode, "Trigger delay");
    }
    lv_obj_align(label_trigger_delay_mode, LV_ALIGN_TOP_LEFT, 318, 70);

    LV_FONT_DECLARE(heiFont16_1);
    btn_trigger_delay_mode = lv_btn_create(set_print_obj);
    lv_obj_set_size(btn_trigger_delay_mode, 78, 30);
    lv_obj_align(btn_trigger_delay_mode, LV_ALIGN_TOP_LEFT, 390, 62);
    lv_obj_set_style_border_width(btn_trigger_delay_mode, 1, LV_STATE_DEFAULT); /* 设置边框宽度 */
    lv_obj_set_style_radius(btn_trigger_delay_mode, 0, LV_STATE_DEFAULT); /* 设置圆角 */
    lv_obj_set_style_bg_color(btn_trigger_delay_mode, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
    label_btn_trigger_delay_mode = lv_label_create(btn_trigger_delay_mode);
    lv_obj_set_style_text_font(label_btn_trigger_delay_mode, &heiFont16_1, LV_STATE_DEFAULT);
    lv_obj_set_style_text_color(label_btn_trigger_delay_mode, lv_color_hex(0x1C1C1C), LV_STATE_DEFAULT);
    lv_label_set_text(label_btn_trigger_delay_mode, "");
    lv_obj_align(label_btn_trigger_delay_mode, LV_ALIGN_CENTER, 0, 0);
    lv_obj_set_style_border_width(label_btn_trigger_delay_mode, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
    lv_obj_set_style_border_color(label_btn_trigger_delay_mode, lv_color_hex(0x8a8a8a), LV_STATE_DEFAULT); /* 设置边框颜色 */
    lv_obj_set_style_border_opa(label_btn_trigger_delay_mode, 100, LV_STATE_DEFAULT); /* 设置边框透明度 */
    lv_obj_set_style_radius(label_btn_trigger_delay_mode, 0, LV_STATE_DEFAULT); /* 设置圆角 */
    lv_obj_set_style_bg_opa(label_btn_trigger_delay_mode, LV_OPA_COVER, LV_PART_MAIN);
    lv_obj_set_style_bg_color(label_btn_trigger_delay_mode, lv_color_hex(0xffffff), LV_PART_MAIN);
    lv_obj_add_event_cb(btn_trigger_delay_mode, btn_trigger_delay_mode_event_cb, LV_EVENT_CLICKED, NULL);

    sprintf(tempbuf, "%d", system_data.print.trigger_delay);
    lv_label_set_text(label_btn_trigger_delay_mode, tempbuf);


    LV_FONT_DECLARE(heiFont16_1);
    label_speed_print_mode = lv_label_create(set_print_obj);
    lv_obj_set_style_text_font(label_speed_print_mode, &heiFont16_1, LV_STATE_DEFAULT);
    lv_obj_set_style_text_color(label_speed_print_mode, lv_color_hex(0x000000), LV_STATE_DEFAULT);
    if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
    {
        lv_label_set_text(label_speed_print_mode,  "喷印速度");
    }
    else if(system_data.system.language == LANGUAGE_ENGLISH)
    {
        lv_label_set_text(label_speed_print_mode, "Printing speed");
    }
    lv_obj_align(label_speed_print_mode, LV_ALIGN_TOP_LEFT, 318, 120);


    LV_FONT_DECLARE(heiFont16_1);
    btn_label_speed_print_mode = lv_btn_create(set_print_obj);
    lv_obj_set_size(btn_label_speed_print_mode, 78, 30);
    lv_obj_align(btn_label_speed_print_mode, LV_ALIGN_TOP_LEFT, 390, 112);
    lv_obj_set_style_border_width(btn_label_speed_print_mode, 1, LV_STATE_DEFAULT); /* 设置边框宽度 */
    lv_obj_set_style_radius(btn_label_speed_print_mode, 0, LV_STATE_DEFAULT); /* 设置圆角 */
    lv_obj_set_style_bg_color(btn_label_speed_print_mode, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
    label_btn_label_speed_print_mode = lv_label_create(btn_label_speed_print_mode);
    lv_obj_set_style_text_font(label_btn_label_speed_print_mode, &heiFont16_1, LV_STATE_DEFAULT);
    lv_obj_set_style_text_color(label_btn_label_speed_print_mode, lv_color_hex(0x1C1C1C), LV_STATE_DEFAULT);
    //lv_label_set_text(label_btn_label_speed_print_mode, "");
    lv_obj_align(label_btn_label_speed_print_mode, LV_ALIGN_CENTER, 0, 0);
    lv_obj_set_style_border_width(label_btn_label_speed_print_mode, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
    lv_obj_set_style_border_color(label_btn_label_speed_print_mode, lv_color_hex(0x8a8a8a), LV_STATE_DEFAULT); /* 设置边框颜色 */
    lv_obj_set_style_border_opa(label_btn_label_speed_print_mode, 100, LV_STATE_DEFAULT); /* 设置边框透明度 */
    lv_obj_set_style_radius(label_btn_label_speed_print_mode, 0, LV_STATE_DEFAULT); /* 设置圆角 */
    lv_obj_set_style_bg_opa(label_btn_label_speed_print_mode, LV_OPA_COVER, LV_PART_MAIN);
    lv_obj_set_style_bg_color(label_btn_label_speed_print_mode, lv_color_hex(0xffffff), LV_PART_MAIN);
    lv_obj_add_event_cb(btn_label_speed_print_mode, btn_label_speed_print_mode_event_cb, LV_EVENT_CLICKED, NULL);

    sprintf(tempbuf, "%d", system_data.print.print_speed);
    lv_label_set_text(label_btn_label_speed_print_mode, tempbuf);

    LV_FONT_DECLARE(heiFont16_1);
    label_set_print_mode = lv_label_create(set_print_obj);
    lv_obj_set_style_text_font(label_set_print_mode, &heiFont16_1, LV_STATE_DEFAULT);
    lv_obj_set_style_text_color(label_set_print_mode, lv_color_hex(0x000000), LV_STATE_DEFAULT);
    if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
    {
        lv_label_set_text(label_set_print_mode,  "闪喷设置");
    }
    else if(system_data.system.language == LANGUAGE_ENGLISH)
    {
        lv_label_set_text(label_set_print_mode, "Flash spray setting");
    }
    lv_obj_align(label_set_print_mode, LV_ALIGN_TOP_LEFT, 318, 170);


    LV_FONT_DECLARE(heiFont16_1);
    btn_label_set_print_mode = lv_btn_create(set_print_obj);
    lv_obj_set_size(btn_label_set_print_mode, 78, 30);
    lv_obj_align(btn_label_set_print_mode, LV_ALIGN_TOP_LEFT, 390, 162);
    lv_obj_set_style_border_width(btn_label_set_print_mode, 1, LV_STATE_DEFAULT); /* 设置边框宽度 */
    lv_obj_set_style_radius(btn_label_set_print_mode, 0, LV_STATE_DEFAULT); /* 设置圆角 */
    lv_obj_set_style_bg_color(btn_label_set_print_mode, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
    label_btn_label_set_print_mode = lv_label_create(btn_label_set_print_mode);
    lv_obj_set_style_text_font(label_btn_label_set_print_mode, &heiFont16_1, LV_STATE_DEFAULT);
    lv_obj_set_style_text_color(label_btn_label_set_print_mode, lv_color_hex(0x1C1C1C), LV_STATE_DEFAULT);
    //lv_label_set_text(label_btn_label_set_print_mode, "");
    lv_obj_align(label_btn_label_set_print_mode, LV_ALIGN_CENTER, 0, 0);
    lv_obj_set_style_border_width(label_btn_label_set_print_mode, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
    lv_obj_set_style_border_color(label_btn_label_set_print_mode, lv_color_hex(0x8a8a8a), LV_STATE_DEFAULT); /* 设置边框颜色 */
    lv_obj_set_style_border_opa(label_btn_label_set_print_mode, 100, LV_STATE_DEFAULT); /* 设置边框透明度 */
    lv_obj_set_style_radius(label_btn_label_set_print_mode, 0, LV_STATE_DEFAULT); /* 设置圆角 */
    lv_obj_set_style_bg_opa(label_btn_label_set_print_mode, LV_OPA_COVER, LV_PART_MAIN);
    lv_obj_set_style_bg_color(label_btn_label_set_print_mode, lv_color_hex(0xffffff), LV_PART_MAIN);
    lv_obj_add_event_cb(btn_label_set_print_mode, btn_label_set_print_mode_event_cb, LV_EVENT_CLICKED, NULL);

    sprintf(tempbuf, "%d", system_data.print.flash_set);
    lv_label_set_text(label_btn_label_set_print_mode, tempbuf);
}


static void btn_system_date_event_cb(lv_event_t* e)
{
    lv_event_code_t code;

    code = lv_event_get_code(e);
   // int len = 0;
   // int i;
   // int offset_x;
   // int offset_y;
   // int line_num = 5;
   // int size_wide = 85;
   // int size_high = 24;
   // lv_obj_t* obj = lv_event_get_target(e);

    if (code == LV_EVENT_CLICKED)
    {
        buzzer_enable = 1;

        static lv_style_t style_sel;
        lv_style_init(&style_sel);
        lv_style_set_text_font(&style_sel, &lv_font_montserrat_20);

        system_date_head_bg = lv_obj_create(lv_scr_act());
        lv_obj_set_size(system_date_head_bg, 480, 24);
        lv_obj_align(system_date_head_bg, LV_ALIGN_TOP_LEFT, 0, 0);
        lv_obj_set_style_border_width(system_date_head_bg, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_border_color(system_date_head_bg, lv_color_hex(0x9bcd9b), LV_STATE_DEFAULT); /* 设置边框颜色 */
        lv_obj_set_style_radius(system_date_head_bg, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_color(system_date_head_bg, lv_color_hex(0x1fadd3), LV_STATE_DEFAULT);

        LV_FONT_DECLARE(heiFont16_1);
        label_system_date_head = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_system_date_head, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_system_date_head, lv_color_hex(0xFFFFFF), LV_STATE_DEFAULT);
        lv_obj_align(label_system_date_head, LV_ALIGN_TOP_LEFT, 200, 4);

        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_system_date_head,  "系统时间设置");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_system_date_head, "System time setting");
        }
 
        system_date_middle_bg = lv_obj_create(lv_scr_act());
        lv_obj_set_size(system_date_middle_bg, 480, 224);
        lv_obj_align(system_date_middle_bg, LV_ALIGN_TOP_LEFT, 0, 24);
        lv_obj_set_style_border_width(system_date_middle_bg, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_border_color(system_date_middle_bg, lv_color_hex(0xaaaaa), LV_STATE_DEFAULT); /* 设置边框颜色 */
        lv_obj_set_style_radius(system_date_middle_bg, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_color(system_date_middle_bg, lv_color_hex(0xffffff), LV_STATE_DEFAULT);


        LV_FONT_DECLARE(heiFont16_1);
        label_system_date_year_middle = lv_label_create(system_date_middle_bg);
        lv_obj_set_style_text_font(label_system_date_year_middle, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_system_date_year_middle, lv_color_hex(0x000000), LV_STATE_DEFAULT);
        lv_obj_align(label_system_date_year_middle, LV_ALIGN_TOP_LEFT, 25, 5);

        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_system_date_year_middle, "年");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_system_date_year_middle, "Year");
        }

        LV_FONT_DECLARE(heiFont16_1);
        label_system_date_month_middle = lv_label_create(system_date_middle_bg);
        lv_obj_set_style_text_font(label_system_date_month_middle, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_system_date_month_middle, lv_color_hex(0x000000), LV_STATE_DEFAULT);
        lv_obj_align(label_system_date_month_middle, LV_ALIGN_TOP_LEFT, 100, 5);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_system_date_month_middle, "月");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_system_date_month_middle, "Month");
        }

        LV_FONT_DECLARE(heiFont16_1);
        label_system_date_day_middle = lv_label_create(system_date_middle_bg);
        lv_obj_set_style_text_font(label_system_date_day_middle, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_system_date_day_middle, lv_color_hex(0x000000), LV_STATE_DEFAULT);
        lv_obj_align(label_system_date_day_middle, LV_ALIGN_TOP_LEFT, 175, 5);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_system_date_day_middle, "日");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_system_date_day_middle, "Day");
        }

        LV_FONT_DECLARE(heiFont16_1);
        label_system_date_hour_middle = lv_label_create(system_date_middle_bg);
        lv_obj_set_style_text_font(label_system_date_hour_middle, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_system_date_hour_middle, lv_color_hex(0x000000), LV_STATE_DEFAULT);
        lv_obj_align(label_system_date_hour_middle, LV_ALIGN_TOP_LEFT, 250, 5);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_system_date_hour_middle, "时");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_system_date_hour_middle, "Hour");
        }

        LV_FONT_DECLARE(heiFont16_1);
        label_system_date_minute_middle = lv_label_create(system_date_middle_bg);
        lv_obj_set_style_text_font(label_system_date_minute_middle, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_system_date_minute_middle, lv_color_hex(0x000000), LV_STATE_DEFAULT);
        lv_obj_align(label_system_date_minute_middle, LV_ALIGN_TOP_LEFT, 325, 5);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_system_date_minute_middle, "分");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_system_date_minute_middle, "Minute");
        }

        LV_FONT_DECLARE(heiFont16_1);
        label_system_date_second_middle = lv_label_create(system_date_middle_bg);
        lv_obj_set_style_text_font(label_system_date_second_middle, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_system_date_second_middle, lv_color_hex(0x000000), LV_STATE_DEFAULT);
        lv_obj_align(label_system_date_second_middle, LV_ALIGN_TOP_LEFT, 400, 5);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_system_date_second_middle, "秒");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_system_date_second_middle, "Second");
        }

        system_date_roller_year = lv_roller_create(system_date_middle_bg);
        lv_roller_set_options(system_date_roller_year,
            "2024\n"
            "2025\n"
            "2026\n"
            "2027\n"
            "2028\n"
            "2029\n"
            "2030\n"
            "2031\n"
            "2032\n"
            "2033\n"
            "2034\n"
            "2035",
            LV_ROLLER_MODE_INFINITE);

        lv_roller_set_visible_row_count(system_date_roller_year, 5);
        lv_obj_align(system_date_roller_year, LV_ALIGN_TOP_LEFT, 5, 25);
        lv_obj_set_style_width(system_date_roller_year, 60, LV_STATE_DEFAULT);
        lv_obj_add_style(system_date_roller_year, &style_sel, LV_PART_SELECTED);

        printf("g_system_time[0]=%d\n\r",g_system_time[0]);

        if((g_system_time[0]>23)&&(g_system_time[0] < 36))
        {
             lv_roller_set_selected(system_date_roller_year, g_system_time[0] - 24, LV_ANIM_ON);
        }
        else
        {
            lv_roller_set_selected(system_date_roller_year, 0, LV_ANIM_ON);
        }

        system_date_roller_month = lv_roller_create(system_date_middle_bg);
        lv_roller_set_options(system_date_roller_month,
            "01\n"
            "02\n"
            "03\n"
            "04\n"
            "05\n"
            "06\n"
            "07\n"
            "08\n"
            "09\n"
            "10\n"
            "11\n"
            "12",
            LV_ROLLER_MODE_INFINITE);
        lv_obj_set_style_width(system_date_roller_month, 60, LV_STATE_DEFAULT);
        lv_roller_set_visible_row_count(system_date_roller_month, 5);
        lv_obj_align(system_date_roller_month, LV_ALIGN_TOP_LEFT, 80, 25);
        lv_obj_add_style(system_date_roller_month, &style_sel, LV_PART_SELECTED);

        printf("g_system_time[1]=%d\n\r",g_system_time[1]);

        if((g_system_time[1]>0)&&(g_system_time[1] < 13))
        {
             lv_roller_set_selected(system_date_roller_month, g_system_time[1] - 1, LV_ANIM_ON);
        }
        else
        {
            lv_roller_set_selected(system_date_roller_month, 0, LV_ANIM_ON);
        }

        system_date_roller_day = lv_roller_create(system_date_middle_bg);
        lv_roller_set_options(system_date_roller_day,
            "01\n"
            "02\n"
            "03\n"
            "04\n"
            "05\n"
            "06\n"
            "07\n"
            "08\n"
            "09\n"
            "10\n"
            "11\n"
            "12\n"
            "13\n"
            "14\n"
            "15\n"
            "16\n"
            "17\n"
            "18\n"
            "19\n"
            "20\n"
            "21\n"
            "22\n"
            "23\n"
            "24\n"
            "25\n"
            "26\n"
            "27\n"
            "28\n"
            "29\n"
            "30\n"
            "31",
            LV_ROLLER_MODE_INFINITE);
        lv_obj_set_style_width(system_date_roller_day, 60, LV_STATE_DEFAULT);
        lv_roller_set_visible_row_count(system_date_roller_day, 5);
        lv_obj_align(system_date_roller_day, LV_ALIGN_TOP_LEFT, 155, 25);
        lv_obj_add_style(system_date_roller_day, &style_sel, LV_PART_SELECTED);

        printf("g_system_time[2]=%d\n\r",g_system_time[2]);

        if((g_system_time[2]>0)&&(g_system_time[2] < 32))
        {
             lv_roller_set_selected(system_date_roller_day, g_system_time[2] - 1, LV_ANIM_ON);
        }
        else
        {
            lv_roller_set_selected(system_date_roller_day, 0, LV_ANIM_ON);
        }

        system_date_roller_hour = lv_roller_create(system_date_middle_bg);
        lv_roller_set_options(system_date_roller_hour,
            "00\n"
            "01\n"
            "02\n"
            "03\n"
            "04\n"
            "05\n"
            "06\n"
            "07\n"
            "08\n"
            "09\n"
            "10\n"
            "11\n"
            "12\n"
            "13\n"
            "14\n"
            "15\n"
            "16\n"
            "17\n"
            "18\n"
            "19\n"
            "20\n"
            "21\n"
            "22\n"
            "23",
            LV_ROLLER_MODE_INFINITE);
        lv_obj_set_style_width(system_date_roller_hour, 60, LV_STATE_DEFAULT);
        lv_roller_set_visible_row_count(system_date_roller_hour, 5);
        lv_obj_align(system_date_roller_hour, LV_ALIGN_TOP_LEFT, 230, 25);
        lv_obj_add_style(system_date_roller_hour, &style_sel, LV_PART_SELECTED);


        printf("g_system_time[3]=%d\n\r",g_system_time[3]);

        if(g_system_time[3] < 24)
        {
             lv_roller_set_selected(system_date_roller_hour, g_system_time[3], LV_ANIM_ON);
        }
        else
        {
            lv_roller_set_selected(system_date_roller_hour, 0, LV_ANIM_ON);
        }


        system_date_roller_minute = lv_roller_create(system_date_middle_bg);
        lv_roller_set_options(system_date_roller_minute,
            "00\n"
            "01\n"
            "02\n"
            "03\n"
            "04\n"
            "05\n"
            "06\n"
            "07\n"
            "08\n"
            "09\n"
            "10\n"
            "11\n"
            "12\n"
            "13\n"
            "14\n"
            "15\n"
            "16\n"
            "17\n"
            "18\n"
            "19\n"
            "20\n"
            "21\n"
            "22\n"
            "23\n"
            "24\n"
            "25\n"
            "26\n"
            "27\n"
            "28\n"
            "29\n"
            "30\n"
            "31\n"
            "32\n"
            "33\n"
            "34\n"
            "35\n"
            "36\n"
            "37\n"
            "38\n"
            "39\n"
            "40\n"
            "41\n"
            "42\n"
            "43\n"
            "44\n"
            "45\n"
            "46\n"
            "47\n"
            "48\n"
            "49\n"
            "50\n"
            "51\n"
            "52\n"
            "53\n"
            "54\n"
            "55\n"
            "56\n"
            "57\n"
            "58\n"
            "59",
            LV_ROLLER_MODE_NORMAL);
        lv_obj_set_style_width(system_date_roller_minute, 60, LV_STATE_DEFAULT);
        lv_roller_set_visible_row_count(system_date_roller_minute, 5);
        lv_obj_align(system_date_roller_minute, LV_ALIGN_TOP_LEFT, 305, 25);
        lv_obj_add_style(system_date_roller_minute, &style_sel, LV_PART_SELECTED);

        printf("g_system_time[4]=%d\n\r",g_system_time[4]);

        if(g_system_time[4] < 60)
        {
             lv_roller_set_selected(system_date_roller_minute, g_system_time[4], LV_ANIM_ON);
        }
        else
        {
            lv_roller_set_selected(system_date_roller_minute, 0, LV_ANIM_ON);
        }


        system_date_roller_second = lv_roller_create(system_date_middle_bg);
        lv_roller_set_options(system_date_roller_second,
            "00\n"
            "01\n"
            "02\n"
            "03\n"
            "04\n"
            "05\n"
            "06\n"
            "07\n"
            "08\n"
            "09\n"
            "10\n"
            "11\n"
            "12\n"
            "13\n"
            "14\n"
            "15\n"
            "16\n"
            "17\n"
            "18\n"
            "19\n"
            "20\n"
            "21\n"
            "22\n"
            "23\n"
            "24\n"
            "25\n"
            "26\n"
            "27\n"
            "28\n"
            "29\n"
            "30\n"
            "31\n"
            "32\n"
            "33\n"
            "34\n"
            "35\n"
            "36\n"
            "37\n"
            "38\n"
            "39\n"
            "40\n"
            "41\n"
            "42\n"
            "43\n"
            "44\n"
            "45\n"
            "46\n"
            "47\n"
            "48\n"
            "49\n"
            "50\n"
            "51\n"
            "52\n"
            "53\n"
            "54\n"
            "55\n"
            "56\n"
            "57\n"
            "58\n"
            "59",
            LV_ROLLER_MODE_NORMAL);
        lv_obj_set_style_width(system_date_roller_second, 60, LV_STATE_DEFAULT);
        lv_roller_set_visible_row_count(system_date_roller_second, 5);
        lv_obj_align(system_date_roller_second, LV_ALIGN_TOP_LEFT, 380, 25);
        lv_obj_add_style(system_date_roller_second, &style_sel, LV_PART_SELECTED);

        printf("g_system_time[5]=%d\n\r",g_system_time[5]);

        if(g_system_time[5] < 60)
        {
             lv_roller_set_selected(system_date_roller_second, g_system_time[5], LV_ANIM_ON);
        }
        else
        {
            lv_roller_set_selected(system_date_roller_second, 0, LV_ANIM_ON);
        }


        system_date_bottom_bg = lv_obj_create(lv_scr_act());
        lv_obj_set_size(system_date_bottom_bg, 480, 24);
        lv_obj_align(system_date_bottom_bg, LV_ALIGN_TOP_LEFT, 0, 248);
        lv_obj_set_style_border_width(system_date_bottom_bg, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_radius(system_date_bottom_bg, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_color(system_date_bottom_bg, lv_color_hex(0x28536a), LV_STATE_DEFAULT);
        lv_obj_remove_style(system_date_bottom_bg, 0, LV_PART_SCROLLBAR);


        LV_FONT_DECLARE(heiFont16_1);
        label_system_date_return = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_system_date_return, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_system_date_return, lv_color_hex(0xffffff), LV_STATE_DEFAULT);

        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_system_date_return,  "返回");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_system_date_return, "Return");
        }
        lv_obj_align(label_system_date_return, LV_ALIGN_TOP_LEFT, 140, 252);

        LV_IMG_DECLARE(get_back);
        btn_system_date_return = lv_imgbtn_create(lv_scr_act());
        lv_imgbtn_set_src(btn_system_date_return, LV_IMGBTN_STATE_RELEASED, NULL, &get_back, NULL);
        lv_obj_set_size(btn_system_date_return, get_back.header.w, get_back.header.h);
        lv_obj_align(btn_system_date_return, LV_ALIGN_TOP_LEFT, 180, 250);
        lv_obj_add_event_cb(btn_system_date_return, btn_system_date_return_event_cb, LV_EVENT_CLICKED, NULL);


        LV_IMG_DECLARE(confirm);
        btn_system_date_confirm = lv_imgbtn_create(lv_scr_act());
        lv_imgbtn_set_src(btn_system_date_confirm, LV_IMGBTN_STATE_RELEASED, NULL, &confirm, NULL);
        lv_obj_set_size(btn_system_date_confirm, get_back.header.w, get_back.header.h);
        lv_obj_align(btn_system_date_confirm, LV_ALIGN_TOP_LEFT, 250, 250);
        lv_obj_add_event_cb(btn_system_date_confirm, btn_system_date_confirm_event_cb, LV_EVENT_CLICKED, NULL);

        LV_FONT_DECLARE(heiFont16_1);
        label_system_date_confirm = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_system_date_confirm, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_system_date_confirm, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_system_date_confirm,  "确定");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_system_date_confirm, "Confirm");
        }
        lv_obj_align(label_system_date_confirm, LV_ALIGN_TOP_LEFT, 277, 252);
    }
}


static void btn_breath_plate_event_cb(lv_event_t* e)
{
    lv_event_code_t code;

    code = lv_event_get_code(e);

    lv_obj_t* obj = lv_event_get_target(e);

    if (code == LV_EVENT_CLICKED)
    {
        typeface_head_bg = lv_obj_create(lv_scr_act());
        lv_obj_set_size(typeface_head_bg, 480, 24);
        lv_obj_align(typeface_head_bg, LV_ALIGN_TOP_LEFT, 0, 0);
        lv_obj_set_style_border_width(typeface_head_bg, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_border_color(typeface_head_bg, lv_color_hex(0x9bcd9b), LV_STATE_DEFAULT); /* 设置边框颜色 */
        lv_obj_set_style_radius(typeface_head_bg, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_color(typeface_head_bg, lv_color_hex(0x1fadd3), LV_STATE_DEFAULT);

        LV_FONT_DECLARE(heiFont16_1);
        label_typeface_head = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_typeface_head, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_typeface_head, lv_color_hex(0xFFFFFF), LV_STATE_DEFAULT);
        lv_obj_align(label_typeface_head, LV_ALIGN_TOP_LEFT, 200, 4);

        if (obj == btn_file_management_word_space_label)
        {
            printf("btn_file_management_word_space_label\n");
            lv_label_set_text(label_typeface_head, "间隔");
        }
        else if (obj == btn_file_management_word_size_label)
        {
            printf("btn_file_management_word_size_label\n");
            lv_label_set_text(label_typeface_head, "字号");
        }

        typeface_slider_bg = lv_obj_create(lv_scr_act());
        lv_obj_set_size(typeface_slider_bg, 480, 224);
        lv_obj_align(typeface_slider_bg, LV_ALIGN_TOP_LEFT, 0, 24);
        lv_obj_set_style_border_width(typeface_slider_bg, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_border_color(typeface_slider_bg, lv_color_hex(0xaaaaaa), LV_STATE_DEFAULT); /* 设置边框颜色 */
        lv_obj_set_style_radius(typeface_slider_bg, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_color(typeface_slider_bg, lv_color_hex(0xaaaaaa), LV_STATE_DEFAULT);

        //数字键盘
        pwd_text_area = lv_textarea_create(lv_scr_act());
        if (pwd_text_area == NULL)
        {
            printf("[%s:%d] create pwd_text_area obj failed\n", __FUNCTION__, __LINE__);
            return;
        }

        // 密码框样式
        static lv_style_t pwd_text_style;
        lv_style_init(&pwd_text_style); // 初始化样式
        lv_style_set_radius(&pwd_text_style, 0); // 设置样式的圆角弧度
        lv_style_set_border_width(&pwd_text_style, 1); // 设置边框宽度
        lv_style_set_pad_all(&pwd_text_style, 0); // 设置样式的内部填充
        lv_style_set_text_font(&pwd_text_style, &lv_font_montserrat_18); //设置字体
        //lv_textarea_set_password_mode(pwd_text_area, true); // 文本区域开启密码模式
        lv_textarea_set_max_length(pwd_text_area, 3); // 设置可输入的文本的最大长度
        lv_obj_add_style(pwd_text_area, &pwd_text_style, 0); // 给btn_label添加样式
        lv_obj_set_size(pwd_text_area, 480, 50); // 设置对象大小
        lv_textarea_set_text(pwd_text_area, ""); // 文本框置空
        lv_obj_align(pwd_text_area, LV_ALIGN_TOP_LEFT, 0, 24);

        // 基于键盘背景对象创建密码校验提示标签
        hint_label = lv_label_create(lv_scr_act());
        if (hint_label == NULL)
        {
            printf("[%s:%d] create hint_label obj failed\n", __FUNCTION__, __LINE__);
            return;
        }

        // 密码提示文本样式
        static lv_style_t hint_label_style;
        lv_style_init(&hint_label_style); // 初始化样式
        lv_style_set_radius(&hint_label_style, 0); // 设置样式的圆角弧度
        lv_style_set_border_width(&hint_label_style, 0); //设置边框宽度
        lv_style_set_text_color(&hint_label_style, lv_palette_main(LV_PALETTE_RED));  // 字体颜色设置为红色
        lv_style_set_text_font(&hint_label_style, &lv_font_montserrat_12); //设置字体
        lv_label_set_long_mode(hint_label, LV_LABEL_LONG_SCROLL_CIRCULAR); // 长文本循环滚动
        lv_obj_add_style(hint_label, &hint_label_style, 0); // 给btn_label添加样式
        lv_obj_align(hint_label, LV_ALIGN_TOP_MID, 0, 110); // 顶部居中显示
        lv_label_set_text(hint_label, ""); // 设置文本内容

        // 基于键盘背景对象创建键盘对象
        pwd_keyboard = lv_keyboard_create(lv_scr_act());
        if (pwd_keyboard == NULL)
        {
            printf("[%s:%d] create pwd_keyboard obj failed\n", __FUNCTION__, __LINE__);
            return;
        }

        //键盘样式
        static lv_style_t pwd_kb_style;
        lv_style_init(&pwd_kb_style); // 初始化样式
        lv_style_set_radius(&pwd_kb_style, 5); // 设置样式的圆角弧度
        lv_style_set_border_width(&pwd_kb_style, 0); //设置边框宽度
        lv_style_set_bg_color(&pwd_kb_style, lv_color_hex(0xF98E2D));
        lv_style_set_text_opa(&pwd_kb_style, LV_OPA_COVER);
        lv_style_set_text_font(&pwd_kb_style, &lv_font_montserrat_20); //设置字体
        lv_obj_set_size(pwd_keyboard, 480, 174); //设置键盘大小
        lv_keyboard_set_mode(pwd_keyboard, LV_KEYBOARD_MODE_NUMBER_2); //设置键盘模式为数字键盘
        lv_keyboard_set_map(pwd_keyboard, LV_KEYBOARD_MODE_NUMBER_2, keyboard_map, keyboard_ctrl); // 设置键盘映射
        lv_keyboard_set_textarea(pwd_keyboard, pwd_text_area); // 键盘对象和文本框绑定
        lv_obj_add_style(pwd_keyboard, &pwd_kb_style, 0); // 添加样式
        lv_obj_align(pwd_keyboard, LV_ALIGN_TOP_LEFT, 0, 74);


        LV_FONT_DECLARE(heiFont16_1);
        label_typeface_return = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_typeface_return, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_typeface_return, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        lv_label_set_text(label_typeface_return, "返回");
        lv_obj_align(label_typeface_return, LV_ALIGN_TOP_LEFT, 140, 252);

        LV_IMG_DECLARE(get_back);
        btn_typeface_return = lv_imgbtn_create(lv_scr_act());
        lv_imgbtn_set_src(btn_typeface_return, LV_IMGBTN_STATE_RELEASED, NULL, &get_back, NULL);
        lv_obj_set_size(btn_typeface_return, get_back.header.w, get_back.header.h);
        lv_obj_align(btn_typeface_return, LV_ALIGN_TOP_LEFT, 180, 250);
        lv_obj_add_event_cb(btn_typeface_return, button_work_space_return_event_cb, LV_EVENT_CLICKED, NULL);


        LV_IMG_DECLARE(confirm);
        btn_typeface_confirm = lv_imgbtn_create(lv_scr_act());
        lv_imgbtn_set_src(btn_typeface_confirm, LV_IMGBTN_STATE_RELEASED, NULL, &confirm, NULL);
        lv_obj_set_size(btn_typeface_confirm, get_back.header.w, get_back.header.h);
        lv_obj_align(btn_typeface_confirm, LV_ALIGN_TOP_LEFT, 250, 250);
        lv_obj_add_event_cb(btn_typeface_confirm, button_word_space_confirm_event_cb, LV_EVENT_CLICKED, NULL);

        LV_FONT_DECLARE(heiFont16_1);
        label_typeface_confirm = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_typeface_confirm, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_typeface_confirm, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        lv_label_set_text(label_typeface_confirm, "确定");
        lv_obj_align(label_typeface_confirm, LV_ALIGN_TOP_LEFT, 277, 252);
    }
}

static void btn_system_time_event_cb(lv_event_t* e)
{
    lv_event_code_t code;

    code = lv_event_get_code(e);
   // int len = 0;
   // int i;
   // int offset_x;
   // int offset_y;
   // int line_num = 5;
   // int size_wide = 85;
   // int size_high = 24;
    lv_obj_t* obj = lv_event_get_target(e);

    if (code == LV_EVENT_CLICKED)
    {
        typeface_head_bg = lv_obj_create(lv_scr_act());
        lv_obj_set_size(typeface_head_bg, 480, 24);
        lv_obj_align(typeface_head_bg, LV_ALIGN_TOP_LEFT, 0, 0);
        lv_obj_set_style_border_width(typeface_head_bg, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_border_color(typeface_head_bg, lv_color_hex(0x9bcd9b), LV_STATE_DEFAULT); /* 设置边框颜色 */
        lv_obj_set_style_radius(typeface_head_bg, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_color(typeface_head_bg, lv_color_hex(0x1fadd3), LV_STATE_DEFAULT);

        LV_FONT_DECLARE(heiFont16_1);
        label_typeface_head = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_typeface_head, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_typeface_head, lv_color_hex(0xFFFFFF), LV_STATE_DEFAULT);
        lv_obj_align(label_typeface_head, LV_ALIGN_TOP_LEFT, 200, 4);

        if (obj == btn_file_management_word_space_label)
        {
            printf("btn_file_management_word_space_label\n");
            lv_label_set_text(label_typeface_head, "间隔");
        }
        else if (obj == btn_file_management_word_size_label)
        {
            printf("btn_file_management_word_size_label\n");
            lv_label_set_text(label_typeface_head, "字号");
        }

        typeface_slider_bg = lv_obj_create(lv_scr_act());
        lv_obj_set_size(typeface_slider_bg, 480, 224);
        lv_obj_align(typeface_slider_bg, LV_ALIGN_TOP_LEFT, 0, 24);
        lv_obj_set_style_border_width(typeface_slider_bg, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_border_color(typeface_slider_bg, lv_color_hex(0xaaaaaa), LV_STATE_DEFAULT); /* 设置边框颜色 */
        lv_obj_set_style_radius(typeface_slider_bg, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_color(typeface_slider_bg, lv_color_hex(0xaaaaaa), LV_STATE_DEFAULT);

        //数字键盘
        pwd_text_area = lv_textarea_create(lv_scr_act());
        if (pwd_text_area == NULL)
        {
            printf("[%s:%d] create pwd_text_area obj failed\n", __FUNCTION__, __LINE__);
            return;
        }

        // 密码框样式
        static lv_style_t pwd_text_style;
        lv_style_init(&pwd_text_style); // 初始化样式
        lv_style_set_radius(&pwd_text_style, 0); // 设置样式的圆角弧度
        lv_style_set_border_width(&pwd_text_style, 1); // 设置边框宽度
        lv_style_set_pad_all(&pwd_text_style, 0); // 设置样式的内部填充
        lv_style_set_text_font(&pwd_text_style, &lv_font_montserrat_18); //设置字体
        //lv_textarea_set_password_mode(pwd_text_area, true); // 文本区域开启密码模式
        lv_textarea_set_max_length(pwd_text_area, 3); // 设置可输入的文本的最大长度
        lv_obj_add_style(pwd_text_area, &pwd_text_style, 0); // 给btn_label添加样式
        lv_obj_set_size(pwd_text_area, 480, 50); // 设置对象大小
        lv_textarea_set_text(pwd_text_area, ""); // 文本框置空
        lv_obj_align(pwd_text_area, LV_ALIGN_TOP_LEFT, 0, 24);

        // 基于键盘背景对象创建密码校验提示标签
        hint_label = lv_label_create(lv_scr_act());
        if (hint_label == NULL)
        {
            printf("[%s:%d] create hint_label obj failed\n", __FUNCTION__, __LINE__);
            return;
        }

        // 密码提示文本样式
        static lv_style_t hint_label_style;
        lv_style_init(&hint_label_style); // 初始化样式
        lv_style_set_radius(&hint_label_style, 0); // 设置样式的圆角弧度
        lv_style_set_border_width(&hint_label_style, 0); //设置边框宽度
        lv_style_set_text_color(&hint_label_style, lv_palette_main(LV_PALETTE_RED));  // 字体颜色设置为红色
        lv_style_set_text_font(&hint_label_style, &lv_font_montserrat_12); //设置字体
        lv_label_set_long_mode(hint_label, LV_LABEL_LONG_SCROLL_CIRCULAR); // 长文本循环滚动
        lv_obj_add_style(hint_label, &hint_label_style, 0); // 给btn_label添加样式
        lv_obj_align(hint_label, LV_ALIGN_TOP_MID, 0, 110); // 顶部居中显示
        lv_label_set_text(hint_label, ""); // 设置文本内容

        // 基于键盘背景对象创建键盘对象
        pwd_keyboard = lv_keyboard_create(lv_scr_act());
        if (pwd_keyboard == NULL)
        {
            printf("[%s:%d] create pwd_keyboard obj failed\n", __FUNCTION__, __LINE__);
            return;
        }

        //键盘样式
        static lv_style_t pwd_kb_style;
        lv_style_init(&pwd_kb_style); // 初始化样式
        lv_style_set_radius(&pwd_kb_style, 5); // 设置样式的圆角弧度
        lv_style_set_border_width(&pwd_kb_style, 0); //设置边框宽度
        lv_style_set_bg_color(&pwd_kb_style, lv_color_hex(0xF98E2D));
        lv_style_set_text_opa(&pwd_kb_style, LV_OPA_COVER);
        lv_style_set_text_font(&pwd_kb_style, &lv_font_montserrat_20); //设置字体
        lv_obj_set_size(pwd_keyboard, 480, 174); //设置键盘大小
        lv_keyboard_set_mode(pwd_keyboard, LV_KEYBOARD_MODE_NUMBER_2); //设置键盘模式为数字键盘
        lv_keyboard_set_map(pwd_keyboard, LV_KEYBOARD_MODE_NUMBER_2, keyboard_map, keyboard_ctrl); // 设置键盘映射
        lv_keyboard_set_textarea(pwd_keyboard, pwd_text_area); // 键盘对象和文本框绑定
        lv_obj_add_style(pwd_keyboard, &pwd_kb_style, 0); // 添加样式
        lv_obj_align(pwd_keyboard, LV_ALIGN_TOP_LEFT, 0, 74);


        LV_FONT_DECLARE(heiFont16_1);
        label_typeface_return = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_typeface_return, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_typeface_return, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        lv_label_set_text(label_typeface_return, "返回");
        lv_obj_align(label_typeface_return, LV_ALIGN_TOP_LEFT, 140, 252);

        LV_IMG_DECLARE(get_back);
        btn_typeface_return = lv_imgbtn_create(lv_scr_act());
        lv_imgbtn_set_src(btn_typeface_return, LV_IMGBTN_STATE_RELEASED, NULL, &get_back, NULL);
        lv_obj_set_size(btn_typeface_return, get_back.header.w, get_back.header.h);
        lv_obj_align(btn_typeface_return, LV_ALIGN_TOP_LEFT, 180, 250);
        lv_obj_add_event_cb(btn_typeface_return, button_work_space_return_event_cb, LV_EVENT_CLICKED, NULL);


        LV_IMG_DECLARE(confirm);
        btn_typeface_confirm = lv_imgbtn_create(lv_scr_act());
        lv_imgbtn_set_src(btn_typeface_confirm, LV_IMGBTN_STATE_RELEASED, NULL, &confirm, NULL);
        lv_obj_set_size(btn_typeface_confirm, get_back.header.w, get_back.header.h);
        lv_obj_align(btn_typeface_confirm, LV_ALIGN_TOP_LEFT, 250, 250);
        lv_obj_add_event_cb(btn_typeface_confirm, button_word_space_confirm_event_cb, LV_EVENT_CLICKED, NULL);

        LV_FONT_DECLARE(heiFont16_1);
        label_typeface_confirm = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_typeface_confirm, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_typeface_confirm, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        lv_label_set_text(label_typeface_confirm, "确定");
        lv_obj_align(label_typeface_confirm, LV_ALIGN_TOP_LEFT, 277, 252);
    }
}
#if 0
void mydelay_s(int n)
{
    int i,j;
    for(j=0;j<n;j++)
    {
        for(i=0;i<1000;i++)
        {
            usleep(1000);
        }
    }
}
#endif


static void btn_calibration_event_cb(lv_event_t* e)
{
    lv_event_code_t code;
    //lv_obj_t* obj = lv_event_get_target(e);

    code = lv_event_get_code(e);
    if (code == LV_EVENT_LONG_PRESSED)
    {
        printf("btn_calibration_event_cb\n");
        buzzer_enable = 1;

        screen_off_obj = lv_obj_create(lv_scr_act());
        lv_obj_align(screen_off_obj, LV_ALIGN_TOP_LEFT, 0, 0);
        lv_obj_set_size(screen_off_obj, 480, 272);
        //lv_obj_set_style_bg_color(screen_off_obj, lv_color_hex(0xff0000), LV_STATE_DEFAULT);
        lv_obj_set_style_bg_color(screen_off_obj, lv_color_hex(0x000000), LV_STATE_DEFAULT);
        lv_obj_set_style_border_width(screen_off_obj, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_border_color(screen_off_obj, lv_color_hex(0xcccccc), LV_STATE_DEFAULT); /* 设置边框颜色 */
        lv_obj_clear_flag(screen_off_obj, LV_OBJ_FLAG_SCROLLABLE);
        lv_obj_set_style_radius(screen_off_obj, 0, LV_STATE_DEFAULT); /* 设置圆角 */ 

        g_screen_touch_flag = 1;     

#if 0
        mydelay_s(5);
    
        printf("screen_off_obj\n");
        lv_obj_del(screen_off_obj);

        status = system("ts_calibrate");
        if (-1 == status)
        {
            printf("ts_calibrate error\n");
        }

        lv_obj_update_layout(set_tv);
#endif
    }
}

static void button_unencrypt_confirm_event_cb(lv_event_t* e)
{
    char tempBuf[128]={0};
    lv_event_code_t code;
    int i;

    code = lv_event_get_code(e);
    if (code == LV_EVENT_CLICKED)
    {
        printf("button_set_developer_confirm_event_cb\r\n");
        buzzer_enable = 1;
        //解密
        sprintf(tempBuf,"%s",lv_label_get_text(label_btn_yield_reset));

        printf("tempBuf=%s\n\r",tempBuf);

        for(i=0;i<16;i++)
        {
            msg[i]  = stringToHex(tempBuf[i*2])*16 + stringToHex(tempBuf[i*2+1]);
            printf("%x ",msg[i]);
        }
        printf("\n\r");

        //memset(msg, 0, MSG_SIZE);
        memset(&context, 0, sizeof(context));
        AES_set_key(&context, key, iv, AES_MODE_128);

        AES_convert_key(&context);
        AES_cbc_decrypt(&context, msg, out, MSG_SIZE);

        for(i = 0 ; i<MSG_SIZE ; i++)
        {
            printf("%02x ", out[i]);
        }
        printf("\r\n");

        unsigned char crc =  CRC8(out,16);

        if(crc == out[15])
        {
            AUTHORIZATION_INFORMATION authorization;

            memcpy((unsigned char *)&authorization, out, 16);

            time_t total_seconds_1 = datetime_to_seconds(authorization.rtc_time.year+2000, authorization.rtc_time.month, authorization.rtc_time.day, authorization.rtc_time.hour, authorization.rtc_time.minute,authorization.rtc_time.second);
            time_t total_seconds_2 = datetime_to_seconds(g_system_time[0]+2000, g_system_time[1], g_system_time[2], g_system_time[3], g_system_time[4],g_system_time[5]);
            int errot_time = total_seconds_1 - total_seconds_2;
            if((errot_time > 86400)||(errot_time < -86400))
            {

            }
            else
            {
                if(authorization.device_id == g_sd_serial)
                {

                    FILE* file = fopen("/media/system_file/config.dat", "wb");
                    if (file == NULL) 
                    {
                        perror("Failed to open file");
                        //return EXIT_FAILURE;
                    }

                    // 将结构体写入文件
                    size_t written = fwrite(msg, 16, 1, file);
                    if (written != 1) {
                        perror("Failed to write data to file");
                        fclose(file);
                        //return EXIT_FAILURE;
                    }
                    // 关闭文件
                    fclose(file);


                    lv_label_set_text(label_prompt_message, "激活成功!");

                    usleep(2000000);

                    //删除取消加密界面
                    lv_obj_del(set_developer_bg);
                    lv_obj_del(label_set_developer_head);
                    lv_obj_del(set_developer_middle_bg);
                    lv_obj_del(label_Rf_frequency_text);
                    lv_obj_del(label_Rf_frequency_label);
                    lv_obj_del(label_yield_reset);
                    lv_obj_del(label_btn_yield_reset);
                    lv_obj_del(btn_yield_reset);
                    lv_obj_del(label_prompt_message);
                    lv_obj_del(addition_date_bottom_bg);
                    lv_obj_del(label_addition_date_time_return);
                    lv_obj_del(imgbtn_addition_date_time_return);
                    lv_obj_del(imgbtn_addition_date_time_confirm);
                    lv_obj_del(label_addition_date_time_confirm);
                }
            }
        }
    }
}



static void button_unencrypt_return_event_cb(lv_event_t* e)
{
    lv_event_code_t code;
    code = lv_event_get_code(e);
    if (code == LV_EVENT_CLICKED)
    {
        printf("button_unencrypt_return_event_cb\r\n");
        buzzer_enable = 1;
        //解密

        //比对序列号

        //如果相同设置全局变量

        //如果不同提示错误信息


        //删除取消加密界面
        lv_obj_del(set_developer_bg);
        lv_obj_del(label_set_developer_head);
        lv_obj_del(set_developer_middle_bg);
        lv_obj_del(label_Rf_frequency_text);
        lv_obj_del(label_Rf_frequency_label);
        lv_obj_del(label_yield_reset);
        lv_obj_del(label_btn_yield_reset);
        lv_obj_del(btn_yield_reset);
        lv_obj_del(label_prompt_message);
        lv_obj_del(addition_date_bottom_bg);
        lv_obj_del(label_addition_date_time_return);
        lv_obj_del(imgbtn_addition_date_time_return);
        lv_obj_del(imgbtn_addition_date_time_confirm);
        lv_obj_del(label_addition_date_time_confirm);
    }
}

static void button_unencrypt_keyboard_confirm_event_cb(lv_event_t* e)
{
    lv_event_code_t code;
    //int i;
    code = lv_event_get_code(e);
    if (code == LV_EVENT_CLICKED)
    {
        printf("button_date_keyboard_confirm_event_cb\n");
        buzzer_enable = 1;
        //获取输入框数据给到文本显示框
        lv_label_set_text(label_btn_yield_reset, lv_textarea_get_text(textarea_text_keyboard));

        printf("label_btn_yield_reset=%s\n\r",lv_label_get_text(label_btn_yield_reset));

        lv_obj_del(textarea_bg_keyboard);
        lv_obj_del(pinyin_ime);
        lv_obj_del(textarea_text_keyboard);
        lv_obj_del(keyboard_bg);
        lv_obj_del(label_keyboard_confirm);
        lv_obj_del(btn_keyboard_confirm);
        lv_obj_del(label_keyboard_return);
        lv_obj_del(btn_keyboard_return);
    }
}


static void button_unencrypt_keyboard_return_event_cb(lv_event_t* e)
{
    lv_event_code_t code;

    code = lv_event_get_code(e);
    if (code == LV_EVENT_CLICKED)
    {
        printf("button_unencrypt_keyboard_return_event_cb\n");
        buzzer_enable = 1;

        lv_obj_del(textarea_bg_keyboard);
        lv_obj_del(pinyin_ime);
        lv_obj_del(textarea_text_keyboard);
        lv_obj_del(keyboard_bg);
        lv_obj_del(label_keyboard_confirm);
        lv_obj_del(btn_keyboard_confirm);
        lv_obj_del(label_keyboard_return);
        lv_obj_del(btn_keyboard_return);
    }
}



static void btn_unencrypt_event_cb(lv_event_t* e)
{
    buzzer_enable = 1;

    textarea_bg_keyboard = lv_obj_create(lv_scr_act());
    /* 设置大小 */

    lv_obj_set_size(textarea_bg_keyboard, 480, 272);
    lv_obj_align(textarea_bg_keyboard, LV_ALIGN_TOP_LEFT, 0, 0);
    lv_obj_set_style_border_width(textarea_bg_keyboard, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
    lv_obj_set_style_border_color(textarea_bg_keyboard, lv_color_hex(0x9bcd9b), LV_STATE_DEFAULT); /* 设置边框颜色 */
    //lv_obj_set_style_border_opa(file_management_win, 100, LV_STATE_DEFAULT); /* 设置边框透明度 */
    lv_obj_set_style_radius(textarea_bg_keyboard, 0, LV_STATE_DEFAULT); /* 设置圆角 */
    lv_obj_set_style_bg_color(textarea_bg_keyboard, lv_color_hex(0x1fadd3), LV_STATE_DEFAULT);

    //输入框+键盘
    LV_FONT_DECLARE(heiFont16_1);
    pinyin_ime = lv_ime_pinyin_create(lv_scr_act());
    lv_obj_set_style_text_font(pinyin_ime, &heiFont16_1, 0);
    //lv_obj_set_style_text_font(pinyin_ime, &lv_font_simsun_16_cjk, 0);
    //lv_ime_pinyin_set_dict(pinyin_ime, your_dict); // Use a custom dictionary. If it is not set, the built-in dictionary will be used.

    textarea_text_keyboard = lv_textarea_create(lv_scr_act());
    //lv_textarea_set_one_line(textarea_text_keyboard, true);
    lv_obj_set_size(textarea_text_keyboard, 480, 95);
    lv_obj_set_style_text_font(textarea_text_keyboard, &heiFont16_1, 0);
    lv_obj_align(textarea_text_keyboard, LV_ALIGN_TOP_LEFT, 0, 0);
    lv_textarea_set_max_length(textarea_text_keyboard, 100);
    lv_textarea_set_placeholder_text(textarea_text_keyboard, "");
    //lv_obj_add_event_cb(textarea_text_keyboard, textarea_text_event_cb, LV_EVENT_ALL, NULL);
    lv_obj_set_style_border_width(textarea_text_keyboard, 1, LV_STATE_DEFAULT); /* 设置边框宽度 */
    lv_obj_set_style_border_color(textarea_text_keyboard, lv_color_hex(0xAAAAAA), LV_STATE_DEFAULT); /* 设置边框颜色 */
    lv_obj_set_style_border_opa(textarea_text_keyboard, 100, LV_STATE_DEFAULT); /* 设置边框透明度 */
    lv_obj_set_style_radius(textarea_text_keyboard, 0, LV_STATE_DEFAULT); /* 设置圆角 */


    /*Create a keyboard and add it to ime_pinyin*/
    text_edit_keyboard = lv_keyboard_create(lv_scr_act());
    lv_ime_pinyin_set_keyboard(pinyin_ime, text_edit_keyboard);
    lv_keyboard_set_textarea(text_edit_keyboard, textarea_text_keyboard);
    //lv_obj_set_style_bg_color(text_edit_keyboard, lv_color_hex(0xff4040), LV_PART_MAIN);
    lv_obj_set_style_bg_color(text_edit_keyboard, lv_color_hex(0x1fadd3), LV_PART_MAIN);
    lv_obj_add_event_cb(textarea_text_keyboard, textarea_text_event_cb, LV_EVENT_ALL, text_edit_keyboard);
    lv_obj_align(text_edit_keyboard, LV_ALIGN_TOP_LEFT, 0, 115);
    lv_obj_set_size(text_edit_keyboard, 480, 133);

    /*Get the cand_panel, and adjust its size and position*/
    keyboard_cand_panel = lv_ime_pinyin_get_cand_panel(pinyin_ime);
    lv_obj_set_size(keyboard_cand_panel, LV_PCT(100), LV_PCT(10));
    lv_obj_align_to(keyboard_cand_panel, text_edit_keyboard, LV_ALIGN_OUT_TOP_MID, 0, 5);
    lv_obj_set_style_bg_color(keyboard_cand_panel, lv_color_hex(0x8B1A1A), LV_PART_MAIN);
    lv_obj_set_style_text_font(keyboard_cand_panel, &heiFont16_1, 0);

    keyboard_bg = lv_obj_create(lv_scr_act());
    lv_obj_set_size(keyboard_bg, 480, 24);
    lv_obj_align(keyboard_bg, LV_ALIGN_TOP_LEFT, 0, 248);
    lv_obj_set_style_border_width(keyboard_bg, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
    lv_obj_set_style_radius(keyboard_bg, 0, LV_STATE_DEFAULT); /* 设置圆角 */
    lv_obj_set_style_bg_color(keyboard_bg, lv_color_hex(0x28536a), LV_STATE_DEFAULT);
    lv_obj_remove_style(keyboard_bg, 0, LV_PART_SCROLLBAR);


    LV_FONT_DECLARE(heiFont16_1);
    label_keyboard_return = lv_label_create(lv_scr_act());
    lv_obj_set_style_text_font(label_keyboard_return, &heiFont16_1, LV_STATE_DEFAULT);
    lv_obj_set_style_text_color(label_keyboard_return, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
    if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
    {
        lv_label_set_text(label_keyboard_return,  "返回");
    }
    else if(system_data.system.language == LANGUAGE_ENGLISH)
    {
        lv_label_set_text(label_keyboard_return, "Return");
    }
    lv_obj_align(label_keyboard_return, LV_ALIGN_TOP_LEFT, 140, 252);

    LV_IMG_DECLARE(get_back);
    btn_keyboard_return = lv_imgbtn_create(lv_scr_act());
    lv_imgbtn_set_src(btn_keyboard_return, LV_IMGBTN_STATE_RELEASED, NULL, &get_back, NULL);
    lv_obj_set_size(btn_keyboard_return, get_back.header.w, get_back.header.h);
    lv_obj_align(btn_keyboard_return, LV_ALIGN_TOP_LEFT, 180, 250);
    lv_obj_add_event_cb(btn_keyboard_return, button_unencrypt_keyboard_return_event_cb, LV_EVENT_CLICKED, NULL);

    LV_IMG_DECLARE(confirm);
    btn_keyboard_confirm = lv_imgbtn_create(lv_scr_act());
    lv_imgbtn_set_src(btn_keyboard_confirm, LV_IMGBTN_STATE_RELEASED, NULL, &confirm, NULL);
    lv_obj_set_size(btn_keyboard_confirm, get_back.header.w, get_back.header.h);
    lv_obj_align(btn_keyboard_confirm, LV_ALIGN_TOP_LEFT, 250, 250);
    lv_obj_add_event_cb(btn_keyboard_confirm, button_unencrypt_keyboard_confirm_event_cb, LV_EVENT_CLICKED, NULL);

    LV_FONT_DECLARE(heiFont16_1);
    label_keyboard_confirm = lv_label_create(lv_scr_act());
    lv_obj_set_style_text_font(label_keyboard_confirm, &heiFont16_1, LV_STATE_DEFAULT);
    lv_obj_set_style_text_color(label_keyboard_confirm, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
    if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
    {
        lv_label_set_text(label_keyboard_confirm,  "确定");
    }
    else if(system_data.system.language == LANGUAGE_ENGLISH)
    {
        lv_label_set_text(label_keyboard_confirm, "Confirm");
    }
    lv_obj_align(label_keyboard_confirm, LV_ALIGN_TOP_LEFT, 277, 252);
}



static void btn_check_updates_event_cb(lv_event_t* e)
{
    lv_event_code_t code;
    char tempbuf[64]={0};
    //int i;
    //lv_obj_t* obj = lv_event_get_target(e);
    code = lv_event_get_code(e);
    if (code == LV_EVENT_LONG_PRESSED)
    {
        printf("btn_check_updates_event_cb LV_EVENT_LONG_PRESSED\n");
        buzzer_enable = 1;
        set_developer_bg = lv_obj_create(lv_scr_act());
        lv_obj_set_size(set_developer_bg, 480, 24);
        lv_obj_align(set_developer_bg, LV_ALIGN_TOP_LEFT, 0, 0);
        lv_obj_set_style_border_width(set_developer_bg, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_radius(set_developer_bg, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_color(set_developer_bg, lv_color_hex(0x28536a), LV_STATE_DEFAULT);
        lv_obj_remove_style(set_developer_bg, 0, LV_PART_SCROLLBAR);


        LV_FONT_DECLARE(heiFont16_1);
        label_set_developer_head = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_set_developer_head, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_set_developer_head, lv_color_hex(0xFFFFFF), LV_STATE_DEFAULT);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_set_developer_head, "权限升级");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_set_developer_head, "Permission upgrade");
        }
        lv_obj_align(label_set_developer_head, LV_ALIGN_TOP_LEFT, 200, 4);


        set_developer_middle_bg = lv_obj_create(lv_scr_act());
        lv_obj_set_size(set_developer_middle_bg, 480, 224);
        lv_obj_align(set_developer_middle_bg, LV_ALIGN_TOP_LEFT, 0, 24);
        lv_obj_set_style_border_width(set_developer_middle_bg, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_radius(set_developer_middle_bg, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_color(set_developer_middle_bg, lv_color_hex(0xffffff), LV_STATE_DEFAULT);


        LV_FONT_DECLARE(heiFont16_1);
        label_Rf_frequency_text = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_Rf_frequency_text, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_Rf_frequency_text, lv_color_hex(0x000000), LV_STATE_DEFAULT);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_Rf_frequency_text, "机器码:");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_Rf_frequency_text, "Machine code:");
        }
        lv_obj_align(label_Rf_frequency_text, LV_ALIGN_TOP_LEFT, 45, 60);


        LV_FONT_DECLARE(heiFont16_1);
        label_Rf_frequency_label = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_Rf_frequency_label, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_Rf_frequency_label, lv_color_hex(0x000000), LV_STATE_DEFAULT);
        lv_obj_align(label_Rf_frequency_label, LV_ALIGN_TOP_LEFT, 130, 60);

        //根据芯片序列号和时间生成
        DEVICE_INFORMATION device_info;

        memset((char *)&device_info,0,sizeof(DEVICE_INFORMATION));

        device_info.device_id = g_sd_serial;
        device_info.rtc_time.year = g_system_time[0];
        device_info.rtc_time.month = g_system_time[1];
        device_info.rtc_time.day = g_system_time[2];
        device_info.rtc_time.hour = g_system_time[3];
        device_info.rtc_time.minute =  g_system_time[4];
        device_info.rtc_time.second = g_system_time[5];
        device_info.crc = CRC8((unsigned char *)&device_info,16);

        memset(msg, 0, MSG_SIZE);
        memset(&context, 0, sizeof(context));
        AES_set_key(&context, key, iv, AES_MODE_128);

        memcpy(msg, (unsigned char *)&device_info, MSG_SIZE);

        AES_set_key(&context, key, iv, AES_MODE_128);
        AES_cbc_encrypt(&context, msg, out, MSG_SIZE);

        sprintf(tempbuf,"%02X%02X%02X%02X%02X%02X%02X%02X%02X%02X%02X%02X%02X%02X%02X%02X",out[0],out[1],out[2],out[3],out[4],out[5],out[6],out[7],out[8],out[9],out[10],out[11],out[12],out[13],out[14],out[15]);

        lv_label_set_text(label_Rf_frequency_label, tempbuf);

        LV_FONT_DECLARE(heiFont16_1);
        label_yield_reset = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_yield_reset, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_yield_reset, lv_color_hex(0x000000), LV_STATE_DEFAULT);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_yield_reset, "授权码:");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_yield_reset, "Authorization code:");
        }
        lv_obj_align(label_yield_reset, LV_ALIGN_TOP_LEFT, 45, 120);

        LV_FONT_DECLARE(heiFont14);
        btn_yield_reset = lv_btn_create(lv_scr_act());
        lv_obj_set_size(btn_yield_reset, 250, 35);
        lv_obj_align(btn_yield_reset, LV_ALIGN_TOP_LEFT, 130, 110);
        lv_obj_set_style_border_width(btn_yield_reset, 1, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_border_color(btn_yield_reset, lv_color_hex(0x000000), LV_STATE_DEFAULT);
        lv_obj_set_style_radius(btn_yield_reset, 10, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_color(btn_yield_reset, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        label_btn_yield_reset = lv_label_create(btn_yield_reset);
        lv_obj_set_style_text_font(label_btn_yield_reset, &heiFont14, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_btn_yield_reset, lv_color_hex(0x000000), LV_STATE_DEFAULT);
        lv_label_set_text(label_btn_yield_reset, "");
        lv_obj_align(label_btn_yield_reset, LV_ALIGN_CENTER, 0, 0);
        lv_obj_set_style_border_width(label_btn_yield_reset, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_border_color(label_btn_yield_reset, lv_color_hex(0x000000), LV_STATE_DEFAULT); /* 设置边框颜色 */
        lv_obj_set_style_border_opa(label_btn_yield_reset, 100, LV_STATE_DEFAULT); /* 设置边框透明度 */
        lv_obj_set_style_radius(label_btn_yield_reset, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_opa(label_btn_yield_reset, LV_OPA_COVER, LV_PART_MAIN);
        lv_obj_set_style_bg_color(label_btn_yield_reset, lv_color_hex(0xffffff), LV_PART_MAIN);
        lv_obj_add_event_cb(btn_yield_reset, btn_unencrypt_event_cb, LV_EVENT_CLICKED, NULL);


        LV_FONT_DECLARE(heiFont16_1);
        label_prompt_message = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_prompt_message, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_prompt_message, lv_color_hex(0x000000), LV_STATE_DEFAULT);
        lv_label_set_text(label_prompt_message, "");
        lv_obj_align(label_prompt_message, LV_ALIGN_TOP_LEFT, 200, 180);


        addition_date_bottom_bg = lv_obj_create(lv_scr_act());
        lv_obj_set_size(addition_date_bottom_bg, 480, 24);
        lv_obj_align(addition_date_bottom_bg, LV_ALIGN_TOP_LEFT, 0, 248);
        lv_obj_set_style_border_width(addition_date_bottom_bg, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_radius(addition_date_bottom_bg, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_color(addition_date_bottom_bg, lv_color_hex(0x28536a), LV_STATE_DEFAULT);
        lv_obj_remove_style(addition_date_bottom_bg, 0, LV_PART_SCROLLBAR);


        LV_FONT_DECLARE(heiFont16_1);
        label_addition_date_time_return = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_addition_date_time_return, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_addition_date_time_return, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_addition_date_time_return,  "返回");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_addition_date_time_return, "Return");
        }
        lv_obj_align(label_addition_date_time_return, LV_ALIGN_TOP_LEFT, 140, 252);


        LV_IMG_DECLARE(get_back);
        imgbtn_addition_date_time_return = lv_imgbtn_create(lv_scr_act());
        lv_imgbtn_set_src(imgbtn_addition_date_time_return, LV_IMGBTN_STATE_RELEASED, NULL, &get_back, NULL);
        lv_obj_set_size(imgbtn_addition_date_time_return, get_back.header.w, get_back.header.h);
        lv_obj_align(imgbtn_addition_date_time_return, LV_ALIGN_TOP_LEFT, 180, 250);
        lv_obj_add_event_cb(imgbtn_addition_date_time_return, button_unencrypt_return_event_cb, LV_EVENT_CLICKED, NULL);

        LV_IMG_DECLARE(confirm);
        imgbtn_addition_date_time_confirm = lv_imgbtn_create(lv_scr_act());
        lv_imgbtn_set_src(imgbtn_addition_date_time_confirm, LV_IMGBTN_STATE_RELEASED, NULL, &confirm, NULL);
        lv_obj_set_size(imgbtn_addition_date_time_confirm, get_back.header.w, get_back.header.h);
        lv_obj_align(imgbtn_addition_date_time_confirm, LV_ALIGN_TOP_LEFT, 250, 250);
        lv_obj_add_event_cb(imgbtn_addition_date_time_confirm, button_unencrypt_confirm_event_cb, LV_EVENT_CLICKED, NULL);

        LV_FONT_DECLARE(heiFont16_1);
        label_addition_date_time_confirm = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_addition_date_time_confirm, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_addition_date_time_confirm, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_addition_date_time_confirm,  "确定");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_addition_date_time_confirm, "Confirm");
        }
        lv_obj_align(label_addition_date_time_confirm, LV_ALIGN_TOP_LEFT, 277, 252);
    }
}





static void button_reset_confirm_event_handler(lv_event_t* e)
{
    lv_event_code_t code;
    code = lv_event_get_code(e);
    if (code == LV_EVENT_CLICKED)
    {
        printf("button_reset_confirm_event_handler\n");

        buzzer_enable = 1;
        system_data.init = 0;
        set_system_data();
        get_system_data();

        if (remove("/media/system_file/data_structure.dat") == 0) 
        {
            printf("文件 /media/system_file/data_structure.dat 删除成功\n\r");
        } 
        else
        {
            perror("删除文件 /media/system_file/data_structure.dat 失败");
        }

        lv_obj_del(Ink_cartridge_error_content);
        lv_obj_del(Ink_cartridge_error_win);
        print_status = 0;
    }
}


static void button_reset_return_event_handler(lv_event_t* e)
{
    lv_event_code_t code;
    code = lv_event_get_code(e);
    if (code == LV_EVENT_CLICKED)
    {
        printf("button_reset_return_event_handler\n");

        buzzer_enable = 1;
        lv_obj_del(Ink_cartridge_error_content);
        lv_obj_del(Ink_cartridge_error_win);
        print_status = 0;
    }
}



static void btn_factory_reset_event_cb(lv_event_t* e)
{
    lv_event_code_t code;
    //int i;
    //lv_obj_t* obj = lv_event_get_target(e);
    code = lv_event_get_code(e);
    if (code == LV_EVENT_CLICKED)
    {
        printf("btn_factory_reset_event_cb\n");
#if 0
        buzzer_enable = 1;
        system_data.init = 0;
        set_system_data();
        get_system_data();
#endif

        print_status = 1;
        buzzer_enable = 1;

        Ink_cartridge_error_win = lv_obj_create(lv_scr_act());
        lv_obj_align(Ink_cartridge_error_win, LV_ALIGN_TOP_LEFT, 90, 80);
        lv_obj_set_size(Ink_cartridge_error_win, 300, 40);
        lv_obj_set_style_bg_color(Ink_cartridge_error_win, lv_color_hex(0x1e90ff), LV_STATE_DEFAULT);
        lv_obj_set_style_bg_opa(Ink_cartridge_error_win, LV_OPA_COVER, LV_STATE_DEFAULT);
        lv_obj_set_style_border_width(Ink_cartridge_error_win, 1, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_border_color(Ink_cartridge_error_win, lv_color_hex(0xcccccc), LV_STATE_DEFAULT); /* 设置边框颜色 */
        lv_obj_clear_flag(Ink_cartridge_error_win, LV_OBJ_FLAG_SCROLLABLE);
        lv_obj_set_style_radius(Ink_cartridge_error_win, 0, LV_STATE_DEFAULT); /* 设置圆角 */

        LV_FONT_DECLARE(heiFont16_1);
        label_warning = lv_label_create(Ink_cartridge_error_win);
        lv_obj_set_style_text_font(label_warning, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_warning, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        lv_label_set_text(label_warning, "是否恢复出厂设置");
        lv_obj_align(label_warning, LV_ALIGN_TOP_LEFT, 75, 0);


        Ink_cartridge_error_content = lv_obj_create(lv_scr_act());
        lv_obj_align(Ink_cartridge_error_content, LV_ALIGN_TOP_LEFT, 90, 120);
        lv_obj_set_size(Ink_cartridge_error_content, 300, 80);
        lv_obj_set_style_bg_color(Ink_cartridge_error_content, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        lv_obj_set_style_bg_opa(Ink_cartridge_error_content, LV_OPA_COVER, LV_STATE_DEFAULT);
        lv_obj_set_style_border_width(Ink_cartridge_error_content, 1, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_border_color(Ink_cartridge_error_content, lv_color_hex(0xcccccc), LV_STATE_DEFAULT); /* 设置边框颜色 */
        lv_obj_clear_flag(Ink_cartridge_error_content, LV_OBJ_FLAG_SCROLLABLE);
        lv_obj_set_style_radius(Ink_cartridge_error_content, 0, LV_STATE_DEFAULT); /* 设置圆角 */


        LV_FONT_DECLARE(heiFont16_1);
        label_warning_content = lv_label_create(Ink_cartridge_error_content);
        lv_obj_set_style_text_font(label_warning_content, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_warning_content, lv_color_hex(0x000000), LV_STATE_DEFAULT);
        lv_label_set_text(label_warning_content, "恢复出厂设置将删除所有数据跟设置!");
        lv_obj_align(label_warning_content, LV_ALIGN_TOP_LEFT, 5, -5);



        button_return = lv_btn_create(Ink_cartridge_error_content);
        lv_obj_add_event_cb(button_return, button_reset_return_event_handler, LV_EVENT_ALL, NULL);
        lv_obj_align(button_return, LV_ALIGN_TOP_LEFT, 45, 20);
        button_return_label = lv_label_create(button_return);
        lv_obj_set_style_text_font(button_return_label, &heiFont16_1, LV_STATE_DEFAULT);
        lv_label_set_text(button_return_label, "取消");
        lv_obj_center(button_return_label);


        button_ack = lv_btn_create(Ink_cartridge_error_content);
        lv_obj_add_event_cb(button_ack, button_ack_event_handler, LV_EVENT_ALL, NULL);
        lv_obj_align(button_ack, LV_ALIGN_TOP_LEFT, 165, 20);

        button_ack_label = lv_label_create(button_ack);
        lv_obj_set_style_text_font(button_ack_label, &heiFont16_1, LV_STATE_DEFAULT);
        lv_label_set_text(button_ack_label, "确定");
        lv_obj_center(button_ack_label);

    }
}




static void dropdown_print_pulse_width_event_handler(lv_event_t* e)
{
    lv_event_code_t code = lv_event_get_code(e);
    lv_obj_t* obj = lv_event_get_target(e);
    if (code == LV_EVENT_VALUE_CHANGED)
    {
        char buf[32];
        lv_dropdown_get_selected_str(obj, buf, sizeof(buf));
        printf("Option: %s", buf);
    }
}


static void button_yield_reset_keyboard_confirm_event_cb(lv_event_t* e)
{
    lv_event_code_t code;
    int i=0;
    char temp_str[12] = { 0 };
    code = lv_event_get_code(e);
    if (code == LV_EVENT_CLICKED)
    {
        printf("button_yield_reset_keyboard_confirm_event_cb\n");
        buzzer_enable = 1;
        const char* pwd_txt = lv_textarea_get_text(yield_text_area);
        if ((pwd_txt != NULL))
        {
            i = atoi(pwd_txt);
            if (i > 999999999)
            {
                i = 999999999;
            }
        }

        sprintf(temp_str, "%d", i);
        printf("temp_str=%s  i=%u\n\r",temp_str,i);
        lv_label_set_text(label_btn_yield_reset, temp_str);

        system_data.total_output = i;

        total_output_changeFlag = 1;

        set_system_data();

        lv_obj_del(typeface_head_bg);
        lv_obj_del(label_typeface_head);
        lv_obj_del(typeface_slider_bg);
        lv_obj_del(yield_text_area);
        lv_obj_del(pwd_keyboard);

        lv_obj_del(label_typeface_return);
        lv_obj_del(btn_typeface_return);
        lv_obj_del(btn_typeface_confirm);
        lv_obj_del(label_typeface_confirm);
    }
}



static void button_yield_reset_keyboard_return_event_cb(lv_event_t* e)
{
    lv_event_code_t code;

    code = lv_event_get_code(e);
    if (code == LV_EVENT_CLICKED)
    {
        printf("button_yield_reset_keyboard_return_event_cb\n");
        buzzer_enable = 1;

        lv_obj_del(typeface_head_bg);
        lv_obj_del(label_typeface_head);
        lv_obj_del(typeface_slider_bg);
        lv_obj_del(yield_text_area);
        lv_obj_del(pwd_keyboard);

        lv_obj_del(label_typeface_return);
        lv_obj_del(btn_typeface_return);
        lv_obj_del(btn_typeface_confirm);
        lv_obj_del(label_typeface_confirm);
    }
}




static void btn_yield_reset_event_cb(lv_event_t* e)
{
    lv_event_code_t code;

    code = lv_event_get_code(e);
    //int len = 0;
    //int line_num = 5;
    //int size_wide = 85;
    //int size_high = 24;
    //lv_obj_t* obj = lv_event_get_target(e);

    if (code == LV_EVENT_CLICKED)
    {
        buzzer_enable = 1;
        typeface_head_bg = lv_obj_create(lv_scr_act());
        lv_obj_set_size(typeface_head_bg, 480, 24);
        lv_obj_align(typeface_head_bg, LV_ALIGN_TOP_LEFT, 0, 0);
        lv_obj_set_style_border_width(typeface_head_bg, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_border_color(typeface_head_bg, lv_color_hex(0x9bcd9b), LV_STATE_DEFAULT); /* 设置边框颜色 */
        lv_obj_set_style_radius(typeface_head_bg, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_color(typeface_head_bg, lv_color_hex(0x1fadd3), LV_STATE_DEFAULT);

        LV_FONT_DECLARE(heiFont16_1);
        label_typeface_head = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_typeface_head, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_typeface_head, lv_color_hex(0xFFFFFF), LV_STATE_DEFAULT);
        lv_obj_align(label_typeface_head, LV_ALIGN_TOP_LEFT, 200, 4);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_typeface_head,  "产量重置");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_typeface_head, "Output reset");
        }
        typeface_slider_bg = lv_obj_create(lv_scr_act());
        lv_obj_set_size(typeface_slider_bg, 480, 224);
        lv_obj_align(typeface_slider_bg, LV_ALIGN_TOP_LEFT, 0, 24);
        lv_obj_set_style_border_width(typeface_slider_bg, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_border_color(typeface_slider_bg, lv_color_hex(0xaaaaaa), LV_STATE_DEFAULT); /* 设置边框颜色 */
        lv_obj_set_style_radius(typeface_slider_bg, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_color(typeface_slider_bg, lv_color_hex(0xaaaaaa), LV_STATE_DEFAULT);

        //数字键盘
        yield_text_area = lv_textarea_create(lv_scr_act());
        if (yield_text_area == NULL)
        {
            printf("[%s:%d] create yield_text_area obj failed\n", __FUNCTION__, __LINE__);
            return;
        }

        // 密码框样式
        static lv_style_t pwd_text_style;
        lv_style_init(&pwd_text_style); // 初始化样式
        lv_style_set_radius(&pwd_text_style, 0); // 设置样式的圆角弧度
        lv_style_set_border_width(&pwd_text_style, 1); // 设置边框宽度
        lv_style_set_pad_all(&pwd_text_style, 0); // 设置样式的内部填充
        lv_style_set_text_font(&pwd_text_style, &lv_font_montserrat_18); //设置字体
        //lv_textarea_set_password_mode(pwd_text_area, true); // 文本区域开启密码模式
        lv_textarea_set_max_length(yield_text_area, 3); // 设置可输入的文本的最大长度
        lv_obj_add_style(yield_text_area, &pwd_text_style, 0); // 给btn_label添加样式
        lv_obj_set_size(yield_text_area, 480, 50); // 设置对象大小
        lv_textarea_set_text(yield_text_area, ""); // 文本框置空
        lv_obj_align(yield_text_area, LV_ALIGN_TOP_LEFT, 0, 24);

        // 基于键盘背景对象创建密码校验提示标签
        hint_label = lv_label_create(lv_scr_act());
        if (hint_label == NULL)
        {
            printf("[%s:%d] create hint_label obj failed\n", __FUNCTION__, __LINE__);
            return;
        }

        // 密码提示文本样式
        static lv_style_t hint_label_style;
        lv_style_init(&hint_label_style); // 初始化样式
        lv_style_set_radius(&hint_label_style, 0); // 设置样式的圆角弧度
        lv_style_set_border_width(&hint_label_style, 0); //设置边框宽度
        lv_style_set_text_color(&hint_label_style, lv_palette_main(LV_PALETTE_RED));  // 字体颜色设置为红色
        lv_style_set_text_font(&hint_label_style, &lv_font_montserrat_12); //设置字体
        lv_label_set_long_mode(hint_label, LV_LABEL_LONG_SCROLL_CIRCULAR); // 长文本循环滚动
        lv_obj_add_style(hint_label, &hint_label_style, 0); // 给btn_label添加样式
        lv_obj_align(hint_label, LV_ALIGN_TOP_MID, 0, 110); // 顶部居中显示
        lv_label_set_text(hint_label, ""); // 设置文本内容

        // 基于键盘背景对象创建键盘对象
        pwd_keyboard = lv_keyboard_create(lv_scr_act());
        if (pwd_keyboard == NULL)
        {
            printf("[%s:%d] create pwd_keyboard obj failed\n", __FUNCTION__, __LINE__);
            return;
        }

        //键盘样式
        static lv_style_t pwd_kb_style;
        lv_style_init(&pwd_kb_style); // 初始化样式
        lv_style_set_radius(&pwd_kb_style, 5); // 设置样式的圆角弧度
        lv_style_set_border_width(&pwd_kb_style, 0); //设置边框宽度
        lv_style_set_bg_color(&pwd_kb_style, lv_color_hex(0xF98E2D));
        lv_style_set_text_opa(&pwd_kb_style, LV_OPA_COVER);
        lv_style_set_text_font(&pwd_kb_style, &lv_font_montserrat_20); //设置字体
        lv_obj_set_size(pwd_keyboard, 480, 174); //设置键盘大小
        lv_keyboard_set_mode(pwd_keyboard, LV_KEYBOARD_MODE_NUMBER_2); //设置键盘模式为数字键盘
        lv_keyboard_set_map(pwd_keyboard, LV_KEYBOARD_MODE_NUMBER_2, keyboard_map, keyboard_ctrl); // 设置键盘映射
        lv_keyboard_set_textarea(pwd_keyboard, yield_text_area); // 键盘对象和文本框绑定
        lv_obj_add_style(pwd_keyboard, &pwd_kb_style, 0); // 添加样式
        lv_obj_align(pwd_keyboard, LV_ALIGN_TOP_LEFT, 0, 74);


        LV_FONT_DECLARE(heiFont16_1);
        label_typeface_return = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_typeface_return, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_typeface_return, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_typeface_return,  "返回");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_typeface_return, "Return");
        }
        lv_obj_align(label_typeface_return, LV_ALIGN_TOP_LEFT, 140, 252);

        LV_IMG_DECLARE(get_back);
        btn_typeface_return = lv_imgbtn_create(lv_scr_act());
        lv_imgbtn_set_src(btn_typeface_return, LV_IMGBTN_STATE_RELEASED, NULL, &get_back, NULL);
        lv_obj_set_size(btn_typeface_return, get_back.header.w, get_back.header.h);
        lv_obj_align(btn_typeface_return, LV_ALIGN_TOP_LEFT, 180, 250);
        lv_obj_add_event_cb(btn_typeface_return, button_yield_reset_keyboard_return_event_cb, LV_EVENT_CLICKED, NULL);


        LV_IMG_DECLARE(confirm);
        btn_typeface_confirm = lv_imgbtn_create(lv_scr_act());
        lv_imgbtn_set_src(btn_typeface_confirm, LV_IMGBTN_STATE_RELEASED, NULL, &confirm, NULL);
        lv_obj_set_size(btn_typeface_confirm, get_back.header.w, get_back.header.h);
        lv_obj_align(btn_typeface_confirm, LV_ALIGN_TOP_LEFT, 250, 250);
        lv_obj_add_event_cb(btn_typeface_confirm, button_yield_reset_keyboard_confirm_event_cb, LV_EVENT_CLICKED, NULL);

        LV_FONT_DECLARE(heiFont16_1);
        label_typeface_confirm = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_typeface_confirm, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_typeface_confirm, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_typeface_confirm,  "确定");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_typeface_confirm, "Confirm");
        }
        lv_obj_align(label_typeface_confirm, LV_ALIGN_TOP_LEFT, 277, 252);
    }
}

static void button_set_developer_confirm_event_cb(lv_event_t* e)
{
    lv_event_code_t code;
    code = lv_event_get_code(e);
    if (code == LV_EVENT_CLICKED)
    {
        printf("button_set_developer_confirm_event_cb\r\n");
        //保存总产量数据到文件
        buzzer_enable = 1;
        
        //删除开发者模式界面
        lv_obj_del(set_developer_bg);
        lv_obj_del(label_set_developer_head);
        lv_obj_del(set_developer_middle_bg);
        lv_obj_del(img_Rf_frequency);
        lv_obj_del(label_Rf_frequency_text);
        lv_obj_del(label_Rf_frequency_label);
        lv_obj_del(img_surrogate_information);
        lv_obj_del(label_surrogate_information_name);
        lv_obj_del(label_surrogate_information_label);
        lv_obj_del(img_print_pulse_width);
        lv_obj_del(label_print_pulse_width);
        lv_obj_del(dropdown_print_pulse_width);
        lv_obj_del(img_yield_reset);
        lv_obj_del(label_yield_reset);
        lv_obj_del(label_btn_yield_reset);
        lv_obj_del(btn_yield_reset);
        lv_obj_del(addition_date_bottom_bg);
        lv_obj_del(label_addition_date_time_return);
        lv_obj_del(imgbtn_addition_date_time_return);
        lv_obj_del(imgbtn_addition_date_time_confirm);
        lv_obj_del(label_addition_date_time_confirm);

        //删除密码界面
        lv_obj_del(hint_label);
        lv_obj_del(pwd_text_area);
        lv_obj_del(pwd_main_cont);
    }
}



static void button_set_developer_return_event_cb(lv_event_t* e)
{
    lv_event_code_t code;
    code = lv_event_get_code(e);
    if (code == LV_EVENT_CLICKED)
    {
        printf("button_set_developer_return_event_cb\r\n");
        buzzer_enable = 1;
        //删除开发者模式界面
        lv_obj_del(set_developer_bg);
        lv_obj_del(label_set_developer_head);
        lv_obj_del(set_developer_middle_bg);
        lv_obj_del(img_Rf_frequency);
        lv_obj_del(label_Rf_frequency_text);
        lv_obj_del(label_Rf_frequency_label);
        lv_obj_del(img_surrogate_information);
        lv_obj_del(label_surrogate_information_name);
        lv_obj_del(label_surrogate_information_label);
        lv_obj_del(img_print_pulse_width);
        lv_obj_del(label_print_pulse_width);
        lv_obj_del(dropdown_print_pulse_width);
        lv_obj_del(img_yield_reset);
        lv_obj_del(label_yield_reset);
        lv_obj_del(label_btn_yield_reset);
        lv_obj_del(btn_yield_reset);
        lv_obj_del(addition_date_bottom_bg);
        lv_obj_del(label_addition_date_time_return);
        lv_obj_del(imgbtn_addition_date_time_return);
        lv_obj_del(imgbtn_addition_date_time_confirm);
        lv_obj_del(label_addition_date_time_confirm);

        //删除密码界面
        lv_obj_del(hint_label);
        lv_obj_del(pwd_text_area);
        lv_obj_del(pwd_main_cont);
    }
}



// 确认按键的事件回调
static void developer_confirm_btn_event_callback(lv_event_t* event)
{
    char tempbuf[64] = { 0 };
    int retvalue;
    unsigned char databuf[20]={0};
    int i;
    unsigned char *p = NULL;
    //int num;
    unsigned char crc;

    if (event == NULL)
    {
        printf("[%s:%d] event is NULL\n", __FUNCTION__, __LINE__);
        return;
    }

    lv_event_code_t code = lv_event_get_code(event);
    if (code == LV_EVENT_CLICKED)
    {
        printf("[%s:%d] confirm button clicked\n", __FUNCTION__, __LINE__);
        buzzer_enable = 1;
        if (pwd_text_area != NULL)
        {
            const char* pwd_txt = lv_textarea_get_text(pwd_text_area);
            if ((pwd_txt != NULL))
            {
                if (strcmp(pwd_txt, "210513") == 0)
                {
                    if (hint_label != NULL)
                    {
                        //lv_label_set_text(hint_label, "Password correct!");
                        printf("confirm_btn_event_callback\n\r");
                        set_developer_bg = lv_obj_create(lv_scr_act());
                        lv_obj_set_size(set_developer_bg, 480, 24);
                        lv_obj_align(set_developer_bg, LV_ALIGN_TOP_LEFT, 0, 0);
                        lv_obj_set_style_border_width(set_developer_bg, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
                        lv_obj_set_style_radius(set_developer_bg, 0, LV_STATE_DEFAULT); /* 设置圆角 */
                        lv_obj_set_style_bg_color(set_developer_bg, lv_color_hex(0x28536a), LV_STATE_DEFAULT);
                        lv_obj_remove_style(set_developer_bg, 0, LV_PART_SCROLLBAR);


                        LV_FONT_DECLARE(heiFont16_1);
                        label_set_developer_head = lv_label_create(lv_scr_act());
                        lv_obj_set_style_text_font(label_set_developer_head, &heiFont16_1, LV_STATE_DEFAULT);
                        lv_obj_set_style_text_color(label_set_developer_head, lv_color_hex(0xFFFFFF), LV_STATE_DEFAULT);
                        lv_label_set_text(label_set_developer_head, "开发者模式");
                        lv_obj_align(label_set_developer_head, LV_ALIGN_TOP_LEFT, 200, 4);


                        set_developer_middle_bg = lv_obj_create(lv_scr_act());
                        lv_obj_set_size(set_developer_middle_bg, 480, 224);
                        lv_obj_align(set_developer_middle_bg, LV_ALIGN_TOP_LEFT, 0, 24);
                        lv_obj_set_style_border_width(set_developer_middle_bg, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
                        lv_obj_set_style_radius(set_developer_middle_bg, 0, LV_STATE_DEFAULT); /* 设置圆角 */
                        lv_obj_set_style_bg_color(set_developer_middle_bg, lv_color_hex(0xffffff), LV_STATE_DEFAULT);


                        LV_IMG_DECLARE(frequency);
                        img_Rf_frequency = lv_img_create(lv_scr_act());
                        lv_img_set_src(img_Rf_frequency, &frequency);
                        lv_obj_align(img_Rf_frequency, LV_ALIGN_TOP_LEFT, 10, 34);

                        LV_FONT_DECLARE(heiFont16_1);
                        label_Rf_frequency_text = lv_label_create(lv_scr_act());
                        lv_obj_set_style_text_font(label_Rf_frequency_text, &heiFont16_1, LV_STATE_DEFAULT);
                        lv_obj_set_style_text_color(label_Rf_frequency_text, lv_color_hex(0x000000), LV_STATE_DEFAULT);
                        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
                        {
                            lv_label_set_text(label_Rf_frequency_text, "射频次数:");
                        }
                        else if(system_data.system.language == LANGUAGE_ENGLISH)
                        {
                            lv_label_set_text(label_Rf_frequency_text, "Radio frequency frequency:");
                        }

                        lv_obj_align(label_Rf_frequency_text, LV_ALIGN_TOP_LEFT, 45, 39);


                        LV_FONT_DECLARE(heiFont16_1);
                        label_Rf_frequency_label = lv_label_create(lv_scr_act());
                        lv_obj_set_style_text_font(label_Rf_frequency_label, &heiFont16_1, LV_STATE_DEFAULT);
                        lv_obj_set_style_text_color(label_Rf_frequency_label, lv_color_hex(0x000000), LV_STATE_DEFAULT);
                        //lv_label_set_text(label_Rf_frequency_label, "123");
                        lv_obj_align(label_Rf_frequency_label, LV_ALIGN_TOP_LEFT, 130, 39);

                        //射频卡信息
                        //sprintf(tempbuf,"%d", system_data.develop);
                        //lv_label_set_text(label_Rf_frequency_label, "123");
                            
                        LV_IMG_DECLARE(surrogate);
                        img_surrogate_information = lv_img_create(lv_scr_act());
                        lv_img_set_src(img_surrogate_information, &surrogate);
                        lv_obj_align(img_surrogate_information, LV_ALIGN_TOP_LEFT, 260, 34);

                        LV_FONT_DECLARE(heiFont16_1);
                        label_surrogate_information_name = lv_label_create(lv_scr_act());
                        lv_obj_set_style_text_font(label_surrogate_information_name, &heiFont16_1, LV_STATE_DEFAULT);
                        lv_obj_set_style_text_color(label_surrogate_information_name, lv_color_hex(0x000000), LV_STATE_DEFAULT);
                        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
                        {
                            lv_label_set_text(label_surrogate_information_name, "代理信息:");
                        }
                        else if(system_data.system.language == LANGUAGE_ENGLISH)
                        {
                            lv_label_set_text(label_surrogate_information_name, "Surrogate information:");
                        }
                        lv_obj_align(label_surrogate_information_name, LV_ALIGN_TOP_LEFT, 295, 39);


                        LV_FONT_DECLARE(heiFont16_1);
                        label_surrogate_information_label = lv_label_create(lv_scr_act());
                        lv_obj_set_style_text_font(label_surrogate_information_label, &heiFont16_1, LV_STATE_DEFAULT);
                        lv_obj_set_style_text_color(label_surrogate_information_label, lv_color_hex(0x000000), LV_STATE_DEFAULT);
                        //lv_label_set_text(label_surrogate_information_label, "123");
                        lv_obj_align(label_surrogate_information_label, LV_ALIGN_TOP_LEFT, 390, 39);


                        printf("device_id=0x%x\n\r",g_authorization.device_id);
                        printf("g_sd_serial=0x%x\n\r",g_sd_serial);
                        printf("machine_model=0x%x\n\r",g_authorization.machine_model);
                        printf("locked_state=0x%x\n\r",g_authorization.locked_state);
                        printf("year=%d\n\r",g_authorization.rtc_time.year);
                        printf("month=%d\n\r",g_authorization.rtc_time.month);
                        printf("hour=%d\n\r",g_authorization.rtc_time.hour);
                        printf("minute=%d\n\r",g_authorization.rtc_time.minute);
                        printf("second=%d\n\r",g_authorization.rtc_time.second);

                        if(g_authorization.device_id == g_sd_serial)
                        {
                            if(g_authorization.locked_state == 1)
                            {

                                read_writer_rtc_enable = 0;

                                memset(databuf,0,sizeof(databuf));
                                databuf[0] = 0x04;
                                
                                retvalue = read(fd_rc522, databuf, 16);
                                if(retvalue < 0)
                                {
                                    printf("fd_rc522 Failed!\r\n");
                                    //close(fd_bm8563);
                                    read_card_info_result = 0;
                                }
                                else
                                {
                                    printf("读卡密文\n\r");
                                    for(i=0;i<16;i++)
                                    {
                                        printf("0x%x ",databuf[i]);
                                    }
                                    printf("\n\r");

                                    memset(msg, 0, MSG_SIZE);
                                    memset(&context, 0, sizeof(context));
                                    AES_set_key(&context, key, iv, AES_MODE_128);

                                    AES_convert_key(&context);
                                    memset((char *)&card_info_newest,0,sizeof(card_info_newest));
                                    AES_cbc_decrypt(&context, databuf, (unsigned char *)&card_info_newest, MSG_SIZE);

                                    p = (unsigned char *)&card_info_newest;
                                    printf("读卡明文\n\r");
                                    for(i=0;i<16;i++)
                                    {
                                        printf("0x%x ",*(p+i));
                                    }
                                    printf("\n\r");

                                    crc =  CRC8(p,16);
                                    if(crc == card_info_newest.crc)
                                    {
                                        printf("databuf ok\n");
                                        read_card_info_result = 1;
                                    }
                                    else
                                    {
                                        read_card_info_result = 0;
                                    }

                                    read_writer_rtc_enable = 1;
                                }

                                if(read_card_info_result == 1)
                                {
                                    if(card_info_newest.machine_model == g_authorization.machine_model)
                                    {
                                        sprintf(tempbuf,"%u",card_info_newest.count);
                                        lv_label_set_text(label_Rf_frequency_label, tempbuf);
                                        sprintf(tempbuf,"%d",card_info_newest.machine_model);
                                        lv_label_set_text(label_surrogate_information_label, tempbuf);
                                    }
                                    else
                                    {
                                        lv_label_set_text(label_Rf_frequency_label, "");
                                        lv_label_set_text(label_surrogate_information_label, "");
                                        printf("machine_model error\n");
                                    }
                                }
                                else
                                {
                                    lv_label_set_text(label_Rf_frequency_label, "");
                                    lv_label_set_text(label_surrogate_information_label, ""); 
                                    printf("crc error\n");
                                }
                            }
                            else
                            {
                                lv_label_set_text(label_Rf_frequency_label, "");
                                lv_label_set_text(label_surrogate_information_label, "");
                                printf("locked_state error\n");
                            }
                        }
                        else
                        {
                            lv_label_set_text(label_Rf_frequency_label, "");
                            lv_label_set_text(label_surrogate_information_label, "");
                            printf("id error\n");
                        }

                        LV_IMG_DECLARE(print_pulse_width);
                        img_print_pulse_width = lv_img_create(lv_scr_act());
                        lv_img_set_src(img_print_pulse_width, &print_pulse_width);
                        lv_obj_align(img_print_pulse_width, LV_ALIGN_TOP_LEFT, 10, 85);

                        LV_FONT_DECLARE(heiFont16_1);
                        label_print_pulse_width = lv_label_create(lv_scr_act());
                        lv_obj_set_style_text_font(label_print_pulse_width, &heiFont16_1, LV_STATE_DEFAULT);
                        lv_obj_set_style_text_color(label_print_pulse_width, lv_color_hex(0x000000), LV_STATE_DEFAULT);
                        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
                        {
                            lv_label_set_text(label_print_pulse_width, "打印脉宽:");
                        }
                        else if(system_data.system.language == LANGUAGE_ENGLISH)
                        {
                            lv_label_set_text(label_print_pulse_width, "Print pulse width:");
                        }
                        lv_obj_align(label_print_pulse_width, LV_ALIGN_TOP_LEFT, 45, 90);


                        //static const char* opts_print_pulse_width = "1.5us\n1.6us\n1.7us\n1.8us\n1.9us\n2.0us\n2.1us\n2.2us\n2.3us\n2.4us\n2.5us\n";
                        static const char* opts_print_pulse_width = "1.8us\n";
                        dropdown_print_pulse_width = lv_dropdown_create(lv_scr_act());
                        lv_obj_set_style_border_width(dropdown_print_pulse_width, 1, LV_STATE_DEFAULT); /* 设置边框宽度 */
                        lv_obj_set_style_radius(dropdown_print_pulse_width, 10, LV_STATE_DEFAULT); /* 设置圆角 */
                        lv_obj_set_style_border_color(dropdown_print_pulse_width, lv_color_hex(0x000000), LV_STATE_DEFAULT); /* 设置边框颜色 */
                        lv_dropdown_set_options_static(dropdown_print_pulse_width, opts_print_pulse_width);
                        lv_obj_align(dropdown_print_pulse_width, LV_ALIGN_TOP_LEFT, 130, 80);
                        lv_obj_set_style_width(dropdown_print_pulse_width, 110, LV_STATE_DEFAULT);
                        LV_FONT_DECLARE(heiFont14);
                        lv_obj_set_style_text_font(dropdown_print_pulse_width, &heiFont14, LV_STATE_DEFAULT);
                        lv_obj_set_style_height(dropdown_print_pulse_width, 35, LV_STATE_DEFAULT);
                        lv_obj_t* opts_print_pulse_width_list = lv_dropdown_get_list(dropdown_print_pulse_width);
                        lv_obj_set_style_text_font(opts_print_pulse_width_list, &heiFont14, 0);   // 设置新的字体
                        LV_IMG_DECLARE(dropdown);
                        lv_dropdown_set_symbol(dropdown_print_pulse_width, &dropdown);
                        lv_obj_add_event_cb(dropdown_print_pulse_width, dropdown_print_pulse_width_event_handler, LV_EVENT_ALL, NULL);


                        LV_IMG_DECLARE(yield_reset);
                        img_yield_reset = lv_img_create(lv_scr_act());
                        lv_img_set_src(img_yield_reset, &yield_reset);
                        lv_obj_align(img_yield_reset, LV_ALIGN_TOP_LEFT, 260, 85);


                        LV_FONT_DECLARE(heiFont16_1);
                        label_yield_reset = lv_label_create(lv_scr_act());
                        lv_obj_set_style_text_font(label_yield_reset, &heiFont16_1, LV_STATE_DEFAULT);
                        lv_obj_set_style_text_color(label_yield_reset, lv_color_hex(0x000000), LV_STATE_DEFAULT);
                        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
                        {
                            lv_label_set_text(label_yield_reset, "产量重置:");
                        }
                        else if(system_data.system.language == LANGUAGE_ENGLISH)
                        {
                            lv_label_set_text(label_yield_reset, "Output reset:");
                        }
                        lv_obj_align(label_yield_reset, LV_ALIGN_TOP_LEFT, 295, 90);

                        LV_FONT_DECLARE(heiFont14);
                        btn_yield_reset = lv_btn_create(lv_scr_act());
                        lv_obj_set_size(btn_yield_reset, 80, 35);
                        lv_obj_align(btn_yield_reset, LV_ALIGN_TOP_LEFT, 390, 80);
                        lv_obj_set_style_border_width(btn_yield_reset, 1, LV_STATE_DEFAULT); /* 设置边框宽度 */
                        lv_obj_set_style_border_color(btn_yield_reset, lv_color_hex(0x000000), LV_STATE_DEFAULT);
                        lv_obj_set_style_radius(btn_yield_reset, 10, LV_STATE_DEFAULT); /* 设置圆角 */
                        lv_obj_set_style_bg_color(btn_yield_reset, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
                        label_btn_yield_reset = lv_label_create(btn_yield_reset);
                        lv_obj_set_style_text_font(label_btn_yield_reset, &heiFont14, LV_STATE_DEFAULT);
                        lv_obj_set_style_text_color(label_btn_yield_reset, lv_color_hex(0x000000), LV_STATE_DEFAULT);
                        //lv_label_set_text(label_btn_yield_reset, "0");
                        lv_obj_align(label_btn_yield_reset, LV_ALIGN_CENTER, 0, 0);
                        lv_obj_set_style_border_width(label_btn_yield_reset, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
                        lv_obj_set_style_border_color(label_btn_yield_reset, lv_color_hex(0x000000), LV_STATE_DEFAULT); /* 设置边框颜色 */
                        lv_obj_set_style_border_opa(label_btn_yield_reset, 100, LV_STATE_DEFAULT); /* 设置边框透明度 */
                        lv_obj_set_style_radius(label_btn_yield_reset, 0, LV_STATE_DEFAULT); /* 设置圆角 */
                        lv_obj_set_style_bg_opa(label_btn_yield_reset, LV_OPA_COVER, LV_PART_MAIN);
                        lv_obj_set_style_bg_color(label_btn_yield_reset, lv_color_hex(0xffffff), LV_PART_MAIN);
                        lv_obj_add_event_cb(btn_yield_reset, btn_yield_reset_event_cb, LV_EVENT_CLICKED, NULL);

                        sprintf(tempbuf, "%d", system_data.total_output);
                        lv_label_set_text(label_btn_yield_reset, tempbuf);


                        addition_date_bottom_bg = lv_obj_create(lv_scr_act());
                        lv_obj_set_size(addition_date_bottom_bg, 480, 24);
                        lv_obj_align(addition_date_bottom_bg, LV_ALIGN_TOP_LEFT, 0, 248);
                        lv_obj_set_style_border_width(addition_date_bottom_bg, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
                        lv_obj_set_style_radius(addition_date_bottom_bg, 0, LV_STATE_DEFAULT); /* 设置圆角 */
                        lv_obj_set_style_bg_color(addition_date_bottom_bg, lv_color_hex(0x28536a), LV_STATE_DEFAULT);
                        lv_obj_remove_style(addition_date_bottom_bg, 0, LV_PART_SCROLLBAR);


                        LV_FONT_DECLARE(heiFont16_1);
                        label_addition_date_time_return = lv_label_create(lv_scr_act());
                        lv_obj_set_style_text_font(label_addition_date_time_return, &heiFont16_1, LV_STATE_DEFAULT);
                        lv_obj_set_style_text_color(label_addition_date_time_return, lv_color_hex(0xffffff), LV_STATE_DEFAULT);

                        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
                        {
                            lv_label_set_text(label_addition_date_time_return, "返回");
                        }
                        else if(system_data.system.language == LANGUAGE_ENGLISH)
                        {
                            lv_label_set_text(label_addition_date_time_return, "Return");
                        }
                        lv_obj_align(label_addition_date_time_return, LV_ALIGN_TOP_LEFT, 140, 252);


                        LV_IMG_DECLARE(get_back);
                        imgbtn_addition_date_time_return = lv_imgbtn_create(lv_scr_act());
                        lv_imgbtn_set_src(imgbtn_addition_date_time_return, LV_IMGBTN_STATE_RELEASED, NULL, &get_back, NULL);
                        lv_obj_set_size(imgbtn_addition_date_time_return, get_back.header.w, get_back.header.h);
                        lv_obj_align(imgbtn_addition_date_time_return, LV_ALIGN_TOP_LEFT, 180, 250);
                        lv_obj_add_event_cb(imgbtn_addition_date_time_return, button_set_developer_return_event_cb, LV_EVENT_CLICKED, NULL);

                        LV_IMG_DECLARE(confirm);
                        imgbtn_addition_date_time_confirm = lv_imgbtn_create(lv_scr_act());
                        lv_imgbtn_set_src(imgbtn_addition_date_time_confirm, LV_IMGBTN_STATE_RELEASED, NULL, &confirm, NULL);
                        lv_obj_set_size(imgbtn_addition_date_time_confirm, get_back.header.w, get_back.header.h);
                        lv_obj_align(imgbtn_addition_date_time_confirm, LV_ALIGN_TOP_LEFT, 250, 250);
                        lv_obj_add_event_cb(imgbtn_addition_date_time_confirm, button_set_developer_confirm_event_cb, LV_EVENT_CLICKED, NULL);

                        LV_FONT_DECLARE(heiFont16_1);
                        label_addition_date_time_confirm = lv_label_create(lv_scr_act());
                        lv_obj_set_style_text_font(label_addition_date_time_confirm, &heiFont16_1, LV_STATE_DEFAULT);
                        lv_obj_set_style_text_color(label_addition_date_time_confirm, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
                        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
                        {
                            lv_label_set_text(label_addition_date_time_confirm, "确定");
                        }
                        else if(system_data.system.language == LANGUAGE_ENGLISH)
                        {
                            lv_label_set_text(label_addition_date_time_confirm, "Confirm");
                        }
                        lv_obj_align(label_addition_date_time_confirm, LV_ALIGN_TOP_LEFT, 277, 252);
                    }
                }
                else if (pwd_txt[0] == '\0')
                {
                    if (hint_label != NULL)
                    {
                        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
                        {
                            lv_label_set_text(hint_label, "密码不能为空!");
                        }
                        else if(system_data.system.language == LANGUAGE_ENGLISH)
                        {
                            lv_label_set_text(hint_label, "Password can not be empty!");
                        }
                    }
                }
                else
                {
                    if (hint_label != NULL)
                    {
                        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
                        {
                            lv_label_set_text(hint_label, "未链接调试设备或验证码错误！");
                        }
                        else if(system_data.system.language == LANGUAGE_ENGLISH)
                        {
                            lv_label_set_text(hint_label, "Verification code error！");
                        }
                    }
                }
            }
        }
    }
}




// 取消按键的事件回调
static void cancel_btn_event_callback(lv_event_t* event)
{
    if (event == NULL)
    {
        printf("[%s:%d] event is NULL\n", __FUNCTION__, __LINE__);
        return;
    }

    lv_event_code_t code = lv_event_get_code(event);
    if (code == LV_EVENT_CLICKED)
    {
#if 0
        printf("[%s:%d] cancel button clicked\n", __FUNCTION__, __LINE__);
        if (pwd_text_area != NULL)
        {
            lv_textarea_set_text(pwd_text_area, ""); // 文本框置空
        }

        if (hint_label != NULL)
        {
            lv_label_set_text(hint_label, "");
        }
#endif
        printf("cancel_btn_event_callback\n");
        buzzer_enable = 1;
        lv_obj_del(pwd_main_cont);


    }
}


static void btn_developer_model_event_cb(lv_event_t* e)
{
    lv_event_code_t code;
    //lv_obj_t* obj = lv_event_get_target(e);
    code = lv_event_get_code(e);
    if (code == LV_EVENT_LONG_PRESSED)
    {
        printf("btn_developer_model_event_cb\n");
        buzzer_enable = 1;
        // 当前页面的画布容器
        pwd_main_cont = lv_obj_create(lv_scr_act()); // 基于屏幕创建了一个容器
        if (pwd_main_cont == NULL)
        {
            printf("[%s:%d] create pwd_main_cont failed\n", __FUNCTION__, __LINE__);
            return;
        }

        // 画布样式
        static lv_style_t main_cont_style;
        lv_style_init(&main_cont_style); // 初始化样式
        lv_style_set_radius(&main_cont_style, 0); // 设置样式的圆角弧度
        lv_style_set_border_width(&main_cont_style, 0); // 设置边框宽度
        lv_style_set_bg_opa(&main_cont_style, LV_OPA_COVER); // 设置样式背景的透明度，不透明
        lv_style_set_bg_color(&main_cont_style, lv_color_make(0xea, 0xea, 0xea));
        lv_style_set_pad_all(&main_cont_style, 0); // 设置样式内部填充
        lv_obj_add_style(pwd_main_cont, &main_cont_style, 0);  // 给对象添加样式
        //lv_obj_set_size(pwd_main_cont, LV_PCT(100), LV_PCT(100)); //设置大小800x480
        lv_obj_set_size(pwd_main_cont, 480,272); //设置大小800x480
        lv_obj_center(pwd_main_cont); // 对象居屏幕中间显示

        // 键盘背景容器
        lv_obj_t* pwd_bg_cont = lv_obj_create(pwd_main_cont);
        if (pwd_bg_cont == NULL)
        {
            printf("[%s:%d] pwd_bg_cont create failed\n", __FUNCTION__, __LINE__);
            return;
        }

        // 键盘背景样式
        static lv_style_t bg_style;
        lv_style_init(&bg_style); // 初始化样式
        lv_style_set_radius(&bg_style, 10); // 设置样式的圆角弧度
        lv_style_set_border_width(&bg_style, 0); // 设置边框宽度
        lv_style_set_bg_opa(&bg_style, LV_OPA_COVER); // 设置样式背景的透明度，不透明
        lv_style_set_bg_color(&bg_style, lv_palette_main(LV_PALETTE_BLUE)); //背景色设置为蓝色
        lv_style_set_pad_all(&bg_style, 0); // 设置样式内部填充
        // 样式添加渐变
        lv_style_set_bg_grad_color(&bg_style, lv_color_white()); // 渐变背景色为白色
        lv_style_set_bg_grad_dir(&bg_style, LV_GRAD_DIR_VER); // 垂直方向渐变
        lv_style_set_bg_main_stop(&bg_style, 30); // 主停止色40
        lv_style_set_bg_grad_stop(&bg_style, 30); // 渐变停止色40
        lv_obj_add_style(pwd_bg_cont, &bg_style, 0);  // 给对象添加样式
        lv_obj_set_size(pwd_bg_cont, 400, 260); // 设置尺寸
        lv_obj_align(pwd_bg_cont, LV_ALIGN_TOP_MID, 0, 5); // 顶部居中显示

        // 键盘标题样式
        static lv_style_t title_label_style;
        lv_style_init(&title_label_style); // 初始化样式
        lv_style_set_radius(&title_label_style, 0); // 设置样式的圆角弧度
        lv_style_set_border_width(&title_label_style, 0); //设置边框宽度
        lv_style_set_text_color(&title_label_style, lv_color_white());  // 字体颜色设置为白色
        lv_style_set_text_font(&title_label_style, &lv_font_montserrat_18); //设置字体


        // 基于键盘背景对象创建键盘标题对象
        lv_obj_t* title_label = lv_label_create(pwd_bg_cont);
        if (title_label == NULL)
        {
            printf("[%s:%d] create title_label obj failed\n", __FUNCTION__, __LINE__);
            return;
        }

        //输入框+键盘
        LV_FONT_DECLARE(heiFont16_1);
        lv_obj_set_style_text_font(title_label, &heiFont16_1, 0);
        lv_label_set_long_mode(title_label, LV_LABEL_LONG_SCROLL_CIRCULAR); // 设置长文本循环滚动模式
        //lv_obj_set_height(title_label, 23); // 设置对象的高度
        lv_obj_add_style(title_label, &title_label_style, 0); // 给btn_label添加样式
        lv_obj_align(title_label, LV_ALIGN_TOP_MID, 0, 5); // 顶部居中显示
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(title_label, "请链接调试设备输入验证码"); // 设置文本内容
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(title_label, "Please enter the verification code"); // 设置文本内容
        }

        // 基于键盘背景对象创建密码框
        pwd_text_area = lv_textarea_create(pwd_bg_cont);
        if (pwd_text_area == NULL)
        {
            printf("[%s:%d] create pwd_text_area obj failed\n", __FUNCTION__, __LINE__);
            return;
        }

        // 密码框样式
        static lv_style_t pwd_text_style;
        lv_style_init(&pwd_text_style); // 初始化样式
        lv_style_set_radius(&pwd_text_style, 0); // 设置样式的圆角弧度
        lv_style_set_border_width(&pwd_text_style, 1); // 设置边框宽度
        lv_style_set_pad_all(&pwd_text_style, 0); // 设置样式的内部填充
        lv_style_set_text_font(&pwd_text_style, &lv_font_montserrat_18); //设置字体

        lv_textarea_set_text(pwd_text_area, ""); // 文本框置空
        lv_textarea_set_password_mode(pwd_text_area, true); // 文本区域开启密码模式
        lv_textarea_set_max_length(pwd_text_area, 8); // 设置可输入的文本的最大长度
        lv_obj_add_style(pwd_text_area, &pwd_text_style, 0); // 给btn_label添加样式

        lv_obj_set_size(pwd_text_area, 295, 35); // 设置对象大小
        lv_obj_align_to(pwd_text_area, title_label, LV_ALIGN_OUT_BOTTOM_MID, 0, 20); // 顶部居中显示

        // 基于键盘背景对象创建密码校验提示标签
        hint_label = lv_label_create(pwd_bg_cont);
        if (hint_label == NULL)
        {
            printf("[%s:%d] create hint_label obj failed\n", __FUNCTION__, __LINE__);
            return;
        }

        // 密码提示文本样式
        static lv_style_t hint_label_style;
        LV_FONT_DECLARE(heiFont16_1);
        lv_style_init(&hint_label_style); // 初始化样式
        lv_style_set_radius(&hint_label_style, 0); // 设置样式的圆角弧度
        lv_style_set_border_width(&hint_label_style, 0); //设置边框宽度
        lv_style_set_text_color(&hint_label_style, lv_palette_main(LV_PALETTE_RED));  // 字体颜色设置为红色
        lv_style_set_text_font(&hint_label_style, &heiFont16_1); //设置字体

        lv_label_set_long_mode(hint_label, LV_LABEL_LONG_SCROLL_CIRCULAR); // 长文本循环滚动
        lv_obj_add_style(hint_label, &hint_label_style, 0); // 给btn_label添加样式
        lv_obj_align(hint_label, LV_ALIGN_TOP_MID, 0, 90); // 顶部居中显示
        lv_label_set_text(hint_label, ""); // 设置文本内容

        // 基于键盘背景对象创建键盘对象
        pwd_keyboard = lv_keyboard_create(pwd_bg_cont);
        if (pwd_keyboard == NULL)
        {
            printf("[%s:%d] create pwd_keyboard obj failed\n", __FUNCTION__, __LINE__);
            return;
        }

        // 键盘样式
        static lv_style_t pwd_kb_style;
        lv_style_init(&pwd_kb_style); // 初始化样式
        lv_style_set_radius(&pwd_kb_style, 5); // 设置样式的圆角弧度
        lv_style_set_border_width(&pwd_kb_style, 0); //设置边框宽度
        lv_style_set_bg_color(&pwd_kb_style, lv_color_hex(0xF98E2D));
        lv_style_set_text_opa(&pwd_kb_style, LV_OPA_COVER);
        lv_style_set_text_font(&pwd_kb_style, &lv_font_montserrat_20); //设置字体


        lv_obj_set_size(pwd_keyboard, 300,110); //设置键盘大小
        lv_keyboard_set_mode(pwd_keyboard, LV_KEYBOARD_MODE_NUMBER_2); //设置键盘模式为数字键盘
        lv_keyboard_set_map(pwd_keyboard, LV_KEYBOARD_MODE_NUMBER_2, keyboard_map, keyboard_ctrl); // 设置键盘映射
        lv_keyboard_set_textarea(pwd_keyboard, pwd_text_area); // 键盘对象和文本框绑定
        lv_obj_add_style(pwd_keyboard, &pwd_kb_style, 0); // 添加样式
        lv_obj_align(pwd_keyboard, LV_ALIGN_TOP_MID, 0, 110);


        static lv_style_t btn_style;
        lv_style_init(&btn_style); // 初始化样式
        lv_style_set_radius(&btn_style, 5); // 设置样式的圆角弧度
        lv_style_set_border_width(&btn_style, 0); //设置边框宽度
        lv_style_set_bg_color(&btn_style, lv_color_hex(0xF98E2D));
        lv_style_set_text_color(&btn_style, lv_color_hex(0xFFFFFF));
        lv_style_set_text_font(&btn_style, &lv_font_montserrat_18); //设置字体

        // 基于键盘背景对象创建确认按键
        lv_obj_t* confirm_btn = lv_btn_create(pwd_bg_cont);
        if (pwd_bg_cont == NULL)
        {
            printf("[%s:%d] pwd_bg_cont create failed\n", __FUNCTION__, __LINE__);
            return;
        }

        lv_obj_add_event_cb(confirm_btn, developer_confirm_btn_event_callback, LV_EVENT_CLICKED, NULL); // 给对象添加CLICK事件和事件处理回调函数
        lv_obj_add_style(confirm_btn, &btn_style, 0); // 添加按键样式
        lv_obj_set_size(confirm_btn, 112, 25); // 设置按键对象大小
        lv_obj_align(confirm_btn, LV_ALIGN_TOP_MID, 65, 225); // 设置按键对象位置

        // 基于confirm_btn对象创建标签
        lv_obj_t* confirm_btn_label = lv_label_create(confirm_btn);
        if (confirm_btn_label == NULL)
        {
            printf("[%s:%d] create confirm_btn_label obj failed\n", __FUNCTION__, __LINE__);
            return;
        }
        LV_FONT_DECLARE(heiFont16_1);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(confirm_btn_label,  "确定");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(confirm_btn_label, "Confirm");
        }
        lv_obj_center(confirm_btn_label); // 居中显示
        lv_obj_set_style_text_font(confirm_btn_label, &heiFont16_1, 0);
        lv_obj_t* cancel_btn = lv_btn_create(pwd_bg_cont);
        if (cancel_btn == NULL)
        {
            printf("[%s:%d] cancel_btn create failed\n", __FUNCTION__, __LINE__);
            return;
        }

        lv_obj_add_event_cb(cancel_btn, cancel_btn_event_callback, LV_EVENT_CLICKED, NULL); // 给对象添加CLICK事件和事件处理回调函数
        lv_obj_add_style(cancel_btn, &btn_style, 0);
        lv_obj_set_size(cancel_btn, 112, 25);
        lv_obj_align(cancel_btn, LV_ALIGN_TOP_MID, -65,225);

        lv_obj_t* cancel_btn_label = lv_label_create(cancel_btn);
        if (cancel_btn_label == NULL)
        {
            printf("[%s:%d] create cancel_btn_label obj failed\n", __FUNCTION__, __LINE__);
            return;
        }

        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(cancel_btn_label, "返回"); // 设置文本内容
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(cancel_btn_label, "Return"); // 设置文本内容
        }
        lv_obj_set_style_text_font(cancel_btn_label, &heiFont16_1, 0);
        lv_obj_center(cancel_btn_label);
    }
}


static void slider_screen_luminance_event_cb(lv_event_t* e)
{
    lv_obj_t* slider = lv_event_get_target(e);
  //  char buf[8];
  //  lv_snprintf(buf, sizeof(buf), "%d%%", (int)lv_slider_get_value(slider));
  //  lv_label_set_text(slider_label, buf);
   // lv_obj_align_to(slider_label, slider, LV_ALIGN_OUT_BOTTOM_MID, 0, 10);
    int i = lv_slider_get_value(slider);
    i = 100 - i;
    printf("i=%d\n\r",i);

    pwm_brightness(i*4/5);
}

/*
2,20   70,10       160,20  230,10      318,20  390,10
2,70   70,60       160,70, 230,60      318,70  390,60
2,120  70,110      160,120,230,110     318,120 390,110
2,170  70,160      160,170,230,160     318,170 390,160
*/
static void set_tv_system_create(lv_obj_t* parent)
{
    char* opts_key_sound;
    char* opts_breath_plate;

    printf("set_tv_system_create\n");
    buzzer_enable = 1;
    lv_obj_set_style_pad_all(parent, 0, LV_STATE_DEFAULT);
    lv_obj_clear_flag(parent, LV_OBJ_FLAG_SCROLLABLE);
    lv_obj_t* set_system_obj = lv_obj_create(parent);
    lv_obj_set_size(set_system_obj, 480, 224);
    lv_obj_align(set_system_obj, LV_ALIGN_TOP_LEFT, 0, 0);
    lv_obj_set_style_border_width(set_system_obj, 2, LV_STATE_DEFAULT); /* 设置边框宽度 */
    lv_obj_set_style_radius(set_system_obj, 0, LV_STATE_DEFAULT); /* 设置圆角 */
    lv_obj_set_style_bg_opa(set_system_obj, LV_OPA_TRANSP, LV_PART_MAIN);
    lv_obj_set_style_pad_all(set_system_obj, 0, LV_STATE_DEFAULT);
    lv_obj_clear_flag(set_system_obj, LV_OBJ_FLAG_SCROLLABLE);


    LV_FONT_DECLARE(heiFont16_1);
    label_system_date = lv_label_create(set_system_obj);
    lv_obj_set_style_text_font(label_system_date, &heiFont16_1, LV_STATE_DEFAULT);
    lv_obj_set_style_text_color(label_system_date, lv_color_hex(0x000000), LV_STATE_DEFAULT);
    if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
    {
        lv_label_set_text(label_system_date,  "系统日期");
    }
    else if(system_data.system.language == LANGUAGE_ENGLISH)
    {
        lv_label_set_text(label_system_date, "System date");
    }

    lv_obj_align(label_system_date, LV_ALIGN_TOP_LEFT, 2, 20);

    LV_FONT_DECLARE(heiFont16_1);
    btn_system_date = lv_btn_create(set_system_obj);
    lv_obj_set_size(btn_system_date, 120, 35);
    lv_obj_align(btn_system_date, LV_ALIGN_TOP_LEFT, 70, 10);
    lv_obj_set_style_border_width(btn_system_date, 1, LV_STATE_DEFAULT); /* 设置边框宽度 */
    lv_obj_set_style_radius(btn_system_date, 0, LV_STATE_DEFAULT); /* 设置圆角 */
    lv_obj_set_style_bg_color(btn_system_date, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
    label_btn_system_date = lv_label_create(btn_system_date);
    lv_obj_set_style_text_font(label_btn_system_date, &heiFont16_1, LV_STATE_DEFAULT);
    lv_obj_set_style_text_color(label_btn_system_date, lv_color_hex(0x1C1C1C), LV_STATE_DEFAULT);

    //sprintf(g_time_data_string,"%04u-%02u-%02u",2000+g_system_time[0],g_system_time[1],g_system_time[2]);
    //lv_label_set_text(label_btn_system_date, g_time_data_string);
    lv_obj_align(label_btn_system_date, LV_ALIGN_CENTER, 0, 0);
    lv_obj_set_style_border_width(label_btn_system_date, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
    lv_obj_set_style_border_color(label_btn_system_date, lv_color_hex(0x8a8a8a), LV_STATE_DEFAULT); /* 设置边框颜色 */
    lv_obj_set_style_border_opa(label_btn_system_date, 100, LV_STATE_DEFAULT); /* 设置边框透明度 */
    lv_obj_set_style_radius(label_btn_system_date, 0, LV_STATE_DEFAULT); /* 设置圆角 */
    lv_obj_set_style_bg_opa(label_btn_system_date, LV_OPA_COVER, LV_PART_MAIN);
    lv_obj_set_style_bg_color(label_btn_system_date, lv_color_hex(0xffffff), LV_PART_MAIN);
    lv_obj_add_event_cb(btn_system_date, btn_system_date_event_cb, LV_EVENT_CLICKED, NULL);

   
    LV_FONT_DECLARE(heiFont16_1);
    label_system_time = lv_label_create(set_system_obj);
    lv_obj_set_style_text_font(label_system_time, &heiFont16_1, LV_STATE_DEFAULT);
    lv_obj_set_style_text_color(label_system_time, lv_color_hex(0x000000), LV_STATE_DEFAULT);
    if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
    {
        lv_label_set_text(label_system_time,  "系统时间");
    }
    else if(system_data.system.language == LANGUAGE_ENGLISH)
    {
        lv_label_set_text(label_system_time, "System time");
    }
    lv_obj_align(label_system_time, LV_ALIGN_TOP_LEFT, 2, 66);

    LV_FONT_DECLARE(heiFont16_1);
    btn_system_time = lv_btn_create(set_system_obj);
    lv_obj_set_size(btn_system_time, 120, 35);
    lv_obj_align(btn_system_time, LV_ALIGN_TOP_LEFT, 70, 56);
    lv_obj_set_style_border_width(btn_system_time, 1, LV_STATE_DEFAULT); /* 设置边框宽度 */
    lv_obj_set_style_radius(btn_system_time, 0, LV_STATE_DEFAULT); /* 设置圆角 */
    lv_obj_set_style_bg_color(btn_system_time, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
    label_btn_system_time = lv_label_create(btn_system_time);
    lv_obj_set_style_text_font(label_btn_system_time, &heiFont16_1, LV_STATE_DEFAULT);
    lv_obj_set_style_text_color(label_btn_system_time, lv_color_hex(0x1C1C1C), LV_STATE_DEFAULT);
    
    //sprintf(g_time_time_string,"%02u:%02u:%02u",g_system_time[3],g_system_time[4],g_system_time[5]);
    //lv_label_set_text(label_btn_system_time, g_time_time_string);
    lv_obj_align(label_btn_system_time, LV_ALIGN_CENTER, 0, 0);
    lv_obj_set_style_border_width(label_btn_system_time, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
    lv_obj_set_style_border_color(label_btn_system_time, lv_color_hex(0x8a8a8a), LV_STATE_DEFAULT); /* 设置边框颜色 */
    lv_obj_set_style_border_opa(label_btn_system_time, 100, LV_STATE_DEFAULT); /* 设置边框透明度 */
    lv_obj_set_style_radius(label_btn_system_time, 0, LV_STATE_DEFAULT); /* 设置圆角 */
    lv_obj_set_style_bg_opa(label_btn_system_time, LV_OPA_COVER, LV_PART_MAIN);
    lv_obj_set_style_bg_color(label_btn_system_time, lv_color_hex(0xffffff), LV_PART_MAIN);
    lv_obj_add_event_cb(btn_system_time, btn_system_date_event_cb, LV_EVENT_CLICKED, NULL);

    set_system_time_flag = 1;

    LV_FONT_DECLARE(heiFont16_1);
    label_key_sound = lv_label_create(set_system_obj);
    lv_obj_set_style_text_font(label_key_sound, &heiFont16_1, LV_STATE_DEFAULT);
    lv_obj_set_style_text_color(label_key_sound, lv_color_hex(0x000000), LV_STATE_DEFAULT);
    if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
    {
        lv_label_set_text(label_key_sound,  "按键声音");
    }
    else if(system_data.system.language == LANGUAGE_ENGLISH)
    {
        lv_label_set_text(label_key_sound, "Key press sound");
    }
    lv_obj_align(label_key_sound, LV_ALIGN_TOP_LEFT, 2, 112);

    if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
    {
        opts_key_sound = "开启\n关闭\n";
    }
    else if(system_data.system.language == LANGUAGE_ENGLISH)
    {
        opts_key_sound = "On\nOff\n";
    }
    else
    {
        opts_key_sound = "开启\n关闭\n";
    }

    key_sound_mode = lv_dropdown_create(set_system_obj);
    lv_obj_set_style_border_width(key_sound_mode, 1, LV_STATE_DEFAULT); /* 设置边框宽度 */
    //lv_obj_set_style_border_color(key_sound_mode, lv_color_hex(0x8a8a8a), LV_STATE_DEFAULT);
    //lv_obj_set_style_radius(key_sound_mode, 0, LV_STATE_DEFAULT); /* 设置圆角 */
    lv_dropdown_set_options_static(key_sound_mode, opts_key_sound);
    lv_obj_align(key_sound_mode, LV_ALIGN_TOP_LEFT, 70, 102);
    lv_obj_set_style_width(key_sound_mode, 120, LV_STATE_DEFAULT);
    lv_obj_set_style_height(key_sound_mode, 35, LV_STATE_DEFAULT);
    LV_FONT_DECLARE(heiFont14);
    lv_obj_set_style_text_font(key_sound_mode, &heiFont14, LV_STATE_DEFAULT);
    lv_obj_t* key_sound_mode_list = lv_dropdown_get_list(key_sound_mode);
    lv_obj_set_style_text_font(key_sound_mode_list, &heiFont14, 0);   // 设置新的字体
    LV_IMG_DECLARE(dropdown);
    lv_dropdown_set_symbol(key_sound_mode, &dropdown);
    lv_obj_add_event_cb(key_sound_mode, key_sound_mode_event_handler, LV_EVENT_ALL, NULL);

    lv_dropdown_set_selected(key_sound_mode, system_data.system.buzzer);


    LV_FONT_DECLARE(heiFont16_1);
    label_screen_luminance = lv_label_create(set_system_obj);
    lv_obj_set_style_text_font(label_screen_luminance, &heiFont16_1, LV_STATE_DEFAULT);
    lv_obj_set_style_text_color(label_screen_luminance, lv_color_hex(0x000000), LV_STATE_DEFAULT);
    if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
    {
        lv_label_set_text(label_screen_luminance, "屏幕亮度");
    }
    else if(system_data.system.language == LANGUAGE_ENGLISH)
    {
        lv_label_set_text(label_screen_luminance, "Screen luminance");
    }
    lv_obj_align(label_screen_luminance, LV_ALIGN_TOP_LEFT, 2, 152);

    /*Create a slider in the center of the display*/
    slider_screen_luminance = lv_slider_create(set_system_obj);
    lv_obj_align(slider_screen_luminance, LV_ALIGN_TOP_LEFT, 80, 152);
    lv_obj_set_style_width(slider_screen_luminance, 95, LV_STATE_DEFAULT);
    lv_obj_add_event_cb(slider_screen_luminance, slider_screen_luminance_event_cb, LV_EVENT_VALUE_CHANGED, NULL);

    /*Create a label below the slider*/
    //slider_label_slider_screen_luminance = lv_label_create(lv_scr_act());
    //lv_label_set_text(slider_label, "0%");
    //lv_obj_align_to(slider_label, slider, LV_ALIGN_OUT_BOTTOM_MID, 0, 10);

    lv_slider_set_value(slider_screen_luminance, system_data.system.brightness, LV_ANIM_ON);


    LV_FONT_DECLARE(heiFont16_1);
    label_USB_transfer = lv_label_create(set_system_obj);
    lv_obj_set_style_text_font(label_USB_transfer, &heiFont16_1, LV_STATE_DEFAULT);
    lv_obj_set_style_text_color(label_USB_transfer, lv_color_hex(0x000000), LV_STATE_DEFAULT);
    if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
    {
        lv_label_set_text(label_USB_transfer, "USB传输");
    }
    else if(system_data.system.language == LANGUAGE_ENGLISH)
    {
        lv_label_set_text(label_USB_transfer, "USB transmission");
    }
    lv_obj_align(label_USB_transfer, LV_ALIGN_TOP_LEFT, 2, 190);

    sw_USB_transfer = lv_switch_create(set_system_obj);
    lv_obj_set_pos(sw_USB_transfer, 85, 184);
    lv_obj_set_width(sw_USB_transfer, 48);
    lv_obj_set_height(sw_USB_transfer, 23);
    lv_obj_set_style_bg_color(sw_USB_transfer, lv_color_hex(0x00ff00), LV_STATE_CHECKED | LV_PART_INDICATOR);


    LV_FONT_DECLARE(heiFont16_1);
    label_language = lv_label_create(set_system_obj);
    lv_obj_set_style_text_font(label_language, &heiFont16_1, LV_STATE_DEFAULT);
    lv_obj_set_style_text_color(label_language, lv_color_hex(0x000000), LV_STATE_DEFAULT);
    if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
    {
        lv_label_set_text(label_language, "语言选择");
    }
    else if(system_data.system.language == LANGUAGE_ENGLISH)
    {
        lv_label_set_text(label_language, "Language selection");
    }
    lv_obj_align(label_language, LV_ALIGN_TOP_LEFT, 240, 20);


    static const char* opts_language = "中文简体\nEnglish\n";
    dropdown_language = lv_dropdown_create(set_system_obj);
    lv_obj_set_style_border_width(dropdown_language, 1, LV_STATE_DEFAULT); /* 设置边框宽度 */
    //lv_obj_set_style_border_color(dropdown_language, lv_color_hex(0x8a8a8a), LV_STATE_DEFAULT);
    //lv_obj_set_style_radius(dropdown_language, 0, LV_STATE_DEFAULT); /* 设置圆角 */
    lv_dropdown_set_options_static(dropdown_language, opts_language);
    lv_obj_align(dropdown_language, LV_ALIGN_TOP_LEFT, 310, 9);
    lv_obj_set_style_width(dropdown_language, 150, LV_STATE_DEFAULT);
    lv_obj_set_style_height(dropdown_language, 35, LV_STATE_DEFAULT);
    LV_FONT_DECLARE(heiFont14);
    lv_obj_set_style_text_font(dropdown_language, &heiFont14, LV_STATE_DEFAULT);
    lv_obj_t* dropdown_language_list = lv_dropdown_get_list(dropdown_language);
    lv_obj_set_style_text_font(dropdown_language_list, &heiFont14, 0);   // 设置新的字体
    LV_IMG_DECLARE(dropdown);
    lv_dropdown_set_symbol(dropdown_language, &dropdown);
    lv_obj_add_event_cb(dropdown_language, dropdown_language_event_handler, LV_EVENT_ALL, NULL);

    lv_dropdown_set_selected(dropdown_language, system_data.system.language);

    LV_FONT_DECLARE(heiFont16_1);
    label_breath_plate = lv_label_create(set_system_obj);
    lv_obj_set_style_text_font(label_breath_plate, &heiFont16_1, LV_STATE_DEFAULT);
    lv_obj_set_style_text_color(label_breath_plate, lv_color_hex(0x000000), LV_STATE_DEFAULT);
    if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
    {
        lv_label_set_text(label_breath_plate, "息屏时间");
    }
    else if(system_data.system.language == LANGUAGE_ENGLISH)
    {
        lv_label_set_text(label_breath_plate, "Screen-off time");
    }
    lv_obj_align(label_breath_plate, LV_ALIGN_TOP_LEFT, 240, 66);

    if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
    {
        opts_breath_plate = "1分钟\n5分钟\n30分钟\n常亮\n";
    }
    else if(system_data.system.language == LANGUAGE_ENGLISH)
    {
        opts_breath_plate = "1min\n5min\n30min\nEver\n";
    }
    else
    {
        opts_breath_plate = "1分钟\n5分钟\n30分钟\n常亮\n"; 
    }
    dropdown_breath_plate = lv_dropdown_create(set_system_obj);
    lv_obj_set_style_border_width(dropdown_breath_plate, 1, LV_STATE_DEFAULT); /* 设置边框宽度 */
    //lv_obj_set_style_border_color(dropdown_breath_plate, lv_color_hex(0x8a8a8a), LV_STATE_DEFAULT);
    //lv_obj_set_style_radius(dropdown_language, 0, LV_STATE_DEFAULT); /* 设置圆角 */
    lv_dropdown_set_options_static(dropdown_breath_plate, opts_breath_plate);
    lv_obj_align(dropdown_breath_plate, LV_ALIGN_TOP_LEFT, 310, 56);
    lv_obj_set_style_width(dropdown_breath_plate, 150, LV_STATE_DEFAULT);
    lv_obj_set_style_height(dropdown_breath_plate, 35, LV_STATE_DEFAULT);
    LV_FONT_DECLARE(heiFont14);
    lv_obj_set_style_text_font(dropdown_breath_plate, &heiFont14, LV_STATE_DEFAULT);
    lv_obj_t* dropdown_breath_plate_list = lv_dropdown_get_list(dropdown_breath_plate);
    lv_obj_set_style_text_font(dropdown_breath_plate_list, &heiFont14, 0);   // 设置新的字体
    LV_IMG_DECLARE(dropdown);
    lv_dropdown_set_symbol(dropdown_breath_plate, &dropdown);
    lv_obj_add_event_cb(dropdown_breath_plate, dropdown_breath_plate_event_handler, LV_EVENT_ALL, NULL);

    lv_dropdown_set_selected(dropdown_breath_plate, system_data.system.screen_off);

    //校准按钮
    btn_calibration= lv_btn_create(set_system_obj);
    lv_obj_set_size(btn_calibration, 220, 30);
    lv_obj_align(btn_calibration, LV_ALIGN_TOP_LEFT, 240, 103);
    lv_obj_set_style_border_width(btn_calibration, 1, LV_PART_MAIN); /* 设置边框宽度 */
    lv_obj_set_style_border_color(btn_calibration, lv_color_hex(0x000000), LV_PART_MAIN); /* 设置边框颜色 */
    lv_obj_set_style_radius(btn_calibration, 10, LV_PART_MAIN); /* 设置圆角 */
    //lv_obj_set_style_bg_color(btn_calibration, lv_color_hex(0xffffff), LV_PART_MAIN);
    lv_obj_set_style_shadow_width(btn_calibration, 0, LV_PART_MAIN);
    lv_obj_add_event_cb(btn_calibration, btn_calibration_event_cb, LV_EVENT_ALL, NULL);

    LV_FONT_DECLARE(heiFont16_1);
    label_btn_calibration = lv_label_create(btn_calibration);
    lv_obj_set_style_text_font(label_btn_calibration, &heiFont16_1, LV_STATE_DEFAULT);
    if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
    {
        lv_label_set_text(label_btn_calibration, "触屏校准");
    }
    else if(system_data.system.language == LANGUAGE_ENGLISH)
    {
        lv_label_set_text(label_btn_calibration, "Screen calibration");
    }
    lv_obj_center(label_btn_calibration);
    lv_obj_set_style_text_color(label_btn_calibration, lv_color_hex(0x000000), LV_STATE_DEFAULT);

    //恢复出厂
    btn_factory_reset = lv_btn_create(set_system_obj);
    lv_obj_set_size(btn_factory_reset, 220, 30);
    lv_obj_align(btn_factory_reset, LV_ALIGN_TOP_LEFT, 240, 145);
    lv_obj_set_style_border_width(btn_factory_reset, 1, LV_PART_MAIN); /* 设置边框宽度 */
    lv_obj_set_style_border_color(btn_factory_reset, lv_color_hex(0x000000), LV_PART_MAIN); /* 设置边框颜色 */
    lv_obj_set_style_radius(btn_factory_reset, 10, LV_PART_MAIN); /* 设置圆角 */
    //lv_obj_set_style_bg_color(btn_calibration, lv_color_hex(0xffffff), LV_PART_MAIN);
    lv_obj_set_style_shadow_width(btn_factory_reset, 0, LV_PART_MAIN);
    lv_obj_add_event_cb(btn_factory_reset, btn_factory_reset_event_cb, LV_EVENT_ALL, NULL);

    LV_FONT_DECLARE(heiFont16_1);
    label_btn_factory_reset = lv_label_create(btn_factory_reset);
    lv_obj_set_style_text_font(label_btn_factory_reset, &heiFont16_1, LV_STATE_DEFAULT);
    if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
    {
        lv_label_set_text(label_btn_factory_reset, "恢复出厂");
    }
    else if(system_data.system.language == LANGUAGE_ENGLISH)
    {
        lv_label_set_text(label_btn_factory_reset, "Factory reset");
    }
    lv_obj_center(label_btn_factory_reset);
    lv_obj_set_style_text_color(label_btn_factory_reset, lv_color_hex(0x000000), LV_STATE_DEFAULT);


    LV_FONT_DECLARE(heiFont16_1);
    label_bluetooth_transfer = lv_label_create(set_system_obj);
    lv_obj_set_style_text_font(label_bluetooth_transfer, &heiFont16_1, LV_STATE_DEFAULT);
    lv_obj_set_style_text_color(label_bluetooth_transfer, lv_color_hex(0x000000), LV_STATE_DEFAULT);
    if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
    {
        lv_label_set_text(label_bluetooth_transfer, "蓝牙传输");
    }
    else if(system_data.system.language == LANGUAGE_ENGLISH)
    {
        lv_label_set_text(label_bluetooth_transfer, "Bluetooth transmission");
    }
    lv_obj_align(label_bluetooth_transfer, LV_ALIGN_TOP_LEFT, 240, 190);

    sw_label_bluetooth_transfer = lv_switch_create(set_system_obj);
    lv_obj_set_pos(sw_label_bluetooth_transfer, 320, 184);
    lv_obj_set_width(sw_label_bluetooth_transfer, 48);
    lv_obj_set_height(sw_label_bluetooth_transfer, 23);
    lv_obj_set_style_bg_color(sw_label_bluetooth_transfer, lv_color_hex(0x00ff00), LV_STATE_CHECKED | LV_PART_INDICATOR);

}

/*
2,20   70,10       160,20  230,10      318,20  390,10
2,70   70,60       160,70, 230,60      318,70  390,60
2,120  70,110      160,120,230,110     318,120 390,110
2,170  70,160      160,170,230,160     318,170 390,160
*/
static void set_tv_about_create(lv_obj_t* parent)
{
    char tempBuf[64]={0};
    printf("set_tv_about_create\n");
    buzzer_enable = 1;
    lv_obj_set_style_pad_all(parent, 0, LV_STATE_DEFAULT);
    lv_obj_clear_flag(parent, LV_OBJ_FLAG_SCROLLABLE);
    lv_obj_t* set_about_obj = lv_obj_create(parent);
    lv_obj_set_size(set_about_obj, 480, 224);
    lv_obj_align(set_about_obj, LV_ALIGN_TOP_LEFT, 0, 0);
    lv_obj_set_style_border_width(set_about_obj, 2, LV_STATE_DEFAULT); /* 设置边框宽度 */
    lv_obj_set_style_radius(set_about_obj, 0, LV_STATE_DEFAULT); /* 设置圆角 */
    lv_obj_set_style_bg_opa(set_about_obj, LV_OPA_TRANSP, LV_PART_MAIN);
    lv_obj_set_style_pad_all(set_about_obj, 0, LV_STATE_DEFAULT);
    lv_obj_clear_flag(set_about_obj, LV_OBJ_FLAG_SCROLLABLE);


    LV_FONT_DECLARE(heiFont16_1);
    label_device_type = lv_label_create(set_about_obj);
    lv_obj_set_style_text_font(label_device_type, &heiFont16_1, LV_STATE_DEFAULT);
    lv_obj_set_style_text_color(label_device_type, lv_color_hex(0x000000), LV_STATE_DEFAULT);

    if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
    {
         lv_label_set_text(label_device_type, "设备型号：X1PLUS");
    }
    else if(system_data.system.language == LANGUAGE_ENGLISH)
    {
         lv_label_set_text(label_device_type, "Model：X1PLUS");
    }
    lv_obj_align(label_device_type, LV_ALIGN_TOP_LEFT, 2, 20);


    LV_FONT_DECLARE(heiFont16_1);
    label_hardware_version = lv_label_create(set_about_obj);
    lv_obj_set_style_text_font(label_hardware_version, &heiFont16_1, LV_STATE_DEFAULT);
    lv_obj_set_style_text_color(label_hardware_version, lv_color_hex(0x000000), LV_STATE_DEFAULT);
    if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
    {
        lv_label_set_text(label_hardware_version, "硬件版本：XMB127PH1-ZC-V1.1");
    }
    else if(system_data.system.language == LANGUAGE_ENGLISH)
    {
        lv_label_set_text(label_hardware_version, "Hardware version：XMB127PH1-ZC-V1.1");
    }

    lv_obj_align(label_hardware_version, LV_ALIGN_TOP_LEFT, 2, 70);


    LV_FONT_DECLARE(heiFont16_1);
    label_manufacturer_information = lv_label_create(set_about_obj);
    lv_obj_set_style_text_font(label_manufacturer_information, &heiFont16_1, LV_STATE_DEFAULT);
    lv_obj_set_style_text_color(label_manufacturer_information, lv_color_hex(0x000000), LV_STATE_DEFAULT);
    if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
    {
        lv_label_set_text(label_manufacturer_information, "厂商信息：XMB127PH1-ZC-V1.1");
    }
    else if(system_data.system.language == LANGUAGE_ENGLISH)
    {
        lv_label_set_text(label_manufacturer_information, "Manufacturer：XMB127PH1-ZC-V1.1");
    }
    lv_obj_align(label_manufacturer_information, LV_ALIGN_TOP_LEFT, 2, 120);



    LV_FONT_DECLARE(heiFont16_1);
    label_software_version = lv_label_create(set_about_obj);
    lv_obj_set_style_text_font(label_software_version, &heiFont16_1, LV_STATE_DEFAULT);
    lv_obj_set_style_text_color(label_software_version, lv_color_hex(0x000000), LV_STATE_DEFAULT);
    if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
    {
        sprintf(tempBuf,"软件版本：%s",SOFTWARE_VERSION);
        lv_label_set_text(label_software_version, tempBuf);
    }
    else if(system_data.system.language == LANGUAGE_ENGLISH)
    {
        sprintf(tempBuf,"Software version%s",SOFTWARE_VERSION);
        lv_label_set_text(label_software_version, tempBuf);
    }
    lv_obj_align(label_software_version, LV_ALIGN_TOP_LEFT, 240, 20);


    //检查更新
    btn_check_updates = lv_btn_create(set_about_obj);
    lv_obj_set_size(btn_check_updates, 220, 30);
    lv_obj_align(btn_check_updates, LV_ALIGN_TOP_LEFT, 240, 58);
    lv_obj_set_style_border_width(btn_check_updates, 1, LV_PART_MAIN); /* 设置边框宽度 */
    lv_obj_set_style_border_color(btn_check_updates, lv_color_hex(0x000000), LV_PART_MAIN); /* 设置边框颜色 */
    lv_obj_set_style_radius(btn_check_updates, 10, LV_PART_MAIN); /* 设置圆角 */
    //lv_obj_set_style_bg_color(btn_calibration, lv_color_hex(0xffffff), LV_PART_MAIN);
    lv_obj_set_style_shadow_width(btn_check_updates, 0, LV_PART_MAIN);
    lv_obj_add_event_cb(btn_check_updates, btn_check_updates_event_cb, LV_EVENT_ALL, NULL);

    LV_FONT_DECLARE(heiFont16_1);
    label_btn_check_updates = lv_label_create(btn_check_updates);
    lv_obj_set_style_text_font(label_btn_check_updates, &heiFont16_1, LV_STATE_DEFAULT);
    if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
    {
        lv_label_set_text(label_btn_check_updates, "检查更新");
    }
    else if(system_data.system.language == LANGUAGE_ENGLISH)
    {
        lv_label_set_text(label_btn_check_updates, "Check for updates");
    }
    lv_obj_center(label_btn_check_updates);
    lv_obj_set_style_text_color(label_btn_check_updates, lv_color_hex(0x000000), LV_STATE_DEFAULT);

    //开发者模式
    btn_developer_model = lv_btn_create(set_about_obj);
    lv_obj_set_size(btn_developer_model, 220, 30);
    lv_obj_align(btn_developer_model, LV_ALIGN_TOP_LEFT, 240, 110);
    lv_obj_set_style_border_width(btn_developer_model, 1, LV_PART_MAIN); /* 设置边框宽度 */
    lv_obj_set_style_border_color(btn_developer_model, lv_color_hex(0x000000), LV_PART_MAIN); /* 设置边框颜色 */
    lv_obj_set_style_radius(btn_developer_model, 10, LV_PART_MAIN); /* 设置圆角 */
    lv_obj_set_style_shadow_width(btn_developer_model, 0, LV_PART_MAIN);
    lv_obj_add_event_cb(btn_developer_model, btn_developer_model_event_cb, LV_EVENT_ALL, NULL);

    LV_FONT_DECLARE(heiFont16_1);
    label_btn_developer_model = lv_label_create(btn_developer_model);
    lv_obj_set_style_text_font(label_btn_developer_model, &heiFont16_1, LV_STATE_DEFAULT);
    if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
    {
        lv_label_set_text(label_btn_developer_model, "开发者模式");
    }
    else if(system_data.system.language == LANGUAGE_ENGLISH)
    {
        lv_label_set_text(label_btn_developer_model, "Developer Mode");
    }
    lv_obj_center(label_btn_developer_model);
    lv_obj_set_style_text_color(label_btn_developer_model, lv_color_hex(0x000000), LV_STATE_DEFAULT);

}

void tabview_event_cb(lv_event_t * e)
{
    lv_obj_t * tabview = lv_event_get_target(e); // 获取触发事件的对象（即tabview）

    buzzer_enable = 1;

    // 获取当前激活的标签页索引
    uint16_t active_tab_id = lv_tabview_get_tab_act(tabview);

    // 根据索引执行你需要的操作
    switch(active_tab_id) {
        case 0:
            printf("切换到标签页 1\n");
            // 例如：更新页面1的内容
            break;
        case 1:
            printf("切换到标签页 2\n");
            // 例如：从网络加载页面2的数据
            break;
        case 2:
            printf("切换到标签页 3\n");
            // 例如：刷新页面3的图表
            break;
        default:
            break;
    }
}

static void button_set_event_cb(lv_event_t* e)
{
    lv_event_code_t code;
    code = lv_event_get_code(e);
    if ((code == LV_EVENT_CLICKED)&&(print_status == 0))
    {
        printf("set\n");
        buzzer_enable = 1;
 
        set_tv = lv_tabview_create(lv_scr_act(), LV_DIR_TOP, 24);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            set_tv_print = lv_tabview_add_tab(set_tv, "打印设置");
            set_tv_system = lv_tabview_add_tab(set_tv, "系统设置");
            set_tv_about = lv_tabview_add_tab(set_tv, "关于本机");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            set_tv_print = lv_tabview_add_tab(set_tv, "Print setup");
            set_tv_system = lv_tabview_add_tab(set_tv, "System setup");
            set_tv_about = lv_tabview_add_tab(set_tv, "About this machine");
        }

        lv_obj_add_event_cb(set_tv, tabview_event_cb, LV_EVENT_VALUE_CHANGED, NULL);

        set_tv_print_create(set_tv_print);
        set_tv_system_create(set_tv_system);
        set_tv_about_create(set_tv_about);

        set_tv_bottom_bg = lv_obj_create(lv_scr_act());
        lv_obj_set_size(set_tv_bottom_bg, 480, 24);
        lv_obj_align(set_tv_bottom_bg, LV_ALIGN_TOP_LEFT, 0, 248);
        lv_obj_set_style_border_width(set_tv_bottom_bg, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
        lv_obj_set_style_radius(set_tv_bottom_bg, 0, LV_STATE_DEFAULT); /* 设置圆角 */
        lv_obj_set_style_bg_color(set_tv_bottom_bg, lv_color_hex(0x28536a), LV_STATE_DEFAULT);
        lv_obj_remove_style(set_tv_bottom_bg, 0, LV_PART_SCROLLBAR);

        LV_FONT_DECLARE(heiFont16_1);
        set_tv_bottom_return = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(set_tv_bottom_return, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(set_tv_bottom_return, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(set_tv_bottom_return,  "返回");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(set_tv_bottom_return, "Return");
        }
        lv_obj_align(set_tv_bottom_return, LV_ALIGN_TOP_LEFT, 140, 252);


        LV_IMG_DECLARE(get_back);
        imgbtn_set_tv_bottom_return = lv_imgbtn_create(lv_scr_act());
        lv_imgbtn_set_src(imgbtn_set_tv_bottom_return, LV_IMGBTN_STATE_RELEASED, NULL, &get_back, NULL);
        lv_obj_set_size(imgbtn_set_tv_bottom_return, get_back.header.w, get_back.header.h);
        lv_obj_align(imgbtn_set_tv_bottom_return, LV_ALIGN_TOP_LEFT, 180, 250);
        lv_obj_add_event_cb(imgbtn_set_tv_bottom_return, imgbtn_set_tv_bottom_return_event_cb, LV_EVENT_CLICKED, NULL);

        LV_IMG_DECLARE(confirm);
        imgbtn_set_tv_bottom_confirm = lv_imgbtn_create(lv_scr_act());
        lv_imgbtn_set_src(imgbtn_set_tv_bottom_confirm, LV_IMGBTN_STATE_RELEASED, NULL, &confirm, NULL);
        lv_obj_set_size(imgbtn_set_tv_bottom_confirm, get_back.header.w, get_back.header.h);
        lv_obj_align(imgbtn_set_tv_bottom_confirm, LV_ALIGN_TOP_LEFT, 250, 250);
        lv_obj_add_event_cb(imgbtn_set_tv_bottom_confirm, imgbtn_set_tv_bottom_confirm_event_cb, LV_EVENT_CLICKED, NULL);

        LV_FONT_DECLARE(heiFont16_1);
        label_set_tv_bottom_confirm = lv_label_create(lv_scr_act());
        lv_obj_set_style_text_font(label_set_tv_bottom_confirm, &heiFont16_1, LV_STATE_DEFAULT);
        lv_obj_set_style_text_color(label_set_tv_bottom_confirm, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
        if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
        {
            lv_label_set_text(label_set_tv_bottom_confirm,  "确定");
        }
        else if(system_data.system.language == LANGUAGE_ENGLISH)
        {
            lv_label_set_text(label_set_tv_bottom_confirm, "Confirm");
        }
        lv_obj_align(label_set_tv_bottom_confirm, LV_ALIGN_TOP_LEFT, 277, 252);
    }
}

extern int LoadConfigFile(const char* pconfName);
extern int GetConfigIntDefault(const char* p_itemname, const int def);


void get_system_data(void)
{
    lv_fs_file_t lv_file;
    lv_fs_res_t  lv_res;
    uint32_t bw;

    lv_res = lv_fs_open(&lv_file, "A:/root/system_data.dat", LV_FS_MODE_RD);
    if (lv_res != LV_FS_RES_OK)
    {
        printf("LVGL FS open error\n");
    }
    else
    {
        printf("LVGL FS open Ok\n");
        memset(&system_data, 0, sizeof(system_data));
        lv_res = lv_fs_read(&lv_file, &system_data, sizeof(system_data), &bw);
        if (lv_res != LV_FS_RES_OK)
        {
            printf("lv_fs_read error\n");
        }
        else
        {
            printf("init=%d\n", system_data.init);
            printf("concentration=%d\n", system_data.print.concentration);
            printf("nozzle=%d\n", system_data.print.nozzle);
            printf("width=%d\n", system_data.print.width);
            lv_fs_close(&lv_file);
        }
    }

    if (system_data.init == 0)
    {
        system_data.init = 1;
        system_data.print.concentration = 1;
        system_data.print.nozzle = 0;
        system_data.print.width = 1;
        system_data.print.print_voltage = 0;
        system_data.print.flash_set = 5;
        system_data.system.brightness = 70;
        system_data.system.buzzer = 1;
        lv_res = lv_fs_open(&lv_file, "A:/root/system_data.dat", LV_FS_MODE_WR);
        if (lv_res != LV_FS_RES_OK)
        {
            printf("LVGL FS open error\n");
        }
        else
        {
            printf("LVGL FS open error\n");   
            lv_fs_write(&lv_file, &system_data, sizeof(system_data), &bw);
            if (lv_res != LV_FS_RES_OK)
            {
                printf("lv_fs_write error\n");
            }
            else
            {
                printf("lv_fs_write ok\n");
                lv_fs_close(&lv_file);
            }
        }
    }

    lv_res = lv_fs_open(&lv_file, "A:/root/system_data.dat", LV_FS_MODE_RD);
    if (lv_res != LV_FS_RES_OK)
    {
        printf("LVGL FS open error\n");
    }
    else
    {
        printf("LVGL FS open Ok\n");
        memset(&system_data, 0, sizeof(system_data));
        lv_res = lv_fs_read(&lv_file, &system_data, sizeof(system_data), &bw);
        if (lv_res != LV_FS_RES_OK)
        {
            printf("lv_fs_read error\n");
        }
        else
        {
            printf("init=%d\n", system_data.init);
            printf("concentration=%d\n", system_data.print.concentration);
            printf("nozzle=%d\n", system_data.print.nozzle);
            printf("width=%d\n", system_data.print.width);
            lv_fs_close(&lv_file);
        }
    }
}



void get_config_data(void)
{
    lv_fs_file_t lv_file;
    lv_fs_res_t  lv_res;
    uint32_t bw;
    int retvalue;
    unsigned char databuf[20]={0};
    int i;
    unsigned char *p = NULL;
    //int num;
    unsigned char crc;

    lv_res = lv_fs_open(&lv_file, "A:/media/system_file/config.dat", LV_FS_MODE_RD);
    if (lv_res != LV_FS_RES_OK)
    {
        printf("LVGL FS open error\n");
    }
    else
    {
        printf("LVGL FS open Ok\n");
        memset(g_authorization_buf, 0, sizeof(g_authorization_buf));
        lv_res = lv_fs_read(&lv_file, g_authorization_buf, sizeof(g_authorization_buf), &bw);
        if (lv_res != LV_FS_RES_OK)
        {
            printf("lv_fs_read error\n");
        }
        else
        {
#if 0
            unsigned char crc =  CRC8(g_authorization_buf,15);
            if(crc == g_authorization_buf[15])
            {
                 printf("g_authorization_buf ok\n");
            }
            else
            {
                memset(g_authorization_buf,0,sizeof(g_authorization_buf));
            }
#endif
            lv_fs_close(&lv_file);
        }
    }

    memset(msg, 0, MSG_SIZE);
    memset(&context, 0, sizeof(context));
    AES_set_key(&context, key, iv, AES_MODE_128);

    AES_convert_key(&context);
    memset((unsigned char *)&g_authorization,0,sizeof(g_authorization));
    AES_cbc_decrypt(&context, g_authorization_buf, (unsigned char *)&g_authorization, MSG_SIZE);

    for(i=0;i<16;i++)
    {
        printf("0x%x ",g_authorization_buf[i]);
    }

    printf("\n\r");

    p = (unsigned char *)&g_authorization;

    for(i=0;i<16;i++)
    {
        printf("0x%x ",*(p+i));
    }

    printf("\n\r");

    read_writer_rtc_enable = 0;

    memset(databuf,0,sizeof(databuf));
    databuf[0] = 0x04;
    
    retvalue = read(fd_rc522, databuf, 16);
    if(retvalue < 0)
    {
        printf("fd_rc522 Failed!\r\n");
        //close(fd_bm8563);
        read_card_info_result = 0;
    }
    else
    {
        printf("读卡密文\n\r");
        for(i=0;i<16;i++)
        {
            printf("0x%x ",databuf[i]);
        }
        printf("\n\r");

        memset(msg, 0, MSG_SIZE);
        memset(&context, 0, sizeof(context));
        AES_set_key(&context, key, iv, AES_MODE_128);

        AES_convert_key(&context);
        memset((char *)&card_info_newest,0,sizeof(card_info_newest));
        AES_cbc_decrypt(&context, databuf, (unsigned char *)&card_info_newest, MSG_SIZE);

        p = (unsigned char *)&card_info_newest;
        printf("读卡明文\n\r");
        for(i=0;i<16;i++)
        {
            printf("0x%x ",*(p+i));
        }
        printf("\n\r");

        crc =  CRC8(p,16);
        if(crc == card_info_newest.crc)
        {
            printf("databuf ok\n");
            read_card_info_result = 1;
        }
        else
        {
            read_card_info_result = 0;
        }
    }

    read_writer_rtc_enable = 1;
}



void check_hp45(void)
{
    int retvalue;
    unsigned char databuf[20]={0};
    //int i;
    unsigned char *p = NULL;
    //int num;
    unsigned char crc;

    read_writer_rtc_enable = 0;

    memset(databuf,0,sizeof(databuf));
    databuf[0] = 0x04;
    
    retvalue = read(fd_rc522, databuf, 16);
    if(retvalue < 0)
    {
        printf("fd_rc522 Failed!\r\n");
        //close(fd_bm8563);
        read_card_info_result = 0;
    }
    else
    {
        //printf("读卡密文\n\r");
        //for(i=0;i<16;i++)
        //{
        //    printf("0x%x ",databuf[i]);
        //}
        //printf("\n\r");

        memset(msg, 0, MSG_SIZE);
        memset(&context, 0, sizeof(context));
        AES_set_key(&context, key, iv, AES_MODE_128);

        AES_convert_key(&context);
        memset((char *)&card_info_newest,0,sizeof(card_info_newest));
        AES_cbc_decrypt(&context, databuf, (unsigned char *)&card_info_newest, MSG_SIZE);

        p = (unsigned char *)&card_info_newest;
        //printf("读卡明文\n\r");
        //for(i=0;i<16;i++)
        //{
        //    printf("0x%x ",*(p+i));
        //}
        //printf("\n\r");

        crc =  CRC8(p,16);
        if(crc == card_info_newest.crc)
        {
            //printf("databuf ok\n");
            read_card_info_result = 1;
        }
        else
        {
            read_card_info_result = 0;
        }
    }

    read_writer_rtc_enable = 1;
}



void set_system_data(void)
{
    lv_fs_file_t lv_file;
    lv_fs_res_t  lv_res;
    uint32_t bw;

    lv_res = lv_fs_open(&lv_file, "A:/root/system_data.dat", LV_FS_MODE_WR);
    if (lv_res != LV_FS_RES_OK)
    {
        printf("LVGL FS open error\n");
    }
    else
    {
        printf("LVGL FS open Ok\n");
        lv_fs_write(&lv_file, &system_data, sizeof(system_data), &bw);
        if (lv_res != LV_FS_RES_OK)
        {
            printf("lv_fs_write error\n");
        }
        else
        {
            printf("lv_fs_write ok\n");
            lv_fs_close(&lv_file);
        } 
    }

    lv_res = lv_fs_open(&lv_file, "A:/root/system_data.dat", LV_FS_MODE_RD);
    if (lv_res != LV_FS_RES_OK)
    {
        printf("LVGL FS open error\n");
    }
    else
    {
        printf("LVGL FS open Ok\n");
        memset(&system_data, 0, sizeof(system_data));
        lv_res = lv_fs_read(&lv_file, &system_data, sizeof(system_data), &bw);
        if (lv_res != LV_FS_RES_OK)
        {
            printf("lv_fs_read error\n");
        }
        else
        {
            printf("init=%d\n", system_data.init);
            printf("concentration=%d\n", system_data.print.concentration);
            printf("nozzle=%d\n", system_data.print.nozzle);
            printf("width=%d\n", system_data.print.width);
            lv_fs_close(&lv_file);
        }
    }
}


// 检查文件扩展名是否为.bmp（不区分大小写）
int is_bmp_png_file(const char *filename) {
    const char *dot = strrchr(filename, '.');
    if (!dot || dot == filename) 
    {
        return 0;
    }

    if(strcasecmp(dot, ".bmp") == 0)
    {
        return 1;
    }
    else if(strcasecmp(dot, ".png") == 0)
    {
        return 1;
    }
    else
    {
        return 0;
    }
}

// 递归删除目录中的所有BMP文件
//void delete_bmp_files(const char *dir_path) 
void delete_bmp_files(void) 
{
    DIR *dir;
    struct dirent *entry;
    struct stat statbuf;
    char path[300];

    if ((dir = opendir("/media/qr_bar_bmp")) == NULL) {
        perror("无法打开目录");
        return;
    }

    while ((entry = readdir(dir)) != NULL) 
    {
        // 跳过当前目录和上级目录
        if (strcmp(entry->d_name, ".") == 0 || strcmp(entry->d_name, "..") == 0) {
            continue;
        }

        // 构建完整路径
        snprintf(path, sizeof(path), "%s/%s", "/media/qr_bar_bmp", entry->d_name);

        // 获取文件信息
        if (lstat(path, &statbuf) == -1) {
            perror("无法获取文件信息");
            continue;
        }

         if (S_ISREG(statbuf.st_mode)) 
         {
            // 如果是普通文件，检查是否为BMP文件
            if (is_bmp_png_file(entry->d_name)) 
            {
                printf("正在删除: %s\n", path);
                if (unlink(path) == -1) 
                {
                    perror("删除文件失败");
                }
            }
         }
#if 0
        if (S_ISDIR(statbuf.st_mode)) {
            // 如果是目录，递归处理
            delete_bmp_files(path);
        } else if (S_ISREG(statbuf.st_mode)) {
            // 如果是普通文件，检查是否为BMP文件
            if (is_bmp_file(entry->d_name)) {
                printf("正在删除: %s\n", path);
                if (unlink(path) == -1) {
                    perror("删除文件失败");
                }
            }
        }
#endif
    }

    closedir(dir);
}



void recovery_data(void)
{
    //lv_event_code_t code;
    int win_content_child_num = 0;
    int i;
    //char file_name[128]={ 0 };
    //char temp_typeface[128] = { 0 };
    int word_space = 0;
    //int word_size = 0;
    //int x_size = 0;
    //int y_size = 0;
    struct zint_symbol* my_symbol = NULL;
    int str_len;
    //int width_len;
    int height_len;
    int width, height, channels;
    unsigned char* pdata = NULL; 
    unsigned char* pnew_data = NULL;
    lv_obj_t* img = NULL;
    lv_obj_t* temp_obj = NULL;
    char tempString[32] = { 0 };
    lv_point_t text_size;
    lv_obj_t* label1; 
    char bmp_name[64]={0};
    char bmp_name_1[100]={0};  
    char date_time_str[64]={ 0 };
    lv_obj_t* img_obj = NULL;
    lv_img_t* img_1 = NULL;
    lv_img_dsc_t* img_dsc = NULL;
    unsigned char * data = NULL;
    int success;
    lv_img_header_t header;
    lv_res_t res;
    int now_year;
    int now_month;
    int now_day;
    int end_year;
    int end_month;
    int end_day;


    memset(&data_structure, 0, sizeof(data_structure));

    // 打开文件以写入二进制数据
    FILE* file = fopen("/media/system_file/data_structure.dat", "rb");
    if (file == NULL) 
    {
        perror("Failed to open file");
    }
    else
    {
        // 将结构体写入文件
        size_t written = fread(&data_structure, sizeof(data_structure), 1, file);
        if (written != 1) {
            perror("Failed to read data to file");
            fclose(file);
            //return EXIT_FAILURE;
        }
        else
        {
            // 关闭文件
            fclose(file);

            for(i = 0; i < NEW_TEXT_MAX_NUMBER; i++)
            {
                printf("data_structure[%d].type=%d\n\r",i,data_structure[i].type);
                if(data_structure[i].type == 0)
                {
                    break;
                }
                else
                {
                    switch(data_structure[i].type)
                    {
                        case TYPE_WORD:
                        {
                            temp_obj = lv_obj_create(win_content);          
                            //sprintf(temp_typeface,"/media/%s", typeface_buf[data_structure[i].data.word.typeface]);
                            //data_structure[i].data.word.info.name = temp_typeface;
                            //printf("%s\n\r", temp_typeface);
                            data_structure[i].data.word.info.weight = data_structure[i].data.word.size;
                            data_structure[i].data.word.info.style = data_structure[i].data.word.italic_bold;
                            //lv_ft_font_init(&data_structure[i].data.word.info);

                            printf("typeface=%d\n\r", data_structure[i].data.word.typeface);
                            lv_font_t* temp_font = font_list_get(data_structure[i].data.word.typeface, data_structure[i].data.word.size, data_structure[i].data.word.info.style);
                            lv_txt_get_size(&text_size, data_structure[i].data.word.text, temp_font, data_structure[i].data.word.space, 0, LV_COORD_MAX, LV_TEXT_FLAG_NONE);  

                            //lv_txt_get_size(&text_size, data_structure[i].data.word.text, data_structure[i].data.word.info.font, 0, 0, LV_COORD_MAX, LV_TEXT_FLAG_NONE);
 
                            lv_obj_set_style_bg_opa(temp_obj, LV_OPA_TRANSP, 0);
                            lv_obj_set_style_border_width(temp_obj, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */

                            lv_obj_add_event_cb(temp_obj, drag_event_handler, LV_EVENT_PRESSING, NULL);
                            lv_obj_add_event_cb(temp_obj, drag_event_handler, LV_EVENT_FOCUSED, NULL);
                            lv_obj_add_event_cb(temp_obj, drag_event_handler, LV_EVENT_DEFOCUSED, NULL);
                            lv_obj_clear_flag(temp_obj, LV_OBJ_FLAG_SCROLLABLE);

                            lv_style_init(&data_structure[i].data.word.style);
                            lv_style_set_text_font(&data_structure[i].data.word.style, temp_font);
                            word_space = data_structure[i].data.word.space;
                            printf("x=%u y=%u\n\r", text_size.x, text_size.y);

                            //x_size = text_size.x + text_size.x / text_size.y * word_space * 2;
                            //printf("x_size=%d\n\r", x_size);

                            lv_obj_set_size(temp_obj, text_size.x, text_size.y);
                            lv_obj_set_style_transform_angle(temp_obj, data_structure[i].data.word.spin*10, 0);

                            if (data_structure[i].data.word.spin != 0)
                            {
                                lv_obj_align(temp_obj, LV_ALIGN_TOP_LEFT, text_size.x, text_size.y);
                            }

                            lv_style_set_text_letter_space(&data_structure[i].data.word.style, word_space);
                            label1 = lv_label_create(temp_obj);
                            lv_obj_add_style(label1, &data_structure[i].data.word.style, 0);
                            lv_label_set_text(label1, data_structure[i].data.word.text);
                            lv_obj_center(label1);     
                            lv_obj_align(temp_obj, LV_ALIGN_OUT_TOP_LEFT, data_structure[i].x, data_structure[i].y);
                            break;
                        }
                        case TYPE_DATE:
                        {
                            temp_obj = lv_obj_create(win_content);          
                            //sprintf(temp_typeface,"/media/%s", typeface_buf[data_structure[i].data.date_time.typeface]);
                            //data_structure[i].data.date_time.info.name = temp_typeface;
                            //printf("%s\n\r", temp_typeface);
                            data_structure[i].data.date_time.info.weight = data_structure[i].data.date_time.size;
                            data_structure[i].data.date_time.info.style = data_structure[i].data.date_time.italic_bold;
                            //lv_ft_font_init(&data_structure[i].data.date_time.info);
                            //lv_txt_get_size(&text_size, data_structure[i].data.date_time.text, data_structure[i].data.date_time.info.font, 0, 0, LV_COORD_MAX, LV_TEXT_FLAG_NONE);
                            
                            printf("typeface=%d\n\r", data_structure[i].data.date_time.typeface);
                            lv_font_t* temp_font = font_list_get(data_structure[i].data.word.typeface, data_structure[i].data.date_time.size, data_structure[i].data.date_time.info.style);
                            lv_txt_get_size(&text_size, data_structure[i].data.date_time.text, temp_font, data_structure[i].data.date_time.space, 0, LV_COORD_MAX, LV_TEXT_FLAG_NONE);  

                            lv_obj_set_style_bg_opa(temp_obj, LV_OPA_TRANSP, 0);
                            lv_obj_set_style_border_width(temp_obj, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */

                            lv_obj_add_event_cb(temp_obj, drag_event_handler, LV_EVENT_PRESSING, NULL);
                            lv_obj_add_event_cb(temp_obj, drag_event_handler, LV_EVENT_FOCUSED, NULL);
                            lv_obj_add_event_cb(temp_obj, drag_event_handler, LV_EVENT_DEFOCUSED, NULL);
                            lv_obj_clear_flag(temp_obj, LV_OBJ_FLAG_SCROLLABLE);

                            lv_style_init(&data_structure[i].data.date_time.style);
                            lv_style_set_text_font(&data_structure[i].data.date_time.style, temp_font);
                            word_space = data_structure[i].data.date_time.space;
                            printf("x=%u y=%u\n\r", text_size.x, text_size.y);

                            //x_size = text_size.x + text_size.x / text_size.y * word_space * 2;
                            //printf("x_size=%d\n\r", x_size);

                            lv_obj_set_size(temp_obj, text_size.x, text_size.y);
                            lv_obj_set_style_transform_angle(temp_obj, data_structure[i].data.date_time.spin*10, 0);

                            if (data_structure[i].data.word.spin != 0)
                            {
                                lv_obj_align(temp_obj, LV_ALIGN_TOP_LEFT, text_size.x, text_size.y);
                            }

                            lv_style_set_text_letter_space(&data_structure[i].data.date_time.style, word_space);
                            label1 = lv_label_create(temp_obj);
                            lv_obj_add_style(label1, &data_structure[i].data.date_time.style, 0);


                            if(data_structure[i].data.date_time.date_or_time == 0)
                            {
                                switch(data_structure[i].data.date_time.date_or_time_type)
                                {
                                    case 0:
                                        sprintf(date_time_str, "%04d/%02d/%02d", 2000 + g_system_time[0], g_system_time[1], g_system_time[2]);
                                        break;
                                    case 1:
                                        sprintf(date_time_str, "%02d/%02d/%02d", g_system_time[0], g_system_time[1], g_system_time[2]);
                                        break;
                                    case 2:
                                        sprintf(date_time_str, "%04d-%02d-%02d", 2000 + g_system_time[0], g_system_time[1], g_system_time[2]);
                                        break;
                                    case 3:
                                        sprintf(date_time_str, "%02d-%02d-%02d", g_system_time[0], g_system_time[1], g_system_time[2]);
                                        break;
                                    case 4:
                                        sprintf(date_time_str, "%04d.%02d.%02d", 2000 + g_system_time[0], g_system_time[1], g_system_time[2]);
                                        break;
                                    case 5:
                                        sprintf(date_time_str, "%02d.%02d.%02d", g_system_time[0], g_system_time[1], g_system_time[2]);
                                        break;
                                    case 6:
                                        sprintf(date_time_str, "%02d/%02d/%04d", g_system_time[2],  g_system_time[1], 2000 + g_system_time[0]);
                                        break;
                                    case 7:
                                        sprintf(date_time_str, "%02d/%02d/%02d", g_system_time[2],  g_system_time[1], g_system_time[0]);
                                        break;
                                    case 8:
                                        sprintf(date_time_str, "%02d-%02d-%04d", g_system_time[2],  g_system_time[1], 2000 + g_system_time[0]);
                                        break;
                                    case 9:
                                        sprintf(date_time_str, "%02d-%02d-%02d", g_system_time[2],  g_system_time[1], g_system_time[0]);
                                        break;
                                    case 10:
                                        sprintf(date_time_str, "%02d.%02d.%04d", g_system_time[2],  g_system_time[1], 2000 + g_system_time[0]);
                                        break;
                                    case 11:
                                        sprintf(date_time_str, "%02d.%02d.%02d", g_system_time[2],  g_system_time[1], g_system_time[0]);
                                        break;
                                    case 12:
                                        sprintf(date_time_str, "%04d年%02d月%02d日", 2000 + g_system_time[0], g_system_time[1], g_system_time[2]);
                                        break;
                                    case 13:
                                        sprintf(date_time_str, "%02d年%02d月%02d日", g_system_time[0], g_system_time[1], g_system_time[2]);
                                        break;
                                    case 14:
                                        sprintf(date_time_str, "%s",data_structure[i].data.date_time.text);
                                        break;
                                    case 15:
                                        sprintf(date_time_str, "延期");
                                        break;
                                }
                            }
                            else if(data_structure[i].data.date_time.date_or_time == 2)
                            {
                                now_year =  2000 + g_system_time[0];
                                now_month =  g_system_time[1];
                                now_day =  g_system_time[2];
                                calculateExpiryDate(now_year,now_month,now_day,data_structure[i].data.date_time.year,data_structure[i].data.date_time.month,data_structure[i].data.date_time.day,&end_year,&end_month,&end_day);
    
                                switch(data_structure[i].data.date_time.date_or_time_type)
                                {
                                    case 0:
                                        sprintf(date_time_str, "%04d/%02d/%02d", end_year, end_month, end_day);
                                        break;
                                    case 1:
                                        sprintf(date_time_str, "%02d/%02d/%02d", end_year%100, end_month, end_day);
                                        break;
                                    case 2:
                                        sprintf(date_time_str, "%04d-%02d-%02d", end_year, end_month, end_day);
                                        break;
                                    case 3:
                                        sprintf(date_time_str, "%02d-%02d-%02d", end_year%100, end_month, end_day);
                                        break;
                                    case 4:
                                        sprintf(date_time_str, "%04d.%02d.%02d", end_year, end_month, end_day);
                                        break;
                                    case 5:
                                        sprintf(date_time_str, "%02d.%02d.%02d", end_year%100, end_month, end_day);
                                        break;
                                    case 6:
                                        sprintf(date_time_str, "%02d/%02d/%04d", end_day,  end_month, end_year);
                                        break;
                                    case 7:
                                        sprintf(date_time_str, "%02d/%02d/%02d", end_day,  end_month, end_year%100);
                                        break;
                                    case 8:
                                        sprintf(date_time_str, "%02d-%02d-%04d", end_day,  end_month, end_year);
                                        break;
                                    case 9:
                                        sprintf(date_time_str, "%02d-%02d-%02d", end_day,  end_month, end_year%100);
                                        break;
                                    case 10:
                                        sprintf(date_time_str, "%02d.%02d.%04d", end_day,  end_month, end_year);
                                        break;
                                    case 11:
                                        sprintf(date_time_str, "%02d.%02d.%02d", end_day,  end_month, end_year%100);
                                        break;
                                    case 12:
                                        sprintf(date_time_str, "%04d年%02d月%02d日", end_year, end_month, end_day);
                                        break;
                                    case 13:
                                        sprintf(date_time_str, "%02d年%02d月%02d日", end_year%100, end_month, end_day);
                                        break;
                                    case 14:
                                        sprintf(date_time_str, "%s",data_structure[i].data.date_time.text);
                                        break;
                                    case 15:
                                        sprintf(date_time_str, "延期");
                                        break;
                                }
                            }
                            else
                            {
                                switch(data_structure[i].data.date_time.date_or_time_type)
                                {
                                    case 0:
                                        sprintf(date_time_str, "%02d:%02d:%02d", g_system_time[3], g_system_time[4], g_system_time[5]);
                                        break;
                                    case 1:
                                        sprintf(date_time_str, "%02d:%02d", g_system_time[3], g_system_time[4]);
                                        break;
                                    case 2:
                                        if (g_system_time[3] > 12)
                                        {
                                            sprintf(date_time_str, "%02d:%02d:%02d PM", g_system_time[3] - 12, g_system_time[4], g_system_time[5]);
                                        }
                                        else
                                        {
                                            sprintf(date_time_str, "%02d:%02d:%02d AM", g_system_time[3], g_system_time[4], g_system_time[5]);
                                        }
                                        break;
                                    case 3:
                                        if (g_system_time[3] > 12)
                                        {
                                            sprintf(date_time_str, "%02d:%02d PM", g_system_time[3] - 12, g_system_time[4]);
                                        }
                                        else
                                        {
                                            sprintf(date_time_str, "%02d:%02d AM", g_system_time[3], g_system_time[4]);
                                        }
                                        break;
                                    case 4:
                                        sprintf(date_time_str, "%02d时%02d分%02d秒", g_system_time[3], g_system_time[4], g_system_time[5]);
                                        break;
                                    case 5:
                                        sprintf(date_time_str, "%s",data_structure[i].data.date_time.text);
                                        break;
                                    case 6:
                                        sprintf(date_time_str, "延期");
                                        break;
                                }              
                            }

                            lv_label_set_text(label1, date_time_str);
                            lv_obj_center(label1);     
                            lv_obj_align(temp_obj, LV_ALIGN_OUT_TOP_LEFT, data_structure[i].x, data_structure[i].y);
                            break;
                        }
                        case TYPE_QR:
                        {
                            str_len = strlen(data_structure[i].data.qr_bar.text) + 1;
                            
                            temp_obj = lv_obj_create(win_content);
                            lv_obj_set_style_bg_opa(temp_obj, LV_OPA_TRANSP, 0);
                            lv_obj_set_style_border_width(temp_obj, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */

                            lv_obj_add_event_cb(temp_obj, drag_event_handler, LV_EVENT_PRESSING, NULL);
                            lv_obj_add_event_cb(temp_obj, drag_event_handler, LV_EVENT_FOCUSED, NULL);
                            lv_obj_add_event_cb(temp_obj, drag_event_handler, LV_EVENT_DEFOCUSED, NULL);
                            lv_obj_clear_flag(temp_obj, LV_OBJ_FLAG_SCROLLABLE);

                            my_symbol = ZBarcode_Create();

                            switch (data_structure[i].data.qr_bar.symbology)
                            {
                                case 0:
                                default:
                                {

                                    height_len = data_structure[i].data.qr_bar.height;
                                    my_symbol->symbology = BARCODE_QRCODE;
                                    my_symbol->scale = 1;
                                    my_symbol->option_1 = 2; //容错级别

                                    if(str_len < 20)
                                    {
                                        my_symbol->option_2 = 1;
                                    }
                                    else if(str_len < 38)
                                    {
                                        my_symbol->option_2 = 2;
                                    }
                                    else if(str_len < 61)
                                    {
                                        my_symbol->option_2 = 3;
                                    }
                                    else if(str_len < 90)
                                    {
                                        my_symbol->option_2 = 4;
                                    }
                                    else if(str_len < 122)
                                    {
                                        my_symbol->option_2 = 5;
                                    }
#if 0
                                    if( data_structure[i].data.qr_bar.figure== 1)
                                    {
                                        my_symbol->show_hrt = 1;
                                        memcpy(my_symbol->text,data_structure[i].data.qr_bar.text,str_len);
                                    }
#endif
                                    if (data_structure[i].data.qr_bar.borders == 1)
                                    {
                                        my_symbol->output_options = BARCODE_BOX;
                                        my_symbol->whitespace_width = 3;
                                        my_symbol-> whitespace_height = 3; 
                                        my_symbol-> border_width = 2;   /* Size of border in X-dimensions */
                                    }

                                    strcpy(my_symbol->outfile, "out.bmp");
                                    ZBarcode_Encode(my_symbol, (unsigned char *)data_structure[i].data.qr_bar.text, 0);

                                    ZBarcode_Print(my_symbol, 0);

                                    pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                                    printf("width=%d\n\r", width);
                                    printf("height=%d\n\r", height);
                                    printf("channels=%d\n\r", channels);
                        
                                    my_symbol->scale = (float)((float)150.0*(float)height_len/(float)QR_BAR_MAX_HIGHT/(float)width);

                                    //my_symbol->scale = (float)height_len/(float)height;
                                    printf("scale=%f\n\r", (double)my_symbol->scale);
            
                                    strcpy(my_symbol->outfile, "out.bmp");
                                    ZBarcode_Encode(my_symbol, (unsigned char *)data_structure[i].data.qr_bar.text, 0);

                                    ZBarcode_Print(my_symbol, 0);
                                    ZBarcode_Delete(my_symbol);
                                    stbi_image_free(pdata);
                            
                                    pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                                    printf("width=%d\n\r", width);
                                    printf("height=%d\n\r", height);
                                    printf("channels=%d\n\r", channels);

                                    lv_obj_set_size(temp_obj, width, height);

                                    pnew_data = (unsigned char*)lv_mem_alloc(width * height * 4); // 为32位数据分配内存
                                    if (!pnew_data) 
                                    {
                                        fprintf(stderr, "Memory allocation failed\n");
                                        stbi_image_free(pdata);
                                        return;
                                    }
                                    else
                                    {
                                        printf("lv_mem_alloc ok\n\r");
                                    }

                                    for (int y = 0; y < height; y++) 
                                    {
                                        for (int x = 0; x < width; x++) 
                                        {
                                            int index = y * width + x; // 计算当前像素在原始数据中的索引
                                            unsigned char color = pdata[index]; // 获取当前像素的灰度值（0或255）
                                            // 映射到RGBA值

                                            if (color == 0)
                                            {
                                                pnew_data[index * 4 + 0] = 0; // R
                                                pnew_data[index * 4 + 1] = 0; // G
                                                pnew_data[index * 4 + 2] = 0; // B
                                                pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                                            }
                                            else
                                            {
                                                pnew_data[index * 4 + 0] = 255; // R
                                                pnew_data[index * 4 + 1] = 255; // G
                                                pnew_data[index * 4 + 2] = 255; // B
                                                pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                                            }
                                        }
                                    }
#if 0
                                    stbi_write_bmp("QR_bar_code.bmp", width, height, 4, pnew_data);
                                    // 使用data进行图像处理...
                                    lv_mem_free(pnew_data);
                                    stbi_image_free(pdata); // 释放内存

                                    //显示图像
                                    img = lv_img_create(temp_obj);
                                    lv_img_set_src(img, "A:/root/QR_bar_code.bmp");
                                    lv_obj_center(img);
#endif

                                    sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.bmp",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                                    stbi_write_bmp(bmp_name, width, height, 4, pnew_data);
                                    // 使用data进行图像处理...
                                    lv_mem_free(pnew_data);
                                    stbi_image_free(pdata); // 释放内存

                                    data = stbi_load(bmp_name, &width, &height, &channels, 0);
                                    if (!data) 
                                    {
                                        printf("错误：无法加载图片 %s\n", bmp_name);
                                    }
                                    printf("图片加载成功：%dx%d，%d 通道\n", width, height, channels);

                                    sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.png",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                                    
                                    success = stbi_write_png(bmp_name, width, height, channels, data, width * channels);
                                    if (!success) 
                                    {
                                        printf("错误：保存 PNG 失败\n");
                                    } 
                                    else
                                    {
                                        printf("PNG 保存成功：%s\n", bmp_name);
                                    }

                                    // 释放内存
                                    stbi_image_free(data);

                                    //显示图像
                                    img = lv_img_create(temp_obj);
                                    sprintf(bmp_name_1,"A:%s",bmp_name);
                                    lv_img_set_src(img, bmp_name_1);
                                    lv_obj_center(img);

                                    res = lv_img_decoder_get_info(bmp_name_1, &header);  // 直接传入文件路径

                                    if (res == LV_RES_OK)
                                    {
                                        printf("PNG: %dx%d\n", header.w, header.h);
                                    }
                                    else
                                    {
                                        printf("lv_img_decoder_get_info error\n");
                                    }

                                    lv_img_set_zoom(img,data_structure[i].data.qr_bar.size);

                                    width = header.w * data_structure[i].data.qr_bar.size / 256;
                                    height = header.h * data_structure[i].data.qr_bar.size / 256;

                                    lv_obj_set_size(temp_obj, width, height);

                                    lv_obj_align(temp_obj, LV_ALIGN_OUT_TOP_LEFT, data_structure[i].x, data_structure[i].y);

                                    break;
                                }
                                case 1:
                                {
                            
        #if 0
                                width_len = atoi(lv_label_get_text(label_btn_addition_QR_code_width));

                                if (width_len > 100)
                                {
                                    width_len = 100;
                                }
                                else if (width_len < 50)
                                {
                                    width_len = 50;
                                }

                                printf("width_len=%u\n\r",width_len);

                                data_structure[win_content_child_num].data.qr_bar.width = width_len;
        #endif
                                    my_symbol->symbology = BARCODE_PDF417;
                                    height_len =  data_structure[i].data.qr_bar.height;
                                    my_symbol->scale = 1;


                #if 0
                                        if(lv_obj_has_state(sw_addition_QR_code_figure, LV_STATE_CHECKED) == 1)
                                        {
                                            my_symbol->show_hrt = 1;
                                            memcpy(my_symbol->text,lv_label_get_text(label_btn_addition_QR_code_text),strlen(lv_label_get_text(label_btn_addition_QR_code_text))+ 1);
                                            //figure_borders |= 0x01;
                                            data_structure[win_content_child_num].data.qr_bar.figure = 1;
                                        }
                #endif

                                        if (data_structure[i].data.qr_bar.borders == 1)
                                        {
                                            my_symbol->output_options = BARCODE_BOX;
                                            my_symbol->whitespace_width = 3;
                                            my_symbol-> whitespace_height = 3; 
                                            my_symbol-> border_width = 2;   /* Size of border in X-dimensions */
                                            //figure_borders |= 0x02;
                                        }

                                    strcpy(my_symbol->outfile, "out.bmp");
                                    ZBarcode_Encode(my_symbol, (unsigned char *)data_structure[i].data.qr_bar.text, 0);

                                    ZBarcode_Print(my_symbol, 0);
                                    //ZBarcode_Delete(my_symbol);

                        
                                    pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                                    printf("width=%d\n\r", width);
                                    printf("height=%d\n\r", height);
                                    printf("channels=%d\n\r", channels);
                        
                                    my_symbol->scale = (float)((float)150.0*(float)height_len/(float)QR_BAR_MAX_HIGHT/(float)height);
                                   // my_symbol->scale = (float)height_len/(float)height;
                                    printf("scale=%f\n\r", (double)my_symbol->scale);
            
                                    strcpy(my_symbol->outfile, "out.bmp");
                                    ZBarcode_Encode(my_symbol, (unsigned char *)data_structure[i].data.qr_bar.text, 0);

                                    ZBarcode_Print(my_symbol, 0);
                                    ZBarcode_Delete(my_symbol);
                                    stbi_image_free(pdata);
                            
                                    pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                                    printf("width=%d\n\r", width);
                                    printf("height=%d\n\r", height);
                                    printf("channels=%d\n\r", channels);

                                    lv_obj_set_size(temp_obj, width, height);

                                    pnew_data = (unsigned char*)lv_mem_alloc(width * height * 4); // 为32位数据分配内存
                                    if (!pnew_data) 
                                    {
                                        fprintf(stderr, "Memory allocation failed\n");
                                        stbi_image_free(pdata);
                                        return;
                                    }
                                    else
                                    {
                                        printf("lv_mem_alloc ok\n\r");
                                    }

                                    for (int y = 0; y < height; y++) 
                                    {
                                        for (int x = 0; x < width; x++) 
                                        {
                                            int index = y * width + x; // 计算当前像素在原始数据中的索引
                                            unsigned char color = pdata[index]; // 获取当前像素的灰度值（0或255）
                                            // 映射到RGBA值

                                            if (color == 0)
                                            {
                                                pnew_data[index * 4 + 0] = 0; // R
                                                pnew_data[index * 4 + 1] = 0; // G
                                                pnew_data[index * 4 + 2] = 0; // B
                                                pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                                            }
                                            else
                                            {
                                                pnew_data[index * 4 + 0] = 255; // R
                                                pnew_data[index * 4 + 1] = 255; // G
                                                pnew_data[index * 4 + 2] = 255; // B
                                                pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                                            }
                                        }
                                    }

#if 0
                                    stbi_write_bmp("QR_bar_code.bmp", width, height, 4, pnew_data);
                                    // 使用data进行图像处理...
                                    lv_mem_free(pnew_data);
                                    stbi_image_free(pdata); // 释放内存

                                    //显示图像
                                    lv_obj_t* img = lv_img_create(temp_obj);
                                    lv_img_set_src(img, "A:/root/QR_bar_code.bmp");
                                    lv_obj_center(img);
#endif

                                    sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.bmp",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                                    stbi_write_bmp(bmp_name, width, height, 4, pnew_data);
                                    // 使用data进行图像处理...
                                    lv_mem_free(pnew_data);
                                    stbi_image_free(pdata); // 释放内存

                                    data = stbi_load(bmp_name, &width, &height, &channels, 0);
                                    if (!data) 
                                    {
                                        printf("错误：无法加载图片 %s\n", bmp_name);
                                    }
                                    printf("图片加载成功：%dx%d，%d 通道\n", width, height, channels);

                                    sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.png",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                                    
                                    success = stbi_write_png(bmp_name, width, height, channels, data, width * channels);
                                    if (!success) 
                                    {
                                        printf("错误：保存 PNG 失败\n");
                                    } 
                                    else
                                    {
                                        printf("PNG 保存成功：%s\n", bmp_name);
                                    }

                                    // 释放内存
                                    stbi_image_free(data);

                                    //显示图像
                                    img = lv_img_create(temp_obj);
                                    sprintf(bmp_name_1,"A:%s",bmp_name);
                                    lv_img_set_src(img, bmp_name_1);
                                    lv_obj_center(img);

                                    res = lv_img_decoder_get_info(bmp_name_1, &header);  // 直接传入文件路径

                                    if (res == LV_RES_OK)
                                    {
                                        printf("PNG: %dx%d\n", header.w, header.h);
                                    }
                                    else
                                    {
                                        printf("lv_img_decoder_get_info error\n");
                                    }

                                    lv_img_set_zoom(img,data_structure[i].data.qr_bar.size);

                                    width = header.w * data_structure[i].data.qr_bar.size / 256;
                                    height = header.h * data_structure[i].data.qr_bar.size / 256;

                                    lv_obj_set_size(temp_obj, width, height);

                                    lv_obj_align(temp_obj, LV_ALIGN_OUT_TOP_LEFT, data_structure[i].x, data_structure[i].y);

                                    break;
                                }
                                case 2:
                                {
                                    my_symbol->symbology = BARCODE_DATAMATRIX;
                                    height_len =  data_structure[i].data.qr_bar.height;
                                    my_symbol->scale = 1;


                                //figure_borders = 0;
        #if 0
                                if(lv_obj_has_state(sw_addition_QR_code_figure, LV_STATE_CHECKED) == 1)
                                {
                                    my_symbol->show_hrt = 1;
                                    memcpy(my_symbol->text,lv_label_get_text(label_btn_addition_QR_code_text),strlen(lv_label_get_text(label_btn_addition_QR_code_text))+ 1);
                                    //figure_borders |= 0x01;
                                    data_structure[win_content_child_num].data.qr_bar.figure = 1;
                                }
        #endif
                                    if (data_structure[i].data.qr_bar.borders == 1)
                                    {
                                        my_symbol->output_options = BARCODE_BOX;
                                        my_symbol->whitespace_width = 3;
                                        my_symbol-> whitespace_height = 3; 
                                        my_symbol-> border_width = 2;   /* Size of border in X-dimensions */
                                        //figure_borders |= 0x02;
                                    }

                                    strcpy(my_symbol->outfile, "out.bmp");
                                    ZBarcode_Encode(my_symbol, (unsigned char *)data_structure[i].data.qr_bar.text, 0);

                                    ZBarcode_Print(my_symbol, 0);
                                    //ZBarcode_Delete(my_symbol);

                                    pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                                    printf("width=%d\n\r", width);
                                    printf("height=%d\n\r", height);
                                    printf("channels=%d\n\r", channels);
                        
                                    my_symbol->scale = (float)((float)150.0*(float)height_len/(float)QR_BAR_MAX_HIGHT/(float)height);
                                   // my_symbol->scale = (float)height_len/(float)height;
                                    printf("scale=%f\n\r", (double)my_symbol->scale);
            
                                    strcpy(my_symbol->outfile, "out.bmp");
                                    ZBarcode_Encode(my_symbol, (unsigned char *)data_structure[i].data.qr_bar.text, 0);

                                    ZBarcode_Print(my_symbol, 0);
                                    ZBarcode_Delete(my_symbol);
                                    stbi_image_free(pdata);
                            
                                    pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                                    printf("width=%d\n\r", width);
                                    printf("height=%d\n\r", height);
                                    printf("channels=%d\n\r", channels);

                                    lv_obj_set_size(temp_obj, width, height);

                                    pnew_data = (unsigned char*)lv_mem_alloc(width * height * 4); // 为32位数据分配内存
                                    if (!pnew_data) 
                                    {
                                        fprintf(stderr, "Memory allocation failed\n");
                                        stbi_image_free(pdata);
                                        return;
                                    }
                                    else
                                    {
                                        printf("lv_mem_alloc ok\n\r");
                                    }

                                    for (int y = 0; y < height; y++) 
                                    {
                                        for (int x = 0; x < width; x++) 
                                        {
                                            int index = y * width + x; // 计算当前像素在原始数据中的索引
                                            unsigned char color = pdata[index]; // 获取当前像素的灰度值（0或255）
                                            // 映射到RGBA值

                                            if (color == 0)
                                            {
                                                pnew_data[index * 4 + 0] = 0; // R
                                                pnew_data[index * 4 + 1] = 0; // G
                                                pnew_data[index * 4 + 2] = 0; // B
                                                pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                                            }
                                            else
                                            {
                                                pnew_data[index * 4 + 0] = 255; // R
                                                pnew_data[index * 4 + 1] = 255; // G
                                                pnew_data[index * 4 + 2] = 255; // B
                                                pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                                            }
                                        }
                                    }

#if 0
                                        stbi_write_bmp("QR_bar_code.bmp", width, height, 4, pnew_data);
                                        // 使用data进行图像处理...
                                        lv_mem_free(pnew_data);
                                        stbi_image_free(pdata); // 释放内存

                                        //显示图像
                                        img = lv_img_create(temp_obj);
                                        lv_img_set_src(img, "A:/root/QR_bar_code.bmp");
                                        lv_obj_center(img);
#endif

                                    sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.bmp",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                                    stbi_write_bmp(bmp_name, width, height, 4, pnew_data);
                                    // 使用data进行图像处理...
                                    lv_mem_free(pnew_data);
                                    stbi_image_free(pdata); // 释放内存

                                    data = stbi_load(bmp_name, &width, &height, &channels, 0);
                                    if (!data) 
                                    {
                                        printf("错误：无法加载图片 %s\n", bmp_name);
                                    }
                                    printf("图片加载成功：%dx%d，%d 通道\n", width, height, channels);

                                    sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.png",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                                    
                                    success = stbi_write_png(bmp_name, width, height, channels, data, width * channels);
                                    if (!success) 
                                    {
                                        printf("错误：保存 PNG 失败\n");
                                    } 
                                    else
                                    {
                                        printf("PNG 保存成功：%s\n", bmp_name);
                                    }

                                    // 释放内存
                                    stbi_image_free(data);

                                    //显示图像
                                    img = lv_img_create(temp_obj);
                                    sprintf(bmp_name_1,"A:%s",bmp_name);
                                    lv_img_set_src(img, bmp_name_1);
                                    lv_obj_center(img);

                                    res = lv_img_decoder_get_info(bmp_name_1, &header);  // 直接传入文件路径

                                    if (res == LV_RES_OK)
                                    {
                                        printf("PNG: %dx%d\n", header.w, header.h);
                                    }
                                    else
                                    {
                                        printf("lv_img_decoder_get_info error\n");
                                    }

                                    lv_img_set_zoom(img,data_structure[i].data.qr_bar.size);

                                    width = header.w * data_structure[i].data.qr_bar.size / 256;
                                    height = header.h * data_structure[i].data.qr_bar.size / 256;

                                    lv_obj_set_size(temp_obj, width, height);

                                    lv_obj_align(temp_obj, LV_ALIGN_OUT_TOP_LEFT, data_structure[i].x, data_structure[i].y);

                                    break;
                                }
                                case 3:
                                {
                                    my_symbol->symbology = BARCODE_HANXIN;
                                    height_len = data_structure[i].data.qr_bar.height;
                                    my_symbol->scale = 1;
        #if 0
                                if(lv_obj_has_state(sw_addition_QR_code_figure, LV_STATE_CHECKED) == 1)
                                {
                                    my_symbol->show_hrt = 1;
                                    memcpy(my_symbol->text,lv_label_get_text(label_btn_addition_QR_code_text),strlen(lv_label_get_text(label_btn_addition_QR_code_text))+ 1);
                                    //figure_borders |= 0x01;
                                    data_structure[win_content_child_num].data.qr_bar.figure = 1;
                                }
        #endif
                                if (data_structure[i].data.qr_bar.borders == 1)
                                {
                                    my_symbol->output_options = BARCODE_BOX;
                                    my_symbol->whitespace_width = 3;
                                    my_symbol-> whitespace_height = 3; 
                                    my_symbol-> border_width = 2;   /* Size of border in X-dimensions */
                                    //figure_borders |= 0x02;
                                }
        

                                    strcpy(my_symbol->outfile, "out.bmp");
                                    ZBarcode_Encode(my_symbol, (unsigned char *)data_structure[i].data.qr_bar.text, 0);

                                    ZBarcode_Print(my_symbol, 0);
                                    //ZBarcode_Delete(my_symbol);

                                    pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                                    printf("width=%d\n\r", width);
                                    printf("height=%d\n\r", height);
                                    printf("channels=%d\n\r", channels);
                        
                                    my_symbol->scale = (float)((float)150.0*(float)height_len/(float)QR_BAR_MAX_HIGHT/(float)height);
                                    //my_symbol->scale = (float)height_len/(float)height;
                                    printf("scale=%f\n\r", (double)my_symbol->scale);
            
                                    strcpy(my_symbol->outfile, "out.bmp");
                                    ZBarcode_Encode(my_symbol, (unsigned char *)data_structure[i].data.qr_bar.text, 0);

                                    ZBarcode_Print(my_symbol, 0);
                                    ZBarcode_Delete(my_symbol);
                                    stbi_image_free(pdata);
                            
                                    pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                                    printf("width=%d\n\r", width);
                                    printf("height=%d\n\r", height);
                                    printf("channels=%d\n\r", channels);

                                    lv_obj_set_size(temp_obj, width, height);

                                    pnew_data = (unsigned char*)lv_mem_alloc(width * height * 4); // 为32位数据分配内存
                                    if (!pnew_data) 
                                    {
                                        fprintf(stderr, "Memory allocation failed\n");
                                        stbi_image_free(pdata);
                                        return;
                                    }
                                    else
                                    {
                                        printf("lv_mem_alloc ok\n\r");
                                    }

                                    for (int y = 0; y < height; y++) 
                                    {
                                        for (int x = 0; x < width; x++) 
                                        {
                                            int index = y * width + x; // 计算当前像素在原始数据中的索引
                                            unsigned char color = pdata[index]; // 获取当前像素的灰度值（0或255）
                                            // 映射到RGBA值

                                            if (color == 0)
                                            {
                                                pnew_data[index * 4 + 0] = 0; // R
                                                pnew_data[index * 4 + 1] = 0; // G
                                                pnew_data[index * 4 + 2] = 0; // B
                                                pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                                            }
                                            else
                                            {
                                                pnew_data[index * 4 + 0] = 255; // R
                                                pnew_data[index * 4 + 1] = 255; // G
                                                pnew_data[index * 4 + 2] = 255; // B
                                                pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                                            }
                                        }
                                    }

                                    sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.bmp",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                                    stbi_write_bmp(bmp_name, width, height, 4, pnew_data);
                                    // 使用data进行图像处理...
                                    lv_mem_free(pnew_data);
                                    stbi_image_free(pdata); // 释放内存

                                    data = stbi_load(bmp_name, &width, &height, &channels, 0);
                                    if (!data) 
                                    {
                                        printf("错误：无法加载图片 %s\n", bmp_name);
                                    }
                                    printf("图片加载成功：%dx%d，%d 通道\n", width, height, channels);

                                    sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.png",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                                    
                                    success = stbi_write_png(bmp_name, width, height, channels, data, width * channels);
                                    if (!success) 
                                    {
                                        printf("错误：保存 PNG 失败\n");
                                    } 
                                    else
                                    {
                                        printf("PNG 保存成功：%s\n", bmp_name);
                                    }

                                    // 释放内存
                                    stbi_image_free(data);

                                    //显示图像
                                    img = lv_img_create(temp_obj);
                                    sprintf(bmp_name_1,"A:%s",bmp_name);
                                    lv_img_set_src(img, bmp_name_1);
                                    lv_obj_center(img);

                                    res = lv_img_decoder_get_info(bmp_name_1, &header);  // 直接传入文件路径

                                    if (res == LV_RES_OK)
                                    {
                                        printf("PNG: %dx%d\n", header.w, header.h);
                                    }
                                    else
                                    {
                                        printf("lv_img_decoder_get_info error\n");
                                    }

                                    lv_img_set_zoom(img,data_structure[i].data.qr_bar.size);

                                    width = header.w * data_structure[i].data.qr_bar.size / 256;
                                    height = header.h * data_structure[i].data.qr_bar.size / 256;

                                    lv_obj_set_size(temp_obj, width, height);

                                    lv_obj_align(temp_obj, LV_ALIGN_OUT_TOP_LEFT, data_structure[i].x, data_structure[i].y);

                                    break;
                                }
                            }
                            break;
                        }
                        case TYPE_BAR:
                        {
                            str_len = strlen(data_structure[i].data.qr_bar.text) + 1;
                            
                            temp_obj = lv_obj_create(win_content);
                            lv_obj_set_style_bg_opa(temp_obj, LV_OPA_TRANSP, 0);
                            lv_obj_set_style_border_width(temp_obj, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */

                            lv_obj_add_event_cb(temp_obj, drag_event_handler, LV_EVENT_PRESSING, NULL);
                            lv_obj_add_event_cb(temp_obj, drag_event_handler, LV_EVENT_FOCUSED, NULL);
                            lv_obj_add_event_cb(temp_obj, drag_event_handler, LV_EVENT_DEFOCUSED, NULL);
                            lv_obj_clear_flag(temp_obj, LV_OBJ_FLAG_SCROLLABLE);

                            my_symbol = ZBarcode_Create();
                            switch (data_structure[i].data.qr_bar.symbology )
                            {
                                case 0:
                                default:
                                {
                                    my_symbol->symbology = BARCODE_CODE39;
                                    height_len =  data_structure[i].data.qr_bar.height;
                                    my_symbol->scale = 1;
    
    
                                    if (data_structure[i].data.qr_bar.figure == 1)
                                    {
                                        my_symbol->show_hrt = 1;
                                        memcpy(my_symbol->text,lv_label_get_text(label_btn_addition_QR_code_text),strlen(lv_label_get_text(label_btn_addition_QR_code_text))+ 1);
                                    }
                                    else
                                    {
                                        my_symbol->show_hrt = 0;
                                    }

                                    if (data_structure[i].data.qr_bar.borders == 1)
                                    {
                                        my_symbol->output_options = BARCODE_BOX;
                                        my_symbol->whitespace_width = 3;
                                        my_symbol-> whitespace_height = 3; 
                                        my_symbol-> border_width = 2;   /* Size of border in X-dimensions */
                                    }

                                    strcpy(my_symbol->outfile, "out.bmp");
                                    ZBarcode_Encode(my_symbol, (unsigned char *)data_structure[i].data.qr_bar.text, 0);

                                    ZBarcode_Print(my_symbol, 0);
                                    //ZBarcode_Delete(my_symbol);

                                    pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                                    printf("width=%d\n\r", width);
                                    printf("height=%d\n\r", height);
                                    printf("channels=%d\n\r", channels);
                        
                                    my_symbol->scale = (float)((float)150.0*(float)height_len/(float)QR_BAR_MAX_HIGHT/(float)height);
                                    //   my_symbol->scale = (float)height_len/(float)height;
                                    printf("scale=%f\n\r", (double)my_symbol->scale);
            
                                    strcpy(my_symbol->outfile, "out.bmp");
                                    ZBarcode_Encode(my_symbol, (unsigned char *)data_structure[i].data.qr_bar.text, 0);

                                    ZBarcode_Print(my_symbol, 0);
                                    ZBarcode_Delete(my_symbol);
                                    stbi_image_free(pdata);
                            
                                    pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                                    printf("width=%d\n\r", width);
                                    printf("height=%d\n\r", height);
                                    printf("channels=%d\n\r", channels);

                                    lv_obj_set_size(temp_obj, width, height);

                                    pnew_data = (unsigned char*)lv_mem_alloc(width * height * 4); // 为32位数据分配内存
                                    if (!pnew_data) 
                                    {
                                        fprintf(stderr, "Memory allocation failed\n");
                                        stbi_image_free(pdata);
                                        return;
                                    }
                                    else
                                    {
                                        printf("lv_mem_alloc ok\n\r");
                                    }

                                    for (int y = 0; y < height; y++) 
                                    {
                                        for (int x = 0; x < width; x++) 
                                        {
                                            int index = y * width + x; // 计算当前像素在原始数据中的索引
                                            unsigned char color = pdata[index]; // 获取当前像素的灰度值（0或255）
                                            // 映射到RGBA值

                                            if (color == 0)
                                            {
                                                pnew_data[index * 4 + 0] = 0; // R
                                                pnew_data[index * 4 + 1] = 0; // G
                                                pnew_data[index * 4 + 2] = 0; // B
                                                pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                                            }
                                            else
                                            {
                                                pnew_data[index * 4 + 0] = 255; // R
                                                pnew_data[index * 4 + 1] = 255; // G
                                                pnew_data[index * 4 + 2] = 255; // B
                                                pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                                            }
                                        }
                                    }

#if 0
                                    stbi_write_bmp("QR_bar_code.bmp", width, height, 4, pnew_data);
                                    // 使用data进行图像处理...
                                    lv_mem_free(pnew_data);
                                    stbi_image_free(pdata); // 释放内存

                                    //显示图像
                                    img = lv_img_create(temp_obj);
                                    lv_img_set_src(img, "A:/root/QR_bar_code.bmp");
                                    lv_obj_center(img);
#endif

                                    sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.bmp",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                                    stbi_write_bmp(bmp_name, width, height, 4, pnew_data);
                                    // 使用data进行图像处理...
                                    lv_mem_free(pnew_data);
                                    stbi_image_free(pdata); // 释放内存

                                    data = stbi_load(bmp_name, &width, &height, &channels, 0);
                                    if (!data) 
                                    {
                                        printf("错误：无法加载图片 %s\n", bmp_name);
                                    }
                                    printf("图片加载成功：%dx%d，%d 通道\n", width, height, channels);

                                    sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.png",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                                    
                                    success = stbi_write_png(bmp_name, width, height, channels, data, width * channels);
                                    if (!success) 
                                    {
                                        printf("错误：保存 PNG 失败\n");
                                    } 
                                    else
                                    {
                                        printf("PNG 保存成功：%s\n", bmp_name);
                                    }

                                    // 释放内存
                                    stbi_image_free(data);

                                    //显示图像
                                    img = lv_img_create(temp_obj);
                                    sprintf(bmp_name_1,"A:%s",bmp_name);
                                    lv_img_set_src(img, bmp_name_1);
                                    lv_obj_center(img);

                                    res = lv_img_decoder_get_info(bmp_name_1, &header);  // 直接传入文件路径

                                    if (res == LV_RES_OK)
                                    {
                                        printf("PNG: %dx%d\n", header.w, header.h);
                                    }
                                    else
                                    {
                                        printf("lv_img_decoder_get_info error\n");
                                    }

                                    lv_img_set_zoom(img,data_structure[i].data.qr_bar.size);

                                    width = header.w * data_structure[i].data.qr_bar.size / 256;
                                    height = header.h * data_structure[i].data.qr_bar.size / 256;

                                    lv_obj_set_size(temp_obj, width, height);

                                    lv_obj_align(temp_obj, LV_ALIGN_OUT_TOP_LEFT, data_structure[i].x, data_structure[i].y);

                                    break;
                                }
                                case 1:
                                {
                                    my_symbol->symbology = BARCODE_CODE128;
                                    height_len = data_structure[win_content_child_num].data.qr_bar.height;
                                    my_symbol->scale = 1;

                                    if (data_structure[i].data.qr_bar.figure == 1)
                                    {
                                        my_symbol->show_hrt = 1;
                                        memcpy(my_symbol->text,lv_label_get_text(label_btn_addition_QR_code_text),strlen(lv_label_get_text(label_btn_addition_QR_code_text))+ 1);
                                    }
                                    else
                                    {
                                        my_symbol->show_hrt = 0;
                                    }

                                    if (data_structure[i].data.qr_bar.borders == 1)
                                    {
                                        my_symbol->output_options = BARCODE_BOX;
                                        my_symbol->whitespace_width = 3;
                                        my_symbol-> whitespace_height = 3; 
                                        my_symbol-> border_width = 2;   /* Size of border in X-dimensions */
                                    }

                                    strcpy(my_symbol->outfile, "out.bmp");
                                    ZBarcode_Encode(my_symbol, (unsigned char *)data_structure[i].data.qr_bar.text, 0);

                                    ZBarcode_Print(my_symbol, 0);
                                    //ZBarcode_Delete(my_symbol);

                                    pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                                    printf("width=%d\n\r", width);
                                    printf("height=%d\n\r", height);
                                    printf("channels=%d\n\r", channels);
                        
                                    my_symbol->scale = (float)((float)150.0*(float)height_len/(float)QR_BAR_MAX_HIGHT/(float)height);
                                    //   my_symbol->scale = (float)height_len/(float)height;
                                    printf("scale=%f\n\r",(double)my_symbol->scale);
            
                                    strcpy(my_symbol->outfile, "out.bmp");
                                    ZBarcode_Encode(my_symbol, (unsigned char *)data_structure[i].data.qr_bar.text, 0);

                                    ZBarcode_Print(my_symbol, 0);
                                    ZBarcode_Delete(my_symbol);
                                    stbi_image_free(pdata);
                            
                                    pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                                    printf("width=%d\n\r", width);
                                    printf("height=%d\n\r", height);
                                    printf("channels=%d\n\r", channels);

                                    lv_obj_set_size(temp_obj, width, height);

                                    pnew_data = (unsigned char*)lv_mem_alloc(width * height * 4); // 为32位数据分配内存
                                    if (!pnew_data) 
                                    {
                                        fprintf(stderr, "Memory allocation failed\n");
                                        stbi_image_free(pdata);
                                        return;
                                    }
                                    else
                                    {
                                        printf("lv_mem_alloc ok\n\r");
                                    }

                                    for (int y = 0; y < height; y++) 
                                    {
                                        for (int x = 0; x < width; x++) 
                                        {
                                            int index = y * width + x; // 计算当前像素在原始数据中的索引
                                            unsigned char color = pdata[index]; // 获取当前像素的灰度值（0或255）
                                            // 映射到RGBA值

                                            if (color == 0)
                                            {
                                                pnew_data[index * 4 + 0] = 0; // R
                                                pnew_data[index * 4 + 1] = 0; // G
                                                pnew_data[index * 4 + 2] = 0; // B
                                                pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                                            }
                                            else
                                            {
                                                pnew_data[index * 4 + 0] = 255; // R
                                                pnew_data[index * 4 + 1] = 255; // G
                                                pnew_data[index * 4 + 2] = 255; // B
                                                pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                                            }
                                        }
                                    }

#if 0
                                    stbi_write_bmp("QR_bar_code.bmp", width, height, 4, pnew_data);
                                    // 使用data进行图像处理...
                                    lv_mem_free(pnew_data);
                                    stbi_image_free(pdata); // 释放内存

                                    //显示图像
                                    img = lv_img_create(temp_obj);
                                    lv_img_set_src(img, "A:/root/QR_bar_code.bmp");
                                    lv_obj_center(img);
#endif

                                    sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.bmp",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                                    stbi_write_bmp(bmp_name, width, height, 4, pnew_data);
                                    // 使用data进行图像处理...
                                    lv_mem_free(pnew_data);
                                    stbi_image_free(pdata); // 释放内存

                                 data = stbi_load(bmp_name, &width, &height, &channels, 0);
                                    if (!data) 
                                    {
                                        printf("错误：无法加载图片 %s\n", bmp_name);
                                    }
                                    printf("图片加载成功：%dx%d，%d 通道\n", width, height, channels);

                                    sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.png",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                                    
                                    success = stbi_write_png(bmp_name, width, height, channels, data, width * channels);
                                    if (!success) 
                                    {
                                        printf("错误：保存 PNG 失败\n");
                                    } 
                                    else
                                    {
                                        printf("PNG 保存成功：%s\n", bmp_name);
                                    }

                                    // 释放内存
                                    stbi_image_free(data);

                                    //显示图像
                                    img = lv_img_create(temp_obj);
                                    sprintf(bmp_name_1,"A:%s",bmp_name);
                                    lv_img_set_src(img, bmp_name_1);
                                    lv_obj_center(img);

                                    res = lv_img_decoder_get_info(bmp_name_1, &header);  // 直接传入文件路径

                                    if (res == LV_RES_OK)
                                    {
                                        printf("PNG: %dx%d\n", header.w, header.h);
                                    }
                                    else
                                    {
                                        printf("lv_img_decoder_get_info error\n");
                                    }

                                    lv_img_set_zoom(img,data_structure[i].data.qr_bar.size);

                                    width = header.w * data_structure[i].data.qr_bar.size / 256;
                                    height = header.h * data_structure[i].data.qr_bar.size / 256;

                                    lv_obj_set_size(temp_obj, width, height);

                                    lv_obj_align(temp_obj, LV_ALIGN_OUT_TOP_LEFT, data_structure[i].x, data_structure[i].y);

                                    break;
                                }
                                case 2:
                                case 3:
                                {
                                    my_symbol->symbology = BARCODE_EANX;
                                    height_len = data_structure[i].data.qr_bar.height;
                                    my_symbol->scale = 1;

                                    if (data_structure[i].data.qr_bar.figure == 1)
                                    {
                                        my_symbol->show_hrt = 1;
                                        memcpy(my_symbol->text,lv_label_get_text(label_btn_addition_QR_code_text),strlen(lv_label_get_text(label_btn_addition_QR_code_text))+ 1);
                                    }
                                    else
                                    {
                                        my_symbol->show_hrt = 0;
                                    }

                                    if (data_structure[i].data.qr_bar.borders == 1)
                                    {
                                        my_symbol->output_options = BARCODE_BOX;
                                        my_symbol->whitespace_width = 3;
                                        my_symbol-> whitespace_height = 3; 
                                        my_symbol-> border_width = 2;   /* Size of border in X-dimensions */
                                    }

                                    strcpy(my_symbol->outfile, "out.bmp");
                                    ZBarcode_Encode(my_symbol, (unsigned char *)data_structure[i].data.qr_bar.text, 0);

                                    ZBarcode_Print(my_symbol, 0);
                                    //ZBarcode_Delete(my_symbol);

                                    pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                                    printf("width=%d\n\r", width);
                                    printf("height=%d\n\r", height);
                                    printf("channels=%d\n\r", channels);
                        
                                    my_symbol->scale = (float)((float)150.0*(float)height_len/(float)QR_BAR_MAX_HIGHT/(float)height);
                                     //  my_symbol->scale = (float)height_len/(float)height;
                                    printf("scale=%f\n\r", (double)my_symbol->scale);
            
                                    strcpy(my_symbol->outfile, "out.bmp");
                                    ZBarcode_Encode(my_symbol, (unsigned char *)data_structure[i].data.qr_bar.text, 0);

                                    ZBarcode_Print(my_symbol, 0);
                                    ZBarcode_Delete(my_symbol);
                                    stbi_image_free(pdata);
                            
                                    pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                                    printf("width=%d\n\r", width);
                                    printf("height=%d\n\r", height);
                                    printf("channels=%d\n\r", channels);

                                    lv_obj_set_size(temp_obj, width, height);

                                    pnew_data = (unsigned char*)lv_mem_alloc(width * height * 4); // 为32位数据分配内存
                                    if (!pnew_data) 
                                    {
                                        fprintf(stderr, "Memory allocation failed\n");
                                        stbi_image_free(pdata);
                                        return;
                                    }
                                    else
                                    {
                                        printf("lv_mem_alloc ok\n\r");
                                    }

                                    for (int y = 0; y < height; y++) 
                                    {
                                        for (int x = 0; x < width; x++) 
                                        {
                                            int index = y * width + x; // 计算当前像素在原始数据中的索引
                                            unsigned char color = pdata[index]; // 获取当前像素的灰度值（0或255）
                                            // 映射到RGBA值

                                            if (color == 0)
                                            {
                                                pnew_data[index * 4 + 0] = 0; // R
                                                pnew_data[index * 4 + 1] = 0; // G
                                                pnew_data[index * 4 + 2] = 0; // B
                                                pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                                            }
                                            else
                                            {
                                                pnew_data[index * 4 + 0] = 255; // R
                                                pnew_data[index * 4 + 1] = 255; // G
                                                pnew_data[index * 4 + 2] = 255; // B
                                                pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                                            }
                                        }
                                    }

#if 0
                                    stbi_write_bmp("QR_bar_code.bmp", width, height, 4, pnew_data);
                                    // 使用data进行图像处理...
                                    lv_mem_free(pnew_data);
                                    stbi_image_free(pdata); // 释放内存

                                    //显示图像
                                    img = lv_img_create(temp_obj);
                                    lv_img_set_src(img, "A:/root/QR_bar_code.bmp");
                                    lv_obj_center(img);
#endif

                                    sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.bmp",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                                    stbi_write_bmp(bmp_name, width, height, 4, pnew_data);
                                    // 使用data进行图像处理...
                                    lv_mem_free(pnew_data);
                                    stbi_image_free(pdata); // 释放内存

                                 data = stbi_load(bmp_name, &width, &height, &channels, 0);
                                    if (!data) 
                                    {
                                        printf("错误：无法加载图片 %s\n", bmp_name);
                                    }
                                    printf("图片加载成功：%dx%d，%d 通道\n", width, height, channels);

                                    sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.png",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                                    
                                    success = stbi_write_png(bmp_name, width, height, channels, data, width * channels);
                                    if (!success) 
                                    {
                                        printf("错误：保存 PNG 失败\n");
                                    } 
                                    else
                                    {
                                        printf("PNG 保存成功：%s\n", bmp_name);
                                    }

                                    // 释放内存
                                    stbi_image_free(data);

                                    //显示图像
                                    img = lv_img_create(temp_obj);
                                    sprintf(bmp_name_1,"A:%s",bmp_name);
                                    lv_img_set_src(img, bmp_name_1);
                                    lv_obj_center(img);

                                    res = lv_img_decoder_get_info(bmp_name_1, &header);  // 直接传入文件路径

                                    if (res == LV_RES_OK)
                                    {
                                        printf("PNG: %dx%d\n", header.w, header.h);
                                    }
                                    else
                                    {
                                        printf("lv_img_decoder_get_info error\n");
                                    }

                                    lv_img_set_zoom(img,data_structure[i].data.qr_bar.size);

                                    width = header.w * data_structure[i].data.qr_bar.size / 256;
                                    height = header.h * data_structure[i].data.qr_bar.size / 256;

                                    lv_obj_set_size(temp_obj, width, height);

                                    lv_obj_align(temp_obj, LV_ALIGN_OUT_TOP_LEFT, data_structure[i].x, data_structure[i].y);

                                    break;
                                }
                                case 4:
                                {
                                    my_symbol->symbology = BARCODE_EAN128;
                                    my_symbol->input_mode |= GS1PARENS_MODE;
                                    height_len =  data_structure[i].data.qr_bar.height ;
                                    my_symbol->scale = 1;

                                    if (data_structure[i].data.qr_bar.figure == 1)
                                    {
                                        my_symbol->show_hrt = 1;
                                        memcpy(my_symbol->text,lv_label_get_text(label_btn_addition_QR_code_text),strlen(lv_label_get_text(label_btn_addition_QR_code_text))+ 1);
                                    }
                                    else
                                    {
                                        my_symbol->show_hrt = 0;
                                    }

                                    if (data_structure[i].data.qr_bar.borders == 1)
                                    {
                                        my_symbol->output_options = BARCODE_BOX;
                                        my_symbol->whitespace_width = 3;
                                        my_symbol-> whitespace_height = 3; 
                                        my_symbol-> border_width = 2;   /* Size of border in X-dimensions */
                                    }
                                    strcpy(my_symbol->outfile, "out.bmp");

                                    ZBarcode_Encode(my_symbol, (unsigned char *)data_structure[i].data.qr_bar.text, 0);
                                    //ZBarcode_Encode(my_symbol, (unsigned char *)"(01)98898765432106(3202)012345(15)991231", 0);

                                    ZBarcode_Print(my_symbol, 0);
                                    //ZBarcode_Delete(my_symbol);

                                    pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                                    printf("width=%d\n\r", width);
                                    printf("height=%d\n\r", height);
                                    printf("channels=%d\n\r", channels);
                        
                                    my_symbol->scale = (float)((float)118.0*(float)height_len/(float)QR_BAR_MAX_HIGHT/(float)height);
                                    printf("scale=%f\n\r",(double)my_symbol->scale);
            
                                    strcpy(my_symbol->outfile, "out.bmp");
                                    ZBarcode_Encode(my_symbol, (unsigned char *)data_structure[i].data.qr_bar.text, 0);

                                    ZBarcode_Print(my_symbol, 0);
                                    ZBarcode_Delete(my_symbol);
                                    stbi_image_free(pdata);
                            
                                    pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                                    printf("width=%d\n\r", width);
                                    printf("height=%d\n\r", height);
                                    printf("channels=%d\n\r", channels);

                                    lv_obj_set_size(temp_obj, width, height);

                                    pnew_data = (unsigned char*)lv_mem_alloc(width * height * 4); // 为32位数据分配内存
                                    if (!pnew_data) 
                                    {
                                        fprintf(stderr, "Memory allocation failed\n");
                                        stbi_image_free(pdata);
                                        return;
                                    }
                                    else
                                    {
                                        printf("lv_mem_alloc ok\n\r");
                                    }

                                    for (int y = 0; y < height; y++) 
                                    {
                                        for (int x = 0; x < width; x++) 
                                        {
                                            int index = y * width + x; // 计算当前像素在原始数据中的索引
                                            unsigned char color = pdata[index]; // 获取当前像素的灰度值（0或255）
                                            // 映射到RGBA值

                                            if (color == 0)
                                            {
                                                pnew_data[index * 4 + 0] = 0; // R
                                                pnew_data[index * 4 + 1] = 0; // G
                                                pnew_data[index * 4 + 2] = 0; // B
                                                pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                                            }
                                            else
                                            {
                                                pnew_data[index * 4 + 0] = 255; // R
                                                pnew_data[index * 4 + 1] = 255; // G
                                                pnew_data[index * 4 + 2] = 255; // B
                                                pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                                            }
                                        }
                                    }

#if 0
                                    stbi_write_bmp("QR_bar_code.bmp", width, height, 4, pnew_data);
                                    // 使用data进行图像处理...
                                    lv_mem_free(pnew_data);
                                    stbi_image_free(pdata); // 释放内存

                                    //显示图像
                                    img = lv_img_create(temp_obj);
                                    lv_img_set_src(img, "A:/root/QR_bar_code.bmp");
                                    lv_obj_center(img);
#endif

                                    sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.bmp",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                                    stbi_write_bmp(bmp_name, width, height, 4, pnew_data);
                                    // 使用data进行图像处理...
                                    lv_mem_free(pnew_data);
                                    stbi_image_free(pdata); // 释放内存
                                    
                                    data = stbi_load(bmp_name, &width, &height, &channels, 0);
                                    if (!data) 
                                    {
                                        printf("错误：无法加载图片 %s\n", bmp_name);
                                    }
                                    printf("图片加载成功：%dx%d，%d 通道\n", width, height, channels);

                                    sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.png",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                                    
                                    success = stbi_write_png(bmp_name, width, height, channels, data, width * channels);
                                    if (!success) 
                                    {
                                        printf("错误：保存 PNG 失败\n");
                                    } 
                                    else
                                    {
                                        printf("PNG 保存成功：%s\n", bmp_name);
                                    }

                                    // 释放内存
                                    stbi_image_free(data);

                                    //显示图像
                                    img = lv_img_create(temp_obj);
                                    sprintf(bmp_name_1,"A:%s",bmp_name);
                                    lv_img_set_src(img, bmp_name_1);
                                    lv_obj_center(img);

                                    res = lv_img_decoder_get_info(bmp_name_1, &header);  // 直接传入文件路径

                                    if (res == LV_RES_OK)
                                    {
                                        printf("PNG: %dx%d\n", header.w, header.h);
                                    }
                                    else
                                    {
                                        printf("lv_img_decoder_get_info error\n");
                                    }

                                    lv_img_set_zoom(img,data_structure[i].data.qr_bar.size);

                                    width = header.w * data_structure[i].data.qr_bar.size / 256;
                                    height = header.h * data_structure[i].data.qr_bar.size / 256;

                                    lv_obj_set_size(temp_obj, width, height);

                                    lv_obj_align(temp_obj, LV_ALIGN_OUT_TOP_LEFT, data_structure[i].x, data_structure[i].y);

                                    break;
                                }
                                case 5:
                                {
                                    my_symbol->symbology = BARCODE_UPCA;
                                    height_len = data_structure[i].data.qr_bar.height;
                                    my_symbol->scale = 1;


                                    if (data_structure[i].data.qr_bar.figure == 1)
                                    {
                                        my_symbol->show_hrt = 1;
                                        memcpy(my_symbol->text,lv_label_get_text(label_btn_addition_QR_code_text),strlen(lv_label_get_text(label_btn_addition_QR_code_text))+ 1);
                                    }
                                    else
                                    {
                                        my_symbol->show_hrt = 0;
                                    }

                                    if (data_structure[i].data.qr_bar.borders == 1)
                                    {
                                        my_symbol->output_options = BARCODE_BOX;
                                        my_symbol->whitespace_width = 3;
                                        my_symbol-> whitespace_height = 3; 
                                        my_symbol-> border_width = 2;   /* Size of border in X-dimensions */
                                    }

                                    strcpy(my_symbol->outfile, "out.bmp");
                                    ZBarcode_Encode(my_symbol, (unsigned char *)data_structure[i].data.qr_bar.text, 0);

                                    ZBarcode_Print(my_symbol, 0);
                                    //ZBarcode_Delete(my_symbol);

                                    pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                                    printf("width=%d\n\r", width);
                                    printf("height=%d\n\r", height);
                                    printf("channels=%d\n\r", channels);
                        
                                    my_symbol->scale = (float)((float)150.0*(float)height_len/(float)QR_BAR_MAX_HIGHT/(float)height);
                                    //   my_symbol->scale = (float)height_len/(float)height;
                                    printf("scale=%f\n\r",(double)my_symbol->scale);
            
                                    strcpy(my_symbol->outfile, "out.bmp");
                                    ZBarcode_Encode(my_symbol, (unsigned char *)data_structure[i].data.qr_bar.text, 0);

                                    ZBarcode_Print(my_symbol, 0);
                                    ZBarcode_Delete(my_symbol);
                                    stbi_image_free(pdata);
                            
                                    pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                                    printf("width=%d\n\r", width);
                                    printf("height=%d\n\r", height);
                                    printf("channels=%d\n\r", channels);

                                    lv_obj_set_size(temp_obj, width, height);

                                    pnew_data = (unsigned char*)lv_mem_alloc(width * height * 4); // 为32位数据分配内存
                                    if (!pnew_data) 
                                    {
                                        fprintf(stderr, "Memory allocation failed\n");
                                        stbi_image_free(pdata);
                                        return;
                                    }
                                    else
                                    {
                                        printf("lv_mem_alloc ok\n\r");
                                    }

                                    for (int y = 0; y < height; y++) 
                                    {
                                        for (int x = 0; x < width; x++) 
                                        {
                                            int index = y * width + x; // 计算当前像素在原始数据中的索引
                                            unsigned char color = pdata[index]; // 获取当前像素的灰度值（0或255）
                                            // 映射到RGBA值

                                            if (color == 0)
                                            {
                                                pnew_data[index * 4 + 0] = 0; // R
                                                pnew_data[index * 4 + 1] = 0; // G
                                                pnew_data[index * 4 + 2] = 0; // B
                                                pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                                            }
                                            else
                                            {
                                                pnew_data[index * 4 + 0] = 255; // R
                                                pnew_data[index * 4 + 1] = 255; // G
                                                pnew_data[index * 4 + 2] = 255; // B
                                                pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                                            }
                                        }
                                    }

#if 0
                                    stbi_write_bmp("QR_bar_code.bmp", width, height, 4, pnew_data);
                                    // 使用data进行图像处理...
                                    lv_mem_free(pnew_data);
                                    stbi_image_free(pdata); // 释放内存

                                    //显示图像
                                    img = lv_img_create(temp_obj);
                                    lv_img_set_src(img, "A:/root/QR_bar_code.bmp");
                                    lv_obj_center(img);
#endif

                                    sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.bmp",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                                    stbi_write_bmp(bmp_name, width, height, 4, pnew_data);
                                    // 使用data进行图像处理...
                                    lv_mem_free(pnew_data);
                                    stbi_image_free(pdata); // 释放内存

                                    data = stbi_load(bmp_name, &width, &height, &channels, 0);
                                    if (!data) 
                                    {
                                        printf("错误：无法加载图片 %s\n", bmp_name);
                                    }
                                    printf("图片加载成功：%dx%d，%d 通道\n", width, height, channels);

                                    sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.png",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                                    
                                    success = stbi_write_png(bmp_name, width, height, channels, data, width * channels);
                                    if (!success) 
                                    {
                                        printf("错误：保存 PNG 失败\n");
                                    } 
                                    else
                                    {
                                        printf("PNG 保存成功：%s\n", bmp_name);
                                    }

                                    // 释放内存
                                    stbi_image_free(data);

                                    //显示图像
                                    img = lv_img_create(temp_obj);
                                    sprintf(bmp_name_1,"A:%s",bmp_name);
                                    lv_img_set_src(img, bmp_name_1);
                                    lv_obj_center(img);

                                    res = lv_img_decoder_get_info(bmp_name_1, &header);  // 直接传入文件路径

                                    if (res == LV_RES_OK)
                                    {
                                        printf("PNG: %dx%d\n", header.w, header.h);
                                    }
                                    else
                                    {
                                        printf("lv_img_decoder_get_info error\n");
                                    }

                                    lv_img_set_zoom(img,data_structure[i].data.qr_bar.size);

                                    width = header.w * data_structure[i].data.qr_bar.size / 256;
                                    height = header.h * data_structure[i].data.qr_bar.size / 256;

                                    lv_obj_set_size(temp_obj, width, height);

                                    lv_obj_align(temp_obj, LV_ALIGN_OUT_TOP_LEFT, data_structure[i].x, data_structure[i].y);

                                    break;
                                }
                                case 6:
                                {
                                    my_symbol->symbology = BARCODE_UPCE;
                                    height_len = data_structure[i].data.qr_bar.height;
                                    my_symbol->scale = 1;

                                    if (data_structure[i].data.qr_bar.figure == 1)
                                    {
                                        my_symbol->show_hrt = 1;
                                        memcpy(my_symbol->text,lv_label_get_text(label_btn_addition_QR_code_text),strlen(lv_label_get_text(label_btn_addition_QR_code_text))+ 1);
                                    }
                                    else
                                    {
                                        my_symbol->show_hrt = 0;
                                    }

                                    if (data_structure[i].data.qr_bar.borders == 1)
                                    {
                                        my_symbol->output_options = BARCODE_BOX;
                                        my_symbol->whitespace_width = 3;
                                        my_symbol-> whitespace_height = 3; 
                                        my_symbol-> border_width = 2;   /* Size of border in X-dimensions */
                                    }

                                    strcpy(my_symbol->outfile, "out.bmp");
                                    ZBarcode_Encode(my_symbol, (unsigned char *)data_structure[i].data.qr_bar.text, 0);

                                    ZBarcode_Print(my_symbol, 0);
                                    //ZBarcode_Delete(my_symbol);

                                    pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                                    printf("width=%d\n\r", width);
                                    printf("height=%d\n\r", height);
                                    printf("channels=%d\n\r", channels);
                        
                                    my_symbol->scale = (float)((float)150.0*(float)height_len/(float)QR_BAR_MAX_HIGHT/(float)height);
                                     // my_symbol->scale = (float)height_len/(float)height;
                                    printf("scale=%f\n\r", (double)my_symbol->scale);
            
                                    strcpy(my_symbol->outfile, "out.bmp");
                                    ZBarcode_Encode(my_symbol, (unsigned char *)data_structure[i].data.qr_bar.text, 0);

                                    ZBarcode_Print(my_symbol, 0);
                                    ZBarcode_Delete(my_symbol);
                                    stbi_image_free(pdata);
                            
                                    pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                                    printf("width=%d\n\r", width);
                                    printf("height=%d\n\r", height);
                                    printf("channels=%d\n\r", channels);

                                    lv_obj_set_size(temp_obj, width, height);

                                    pnew_data = (unsigned char*)lv_mem_alloc(width * height * 4); // 为32位数据分配内存
                                    if (!pnew_data) 
                                    {
                                        fprintf(stderr, "Memory allocation failed\n");
                                        stbi_image_free(pdata);
                                        return;
                                    }
                                    else
                                    {
                                        printf("lv_mem_alloc ok\n\r");
                                    }

                                    for (int y = 0; y < height; y++) 
                                    {
                                        for (int x = 0; x < width; x++) 
                                        {
                                            int index = y * width + x; // 计算当前像素在原始数据中的索引
                                            unsigned char color = pdata[index]; // 获取当前像素的灰度值（0或255）
                                            // 映射到RGBA值

                                            if (color == 0)
                                            {
                                                pnew_data[index * 4 + 0] = 0; // R
                                                pnew_data[index * 4 + 1] = 0; // G
                                                pnew_data[index * 4 + 2] = 0; // B
                                                pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                                            }
                                            else
                                            {
                                                pnew_data[index * 4 + 0] = 255; // R
                                                pnew_data[index * 4 + 1] = 255; // G
                                                pnew_data[index * 4 + 2] = 255; // B
                                                pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                                            }
                                        }
                                    }

#if 0
                                    stbi_write_bmp("QR_bar_code.bmp", width, height, 4, pnew_data);
                                    // 使用data进行图像处理...
                                    lv_mem_free(pnew_data);
                                    stbi_image_free(pdata); // 释放内存

                                    //显示图像
                                    img = lv_img_create(temp_obj);
                                    lv_img_set_src(img, "A:/root/QR_bar_code.bmp");
                                    lv_obj_center(img);     
#endif

                                    sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.bmp",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                                    stbi_write_bmp(bmp_name, width, height, 4, pnew_data);
                                    // 使用data进行图像处理...
                                    lv_mem_free(pnew_data);
                                    stbi_image_free(pdata); // 释放内存

                                    data = stbi_load(bmp_name, &width, &height, &channels, 0);
                                    if (!data) 
                                    {
                                        printf("错误：无法加载图片 %s\n", bmp_name);
                                    }
                                    printf("图片加载成功：%dx%d，%d 通道\n", width, height, channels);

                                    sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.png",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                                    
                                    success = stbi_write_png(bmp_name, width, height, channels, data, width * channels);
                                    if (!success) 
                                    {
                                        printf("错误：保存 PNG 失败\n");
                                    } 
                                    else
                                    {
                                        printf("PNG 保存成功：%s\n", bmp_name);
                                    }

                                    // 释放内存
                                    stbi_image_free(data);

                                    //显示图像
                                    img = lv_img_create(temp_obj);
                                    sprintf(bmp_name_1,"A:%s",bmp_name);
                                    lv_img_set_src(img, bmp_name_1);
                                    lv_obj_center(img);

                                    res = lv_img_decoder_get_info(bmp_name_1, &header);  // 直接传入文件路径

                                    if (res == LV_RES_OK)
                                    {
                                        printf("PNG: %dx%d\n", header.w, header.h);
                                    }
                                    else
                                    {
                                        printf("lv_img_decoder_get_info error\n");
                                    }

                                    lv_img_set_zoom(img,data_structure[i].data.qr_bar.size);

                                    width = header.w * data_structure[i].data.qr_bar.size / 256;
                                    height = header.h * data_structure[i].data.qr_bar.size / 256;

                                    lv_obj_set_size(temp_obj, width, height);

                                    lv_obj_align(temp_obj, LV_ALIGN_OUT_TOP_LEFT, data_structure[i].x, data_structure[i].y);

                                    break;
                                }
                                case 7:
                                {
                                    my_symbol->symbology = BARCODE_ITF14;
                                    height_len = data_structure[i].data.qr_bar.height;
                                    my_symbol->scale = 1;

                                    if (data_structure[i].data.qr_bar.figure == 1)
                                    {
                                        my_symbol->show_hrt = 1;
                                        memcpy(my_symbol->text,lv_label_get_text(label_btn_addition_QR_code_text),strlen(lv_label_get_text(label_btn_addition_QR_code_text))+ 1);
                                    }
                                    else
                                    {
                                        my_symbol->show_hrt = 0;
                                    }

                                    if (data_structure[i].data.qr_bar.borders == 1)
                                    {
                                        my_symbol->output_options = BARCODE_BOX;
                                        my_symbol->whitespace_width = 3;
                                        my_symbol-> whitespace_height = 3; 
                                        my_symbol-> border_width = 2;   /* Size of border in X-dimensions */
                                    }

                                    strcpy(my_symbol->outfile, "out.bmp");
                                    ZBarcode_Encode(my_symbol, (unsigned char *)data_structure[i].data.qr_bar.text, 0);

                                    ZBarcode_Print(my_symbol, 0);
                                    //ZBarcode_Delete(my_symbol);

                                    pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                                    printf("width=%d\n\r", width);
                                    printf("height=%d\n\r", height);
                                    printf("channels=%d\n\r", channels);
                        
                                    my_symbol->scale = (float)((float)150.0*(float)height_len/(float)QR_BAR_MAX_HIGHT/(float)height);
                                    // my_symbol->scale = (float)height_len/(float)height;
                                    printf("scale=%f\n\r", (double)my_symbol->scale);
            
                                    strcpy(my_symbol->outfile, "out.bmp");
                                    ZBarcode_Encode(my_symbol, (unsigned char *)data_structure[i].data.qr_bar.text, 0);

                                    ZBarcode_Print(my_symbol, 0);
                                    ZBarcode_Delete(my_symbol);
                                    stbi_image_free(pdata);
                            
                                    pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                                    printf("width=%d\n\r", width);
                                    printf("height=%d\n\r", height);
                                    printf("channels=%d\n\r", channels);

                                    lv_obj_set_size(temp_obj, width, height);

                                    pnew_data = (unsigned char*)lv_mem_alloc(width * height * 4); // 为32位数据分配内存
                                    if (!pnew_data) 
                                    {
                                        fprintf(stderr, "Memory allocation failed\n");
                                        stbi_image_free(pdata);
                                        return;
                                    }
                                    else
                                    {
                                        printf("lv_mem_alloc ok\n\r");
                                    }

                                    for (int y = 0; y < height; y++) 
                                    {
                                        for (int x = 0; x < width; x++) 
                                        {
                                            int index = y * width + x; // 计算当前像素在原始数据中的索引
                                            unsigned char color = pdata[index]; // 获取当前像素的灰度值（0或255）
                                            // 映射到RGBA值

                                            if (color == 0)
                                            {
                                                pnew_data[index * 4 + 0] = 0; // R
                                                pnew_data[index * 4 + 1] = 0; // G
                                                pnew_data[index * 4 + 2] = 0; // B
                                                pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                                            }
                                            else
                                            {
                                                pnew_data[index * 4 + 0] = 255; // R
                                                pnew_data[index * 4 + 1] = 255; // G
                                                pnew_data[index * 4 + 2] = 255; // B
                                                pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                                            }
                                        }
                                    }

#if 0
                                    stbi_write_bmp("QR_bar_code.bmp", width, height, 4, pnew_data);
                                    // 使用data进行图像处理...
                                    lv_mem_free(pnew_data);
                                    stbi_image_free(pdata); // 释放内存

                                    //显示图像
                                    img = lv_img_create(temp_obj);
                                    lv_img_set_src(img, "A:/root/QR_bar_code.bmp");
                                    lv_obj_center(img);
#endif

                                    sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.bmp",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                                    stbi_write_bmp(bmp_name, width, height, 4, pnew_data);
                                    // 使用data进行图像处理...
                                    lv_mem_free(pnew_data);
                                    stbi_image_free(pdata); // 释放内存

                                    data = stbi_load(bmp_name, &width, &height, &channels, 0);
                                    if (!data) 
                                    {
                                        printf("错误：无法加载图片 %s\n", bmp_name);
                                    }
                                    printf("图片加载成功：%dx%d，%d 通道\n", width, height, channels);

                                    sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.png",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                                    
                                    success = stbi_write_png(bmp_name, width, height, channels, data, width * channels);
                                    if (!success) 
                                    {
                                        printf("错误：保存 PNG 失败\n");
                                    } 
                                    else
                                    {
                                        printf("PNG 保存成功：%s\n", bmp_name);
                                    }

                                    // 释放内存
                                    stbi_image_free(data);

                                    //显示图像
                                    img = lv_img_create(temp_obj);
                                    sprintf(bmp_name_1,"A:%s",bmp_name);
                                    lv_img_set_src(img, bmp_name_1);
                                    lv_obj_center(img);

                                    res = lv_img_decoder_get_info(bmp_name_1, &header);  // 直接传入文件路径

                                    if (res == LV_RES_OK)
                                    {
                                        printf("PNG: %dx%d\n", header.w, header.h);
                                    }
                                    else
                                    {
                                        printf("lv_img_decoder_get_info error\n");
                                    }

                                    lv_img_set_zoom(img,data_structure[i].data.qr_bar.size);

                                    width = header.w * data_structure[i].data.qr_bar.size / 256;
                                    height = header.h * data_structure[i].data.qr_bar.size / 256;

                                    lv_obj_set_size(temp_obj, width, height);

                                    lv_obj_align(temp_obj, LV_ALIGN_OUT_TOP_LEFT, data_structure[i].x, data_structure[i].y);

                                    break;
                                }
                                case 8:
                                {
                                    my_symbol->symbology = BARCODE_C25INTER;
                                    height_len = data_structure[i].data.qr_bar.height;
                                    my_symbol->scale = 1;

                                    if (data_structure[i].data.qr_bar.figure == 1)
                                    {
                                        my_symbol->show_hrt = 1;
                                        memcpy(my_symbol->text,lv_label_get_text(label_btn_addition_QR_code_text),strlen(lv_label_get_text(label_btn_addition_QR_code_text))+ 1);
                                    }
                                    else
                                    {
                                        my_symbol->show_hrt = 0;
                                    }

                                    if (data_structure[i].data.qr_bar.borders == 1)
                                    {
                                        my_symbol->output_options = BARCODE_BOX;
                                        my_symbol->whitespace_width = 3;
                                        my_symbol-> whitespace_height = 3; 
                                        my_symbol-> border_width = 2;   /* Size of border in X-dimensions */
                                    }

                                    strcpy(my_symbol->outfile, "out.bmp");
                                    ZBarcode_Encode(my_symbol, (unsigned char *)data_structure[i].data.qr_bar.text, 0);

                                    ZBarcode_Print(my_symbol, 0);
                                    //ZBarcode_Delete(my_symbol);

                                    pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                                    printf("width=%d\n\r", width);
                                    printf("height=%d\n\r", height);
                                    printf("channels=%d\n\r", channels);
                        
                                    my_symbol->scale = (float)((float)150.0*(float)height_len/(float)QR_BAR_MAX_HIGHT/(float)height);
                                    // my_symbol->scale = (float)height_len/(float)height;
                                    printf("scale=%f\n\r", (double)my_symbol->scale);
            
                                    strcpy(my_symbol->outfile, "out.bmp");
                                    ZBarcode_Encode(my_symbol, (unsigned char *)data_structure[i].data.qr_bar.text, 0);

                                    ZBarcode_Print(my_symbol, 0);
                                    ZBarcode_Delete(my_symbol);
                                    stbi_image_free(pdata);
                    
                                    pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                                    printf("width=%d\n\r", width);
                                    printf("height=%d\n\r", height);
                                    printf("channels=%d\n\r", channels);

                                    lv_obj_set_size(temp_obj, width, height);

                                    pnew_data = (unsigned char*)lv_mem_alloc(width * height * 4); // 为32位数据分配内存
                                    if (!pnew_data) 
                                    {
                                        fprintf(stderr, "Memory allocation failed\n");
                                        stbi_image_free(pdata);
                                        return;
                                    }
                                    else
                                    {
                                        printf("lv_mem_alloc ok\n\r");
                                    }

                                    for (int y = 0; y < height; y++) 
                                    {
                                        for (int x = 0; x < width; x++) 
                                        {
                                            int index = y * width + x; // 计算当前像素在原始数据中的索引
                                            unsigned char color = pdata[index]; // 获取当前像素的灰度值（0或255）
                                            // 映射到RGBA值

                                            if (color == 0)
                                            {
                                                pnew_data[index * 4 + 0] = 0; // R
                                                pnew_data[index * 4 + 1] = 0; // G
                                                pnew_data[index * 4 + 2] = 0; // B
                                                pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                                            }
                                            else
                                            {
                                                pnew_data[index * 4 + 0] = 255; // R
                                                pnew_data[index * 4 + 1] = 255; // G
                                                pnew_data[index * 4 + 2] = 255; // B
                                                pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                                            }
                                        }
                                    }

#if 0
                                    stbi_write_bmp("QR_bar_code.bmp", width, height, 4, pnew_data);
                                    // 使用data进行图像处理...
                                    lv_mem_free(pnew_data);
                                    stbi_image_free(pdata); // 释放内存

                                    //显示图像
                                    img = lv_img_create(temp_obj);
                                    lv_img_set_src(img, "A:/root/QR_bar_code.bmp");
                                    lv_obj_center(img);
#endif

                                    sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.bmp",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                                    stbi_write_bmp(bmp_name, width, height, 4, pnew_data);
                                    // 使用data进行图像处理...
                                    lv_mem_free(pnew_data);
                                    stbi_image_free(pdata); // 释放内存

                                    data = stbi_load(bmp_name, &width, &height, &channels, 0);
                                    if (!data) 
                                    {
                                        printf("错误：无法加载图片 %s\n", bmp_name);
                                    }
                                    printf("图片加载成功：%dx%d，%d 通道\n", width, height, channels);

                                    sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.png",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                                    
                                    success = stbi_write_png(bmp_name, width, height, channels, data, width * channels);
                                    if (!success) 
                                    {
                                        printf("错误：保存 PNG 失败\n");
                                    } 
                                    else
                                    {
                                        printf("PNG 保存成功：%s\n", bmp_name);
                                    }

                                    // 释放内存
                                    stbi_image_free(data);

                                    //显示图像
                                    img = lv_img_create(temp_obj);
                                    sprintf(bmp_name_1,"A:%s",bmp_name);
                                    lv_img_set_src(img, bmp_name_1);
                                    lv_obj_center(img);

                                    res = lv_img_decoder_get_info(bmp_name_1, &header);  // 直接传入文件路径

                                    if (res == LV_RES_OK)
                                    {
                                        printf("PNG: %dx%d\n", header.w, header.h);
                                    }
                                    else
                                    {
                                        printf("lv_img_decoder_get_info error\n");
                                    }

                                    lv_img_set_zoom(img,data_structure[i].data.qr_bar.size);

                                    width = header.w * data_structure[i].data.qr_bar.size / 256;
                                    height = header.h * data_structure[i].data.qr_bar.size / 256;

                                    lv_obj_set_size(temp_obj, width, height);

                                    lv_obj_align(temp_obj, LV_ALIGN_OUT_TOP_LEFT, data_structure[i].x, data_structure[i].y);

                                    break;
                                }
                                case 9:
                                {
                                    my_symbol->symbology = BARCODE_EAN14;
                                    height_len = data_structure[i].data.qr_bar.height;
                                    my_symbol->scale = 1;

                                    if (data_structure[i].data.qr_bar.figure == 1)
                                    {
                                        my_symbol->show_hrt = 1;
                                        memcpy(my_symbol->text,lv_label_get_text(label_btn_addition_QR_code_text),strlen(lv_label_get_text(label_btn_addition_QR_code_text))+ 1);
                                    }
                                    else
                                    {
                                        my_symbol->show_hrt = 0;
                                    }

                                    if (data_structure[i].data.qr_bar.borders == 1)
                                    {
                                        my_symbol->output_options = BARCODE_BOX;
                                        my_symbol->whitespace_width = 3;
                                        my_symbol-> whitespace_height = 3; 
                                        my_symbol-> border_width = 2;   /* Size of border in X-dimensions */
                                    }

                                    strcpy(my_symbol->outfile, "out.bmp");
                                    ZBarcode_Encode(my_symbol, (unsigned char *)data_structure[i].data.qr_bar.text, 0);

                                    ZBarcode_Print(my_symbol, 0);
                                    //ZBarcode_Delete(my_symbol);

                                    pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                                    printf("width=%d\n\r", width);
                                    printf("height=%d\n\r", height);
                                    printf("channels=%d\n\r", channels);
                        
                                    my_symbol->scale = (float)((float)150.0*(float)height_len/(float)QR_BAR_MAX_HIGHT/(float)height);
                                     //my_symbol->scale = (float)height_len/(float)height;
                                    printf("scale=%f\n\r", (double)my_symbol->scale);
    
                                    strcpy(my_symbol->outfile, "out.bmp");
                                    ZBarcode_Encode(my_symbol, (unsigned char *)data_structure[i].data.qr_bar.text, 0);

                                    ZBarcode_Print(my_symbol, 0);
                                    ZBarcode_Delete(my_symbol);
                                    stbi_image_free(pdata);
                            
                                    pdata = stbi_load("out.bmp", &width, &height, &channels, 1);
                                    printf("width=%d\n\r", width);
                                    printf("height=%d\n\r", height);
                                    printf("channels=%d\n\r", channels);

                                    lv_obj_set_size(temp_obj, width, height);

                                    pnew_data = (unsigned char*)lv_mem_alloc(width * height * 4); // 为32位数据分配内存
                                    if (!pnew_data) 
                                    {
                                        fprintf(stderr, "Memory allocation failed\n");
                                        stbi_image_free(pdata);
                                        return;
                                    }
                                    else
                                    {
                                        printf("lv_mem_alloc ok\n\r");
                                    }

                                    for (int y = 0; y < height; y++) 
                                    {
                                        for (int x = 0; x < width; x++) 
                                        {
                                            int index = y * width + x; // 计算当前像素在原始数据中的索引
                                            unsigned char color = pdata[index]; // 获取当前像素的灰度值（0或255）
                                            // 映射到RGBA值

                                            if (color == 0)
                                            {
                                                pnew_data[index * 4 + 0] = 0; // R
                                                pnew_data[index * 4 + 1] = 0; // G
                                                pnew_data[index * 4 + 2] = 0; // B
                                                pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                                            }
                                            else
                                            {
                                                pnew_data[index * 4 + 0] = 255; // R
                                                pnew_data[index * 4 + 1] = 255; // G
                                                pnew_data[index * 4 + 2] = 255; // B
                                                pnew_data[index * 4 + 3] = 255; // A (alpha channel, full opacity)
                                            }
                                        }
                                    }

#if 0
                                    stbi_write_bmp("QR_bar_code.bmp", width, height, 4, pnew_data);
                                    // 使用data进行图像处理...
                                    lv_mem_free(pnew_data);
                                    stbi_image_free(pdata); // 释放内存

                                    //显示图像
                                    img = lv_img_create(temp_obj);
                                    lv_img_set_src(img, "A:/root/QR_bar_code.bmp");
                                    lv_obj_center(img);
#endif

                                    sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.bmp",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                                    stbi_write_bmp(bmp_name, width, height, 4, pnew_data);
                                    // 使用data进行图像处理...
                                    lv_mem_free(pnew_data);
                                    stbi_image_free(pdata); // 释放内存

                                    data = stbi_load(bmp_name, &width, &height, &channels, 0);
                                    if (!data) 
                                    {
                                        printf("错误：无法加载图片 %s\n", bmp_name);
                                    }
                                    printf("图片加载成功：%dx%d，%d 通道\n", width, height, channels);

                                    sprintf(bmp_name,"/media/qr_bar_bmp/%02d%02d%02d%02d%02d%02d.png",g_system_time[0],g_system_time[1],g_system_time[2],g_system_time[3],g_system_time[4],g_system_time[5]);
                                    
                                    success = stbi_write_png(bmp_name, width, height, channels, data, width * channels);
                                    if (!success) 
                                    {
                                        printf("错误：保存 PNG 失败\n");
                                    } 
                                    else
                                    {
                                        printf("PNG 保存成功：%s\n", bmp_name);
                                    }

                                    // 释放内存
                                    stbi_image_free(data);

                                    //显示图像
                                    img = lv_img_create(temp_obj);
                                    sprintf(bmp_name_1,"A:%s",bmp_name);
                                    lv_img_set_src(img, bmp_name_1);
                                    lv_obj_center(img);

                                    res = lv_img_decoder_get_info(bmp_name_1, &header);  // 直接传入文件路径

                                    if (res == LV_RES_OK)
                                    {
                                        printf("PNG: %dx%d\n", header.w, header.h);
                                    }
                                    else
                                    {
                                        printf("lv_img_decoder_get_info error\n");
                                    }

                                    lv_img_set_zoom(img,data_structure[i].data.qr_bar.size);

                                    width = header.w * data_structure[i].data.qr_bar.size / 256;
                                    height = header.h * data_structure[i].data.qr_bar.size / 256;

                                    lv_obj_set_size(temp_obj, width, height);

                                    lv_obj_align(temp_obj, LV_ALIGN_OUT_TOP_LEFT, data_structure[i].x, data_structure[i].y);

                                    break;
                                }
                            }
                            break;
                        }
                        case TYPE_PITCTURE:
                        {

                            temp_obj = lv_obj_create(win_content);

                            lv_obj_set_style_bg_opa(temp_obj, LV_OPA_TRANSP, 0);
                            lv_obj_set_style_border_width(temp_obj, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */

                            lv_obj_add_event_cb(temp_obj, drag_event_handler, LV_EVENT_PRESSING, NULL);
                            lv_obj_add_event_cb(temp_obj, drag_event_handler, LV_EVENT_FOCUSED, NULL);
                            lv_obj_add_event_cb(temp_obj, drag_event_handler, LV_EVENT_DEFOCUSED, NULL);
                            lv_obj_clear_flag(temp_obj, LV_OBJ_FLAG_SCROLLABLE);

                            temp_obj = lv_obj_create(win_content);

                            lv_obj_set_style_bg_opa(temp_obj, LV_OPA_TRANSP, 0);
                            lv_obj_set_style_border_width(temp_obj, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */

                            lv_obj_add_event_cb(temp_obj, drag_event_handler, LV_EVENT_PRESSING, NULL);
                            lv_obj_add_event_cb(temp_obj, drag_event_handler, LV_EVENT_FOCUSED, NULL);
                            lv_obj_add_event_cb(temp_obj, drag_event_handler, LV_EVENT_DEFOCUSED, NULL);
                            lv_obj_clear_flag(temp_obj, LV_OBJ_FLAG_SCROLLABLE);

                            char picture_name[128]={0};

                            // 假设你有一个图片对象
                            img_obj = lv_img_create(temp_obj);

                            if(strcmp(data_structure[i].data.picture.text_1,"png") != 0)
                            {
                                //int width, height, channels;
                                data = stbi_load(data_structure[i].data.picture.text_1, &width, &height, &channels, 0);
                                if (!data) 
                                {
                                    printf("错误：无法加载图片 %s\n", data_structure[i].data.picture.text_1);
                                }

                                printf("图片加载成功：%dx%d，%d 通道\n", width, height, channels);


                                // 步骤 2：将数据保存为 PNG
                                success = stbi_write_png(data_structure[i].data.picture.text_2, width, height, channels, data, width * channels);
                                if (!success) 
                                {
                                    printf("错误：保存 PNG 失败\n");
                                } 
                                else 
                                {
                                    printf("PNG 保存成功：%s\n", data_structure[i].data.picture.text_2);
                                }

                                sprintf(picture_name, "A:%s", data_structure[i].data.picture.text_2);

                                stbi_image_free(data);
                            }
                            else
                            {
                                sprintf(picture_name, "A:%s", data_structure[i].data.picture.text_1);
                            }
                            
                            lv_img_set_src(img_obj, picture_name);
                            lv_obj_center(img_obj);
                            
                            res = lv_img_decoder_get_info(picture_name, &header);  // 直接传入文件路径

                            if (res == LV_RES_OK)
                            {
                                printf("PNG: %dx%d\n", header.w, header.h);
                            }
                            else
                            {
                                printf("lv_img_decoder_get_info error\n");
                            }

                            lv_img_set_zoom(img_obj,data_structure[i].data.picture.size);

                            width = header.w * data_structure[i].data.picture.size / 256;
                            height = header.h * data_structure[i].data.picture.size / 256;

                            lv_obj_set_size(temp_obj, width, height);
                            lv_obj_align(temp_obj, LV_ALIGN_OUT_TOP_LEFT, data_structure[i].x, data_structure[i].y); 
                            break;
                        }
                        case TYPE_ICON:
                        {

                            temp_obj = lv_obj_create(win_content);

                            lv_obj_set_style_bg_opa(temp_obj, LV_OPA_TRANSP, 0);
                            lv_obj_set_style_border_width(temp_obj, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */

                            lv_obj_add_event_cb(temp_obj, drag_event_handler, LV_EVENT_PRESSING, NULL);
                            lv_obj_add_event_cb(temp_obj, drag_event_handler, LV_EVENT_FOCUSED, NULL);
                            lv_obj_add_event_cb(temp_obj, drag_event_handler, LV_EVENT_DEFOCUSED, NULL);
                            lv_obj_clear_flag(temp_obj, LV_OBJ_FLAG_SCROLLABLE);

                            // 假设你有一个图片对象
                            img_obj = lv_img_create(temp_obj);
                            lv_img_set_src(img_obj,  &icon_buf[data_structure[i].data.icon.type]);

                            lv_obj_center(img_obj);

                            lv_img_set_zoom(img_obj, data_structure[i].data.icon.size);

                            // 获取图片对象
                            img_1 = (lv_img_t*)img_obj;

                            // 获取图片的源文件
                            img_dsc = (lv_img_dsc_t*)img_1->src;

                            // 获取图片的宽和高
                            width = img_dsc->header.w * data_structure[i].data.icon.size / 256;
                            height = img_dsc->header.h * data_structure[i].data.icon.size / 256;

                            // 打印宽和高
                            printf("Image width: %d, height: %d\n", width, height);
                            lv_obj_set_size(temp_obj, width, height);
                            lv_obj_align(temp_obj, LV_ALIGN_OUT_TOP_LEFT, data_structure[i].x, data_structure[i].y); 
                            break;
                        }
                        case TYPE_BREAK:
                        {
                            temp_obj = lv_obj_create(win_content);
                            lv_obj_set_style_bg_opa(temp_obj, LV_OPA_COVER, 0);
                            lv_obj_set_style_bg_color(temp_obj, lv_color_hex(0xFF6A6A), LV_STATE_DEFAULT);
                            lv_obj_set_style_border_width(temp_obj, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */

                            lv_obj_add_event_cb(temp_obj, drag_event_handler, LV_EVENT_PRESSING, NULL);
                            lv_obj_add_event_cb(temp_obj, drag_event_handler, LV_EVENT_FOCUSED, NULL);
                            lv_obj_add_event_cb(temp_obj, drag_event_handler, LV_EVENT_DEFOCUSED, NULL);
                            lv_obj_clear_flag(temp_obj, LV_OBJ_FLAG_SCROLLABLE);

                            lv_obj_set_size(temp_obj, 5, 150);

                            lv_obj_align(temp_obj, LV_ALIGN_OUT_TOP_LEFT, data_structure[i].x, data_structure[i].y); 
                            break;
                        }
                        case TYPE_COUNT:
                        {
                            //保存所有数据
                            //data_structure[win_content_child_num].data.count.law = lv_dropdown_get_selected(dropdown_addition_count_law);
                            //data_structure[win_content_child_num].data.count.repetition = atoi(lv_label_get_text(label_btn_addition_count_times_repetition));

                            temp_obj = lv_obj_create(win_content);
                            //sprintf(temp_typeface, "/media/%s", typeface_buf[data_structure[win_content_child_num].data.count.typeface]);
                            //data_structure[win_content_child_num].data.count.typeface = i;
                            //printf("%s\n", temp_typeface);
                            //data_structure[win_content_child_num].data.count.info.name = temp_typeface;
                            data_structure[win_content_child_num].data.count.info.weight = data_structure[win_content_child_num].data.count.size;

                            //lv_ft_font_init(&data_structure[win_content_child_num].data.count.info);
                            lv_font_t* temp_font = font_list_get(data_structure[win_content_child_num].data.count.typeface, data_structure[win_content_child_num].data.count.size, 0);

                            printf("lead_zero=%d\n\r", data_structure[win_content_child_num].data.count.lead_zero);
                            printf("law=%d\n\r", data_structure[win_content_child_num].data.count.law);

                            //确定显示值的位数
                            //递增
                            if (data_structure[win_content_child_num].data.count.law == 0)
                            {
                                if (data_structure[win_content_child_num].data.count.current_value < data_structure[win_content_child_num].data.count.minimum)
                                {
                                    data_structure[win_content_child_num].data.count.current_value = data_structure[win_content_child_num].data.count.minimum;
                                }
                                else if(data_structure[win_content_child_num].data.count.current_value > data_structure[win_content_child_num].data.count.maximum)
                                {
                                    data_structure[win_content_child_num].data.count.current_value = data_structure[win_content_child_num].data.count.maximum;
                                }

                                if (data_structure[win_content_child_num].data.count.lead_zero == 0)
                                {
                                    formatNumberWithLeadingZeros(data_structure[win_content_child_num].data.count.current_value, data_structure[win_content_child_num].data.count.maximum, tempString);
                                }
                                else
                                {
                                    sprintf(tempString, "%d", data_structure[win_content_child_num].data.count.current_value);
                                }
                            }
                            else
                            {
                                if (data_structure[win_content_child_num].data.count.current_value < data_structure[win_content_child_num].data.count.minimum)
                                {
                                    data_structure[win_content_child_num].data.count.current_value = data_structure[win_content_child_num].data.count.minimum;
                                }
                                else if (data_structure[win_content_child_num].data.count.current_value > data_structure[win_content_child_num].data.count.maximum)
                                {
                                    data_structure[win_content_child_num].data.count.current_value = data_structure[win_content_child_num].data.count.maximum;
                                }

                                if (data_structure[win_content_child_num].data.count.lead_zero == 0)
                                {
                                    formatNumberWithLeadingZeros(data_structure[win_content_child_num].data.count.current_value, data_structure[win_content_child_num].data.count.maximum, tempString);
                                }
                                else
                                {
                                    sprintf(tempString, "%d", data_structure[win_content_child_num].data.count.current_value);
                                }       
                            }

                            printf("tempString=%s\n\r", tempString);

                            word_space =  data_structure[win_content_child_num].data.count.space;
                            lv_txt_get_size(&text_size, tempString, temp_font, word_space, 0, LV_COORD_MAX, LV_TEXT_FLAG_NONE);

                            lv_obj_set_style_bg_opa(temp_obj, LV_OPA_TRANSP, 0);
                            lv_obj_set_style_border_width(temp_obj, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */

                            lv_obj_add_event_cb(temp_obj, drag_event_handler, LV_EVENT_PRESSING, NULL);
                            lv_obj_add_event_cb(temp_obj, drag_event_handler, LV_EVENT_FOCUSED, NULL);
                            lv_obj_add_event_cb(temp_obj, drag_event_handler, LV_EVENT_DEFOCUSED, NULL);
                            lv_obj_clear_flag(temp_obj, LV_OBJ_FLAG_SCROLLABLE);

                            lv_style_init(&data_structure[win_content_child_num].data.count.style);
                            lv_style_set_text_font(&data_structure[win_content_child_num].data.count.style, temp_font);
                            printf("x=%u y=%u\n\r", text_size.x, text_size.y);
                            lv_obj_set_size(temp_obj, text_size.x, text_size.y);

                            lv_style_set_text_letter_space(&data_structure[win_content_child_num].data.count.style, word_space);
                            label1 = lv_label_create(temp_obj);
                            lv_obj_add_style(label1, &data_structure[win_content_child_num].data.count.style, 0);
                            lv_label_set_text(label1, tempString);
                            lv_obj_center(label1);
    
                            lv_obj_align(temp_obj, LV_ALIGN_OUT_TOP_LEFT, data_structure[i].x, data_structure[i].y); 

                            break;
                        }
                        case TYPE_SYMBOL:
                        {
                            temp_obj = lv_obj_create(win_content);

                            //sprintf(temp_typeface, "/media/%s", typeface_buf[0]);
                            //data_structure[win_content_child_num].data.word.typeface = 0;
                            //info.name = "./lvgl/src/extra/libs/freetype/arial.ttf";
                            //info.name = "./lvgl/src/extra/libs/freetype/simsun.ttc";
                            //sprintf(temp_typeface, "./lvgl/src/extra/libs/freetype/%s", typeface_buf[SOURCE_HAN_SERIF_CN_REGULAR_1]);
                            //printf("%s\n", temp_typeface);

                            //data_structure[win_content_child_num].data.word.info.name = temp_typeface;

                            data_structure[win_content_child_num].data.word.info.weight = data_structure[win_content_child_num].data.word.size;

                            data_structure[win_content_child_num].data.word.spin = 0;

                            data_structure[win_content_child_num].data.word.info.style = FT_FONT_STYLE_NORMAL;

                            //lv_ft_font_init(&data_structure[win_content_child_num].data.word.info);
                            lv_font_t* temp_font = font_list_get(0, data_structure[win_content_child_num].data.word.size, 0);

                            lv_txt_get_size(&text_size, typeface_buf[0], temp_font, 0, 0, LV_COORD_MAX, LV_TEXT_FLAG_NONE);

                            lv_obj_set_style_bg_opa(temp_obj, LV_OPA_TRANSP, 0);
                            lv_obj_set_style_border_width(temp_obj, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */

                            lv_obj_add_event_cb(temp_obj, drag_event_handler, LV_EVENT_PRESSING, NULL);
                            lv_obj_add_event_cb(temp_obj, drag_event_handler, LV_EVENT_FOCUSED, NULL);
                            lv_obj_add_event_cb(temp_obj, drag_event_handler, LV_EVENT_DEFOCUSED, NULL);
                            lv_obj_clear_flag(temp_obj, LV_OBJ_FLAG_SCROLLABLE);

                            lv_style_init(&data_structure[win_content_child_num].data.word.style);
                            lv_style_set_text_font(&data_structure[win_content_child_num].data.word.style, temp_font);

                            lv_obj_set_size(temp_obj, text_size.x, text_size.y);

                            label1 = lv_label_create(temp_obj);
                            lv_obj_add_style(label1, &data_structure[win_content_child_num].data.word.style, 0);
                            lv_label_set_text(label1, data_structure[win_content_child_num].data.word.text);
                            lv_obj_center(label1);
                            lv_obj_align(temp_obj, LV_ALIGN_OUT_TOP_LEFT, data_structure[i].x, data_structure[i].y); 
                            break;
                        }
                    }     
                }
            }
        } 
    }   
}

int get_sd_id(void)
{
  FILE *fp = fopen("/sys/block/mmcblk0/device/serial", "r");
    if (!fp) 
    {
        perror("无法打开 serial 文件");
        return -1;
    }

    if (fseek(fp, 2, SEEK_SET) != 0) 
    {
        perror("无法跳过第1个字符");
        fclose(fp);
        return -1;
    }

    if (fscanf(fp, "%08x", &g_sd_serial) != 1) 
    {
        perror("读取 serial 失败");
        fclose(fp);
        return -1;
    }

    fclose(fp);
    printf("SD 卡序列号: %08X\n", g_sd_serial);

    return 0;
}


static void button_left_stop_event_cb(lv_event_t* e)
{
    lv_event_code_t code;
    lv_coord_t x_vaule;

    code = lv_event_get_code(e);
    if ((code == LV_EVENT_CLICKED) && (print_status == 0))
    {
        printf("button_left_stop__event_cb\n\r");

        x_vaule = lv_obj_get_x(win_content);
        printf("x_vaule=%d\n\r", x_vaule);
        //-15~-15615
        x_vaule = x_vaule + 50;
        if (x_vaule >= -15)
        {
            x_vaule = -15;
        }

        lv_obj_set_pos(win_content, x_vaule, -15);//Limit drag boundaries

        lv_slider_set_value(slider_main, ( - 15 - x_vaule) / 156, LV_ANIM_ON);
    }
}

static void button_right_stop_event_cb(lv_event_t* e)
{
    lv_event_code_t code;
    lv_coord_t x_vaule;

    code = lv_event_get_code(e);
    if ((code == LV_EVENT_CLICKED) && (print_status == 0))
    {
        printf("button_right_stop_event_cb\n\r");
        x_vaule = lv_obj_get_x(win_content);
        printf("x_vaule=%d\n\r", x_vaule);
        //-15~-15615
        x_vaule = x_vaule - 50;
        if (x_vaule <= -15615)
        {
            x_vaule = -15615;
        }

        lv_obj_set_pos(win_content, x_vaule, -15);//Limit drag boundaries

        lv_slider_set_value(slider_main, (-15 - x_vaule) / 156, LV_ANIM_ON);
    }
}



void lv_demo_widgets(void)
{
	char databuf[32];
    //int retvalue;
    //char buf[2]={0};
    //char cmd[128];

    if(LV_HOR_RES <= 320) 
    {
        disp_size = DISP_SMALL;
    }
    else if(LV_HOR_RES < 720) 
    {
        disp_size = DISP_MEDIUM;
    }
    else 
    {
        disp_size = DISP_LARGE;
    }
    
    font_large = LV_FONT_DEFAULT;
    font_normal = LV_FONT_DEFAULT;

#if 0
    lv_coord_t tab_h;
    if(disp_size == DISP_LARGE) {
        tab_h = 70;
#if LV_FONT_MONTSERRAT_24
        font_large     = &lv_font_montserrat_24;
#else
        LV_LOG_WARN("LV_FONT_MONTSERRAT_24 is not enabled for the widgets demo. Using LV_FONT_DEFAULT instead.");
#endif
#if LV_FONT_MONTSERRAT_16
        font_normal    = &lv_font_montserrat_16;
#else
        LV_LOG_WARN("LV_FONT_MONTSERRAT_16 is not enabled for the widgets demo. Using LV_FONT_DEFAULT instead.");
#endif
    }
    else if(disp_size == DISP_MEDIUM) {
        tab_h = 45;
#if LV_FONT_MONTSERRAT_20
        font_large     = &lv_font_montserrat_20;
#else
        LV_LOG_WARN("LV_FONT_MONTSERRAT_20 is not enabled for the widgets demo. Using LV_FONT_DEFAULT instead.");
#endif
#if LV_FONT_MONTSERRAT_14
        font_normal    = &lv_font_montserrat_14;
#else
        LV_LOG_WARN("LV_FONT_MONTSERRAT_14 is not enabled for the widgets demo. Using LV_FONT_DEFAULT instead.");
#endif
    }
    else {   /* disp_size == DISP_SMALL */
        tab_h = 45;
#if LV_FONT_MONTSERRAT_18
        font_large     = &lv_font_montserrat_18;
#else
        LV_LOG_WARN("LV_FONT_MONTSERRAT_18 is not enabled for the widgets demo. Using LV_FONT_DEFAULT instead.");
#endif
#if LV_FONT_MONTSERRAT_12
        font_normal    = &lv_font_montserrat_12;
#else
        LV_LOG_WARN("LV_FONT_MONTSERRAT_12 is not enabled for the widgets demo. Using LV_FONT_DEFAULT instead.");
#endif
    }

#if LV_USE_THEME_DEFAULT
    lv_theme_default_init(NULL, lv_palette_main(LV_PALETTE_BLUE), lv_palette_main(LV_PALETTE_RED), LV_THEME_DEFAULT_DARK,
                          font_normal);
#endif
#endif

#if 0

    lv_fs_file_t lv_file;
  	lv_fs_res_t  lv_res;
    char buf[20] = {0};
    int num;

  	lv_res = lv_fs_open( &lv_file, "A:/root/1.txt", LV_FS_MODE_RD );
  	if ( lv_res != LV_FS_RES_OK ) 
    {
    	printf( "LVGL FS open error. (%d)\n", lv_res );
  	} 
    else 
    {
        printf( "LVGL FS open Ok\n" );
    }

    lv_res = lv_fs_read(&lv_file,buf,5,&num);
    if(lv_res != LV_FS_RES_OK )
    {
        printf( "LVGL f_read error. (%d)\n", lv_res);
    }
    else
    {
        printf( "%s\n", buf);
    }
    
  	
	lv_fs_close(&lv_file);

#if 0
    lv_draw_rect_dsc_t rect_dsc;
    /* 初始化绘画矩形 */
    lv_draw_rect_dsc_init(&rect_dsc);
    /* 设置圆角 */
    rect_dsc.radius = 10;
    /* 设置透明度 */
    rect_dsc.bg_opa = LV_OPA_COVER;
    /* 设置颜色渐变方向 */
    rect_dsc.bg_grad.dir = LV_GRAD_DIR_HOR;
    /* 设置开始颜色 */
    rect_dsc.bg_grad.stops[0].color = lv_palette_main(LV_PALETTE_RED);
    /* 设置结束颜色 */
    rect_dsc.bg_grad.stops[1].color = lv_palette_main(LV_PALETTE_BLUE);
    /* 设置边缘宽度 */
    rect_dsc.border_width = 2;
    /* 设置边缘透明度 */
    rect_dsc.border_opa = LV_OPA_90;
    /* 设置边缘颜色 */
    rect_dsc.border_color = lv_color_white();
    /* 在画布上绘制矩形 */
    lv_canvas_draw_rect(canvas,0,0,50,50,&rect_dsc);
#endif

#if 0

    /* 定义绘制标签 */
    lv_draw_label_dsc_t label_dsc;
    /* 初始化绘制标签 */
    lv_draw_label_dsc_init(&label_dsc);
    /* 设置标签颜色 */
    label_dsc.color = lv_color_black();
    /* 在画布上绘制标签 */
    lv_canvas_draw_text(canvas,0,0,1024,&label_dsc,"Some text on text canvas");
#endif

/* 字体测试*/
    lv_font_t *my_font;
    my_font = lv_font_load("A:/usr/font/songFont36.bin");
    if (my_font == NULL)
    {
        printf("font load failed\n");
    }
    else
    {
       printf("font load ok\n");
    }
    

    static lv_style_t font_style;
    lv_style_init(&font_style);
    lv_style_set_text_font(&font_style, my_font);


    lv_obj_t *label_zh = lv_label_create(lv_scr_act());
    lv_obj_align(label_zh, LV_ALIGN_BOTTOM_MID, 0, 0);
    lv_obj_add_style(label_zh, &font_style, 0);
    lv_label_set_text(label_zh, "中国智造");

    lv_font_free(my_font);

#endif


    //delete_bmp_files("/media/qr_bar_bmp");
    delete_bmp_files();

    get_system_data();

    get_sd_id();

    //get_config_data();

    //lv_obj_add_event_cb(lv_scr_act(), screen_touched_event_handler, LV_EVENT_PRESSED, NULL);

    LV_IMG_DECLARE(head_background_image);
    Head_background_image = lv_img_create(lv_scr_act()); /* 创建图片部件 */
    lv_img_set_src(Head_background_image, &head_background_image); /* 设置图片源 */
    /* 设置图片位置 */
    lv_obj_align(Head_background_image, LV_ALIGN_TOP_LEFT, 0, 0);
    lv_obj_update_layout(Head_background_image); /* 更新图片参数 */

    LV_FONT_DECLARE(heiFont16_1);
    Total_output_label = lv_label_create(lv_scr_act());
    lv_obj_set_style_text_font(Total_output_label, (const lv_font_t *)&heiFont16_1, 0);
    //LoadConfigFile(config_file);
    //g_total_output = GetConfigFromString("system_data");
    if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
    {
        sprintf(databuf,"总产量:%u",system_data.total_output);
    }
    else if(system_data.system.language == LANGUAGE_ENGLISH)
    {
        sprintf(databuf,"Total Output:%u",system_data.total_output);
    }

    lv_label_set_text(Total_output_label, databuf);
    lv_obj_align(Total_output_label, LV_ALIGN_TOP_LEFT, 0, 5);
    lv_obj_set_style_text_color(Total_output_label, lv_color_hex(0xffffff),LV_STATE_DEFAULT);

    Date_label = lv_label_create(lv_scr_act());
    lv_obj_set_style_text_font(Date_label, (const lv_font_t *)&heiFont16_1, 0);
    lv_label_set_text(Date_label, g_time_data_string);
    lv_label_set_text(Date_label, "");
    lv_obj_align(Date_label, LV_ALIGN_TOP_LEFT, 160, 5);
    lv_obj_set_style_text_color(Date_label, lv_color_hex(0xffffff),LV_STATE_DEFAULT);

    Time_label = lv_label_create(lv_scr_act());
    lv_obj_set_style_text_font(Time_label, (const lv_font_t *)&heiFont16_1, 0);
    lv_label_set_text(Time_label, g_time_time_string);
    lv_obj_align(Time_label, LV_ALIGN_TOP_LEFT, 280, 5);
    lv_obj_set_style_text_color(Time_label, lv_color_hex(0xffffff),LV_STATE_DEFAULT);

    Battery_label = lv_label_create(lv_scr_act());
    lv_obj_set_style_text_font(Battery_label, (const lv_font_t *)&heiFont16_1, 0);
    //lv_label_set_text(Battery_label, "80%");
    //lv_obj_align(Battery_label, LV_ALIGN_TOP_LEFT, 405, 0);
    lv_obj_set_style_text_color(Battery_label, lv_color_hex(0xffffff),LV_STATE_DEFAULT);

    //LV_IMG_DECLARE(lv_font_montserrat_14);
    Battery_image = lv_label_create(lv_scr_act());
    lv_obj_set_style_text_font(Battery_image, (const lv_font_t *)&lv_font_montserrat_28, 0);
    //lv_label_set_text(Battery_image, LV_SYMBOL_BATTERY_3);
    lv_label_set_text(Battery_image, "");
    lv_obj_align(Battery_image, LV_ALIGN_TOP_LEFT, 440, -3);
    lv_obj_set_style_text_color(Battery_image, lv_color_hex(0x00ff00),LV_STATE_DEFAULT);


    lv_freetype_init(40, 200, 1024*1024);
#if 0
    lv_freetype_init(64, 1, 0);
    ///*Create a font*/
    //static lv_ft_info_t info;
    //info.name = "./lvgl/src/extra/libs/freetype/arial.ttf";
    //info.name = "./lvgl/src/extra/libs/freetype/simsun.ttc";
    main_info.name = "/media/SourceHanSerifCN-Regular-1.otf";
    main_info.weight = 80;
    //info.style = FT_FONT_STYLE_BOLD | FT_FONT_STYLE_ITALIC;
    //info.style = FT_FONT_STYLE_BOLD;
    main_info.style = FT_FONT_STYLE_NORMAL;
    lv_ft_font_init(&main_info);


    //static lv_style_t style;
    //lv_style_init(&style);
    //lv_style_set_text_font(&style, main_info.font);


    //lv_obj_t* label123 = lv_label_create(lv_scr_act());
    //lv_obj_add_style(label123, &style, 0);
    //lv_label_set_text(label123, "欢迎使用");


    /* 第二步：创建一个画布*/
    win_content = lv_obj_create(lv_scr_act());
    lv_obj_set_size(win_content, 480, 160);
    lv_obj_align(win_content, LV_ALIGN_TOP_LEFT, 0, 24);
    lv_obj_set_style_bg_color(win_content, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
    lv_obj_set_style_border_width(win_content, 1, LV_STATE_DEFAULT); /* 设置边框宽度 */
    lv_obj_set_style_border_color(win_content, lv_color_hex(0xcccccc), LV_STATE_DEFAULT); /* 设置边框颜色 */
    lv_obj_remove_style(win_content, 0, LV_PART_SCROLLBAR);
    lv_obj_set_scrollbar_mode(win_content, LV_SCROLLBAR_MODE_ON);
    lv_obj_set_style_radius(win_content, 1, LV_STATE_DEFAULT); /* 设置圆角 */

    //LV_FONT_DECLARE(heiFont16_1);
    lv_draw_label_dsc_init(&main_label_dsc);
    main_label_dsc.color = lv_color_black();
    //main_label_dsc.font = &heiFont16_1;
    main_label_dsc.font = main_info.font;
    main_canvas = lv_canvas_create(win_content);
    lv_obj_align(main_canvas, LV_ALIGN_TOP_LEFT, 0, 0);

    /* 第三步：为画布设置缓冲区 */
    lv_canvas_set_buffer(main_canvas, canvasBuf, CANVAS_WIDTH, CANVAS_HEIGHT, LV_IMG_CF_TRUE_COLOR);
    lv_canvas_fill_bg(main_canvas, lv_color_hex(0xffffff), LV_OPA_COVER);

    lv_canvas_set_palette(main_canvas, 0, lv_color_hex3(0x33f));
    lv_canvas_set_palette(main_canvas, 1, lv_color_hex3(0xeef));
    lv_obj_align(main_canvas, LV_ALIGN_TOP_LEFT, 0, 0);
    lv_canvas_fill_bg(main_canvas, lv_color_hex(0xffffff), LV_OPA_COVER);
    lv_canvas_draw_text(main_canvas, 0, 0, CANVAS_WIDTH, &main_label_dsc, "12345678");
#endif



    LV_IMG_DECLARE(ThisSideUp1);
    LV_IMG_DECLARE(ThisSideUp2);
    LV_IMG_DECLARE(ThisSideUp3);
    LV_IMG_DECLARE(ThisSideUp4);
    LV_IMG_DECLARE(BeAfraidOfRain1);
    LV_IMG_DECLARE(BeAfraidOfRain2);
    LV_IMG_DECLARE(BeAfraidOfRain3);
    LV_IMG_DECLARE(BeAfraidOfRain4);
    LV_IMG_DECLARE(fragile1);
    LV_IMG_DECLARE(fragile2);
    LV_IMG_DECLARE(fragile3);
    LV_IMG_DECLARE(fragile4);
    LV_IMG_DECLARE(fragile5);
    LV_IMG_DECLARE(putDownGently1);
    LV_IMG_DECLARE(PutDownGently2);
    LV_IMG_DECLARE(PutDownGently3);
    LV_IMG_DECLARE(PutDownGently4);
    LV_IMG_DECLARE(FearOfTheSun);
    LV_IMG_DECLARE(FearOfTheSun1);
    LV_IMG_DECLARE(FearOfTheSun2);
    LV_IMG_DECLARE(FearOfTheSun3);
    LV_IMG_DECLARE(NoStepping);
    LV_IMG_DECLARE(NoStepping1);
    LV_IMG_DECLARE(NoStepping2);
    LV_IMG_DECLARE(NoStepping3);
    LV_IMG_DECLARE(FearOfFire);
    LV_IMG_DECLARE(FearOfFire1);
    LV_IMG_DECLARE(FearOfFire2);
    LV_IMG_DECLARE(FearOfFire3);
    LV_IMG_DECLARE(handHook);
    LV_IMG_DECLARE(handHook1);
    LV_IMG_DECLARE(handHook2);
    LV_IMG_DECLARE(handHook3);
    LV_IMG_DECLARE(img_roll);
    LV_IMG_DECLARE(img_roll1);
    LV_IMG_DECLARE(img_roll2);
    LV_IMG_DECLARE(img_roll3);
    LV_IMG_DECLARE(heapUp);
    LV_IMG_DECLARE(heapUp1);
    LV_IMG_DECLARE(heapUp2);
    LV_IMG_DECLARE(heapUp3);
    LV_IMG_DECLARE(heapUp4);
    LV_IMG_DECLARE(heapUp5);
    LV_IMG_DECLARE(heapUp6);
    LV_IMG_DECLARE(noLittering);
    LV_IMG_DECLARE(MobiusLoop);
    LV_IMG_DECLARE(MobiusLoop1);
    LV_IMG_DECLARE(MobiusLoop2);
    LV_IMG_DECLARE(MobiusLoop3);
    LV_IMG_DECLARE(MobiusLoop4);
    LV_IMG_DECLARE(PlasticGrade_1);
    LV_IMG_DECLARE(PlasticGrade_2);
    LV_IMG_DECLARE(PlasticGrade_3);
    LV_IMG_DECLARE(PlasticGrade_4);
    LV_IMG_DECLARE(PlasticGrade_5);
    LV_IMG_DECLARE(PlasticGrade_6);
    LV_IMG_DECLARE(PlasticGrade_7);
    LV_IMG_DECLARE(GreenDot);
    LV_IMG_DECLARE(WEEE);
    LV_IMG_DECLARE(RoHS_1);
    LV_IMG_DECLARE(RoHS_2);
    LV_IMG_DECLARE(RoHS_3);
    LV_IMG_DECLARE(RoHS_4);
    LV_IMG_DECLARE(CE);
    LV_IMG_DECLARE(FC);
    LV_IMG_DECLARE(UL_1);
    LV_IMG_DECLARE(UL_2);
    LV_IMG_DECLARE(CB);
    LV_IMG_DECLARE(RU_1);
    LV_IMG_DECLARE(RU_2);
    LV_IMG_DECLARE(ETL);
    LV_IMG_DECLARE(PSE_1);
    LV_IMG_DECLARE(PSE_2);
    LV_IMG_DECLARE(CCC);
    LV_IMG_DECLARE(SA);
    LV_IMG_DECLARE(CQC);
    LV_IMG_DECLARE(DVE);
    LV_IMG_DECLARE(GS);
    LV_IMG_DECLARE(EMC);
    LV_IMG_DECLARE(KC);
    LV_IMG_DECLARE(SAA);
    LV_IMG_DECLARE(MA);
    LV_IMG_DECLARE(ITS);
    LV_IMG_DECLARE(CAL);
    LV_IMG_DECLARE(EAC);
    LV_IMG_DECLARE(C_TICK);
    LV_IMG_DECLARE(BSMI);
    LV_IMG_DECLARE(WSC);
    LV_IMG_DECLARE(TUV_1);
    LV_IMG_DECLARE(TUV_2);
    LV_IMG_DECLARE(CNAS);
    LV_IMG_DECLARE(FSC);
    LV_IMG_DECLARE(staticElectricity);
    LV_IMG_DECLARE(paper);
    LV_IMG_DECLARE(CorrugatedRecycling);
    LV_IMG_DECLARE(GreatWallCertification);
    LV_IMG_DECLARE(MembraneAssociation);
    LV_IMG_DECLARE(age0_3);


    icon_buf[0] = ThisSideUp1;
    icon_buf[1] = ThisSideUp2;
    icon_buf[2] = ThisSideUp3;
    icon_buf[3] = ThisSideUp4;
    icon_buf[4] = BeAfraidOfRain1;
    icon_buf[5] = BeAfraidOfRain2;
    icon_buf[6] = BeAfraidOfRain3;
    icon_buf[7] = BeAfraidOfRain4;
    icon_buf[8] = fragile1;
    icon_buf[9] = fragile2;
    icon_buf[10] = fragile3;
    icon_buf[11] = fragile4;
    icon_buf[12] = fragile5;
    icon_buf[13] = putDownGently1;
    icon_buf[14] = PutDownGently2;
    icon_buf[15] = PutDownGently3;
    icon_buf[16] = PutDownGently4;
    icon_buf[17] = FearOfTheSun;
    icon_buf[18] = FearOfTheSun1;
    icon_buf[19] = FearOfTheSun2;
    icon_buf[20] = FearOfTheSun3;
    icon_buf[21] = NoStepping;
    icon_buf[22] = NoStepping1;
    icon_buf[23] = NoStepping2;
    icon_buf[24] = NoStepping3;
    icon_buf[25] = FearOfFire;
    icon_buf[26] = FearOfFire1;
    icon_buf[27] = FearOfFire2;
    icon_buf[28] = FearOfFire3;
    icon_buf[29] = handHook;
    icon_buf[30] = handHook1;
    icon_buf[31] = handHook2;
    icon_buf[32] = handHook3;
    icon_buf[33] = img_roll;
    icon_buf[34] = img_roll1;
    icon_buf[35] = img_roll2;
    icon_buf[36] = img_roll3;
    icon_buf[37] = heapUp;
    icon_buf[38] = heapUp1;
    icon_buf[39] = heapUp2;
    icon_buf[40] = heapUp3;
    icon_buf[41] = heapUp4;
    icon_buf[42] = heapUp5;
    icon_buf[43] = heapUp6;
    icon_buf[44] = noLittering;
    icon_buf[45] = MobiusLoop;
    icon_buf[46] = MobiusLoop1;
    icon_buf[47] = MobiusLoop2;
    icon_buf[48] = MobiusLoop3;
    icon_buf[49] = MobiusLoop4;
    icon_buf[50] = PlasticGrade_1;
    icon_buf[51] = PlasticGrade_2;
    icon_buf[52] = PlasticGrade_3;
    icon_buf[53] = PlasticGrade_4;
    icon_buf[54] = PlasticGrade_5;
    icon_buf[55] = PlasticGrade_6;
    icon_buf[56] = PlasticGrade_7;
    icon_buf[57] = GreenDot;
    icon_buf[58] = WEEE;
    icon_buf[59] = RoHS_1;
    icon_buf[60] = RoHS_2;
    icon_buf[61] = RoHS_3;
    icon_buf[62] = RoHS_4;
    icon_buf[63] = CE;
    icon_buf[64] = FC;
    icon_buf[65] = UL_1;
    icon_buf[66] = UL_2;
    icon_buf[67] = CB;
    icon_buf[68] = RU_1;
    icon_buf[69] = RU_2;
    icon_buf[70] = ETL;
    icon_buf[71] = PSE_1;
    icon_buf[72] = PSE_2;
    icon_buf[73] = CCC;
    icon_buf[74] = SA;
    icon_buf[75] = CQC;
    icon_buf[76] = DVE;
    icon_buf[77] = GS;
    icon_buf[78] = EMC;
    icon_buf[79] = KC;
    icon_buf[80] = SAA;
    icon_buf[81] = MA;
    icon_buf[82] = ITS;
    icon_buf[83] = CAL;
    icon_buf[84] = EAC;
    icon_buf[85] = C_TICK;
    icon_buf[86] = BSMI;
    icon_buf[87] = WSC;
    icon_buf[88] = TUV_1;
    icon_buf[89] = TUV_2;
    icon_buf[90] = CNAS;
    icon_buf[91] = FSC;
    icon_buf[92] = staticElectricity;
    icon_buf[93] = paper;
    icon_buf[94] = CorrugatedRecycling;
    icon_buf[95] = GreatWallCertification;
    icon_buf[96] = MembraneAssociation;
    icon_buf[97] = age0_3;


    win_obj = lv_obj_create(lv_scr_act());
    lv_obj_align(win_obj, LV_ALIGN_TOP_LEFT, 0, 24);
    lv_obj_set_size(win_obj, 480, 160);
    lv_obj_set_style_bg_color(win_obj, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
    lv_obj_set_style_border_width(win_obj, 0, LV_STATE_DEFAULT); /* 设置边框宽度 */
    lv_obj_set_style_border_color(win_obj, lv_color_hex(0xcccccc), LV_STATE_DEFAULT); /* 设置边框颜色 */
    lv_obj_clear_flag(win_obj, LV_OBJ_FLAG_SCROLLABLE);
    lv_obj_set_style_radius(win_obj, 0, LV_STATE_DEFAULT); /* 设置圆角 */

    win_content = lv_obj_create(win_obj);
    lv_obj_set_size(win_content, CANVAS_WIDTH, CANVAS_HEIGHT);
    //lv_obj_set_size(win_content, 1000, 158);
    lv_obj_align(win_content, LV_ALIGN_TOP_LEFT, -15, -15);
    lv_obj_set_style_bg_color(win_content, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
    lv_obj_set_style_border_width(win_content, 2, LV_STATE_DEFAULT); /* 设置边框宽度 */
    lv_obj_set_style_border_color(win_content, lv_color_hex(0xcccccc), LV_STATE_DEFAULT); /* 设置边框颜色 */
    lv_obj_clear_flag(win_content, LV_OBJ_FLAG_SCROLLABLE);
    lv_obj_set_style_radius(win_content, 0, LV_STATE_DEFAULT); /* 设置圆角 */
    lv_obj_set_style_pad_all(win_content, 0, LV_STATE_DEFAULT);

    //recovery_data();

    LV_IMG_DECLARE(Slider_base_color);
    lv_obj_t* Slider_base_color_img = lv_img_create(lv_scr_act());
    lv_img_set_src(Slider_base_color_img, &Slider_base_color);
    lv_obj_align(Slider_base_color_img, LV_ALIGN_TOP_LEFT, 0, 183);

    //左滑块停止
    LV_IMG_DECLARE(left_stop);
    lv_obj_t* left_stop_img = lv_imgbtn_create(lv_scr_act());
    lv_imgbtn_set_src(left_stop_img, LV_IMGBTN_STATE_RELEASED, NULL,&left_stop,NULL);
    lv_obj_set_size(left_stop_img, left_stop.header.w, left_stop.header.h);
    lv_obj_align(left_stop_img, LV_ALIGN_TOP_LEFT, 0, 183);
    lv_obj_add_event_cb(left_stop_img, button_left_stop_event_cb, LV_EVENT_CLICKED, NULL);

    slider_show_2();

    //右滑块停止
    LV_IMG_DECLARE(right_stop);
    lv_obj_t* right_stop_img = lv_imgbtn_create(lv_scr_act());
    lv_imgbtn_set_src(right_stop_img, LV_IMGBTN_STATE_RELEASED, NULL,&right_stop,NULL);
    lv_obj_set_size(right_stop_img, right_stop.header.w, right_stop.header.h);
    lv_obj_align(right_stop_img, LV_ALIGN_TOP_LEFT, 459, 183);
    lv_obj_add_event_cb(right_stop_img, button_right_stop_event_cb, LV_EVENT_CLICKED, NULL);


    //底部背景
    LV_IMG_DECLARE(Bottom_background);
     lv_obj_t* Bottom_background_img = lv_img_create(lv_scr_act());
    lv_img_set_src(Bottom_background_img, &Bottom_background);
    lv_obj_align(Bottom_background_img, LV_ALIGN_TOP_LEFT, 0, 204);

    //文件
    LV_IMG_DECLARE(file);
    lv_obj_t* imgbtn_file = lv_imgbtn_create(lv_scr_act());
    lv_imgbtn_set_src(imgbtn_file, LV_IMGBTN_STATE_RELEASED, NULL, &file, NULL);
    lv_obj_set_size(imgbtn_file, file.header.w, file.header.h);
    lv_obj_align(imgbtn_file, LV_ALIGN_TOP_LEFT, 15, 207);
    lv_obj_add_event_cb(imgbtn_file, button_file_event_cb, LV_EVENT_CLICKED, NULL);

    LV_FONT_DECLARE(heiFont16_1);
    lv_obj_t* label_file = lv_label_create(lv_scr_act());
    lv_obj_set_style_text_font(label_file, &heiFont16_1, LV_STATE_DEFAULT);
    lv_obj_set_style_text_color(label_file, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
    if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
    {
        lv_label_set_text(label_file, "文件");
    }
    else if(system_data.system.language == LANGUAGE_ENGLISH)
    {
        lv_label_set_text(label_file, "File");
    }
    lv_obj_align(label_file, LV_ALIGN_TOP_LEFT, 18, 251);

    //保存
    LV_IMG_DECLARE(save);
    lv_obj_t* imgbtn_save = lv_imgbtn_create(lv_scr_act());
    lv_imgbtn_set_src(imgbtn_save, LV_IMGBTN_STATE_RELEASED, NULL, &save, NULL);
    lv_obj_set_size(imgbtn_save, save.header.w, save.header.h);
    lv_obj_align(imgbtn_save, LV_ALIGN_TOP_LEFT, 70, 207);
    lv_obj_add_event_cb(imgbtn_save, button_save_event_cb, LV_EVENT_CLICKED, NULL);

    LV_FONT_DECLARE(heiFont16_1);
    lv_obj_t* label_save = lv_label_create(lv_scr_act());
    lv_obj_set_style_text_font(label_save, &heiFont16_1, LV_STATE_DEFAULT);
    lv_obj_set_style_text_color(label_save, lv_color_hex(0xffffff), LV_STATE_DEFAULT);

    if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
    {
        lv_label_set_text(label_save,  "保存");
    }
    else if(system_data.system.language == LANGUAGE_ENGLISH)
    {
        lv_label_set_text(label_save, "Save");
    }

    lv_obj_align(label_save, LV_ALIGN_TOP_LEFT, 73, 251);

    //添加
    LV_IMG_DECLARE(addition);
    lv_obj_t* imgbtn_addition = lv_imgbtn_create(lv_scr_act());
    lv_imgbtn_set_src(imgbtn_addition, LV_IMGBTN_STATE_RELEASED, NULL, &addition, NULL);
    lv_obj_set_size(imgbtn_addition, addition.header.w, addition.header.h);
    lv_obj_align(imgbtn_addition, LV_ALIGN_TOP_LEFT, 125, 207);
    lv_obj_add_event_cb(imgbtn_addition, button_addition_event_cb, LV_EVENT_CLICKED, NULL);

    LV_FONT_DECLARE(heiFont16_1);
    lv_obj_t* label_addition = lv_label_create(lv_scr_act());
    lv_obj_set_style_text_font(label_addition, &heiFont16_1, LV_STATE_DEFAULT);
    lv_obj_set_style_text_color(label_addition, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
    if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
    {
        lv_label_set_text(label_addition,  "添加");
    }
    else if(system_data.system.language == LANGUAGE_ENGLISH)
    {
        lv_label_set_text(label_addition, "Add");
    }

    lv_obj_align(label_addition, LV_ALIGN_TOP_LEFT, 128, 251);

    //删除
    LV_IMG_DECLARE(delete);
    lv_obj_t* imgbtn_delete = lv_imgbtn_create(lv_scr_act());
    lv_imgbtn_set_src(imgbtn_delete, LV_IMGBTN_STATE_RELEASED, NULL, &delete, NULL);
    lv_obj_set_size(imgbtn_delete, delete.header.w, delete.header.h);
    lv_obj_align(imgbtn_delete, LV_ALIGN_TOP_LEFT, 180, 207);
    lv_obj_add_event_cb(imgbtn_delete, button_delete_event_cb, LV_EVENT_CLICKED, NULL);

    LV_FONT_DECLARE(heiFont16_1);
    lv_obj_t* label_delete = lv_label_create(lv_scr_act());
    lv_obj_set_style_text_font(label_delete, &heiFont16_1, LV_STATE_DEFAULT);
    lv_obj_set_style_text_color(label_delete, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
    if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
    {
        lv_label_set_text(label_delete,  "删除");
    }
    else if(system_data.system.language == LANGUAGE_ENGLISH)
    {
        lv_label_set_text(label_delete, "Delete");
    }

    lv_obj_align(label_delete, LV_ALIGN_TOP_LEFT, 183, 251);

    //修改
    LV_IMG_DECLARE(modification);
    lv_obj_t* imgbtn_modification = lv_imgbtn_create(lv_scr_act());
    lv_imgbtn_set_src(imgbtn_modification, LV_IMGBTN_STATE_RELEASED, NULL, &modification, NULL);
    lv_obj_set_size(imgbtn_modification, modification.header.w, modification.header.h);
    lv_obj_align(imgbtn_modification, LV_ALIGN_TOP_LEFT, 235, 207);
    lv_obj_add_event_cb(imgbtn_modification, button_modification_event_cb, LV_EVENT_CLICKED, NULL);


    LV_FONT_DECLARE(heiFont16_1);
    lv_obj_t* label_modification = lv_label_create(lv_scr_act());
    lv_obj_set_style_text_font(label_modification, &heiFont16_1, LV_STATE_DEFAULT);
    lv_obj_set_style_text_color(label_modification, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
    if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
    {
        lv_label_set_text(label_modification,  "修改");
    }
    else if(system_data.system.language == LANGUAGE_ENGLISH)
    {
        lv_label_set_text(label_modification, "Rewrite");
    }

    lv_obj_align(label_modification, LV_ALIGN_TOP_LEFT, 238, 251);

    //设置
    LV_IMG_DECLARE(set);
    lv_obj_t* imgbtn_set = lv_imgbtn_create(lv_scr_act());
    lv_imgbtn_set_src(imgbtn_set, LV_IMGBTN_STATE_RELEASED, NULL, &set, NULL);
    lv_obj_set_size(imgbtn_set, set.header.w, set.header.h);
    lv_obj_align(imgbtn_set, LV_ALIGN_TOP_LEFT, 290, 207);
    lv_obj_add_event_cb(imgbtn_set, button_set_event_cb, LV_EVENT_CLICKED, NULL);


    LV_FONT_DECLARE(heiFont16_1);
    lv_obj_t* label_set = lv_label_create(lv_scr_act());
    lv_obj_set_style_text_font(label_set, &heiFont16_1, LV_STATE_DEFAULT);
    lv_obj_set_style_text_color(label_set, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
    if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
    {
        lv_label_set_text(label_set,  "设置");
    }
    else if(system_data.system.language == LANGUAGE_ENGLISH)
    {
        lv_label_set_text(label_set, "Setting");
    }

    lv_obj_align(label_set, LV_ALIGN_TOP_LEFT, 293, 251);


    LV_IMG_DECLARE(left);
    lv_obj_t* imgbtn_turn_left = lv_imgbtn_create(lv_scr_act());
    lv_imgbtn_set_src(imgbtn_turn_left, LV_IMGBTN_STATE_RELEASED, NULL, &left, NULL);
    //printf("zhangchuan-%u %u\n\r",left.header.w,left.header.h);
    lv_obj_set_size(imgbtn_turn_left, left.header.w, left.header.h);
    lv_obj_align(imgbtn_turn_left, LV_ALIGN_TOP_LEFT, 347, 216);
    lv_obj_add_event_cb(imgbtn_turn_left, button_left_event_cb, LV_EVENT_CLICKED, NULL);


    LV_IMG_DECLARE(up);
    lv_obj_t* imgbtn_turn_up = lv_imgbtn_create(lv_scr_act());
    lv_imgbtn_set_src(imgbtn_turn_up, LV_IMGBTN_STATE_RELEASED, NULL, &up, NULL);
    lv_obj_set_size(imgbtn_turn_up, up.header.w, up.header.h);
    lv_obj_align(imgbtn_turn_up, LV_ALIGN_TOP_LEFT, 357, 207);
    lv_obj_add_event_cb(imgbtn_turn_up, button_up_event_cb, LV_EVENT_CLICKED, NULL);


    LV_IMG_DECLARE(right);
    lv_obj_t* imgbtn_turn_right = lv_imgbtn_create(lv_scr_act());
    lv_imgbtn_set_src(imgbtn_turn_right, LV_IMGBTN_STATE_RELEASED, NULL, &right, NULL);
    lv_obj_set_size(imgbtn_turn_right, right.header.w, right.header.h);
    lv_obj_align(imgbtn_turn_right, LV_ALIGN_TOP_LEFT, 389, 216);
    lv_obj_add_event_cb(imgbtn_turn_right, button_right_event_cb, LV_EVENT_CLICKED, NULL);


    LV_IMG_DECLARE(down);
    lv_obj_t* imgbtn_turn_down = lv_imgbtn_create(lv_scr_act());
    lv_imgbtn_set_src(imgbtn_turn_down, LV_IMGBTN_STATE_RELEASED, NULL, &down, NULL);
    lv_obj_set_size(imgbtn_turn_down, down.header.w, down.header.h);
    lv_obj_align(imgbtn_turn_down, LV_ALIGN_TOP_LEFT, 357, 249);
    lv_obj_add_event_cb(imgbtn_turn_down, button_down_event_cb, LV_EVENT_CLICKED, NULL);

    //增大
    LV_IMG_DECLARE(add);
    lv_obj_t* imgbtn_add = lv_imgbtn_create(lv_scr_act());
    lv_imgbtn_set_src(imgbtn_add, LV_IMGBTN_STATE_RELEASED, NULL, &add, NULL);
    lv_obj_set_size(imgbtn_add, add.header.w, add.header.h);
    lv_obj_align(imgbtn_add, LV_ALIGN_TOP_LEFT, 362, 221);
    lv_obj_add_event_cb(imgbtn_add, button_add_event_cb, LV_EVENT_CLICKED, NULL);

    //减小
    LV_IMG_DECLARE(reduce);
    lv_obj_t* imgbtn_reduce = lv_imgbtn_create(lv_scr_act());
    lv_imgbtn_set_src(imgbtn_reduce, LV_IMGBTN_STATE_RELEASED, NULL, &reduce, NULL);
    lv_obj_set_size(imgbtn_reduce, reduce.header.w, reduce.header.h);
    lv_obj_align(imgbtn_reduce, LV_ALIGN_TOP_LEFT, 362,237);
    lv_obj_add_event_cb(imgbtn_reduce, button_reduce_event_cb, LV_EVENT_CLICKED, NULL);


    //打印
    LV_IMG_DECLARE(print);
    imgbtn_print = lv_imgbtn_create(lv_scr_act());
    lv_imgbtn_set_src(imgbtn_print, LV_IMGBTN_STATE_RELEASED, NULL, &print, NULL);
    lv_obj_set_size(imgbtn_print, print.header.w, print.header.h);
    lv_obj_align(imgbtn_print, LV_ALIGN_TOP_LEFT, 425, 207);
    lv_obj_add_event_cb(imgbtn_print, button_print_event_cb, LV_EVENT_CLICKED, NULL);


    LV_FONT_DECLARE(heiFont16_1);
    label_print = lv_label_create(lv_scr_act());
    lv_obj_set_style_text_font(label_print, &heiFont16_1, LV_STATE_DEFAULT);
    lv_obj_set_style_text_color(label_print, lv_color_hex(0xffffff), LV_STATE_DEFAULT);
    if(system_data.system.language == LANGUAGE_SIMPLIFIED_CHINESE)
    {
        lv_label_set_text(label_print,  "打印");
    }
    else if(system_data.system.language == LANGUAGE_ENGLISH)
    {
        lv_label_set_text(label_print, "Print");
    }

    lv_obj_align(label_print, LV_ALIGN_TOP_LEFT, 428, 251);


#if 0
    LV_IMG_DECLARE(bottom_img);
    Bottom_background_image = lv_img_create(lv_scr_act()); /* 创建图片部件 */
    lv_img_set_src(Bottom_background_image, &bottom_img); /* 设置图片源 */
    /* 设置图片位置 */
    lv_obj_align(Bottom_background_image, LV_ALIGN_TOP_LEFT, 0, 200);
    lv_obj_update_layout(Head_background_image); /* 更新图片参数 */


    LV_IMG_DECLARE(print_img);
    /* 定义并创建图片按钮 */
    print_imgbtn = lv_imgbtn_create(lv_scr_act());
    /* 设置图片释放时的图片 */
    lv_imgbtn_set_src(print_imgbtn, LV_IMGBTN_STATE_RELEASED, NULL, &print_img, NULL);
    /* 设置图片按钮大小 */
    lv_obj_set_size(print_imgbtn, 48, 48);
    /* 设置图片按钮位置 */
    lv_obj_align(print_imgbtn, LV_ALIGN_TOP_LEFT, 430, 201);
    lv_obj_add_event_cb(print_imgbtn, print_event_cb, LV_EVENT_PRESSED, NULL);
    

    LV_IMG_DECLARE(songFont10);
    Print_label = lv_label_create(lv_scr_act());
    lv_obj_set_style_text_font(Print_label, (const lv_font_t *)&songFont10, 0);
    lv_label_set_text(Print_label, "喷印");
    lv_obj_align(Print_label, LV_ALIGN_TOP_LEFT, 432, 248);
    lv_obj_set_style_text_color(Print_label, lv_color_hex(0xffffff),LV_STATE_DEFAULT);
    
    LV_IMG_DECLARE(songFont28);

    //LV_IMG_DECLARE(lv_font_montserrat_48);
    /* 定义绘制标签 */
    lv_draw_label_dsc_t label_dsc;
    /* 初始化绘制标签 */
    lv_draw_label_dsc_init(&label_dsc);
    /* 设置标签颜色 */
    label_dsc.color = lv_color_black();
    label_dsc.font = (const lv_font_t *)&songFont28;
    //label_dsc.font = font_normal;
    label_dsc.align = LV_TEXT_ALIGN_LEFT;
    /* 在画布上绘制标签 */
    lv_canvas_draw_text(canvas, 10, 10, 1024,&label_dsc,"欢迎使用");

#endif

    	/* 打开beep驱动 */
	fd_buzzer = open("/dev/buzzer", O_RDWR);
	if(fd_buzzer < 0)
    {
		printf("file /dev/buzzer open failed!\r\n");
	}
    else
    {
        printf("file /dev/buzzer open ok!\r\n");
    }
#if 0
    fd_mp1484_en = open("/dev/mp1484_en", O_RDWR);
	if(fd_mp1484_en < 0)
    {
		printf("file /dev/mp1484_en open failed!\r\n");
	}
    else
    {
        printf("file /dev/mp1484_en open ok!\r\n");
        set_mp1484_en(1);
    }
#endif

    fd_bm8563 = open("/dev/bm8563", O_RDWR);
	if(fd_bm8563 < 0)
    {
		printf("file /dev/bm8563 open failed!\r\n");
	}
    else
    {
        printf("file /dev/bm8563 open ok!\r\n");
    }

    fd_rc522 = open("/dev/rc522", O_RDWR);
	if(fd_rc522 < 0)
    {
		printf("file /dev/rc522 open failed!\r\n");
	}
    else
    {
        printf("file /dev/rc522 open ok!\r\n");
    }

    get_config_data();

    fd_optoelectronic = open("/dev/optoelectronic", O_RDWR);
	if(fd_optoelectronic < 0)
    {
		printf("open /dev/keys-key failed!\r\n");
	}
    else
    {
        printf("open /dev/keys-key  ok!\r\n");
    }

    pwm_init();
    pwm_voltage();
    pwm_brightness((int)(100-system_data.system.brightness)*4/5);

    fd_adc = open("/dev/adc", O_RDWR);
	if(fd_adc < 0)
    {
		printf("file /dev/adc open failed!\r\n");
	}
    else
    {
        printf("file /dev/adc open ok!\r\n");
    }

    timer_100ms = lv_timer_create(timer_100ms_cb, 100, NULL);
}


/**********************
 *      MACROS
 **********************/

/**********************
 *   GLOBAL FUNCTIONS
 **********************/


#if 0

void lv_demo_widgets(void)
{
    if(LV_HOR_RES <= 320) disp_size = DISP_SMALL;
    else if(LV_HOR_RES < 720) disp_size = DISP_MEDIUM;
    else disp_size = DISP_LARGE;

    font_large = LV_FONT_DEFAULT;
    font_normal = LV_FONT_DEFAULT;

    lv_coord_t tab_h;
    if(disp_size == DISP_LARGE) {
        tab_h = 70;
#if LV_FONT_MONTSERRAT_24
        font_large     = &lv_font_montserrat_24;
#else
        LV_LOG_WARN("LV_FONT_MONTSERRAT_24 is not enabled for the widgets demo. Using LV_FONT_DEFAULT instead.");
#endif
#if LV_FONT_MONTSERRAT_16
        font_normal    = &lv_font_montserrat_16;
#else
        LV_LOG_WARN("LV_FONT_MONTSERRAT_16 is not enabled for the widgets demo. Using LV_FONT_DEFAULT instead.");
#endif
    }
    else if(disp_size == DISP_MEDIUM) {
        tab_h = 45;
#if LV_FONT_MONTSERRAT_20
        font_large     = &lv_font_montserrat_20;
#else
        LV_LOG_WARN("LV_FONT_MONTSERRAT_20 is not enabled for the widgets demo. Using LV_FONT_DEFAULT instead.");
#endif
#if LV_FONT_MONTSERRAT_14
        font_normal    = &lv_font_montserrat_14;
#else
        LV_LOG_WARN("LV_FONT_MONTSERRAT_14 is not enabled for the widgets demo. Using LV_FONT_DEFAULT instead.");
#endif
    }
    else {   /* disp_size == DISP_SMALL */
        tab_h = 45;
#if LV_FONT_MONTSERRAT_18
        font_large     = &lv_font_montserrat_18;
#else
        LV_LOG_WARN("LV_FONT_MONTSERRAT_18 is not enabled for the widgets demo. Using LV_FONT_DEFAULT instead.");
#endif
#if LV_FONT_MONTSERRAT_12
        font_normal    = &lv_font_montserrat_12;
#else
        LV_LOG_WARN("LV_FONT_MONTSERRAT_12 is not enabled for the widgets demo. Using LV_FONT_DEFAULT instead.");
#endif
    }

#if LV_USE_THEME_DEFAULT
    lv_theme_default_init(NULL, lv_palette_main(LV_PALETTE_BLUE), lv_palette_main(LV_PALETTE_RED), LV_THEME_DEFAULT_DARK,
                          font_normal);
#endif

    lv_style_init(&style_text_muted);
    lv_style_set_text_opa(&style_text_muted, LV_OPA_50);

    lv_style_init(&style_title);
    lv_style_set_text_font(&style_title, font_large);

    lv_style_init(&style_icon);
    lv_style_set_text_color(&style_icon, lv_theme_get_color_primary(NULL));
    lv_style_set_text_font(&style_icon, font_large);

    lv_style_init(&style_bullet);
    lv_style_set_border_width(&style_bullet, 0);
    lv_style_set_radius(&style_bullet, LV_RADIUS_CIRCLE);

    tv = lv_tabview_create(lv_scr_act(), LV_DIR_TOP, tab_h);

    lv_obj_set_style_text_font(lv_scr_act(), font_normal, 0);

    if(disp_size == DISP_LARGE) {
        lv_obj_t * tab_btns = lv_tabview_get_tab_btns(tv);
        lv_obj_set_style_pad_left(tab_btns, LV_HOR_RES / 2, 0);
        lv_obj_t * logo = lv_img_create(tab_btns);
        LV_IMG_DECLARE(img_lvgl_logo);
        lv_img_set_src(logo, &img_lvgl_logo);
        lv_obj_align(logo, LV_ALIGN_LEFT_MID, -LV_HOR_RES / 2 + 25, 0);

        lv_obj_t * label = lv_label_create(tab_btns);
        lv_obj_add_style(label, &style_title, 0);
        lv_label_set_text(label, "LVGL v8");
        lv_obj_align_to(label, logo, LV_ALIGN_OUT_RIGHT_TOP, 10, 0);

        label = lv_label_create(tab_btns);
        lv_label_set_text(label, "Widgets demo");
        lv_obj_add_style(label, &style_text_muted, 0);
        lv_obj_align_to(label, logo, LV_ALIGN_OUT_RIGHT_BOTTOM, 10, 0);
    }

    lv_obj_t * t1 = lv_tabview_add_tab(tv, "Profile");
    lv_obj_t * t2 = lv_tabview_add_tab(tv, "Analytics");
    lv_obj_t * t3 = lv_tabview_add_tab(tv, "Shop");
    profile_create(t1);
    analytics_create(t2);
    shop_create(t3);

    color_changer_create(tv);
}
#endif

void lv_demo_widgets_close(void)
{
    /*Delete all animation*/
    lv_anim_del(NULL, NULL);

    lv_timer_del(meter2_timer);
    meter2_timer = NULL;

    lv_obj_clean(lv_scr_act());

    lv_style_reset(&style_text_muted);
    lv_style_reset(&style_title);
    lv_style_reset(&style_icon);
    lv_style_reset(&style_bullet);
}

/**********************
 *   STATIC FUNCTIONS
 **********************/

static void profile_create(lv_obj_t * parent)
{
    lv_obj_t * panel1 = lv_obj_create(parent);
    lv_obj_set_height(panel1, LV_SIZE_CONTENT);


    LV_IMG_DECLARE(img_demo_widgets_avatar);
    lv_obj_t * avatar = lv_img_create(panel1);
    lv_img_set_src(avatar, &img_demo_widgets_avatar);

    lv_obj_t * name = lv_label_create(panel1);
    lv_label_set_text(name, "Elena Smith");
    lv_obj_add_style(name, &style_title, 0);

    lv_obj_t * dsc = lv_label_create(panel1);
    lv_obj_add_style(dsc, &style_text_muted, 0);
    lv_label_set_text(dsc, "This is a short description of me. Take a look at my profile!");
    lv_label_set_long_mode(dsc, LV_LABEL_LONG_WRAP);

    lv_obj_t * email_icn = lv_label_create(panel1);
    lv_obj_add_style(email_icn, &style_icon, 0);
    lv_label_set_text(email_icn, LV_SYMBOL_ENVELOPE);

    lv_obj_t * email_label = lv_label_create(panel1);
    lv_label_set_text(email_label, "elena@smith.com");

    lv_obj_t * call_icn = lv_label_create(panel1);
    lv_obj_add_style(call_icn, &style_icon, 0);
    lv_label_set_text(call_icn, LV_SYMBOL_CALL);

    lv_obj_t * call_label = lv_label_create(panel1);
    lv_label_set_text(call_label, "+79 246 123 4567");

    lv_obj_t * log_out_btn = lv_btn_create(panel1);
    lv_obj_set_height(log_out_btn, LV_SIZE_CONTENT);

    lv_obj_t * label = lv_label_create(log_out_btn);
    lv_label_set_text(label, "Log out");
    lv_obj_center(label);

    lv_obj_t * invite_btn = lv_btn_create(panel1);
    lv_obj_add_state(invite_btn, LV_STATE_DISABLED);
    lv_obj_set_height(invite_btn, LV_SIZE_CONTENT);

    label = lv_label_create(invite_btn);
    lv_label_set_text(label, "Invite");
    lv_obj_center(label);

    /*Create a keyboard*/
    lv_obj_t * kb = lv_keyboard_create(lv_scr_act());
    lv_obj_add_flag(kb, LV_OBJ_FLAG_HIDDEN);

    /*Create the second panel*/
    lv_obj_t * panel2 = lv_obj_create(parent);
    lv_obj_set_height(panel2, LV_SIZE_CONTENT);

    lv_obj_t * panel2_title = lv_label_create(panel2);
    lv_label_set_text(panel2_title, "Your profile");
    lv_obj_add_style(panel2_title, &style_title, 0);

    lv_obj_t * user_name_label = lv_label_create(panel2);
    lv_label_set_text(user_name_label, "User name");
    lv_obj_add_style(user_name_label, &style_text_muted, 0);

    lv_obj_t * user_name = lv_textarea_create(panel2);
    lv_textarea_set_one_line(user_name, true);
    lv_textarea_set_placeholder_text(user_name, "Your name");
    lv_obj_add_event_cb(user_name, ta_event_cb, LV_EVENT_ALL, kb);

    lv_obj_t * password_label = lv_label_create(panel2);
    lv_label_set_text(password_label, "Password");
    lv_obj_add_style(password_label, &style_text_muted, 0);

    lv_obj_t * password = lv_textarea_create(panel2);
    lv_textarea_set_one_line(password, true);
    lv_textarea_set_password_mode(password, true);
    lv_textarea_set_placeholder_text(password, "Min. 8 chars.");
    lv_obj_add_event_cb(password, ta_event_cb, LV_EVENT_ALL, kb);

    lv_obj_t * gender_label = lv_label_create(panel2);
    lv_label_set_text(gender_label, "Gender");
    lv_obj_add_style(gender_label, &style_text_muted, 0);

    lv_obj_t * gender = lv_dropdown_create(panel2);
    lv_dropdown_set_options_static(gender, "Male\nFemale\nOther");

    lv_obj_t * birthday_label = lv_label_create(panel2);
    lv_label_set_text(birthday_label, "Birthday");
    lv_obj_add_style(birthday_label, &style_text_muted, 0);

    lv_obj_t * birthdate = lv_textarea_create(panel2);
    lv_textarea_set_one_line(birthdate, true);
    lv_obj_add_event_cb(birthdate, birthday_event_cb, LV_EVENT_ALL, NULL);

    /*Create the third panel*/
    lv_obj_t * panel3 = lv_obj_create(parent);
    lv_obj_t * panel3_title = lv_label_create(panel3);
    lv_label_set_text(panel3_title, "Your skills");
    lv_obj_add_style(panel3_title, &style_title, 0);

    lv_obj_t * experience_label = lv_label_create(panel3);
    lv_label_set_text(experience_label, "Experience");
    lv_obj_add_style(experience_label, &style_text_muted, 0);

    lv_obj_t * slider1 = lv_slider_create(panel3);
    lv_obj_set_width(slider1, LV_PCT(95));
    lv_obj_add_event_cb(slider1, slider_event_cb, LV_EVENT_ALL, NULL);
    lv_obj_refresh_ext_draw_size(slider1);

    lv_obj_t * team_player_label = lv_label_create(panel3);
    lv_label_set_text(team_player_label, "Team player");
    lv_obj_add_style(team_player_label, &style_text_muted, 0);

    lv_obj_t * sw1 = lv_switch_create(panel3);

    lv_obj_t * hard_working_label = lv_label_create(panel3);
    lv_label_set_text(hard_working_label, "Hard-working");
    lv_obj_add_style(hard_working_label, &style_text_muted, 0);

    lv_obj_t * sw2 = lv_switch_create(panel3);

    if(disp_size == DISP_LARGE) {
        static lv_coord_t grid_main_col_dsc[] = {LV_GRID_FR(1), LV_GRID_FR(1), LV_GRID_TEMPLATE_LAST};
        static lv_coord_t grid_main_row_dsc[] = {LV_GRID_CONTENT, LV_GRID_CONTENT, LV_GRID_TEMPLATE_LAST};

        /*Create the top panel*/
        static lv_coord_t grid_1_col_dsc[] = {LV_GRID_CONTENT, 5, LV_GRID_CONTENT, LV_GRID_FR(2), LV_GRID_FR(1), LV_GRID_FR(1), LV_GRID_TEMPLATE_LAST};
        static lv_coord_t grid_1_row_dsc[] = {LV_GRID_CONTENT, LV_GRID_CONTENT, 10, LV_GRID_CONTENT, LV_GRID_CONTENT, LV_GRID_TEMPLATE_LAST};

        static lv_coord_t grid_2_col_dsc[] = {LV_GRID_FR(1), LV_GRID_FR(1), LV_GRID_TEMPLATE_LAST};
        static lv_coord_t grid_2_row_dsc[] = {
            LV_GRID_CONTENT,  /*Title*/
            5,                /*Separator*/
            LV_GRID_CONTENT,  /*Box title*/
            30,               /*Boxes*/
            5,                /*Separator*/
            LV_GRID_CONTENT,  /*Box title*/
            30,               /*Boxes*/
            LV_GRID_TEMPLATE_LAST
        };


        lv_obj_set_grid_dsc_array(parent, grid_main_col_dsc, grid_main_row_dsc);

        lv_obj_set_grid_cell(panel1, LV_GRID_ALIGN_STRETCH, 0, 2, LV_GRID_ALIGN_CENTER, 0, 1);

        lv_obj_set_grid_dsc_array(panel1, grid_1_col_dsc, grid_1_row_dsc);
        lv_obj_set_grid_cell(avatar, LV_GRID_ALIGN_CENTER, 0, 1, LV_GRID_ALIGN_CENTER, 0, 5);
        lv_obj_set_grid_cell(name, LV_GRID_ALIGN_START, 2, 2, LV_GRID_ALIGN_CENTER, 0, 1);
        lv_obj_set_grid_cell(dsc, LV_GRID_ALIGN_STRETCH, 2, 4, LV_GRID_ALIGN_START, 1, 1);
        lv_obj_set_grid_cell(email_icn, LV_GRID_ALIGN_CENTER, 2, 1, LV_GRID_ALIGN_CENTER, 3, 1);
        lv_obj_set_grid_cell(email_label, LV_GRID_ALIGN_START, 3, 1, LV_GRID_ALIGN_CENTER, 3, 1);
        lv_obj_set_grid_cell(call_icn, LV_GRID_ALIGN_CENTER, 2, 1, LV_GRID_ALIGN_CENTER, 4, 1);
        lv_obj_set_grid_cell(call_label, LV_GRID_ALIGN_START, 3, 1, LV_GRID_ALIGN_CENTER, 4, 1);
        lv_obj_set_grid_cell(log_out_btn, LV_GRID_ALIGN_STRETCH, 4, 1, LV_GRID_ALIGN_CENTER, 3, 2);
        lv_obj_set_grid_cell(invite_btn, LV_GRID_ALIGN_STRETCH, 5, 1, LV_GRID_ALIGN_CENTER, 3, 2);

        lv_obj_set_grid_cell(panel2, LV_GRID_ALIGN_STRETCH, 0, 1, LV_GRID_ALIGN_START, 1, 1);
        lv_obj_set_grid_dsc_array(panel2, grid_2_col_dsc, grid_2_row_dsc);
        lv_obj_set_grid_cell(panel2_title, LV_GRID_ALIGN_START, 0, 2, LV_GRID_ALIGN_CENTER, 0, 1);
        lv_obj_set_grid_cell(user_name, LV_GRID_ALIGN_STRETCH, 0, 1, LV_GRID_ALIGN_CENTER, 3, 1);
        lv_obj_set_grid_cell(user_name_label, LV_GRID_ALIGN_START, 0, 1, LV_GRID_ALIGN_START, 2, 1);
        lv_obj_set_grid_cell(password, LV_GRID_ALIGN_STRETCH, 1, 1, LV_GRID_ALIGN_CENTER, 3, 1);
        lv_obj_set_grid_cell(password_label, LV_GRID_ALIGN_START, 1, 1, LV_GRID_ALIGN_START, 2, 1);
        lv_obj_set_grid_cell(birthdate, LV_GRID_ALIGN_STRETCH, 1, 1, LV_GRID_ALIGN_CENTER, 6, 1);
        lv_obj_set_grid_cell(birthday_label, LV_GRID_ALIGN_START, 1, 1, LV_GRID_ALIGN_START, 5, 1);
        lv_obj_set_grid_cell(gender, LV_GRID_ALIGN_STRETCH, 0, 1, LV_GRID_ALIGN_CENTER, 6, 1);
        lv_obj_set_grid_cell(gender_label, LV_GRID_ALIGN_START, 0, 1, LV_GRID_ALIGN_START, 5, 1);


        lv_obj_set_grid_cell(panel3, LV_GRID_ALIGN_STRETCH, 1, 1, LV_GRID_ALIGN_STRETCH, 1, 1);
        lv_obj_set_grid_dsc_array(panel3, grid_2_col_dsc, grid_2_row_dsc);
        lv_obj_set_grid_cell(panel3_title, LV_GRID_ALIGN_START, 0, 2, LV_GRID_ALIGN_CENTER, 0, 1);
        lv_obj_set_grid_cell(slider1, LV_GRID_ALIGN_CENTER, 0, 2, LV_GRID_ALIGN_CENTER, 3, 1);
        lv_obj_set_grid_cell(experience_label, LV_GRID_ALIGN_START, 0, 1, LV_GRID_ALIGN_START, 2, 1);
        lv_obj_set_grid_cell(sw2, LV_GRID_ALIGN_START, 1, 1, LV_GRID_ALIGN_CENTER, 6, 1);
        lv_obj_set_grid_cell(hard_working_label, LV_GRID_ALIGN_START, 0, 1, LV_GRID_ALIGN_START, 5, 1);
        lv_obj_set_grid_cell(sw1, LV_GRID_ALIGN_START, 0, 1, LV_GRID_ALIGN_CENTER, 6, 1);
        lv_obj_set_grid_cell(team_player_label, LV_GRID_ALIGN_START, 1, 1, LV_GRID_ALIGN_START, 5, 1);
    }
    else if(disp_size == DISP_MEDIUM) {
        static lv_coord_t grid_main_col_dsc[] = {LV_GRID_FR(1), LV_GRID_FR(1), LV_GRID_TEMPLATE_LAST};
        static lv_coord_t grid_main_row_dsc[] = {LV_GRID_CONTENT, LV_GRID_CONTENT, LV_GRID_TEMPLATE_LAST};


        /*Create the top panel*/
        static lv_coord_t grid_1_col_dsc[] = {LV_GRID_CONTENT, 1, LV_GRID_CONTENT, LV_GRID_FR(1), LV_GRID_TEMPLATE_LAST};
        static lv_coord_t grid_1_row_dsc[] = {
            LV_GRID_CONTENT, /*Name*/
            LV_GRID_CONTENT, /*Description*/
            LV_GRID_CONTENT, /*Email*/
            -20,
            LV_GRID_CONTENT, /*Phone*/
            LV_GRID_CONTENT, /*Buttons*/
            LV_GRID_TEMPLATE_LAST
        };

        static lv_coord_t grid_2_col_dsc[] = {LV_GRID_FR(1), LV_GRID_FR(1), LV_GRID_TEMPLATE_LAST};
        static lv_coord_t grid_2_row_dsc[] = {
            LV_GRID_CONTENT,  /*Title*/
            5,                /*Separator*/
            LV_GRID_CONTENT,  /*Box title*/
            40,               /*Box*/
            LV_GRID_CONTENT,  /*Box title*/
            40,               /*Box*/
            LV_GRID_CONTENT,  /*Box title*/
            40,               /*Box*/
            LV_GRID_CONTENT,  /*Box title*/
            40,               /*Box*/
            LV_GRID_TEMPLATE_LAST
        };


        lv_obj_set_grid_dsc_array(parent, grid_main_col_dsc, grid_main_row_dsc);
        lv_obj_set_grid_cell(panel1, LV_GRID_ALIGN_STRETCH, 0, 2, LV_GRID_ALIGN_CENTER, 0, 1);

        lv_obj_set_width(log_out_btn, 120);
        lv_obj_set_width(invite_btn, 120);

        lv_obj_set_grid_dsc_array(panel1, grid_1_col_dsc, grid_1_row_dsc);
        lv_obj_set_grid_cell(avatar, LV_GRID_ALIGN_CENTER, 0, 1, LV_GRID_ALIGN_START, 0, 4);
        lv_obj_set_grid_cell(name, LV_GRID_ALIGN_START, 2, 2, LV_GRID_ALIGN_CENTER, 0, 1);
        lv_obj_set_grid_cell(dsc, LV_GRID_ALIGN_STRETCH, 2, 2, LV_GRID_ALIGN_START, 1, 1);
        lv_obj_set_grid_cell(email_label, LV_GRID_ALIGN_START, 3, 1, LV_GRID_ALIGN_CENTER, 2, 1);
        lv_obj_set_grid_cell(email_icn, LV_GRID_ALIGN_CENTER, 2, 1, LV_GRID_ALIGN_CENTER, 2, 1);
        lv_obj_set_grid_cell(call_icn, LV_GRID_ALIGN_CENTER, 2, 1, LV_GRID_ALIGN_CENTER, 4, 1);
        lv_obj_set_grid_cell(call_label, LV_GRID_ALIGN_START, 3, 1, LV_GRID_ALIGN_CENTER, 4, 1);
        lv_obj_set_grid_cell(log_out_btn, LV_GRID_ALIGN_START, 1, 1, LV_GRID_ALIGN_CENTER, 5, 1);
        lv_obj_set_grid_cell(invite_btn, LV_GRID_ALIGN_END, 3, 1, LV_GRID_ALIGN_CENTER, 5, 1);

        lv_obj_set_grid_cell(panel2, LV_GRID_ALIGN_STRETCH, 0, 1, LV_GRID_ALIGN_START, 1, 1);
        lv_obj_set_grid_dsc_array(panel2, grid_2_col_dsc, grid_2_row_dsc);
        lv_obj_set_grid_cell(panel2_title, LV_GRID_ALIGN_START, 0, 2, LV_GRID_ALIGN_CENTER, 0, 1);
        lv_obj_set_grid_cell(user_name_label, LV_GRID_ALIGN_START, 0, 2, LV_GRID_ALIGN_START, 2, 1);
        lv_obj_set_grid_cell(user_name, LV_GRID_ALIGN_STRETCH, 0, 2, LV_GRID_ALIGN_START, 3, 1);
        lv_obj_set_grid_cell(password_label, LV_GRID_ALIGN_START, 0, 2, LV_GRID_ALIGN_START, 4, 1);
        lv_obj_set_grid_cell(password, LV_GRID_ALIGN_STRETCH, 0, 2, LV_GRID_ALIGN_START, 5, 1);
        lv_obj_set_grid_cell(birthday_label, LV_GRID_ALIGN_START, 0, 2, LV_GRID_ALIGN_START, 6, 1);
        lv_obj_set_grid_cell(birthdate, LV_GRID_ALIGN_STRETCH, 0, 2, LV_GRID_ALIGN_START, 7, 1);
        lv_obj_set_grid_cell(gender_label, LV_GRID_ALIGN_START, 0, 2, LV_GRID_ALIGN_START, 8, 1);
        lv_obj_set_grid_cell(gender, LV_GRID_ALIGN_STRETCH, 0, 2, LV_GRID_ALIGN_START, 9, 1);

        lv_obj_set_grid_cell(panel3, LV_GRID_ALIGN_STRETCH, 1, 1, LV_GRID_ALIGN_STRETCH, 1, 1);
        lv_obj_set_grid_dsc_array(panel3, grid_2_col_dsc, grid_2_row_dsc);
        lv_obj_set_grid_cell(panel3_title, LV_GRID_ALIGN_START, 0, 2, LV_GRID_ALIGN_CENTER, 0, 1);
        lv_obj_set_grid_cell(slider1, LV_GRID_ALIGN_CENTER, 0, 2, LV_GRID_ALIGN_CENTER, 3, 1);
        lv_obj_set_grid_cell(experience_label, LV_GRID_ALIGN_START, 0, 1, LV_GRID_ALIGN_START, 2, 1);
        lv_obj_set_grid_cell(hard_working_label, LV_GRID_ALIGN_START, 0, 1, LV_GRID_ALIGN_START, 4, 1);
        lv_obj_set_grid_cell(sw2, LV_GRID_ALIGN_START, 0, 1, LV_GRID_ALIGN_START, 5, 1);
        lv_obj_set_grid_cell(team_player_label, LV_GRID_ALIGN_START, 0, 1, LV_GRID_ALIGN_START, 6, 1);
        lv_obj_set_grid_cell(sw1, LV_GRID_ALIGN_START, 0, 1, LV_GRID_ALIGN_START, 7, 1);
    }
    else if(disp_size == DISP_SMALL) {
        static lv_coord_t grid_main_col_dsc[] = {LV_GRID_FR(1), LV_GRID_TEMPLATE_LAST};
        static lv_coord_t grid_main_row_dsc[] = {LV_GRID_CONTENT, LV_GRID_CONTENT, LV_GRID_CONTENT, LV_GRID_TEMPLATE_LAST};
        lv_obj_set_grid_dsc_array(parent, grid_main_col_dsc, grid_main_row_dsc);


        /*Create the top panel*/
        static lv_coord_t grid_1_col_dsc[] = {LV_GRID_CONTENT, LV_GRID_FR(1), LV_GRID_TEMPLATE_LAST};
        static lv_coord_t grid_1_row_dsc[] = {LV_GRID_CONTENT, /*Avatar*/
                                              LV_GRID_CONTENT, /*Name*/
                                              LV_GRID_CONTENT, /*Description*/
                                              LV_GRID_CONTENT, /*Email*/
                                              LV_GRID_CONTENT, /*Phone number*/
                                              LV_GRID_CONTENT, /*Button1*/
                                              LV_GRID_CONTENT, /*Button2*/
                                              LV_GRID_TEMPLATE_LAST
                                             };

        lv_obj_set_grid_dsc_array(panel1, grid_1_col_dsc, grid_1_row_dsc);


        static lv_coord_t grid_2_col_dsc[] = {LV_GRID_FR(1), LV_GRID_FR(1), LV_GRID_TEMPLATE_LAST};
        static lv_coord_t grid_2_row_dsc[] = {
            LV_GRID_CONTENT,  /*Title*/
            5,                /*Separator*/
            LV_GRID_CONTENT,  /*Box title*/
            40,               /*Box*/
            LV_GRID_CONTENT,  /*Box title*/
            40,               /*Box*/
            LV_GRID_CONTENT,  /*Box title*/
            40,               /*Box*/
            LV_GRID_CONTENT,  /*Box title*/
            40, LV_GRID_TEMPLATE_LAST               /*Box*/
        };

        lv_obj_set_grid_dsc_array(panel2, grid_2_col_dsc, grid_2_row_dsc);
        lv_obj_set_grid_dsc_array(panel3, grid_2_col_dsc, grid_2_row_dsc);

        lv_obj_set_grid_cell(panel1, LV_GRID_ALIGN_STRETCH, 0, 1, LV_GRID_ALIGN_CENTER, 0, 1);

        lv_obj_set_style_text_align(dsc, LV_TEXT_ALIGN_CENTER, 0);

        lv_obj_set_grid_cell(avatar, LV_GRID_ALIGN_CENTER, 0, 2, LV_GRID_ALIGN_CENTER, 0, 1);
        lv_obj_set_grid_cell(name, LV_GRID_ALIGN_CENTER, 0, 2, LV_GRID_ALIGN_CENTER, 1, 1);
        lv_obj_set_grid_cell(dsc, LV_GRID_ALIGN_STRETCH, 0, 2, LV_GRID_ALIGN_START, 2, 1);
        lv_obj_set_grid_cell(email_icn, LV_GRID_ALIGN_CENTER, 0, 1, LV_GRID_ALIGN_CENTER, 3, 1);
        lv_obj_set_grid_cell(email_label, LV_GRID_ALIGN_START, 1, 1, LV_GRID_ALIGN_CENTER, 3, 1);
        lv_obj_set_grid_cell(call_icn, LV_GRID_ALIGN_CENTER, 0, 1, LV_GRID_ALIGN_CENTER, 4, 1);
        lv_obj_set_grid_cell(call_label, LV_GRID_ALIGN_START, 1, 1, LV_GRID_ALIGN_CENTER, 4, 1);
        lv_obj_set_grid_cell(log_out_btn, LV_GRID_ALIGN_STRETCH, 0, 2, LV_GRID_ALIGN_CENTER, 5, 1);
        lv_obj_set_grid_cell(invite_btn, LV_GRID_ALIGN_STRETCH, 0, 2, LV_GRID_ALIGN_CENTER, 6, 1);

        lv_obj_set_grid_cell(panel2, LV_GRID_ALIGN_STRETCH, 0, 1, LV_GRID_ALIGN_START, 1, 1);
        lv_obj_set_grid_cell(panel2_title, LV_GRID_ALIGN_START, 0, 2, LV_GRID_ALIGN_CENTER, 0, 1);
        lv_obj_set_grid_cell(user_name_label, LV_GRID_ALIGN_START, 0, 2, LV_GRID_ALIGN_START, 2, 1);
        lv_obj_set_grid_cell(user_name, LV_GRID_ALIGN_STRETCH, 0, 2, LV_GRID_ALIGN_START, 3, 1);
        lv_obj_set_grid_cell(password_label, LV_GRID_ALIGN_START, 0, 2, LV_GRID_ALIGN_START, 4, 1);
        lv_obj_set_grid_cell(password, LV_GRID_ALIGN_STRETCH, 0, 2, LV_GRID_ALIGN_START, 5, 1);
        lv_obj_set_grid_cell(birthday_label, LV_GRID_ALIGN_START, 0, 2, LV_GRID_ALIGN_START, 6, 1);
        lv_obj_set_grid_cell(birthdate, LV_GRID_ALIGN_STRETCH, 0, 2, LV_GRID_ALIGN_START, 7, 1);
        lv_obj_set_grid_cell(gender_label, LV_GRID_ALIGN_START, 0, 2, LV_GRID_ALIGN_START, 8, 1);
        lv_obj_set_grid_cell(gender, LV_GRID_ALIGN_STRETCH, 0, 2, LV_GRID_ALIGN_START, 9, 1);

        lv_obj_set_height(panel3, LV_SIZE_CONTENT);
        lv_obj_set_grid_cell(panel3, LV_GRID_ALIGN_STRETCH, 0, 1, LV_GRID_ALIGN_START, 2, 1);
        lv_obj_set_grid_cell(panel3_title, LV_GRID_ALIGN_START, 0, 2, LV_GRID_ALIGN_CENTER, 0, 1);
        lv_obj_set_grid_cell(experience_label, LV_GRID_ALIGN_START, 0, 1, LV_GRID_ALIGN_START, 2, 1);
        lv_obj_set_grid_cell(slider1, LV_GRID_ALIGN_CENTER, 0, 2, LV_GRID_ALIGN_CENTER, 3, 1);
        lv_obj_set_grid_cell(hard_working_label, LV_GRID_ALIGN_START, 0, 1, LV_GRID_ALIGN_START, 4, 1);
        lv_obj_set_grid_cell(sw1, LV_GRID_ALIGN_START, 0, 1, LV_GRID_ALIGN_START, 5, 1);
        lv_obj_set_grid_cell(team_player_label, LV_GRID_ALIGN_START, 1, 1, LV_GRID_ALIGN_START, 4, 1);
        lv_obj_set_grid_cell(sw2, LV_GRID_ALIGN_START, 1, 1, LV_GRID_ALIGN_START, 5, 1);
    }
}


static void analytics_create(lv_obj_t * parent)
{
    lv_obj_set_flex_flow(parent, LV_FLEX_FLOW_ROW_WRAP);

    static lv_coord_t grid_chart_row_dsc[] = {LV_GRID_CONTENT, LV_GRID_FR(1), 10, LV_GRID_TEMPLATE_LAST};
    static lv_coord_t grid_chart_col_dsc[] = {20, LV_GRID_FR(1), LV_GRID_TEMPLATE_LAST};

    lv_obj_t * chart1_cont = lv_obj_create(parent);
    lv_obj_set_flex_grow(chart1_cont, 1);
    lv_obj_set_grid_dsc_array(chart1_cont, grid_chart_col_dsc, grid_chart_row_dsc);

    lv_obj_set_height(chart1_cont, LV_PCT(100));
    lv_obj_set_style_max_height(chart1_cont, 300, 0);

    lv_obj_t * title = lv_label_create(chart1_cont);
    lv_label_set_text(title, "Unique visitors");
    lv_obj_add_style(title, &style_title, 0);
    lv_obj_set_grid_cell(title, LV_GRID_ALIGN_START, 0, 2, LV_GRID_ALIGN_START, 0, 1);

    chart1 = lv_chart_create(chart1_cont);
    lv_group_add_obj(lv_group_get_default(), chart1);
    lv_obj_add_flag(chart1, LV_OBJ_FLAG_SCROLL_ON_FOCUS);
    lv_obj_set_grid_cell(chart1, LV_GRID_ALIGN_STRETCH, 1, 1, LV_GRID_ALIGN_STRETCH, 1, 1);
    lv_chart_set_axis_tick(chart1, LV_CHART_AXIS_PRIMARY_Y, 0, 0, 5, 1, true, 80);
    lv_chart_set_axis_tick(chart1, LV_CHART_AXIS_PRIMARY_X, 0, 0, 12, 1, true, 50);
    lv_chart_set_div_line_count(chart1, 0, 12);
    lv_chart_set_point_count(chart1, 12);
    lv_obj_add_event_cb(chart1, chart_event_cb, LV_EVENT_ALL, NULL);
    if(disp_size == DISP_SMALL) lv_chart_set_zoom_x(chart1, 256 * 3);
    else if(disp_size == DISP_MEDIUM) lv_chart_set_zoom_x(chart1, 256 * 2);

    lv_obj_set_style_border_side(chart1, LV_BORDER_SIDE_LEFT | LV_BORDER_SIDE_BOTTOM, 0);
    lv_obj_set_style_radius(chart1, 0, 0);

    ser1 = lv_chart_add_series(chart1, lv_theme_get_color_primary(chart1), LV_CHART_AXIS_PRIMARY_Y);
    lv_chart_set_next_value(chart1, ser1, lv_rand(10, 80));
    lv_chart_set_next_value(chart1, ser1, lv_rand(10, 80));
    lv_chart_set_next_value(chart1, ser1, lv_rand(10, 80));
    lv_chart_set_next_value(chart1, ser1, lv_rand(10, 80));
    lv_chart_set_next_value(chart1, ser1, lv_rand(10, 80));
    lv_chart_set_next_value(chart1, ser1, lv_rand(10, 80));
    lv_chart_set_next_value(chart1, ser1, lv_rand(10, 80));
    lv_chart_set_next_value(chart1, ser1, lv_rand(10, 80));
    lv_chart_set_next_value(chart1, ser1, lv_rand(10, 80));
    lv_chart_set_next_value(chart1, ser1, lv_rand(10, 80));
    lv_chart_set_next_value(chart1, ser1, lv_rand(10, 80));
    lv_chart_set_next_value(chart1, ser1, lv_rand(10, 80));
    lv_chart_set_next_value(chart1, ser1, lv_rand(10, 80));

    lv_obj_t * chart2_cont = lv_obj_create(parent);
    lv_obj_add_flag(chart2_cont, LV_OBJ_FLAG_FLEX_IN_NEW_TRACK);
    lv_obj_set_flex_grow(chart2_cont, 1);

    lv_obj_set_height(chart2_cont, LV_PCT(100));
    lv_obj_set_style_max_height(chart2_cont, 300, 0);

    lv_obj_set_grid_dsc_array(chart2_cont, grid_chart_col_dsc, grid_chart_row_dsc);

    title = lv_label_create(chart2_cont);
    lv_label_set_text(title, "Monthly revenue");
    lv_obj_add_style(title, &style_title, 0);
    lv_obj_set_grid_cell(title, LV_GRID_ALIGN_START, 0, 2, LV_GRID_ALIGN_START, 0, 1);

    chart2 = lv_chart_create(chart2_cont);
    lv_group_add_obj(lv_group_get_default(), chart2);
    lv_obj_add_flag(chart2, LV_OBJ_FLAG_SCROLL_ON_FOCUS);

    lv_obj_set_grid_cell(chart2, LV_GRID_ALIGN_STRETCH, 1, 1, LV_GRID_ALIGN_STRETCH, 1, 1);
    lv_chart_set_axis_tick(chart2, LV_CHART_AXIS_PRIMARY_Y, 0, 0, 5, 1, true, 80);
    lv_chart_set_axis_tick(chart2, LV_CHART_AXIS_PRIMARY_X, 0, 0, 12, 1, true, 50);
    lv_obj_set_size(chart2, LV_PCT(100), LV_PCT(100));
    lv_chart_set_type(chart2, LV_CHART_TYPE_BAR);
    lv_chart_set_div_line_count(chart2, 6, 0);
    lv_chart_set_point_count(chart2, 12);
    lv_obj_add_event_cb(chart2, chart_event_cb, LV_EVENT_ALL, NULL);
    lv_chart_set_zoom_x(chart2, 256 * 2);
    lv_obj_set_style_border_side(chart2, LV_BORDER_SIDE_LEFT | LV_BORDER_SIDE_BOTTOM, 0);
    lv_obj_set_style_radius(chart2, 0, 0);

    if(disp_size == DISP_SMALL) {
        lv_obj_set_style_pad_gap(chart2, 0, LV_PART_ITEMS);
        lv_obj_set_style_pad_gap(chart2, 2, LV_PART_MAIN);
    }
    else if(disp_size == DISP_LARGE) {
        lv_obj_set_style_pad_gap(chart2, 16, 0);
    }

    ser2 = lv_chart_add_series(chart2, lv_palette_lighten(LV_PALETTE_GREY, 1), LV_CHART_AXIS_PRIMARY_Y);
    lv_chart_set_next_value(chart2, ser2, lv_rand(10, 80));
    lv_chart_set_next_value(chart2, ser2, lv_rand(10, 80));
    lv_chart_set_next_value(chart2, ser2, lv_rand(10, 80));
    lv_chart_set_next_value(chart2, ser2, lv_rand(10, 80));
    lv_chart_set_next_value(chart2, ser2, lv_rand(10, 80));
    lv_chart_set_next_value(chart2, ser2, lv_rand(10, 80));
    lv_chart_set_next_value(chart2, ser2, lv_rand(10, 80));
    lv_chart_set_next_value(chart2, ser2, lv_rand(10, 80));
    lv_chart_set_next_value(chart2, ser2, lv_rand(10, 80));
    lv_chart_set_next_value(chart2, ser2, lv_rand(10, 80));
    lv_chart_set_next_value(chart2, ser2, lv_rand(10, 80));
    lv_chart_set_next_value(chart2, ser2, lv_rand(10, 80));
    lv_chart_set_next_value(chart2, ser2, lv_rand(10, 80));

    ser3 = lv_chart_add_series(chart2, lv_theme_get_color_primary(chart1), LV_CHART_AXIS_PRIMARY_Y);
    lv_chart_set_next_value(chart2, ser3, lv_rand(10, 80));
    lv_chart_set_next_value(chart2, ser3, lv_rand(10, 80));
    lv_chart_set_next_value(chart2, ser3, lv_rand(10, 80));
    lv_chart_set_next_value(chart2, ser3, lv_rand(10, 80));
    lv_chart_set_next_value(chart2, ser3, lv_rand(10, 80));
    lv_chart_set_next_value(chart2, ser3, lv_rand(10, 80));
    lv_chart_set_next_value(chart2, ser3, lv_rand(10, 80));
    lv_chart_set_next_value(chart2, ser3, lv_rand(10, 80));
    lv_chart_set_next_value(chart2, ser3, lv_rand(10, 80));
    lv_chart_set_next_value(chart2, ser3, lv_rand(10, 80));
    lv_chart_set_next_value(chart2, ser3, lv_rand(10, 80));
    lv_chart_set_next_value(chart2, ser3, lv_rand(10, 80));
    lv_chart_set_next_value(chart2, ser3, lv_rand(10, 80));

    lv_meter_scale_t * scale;
    lv_meter_indicator_t * indic;
    meter1 = create_meter_box(parent, "Monthly Target", "Revenue: 63%", "Sales: 44%", "Costs: 58%");
    lv_obj_add_flag(lv_obj_get_parent(meter1), LV_OBJ_FLAG_FLEX_IN_NEW_TRACK);
    scale = lv_meter_add_scale(meter1);
    lv_meter_set_scale_range(meter1, scale, 0, 100, 270, 90);
    lv_meter_set_scale_ticks(meter1, scale, 0, 0, 0, lv_color_black());

    lv_anim_t a;
    lv_anim_init(&a);
    lv_anim_set_values(&a, 20, 100);
    lv_anim_set_repeat_count(&a, LV_ANIM_REPEAT_INFINITE);

    indic = lv_meter_add_arc(meter1, scale, 15, lv_palette_main(LV_PALETTE_BLUE), 0);
    lv_anim_set_exec_cb(&a, meter1_indic1_anim_cb);
    lv_anim_set_var(&a, indic);
    lv_anim_set_time(&a, 4100);
    lv_anim_set_playback_time(&a, 2700);
    lv_anim_start(&a);

    indic = lv_meter_add_arc(meter1, scale, 15, lv_palette_main(LV_PALETTE_RED), -20);
    lv_anim_set_exec_cb(&a, meter1_indic2_anim_cb);
    lv_anim_set_var(&a, indic);
    lv_anim_set_time(&a, 2600);
    lv_anim_set_playback_time(&a, 3200);
    a.user_data = indic;
    lv_anim_start(&a);

    indic = lv_meter_add_arc(meter1, scale, 15, lv_palette_main(LV_PALETTE_GREEN), -40);
    lv_anim_set_exec_cb(&a, meter1_indic3_anim_cb);
    lv_anim_set_var(&a, indic);
    lv_anim_set_time(&a, 2800);
    lv_anim_set_playback_time(&a, 1800);
    lv_anim_start(&a);

    meter2 = create_meter_box(parent, "Sessions", "Desktop: ", "Tablet: ", "Mobile: ");
    if(disp_size < DISP_LARGE) lv_obj_add_flag(lv_obj_get_parent(meter2), LV_OBJ_FLAG_FLEX_IN_NEW_TRACK);
    scale = lv_meter_add_scale(meter2);
    lv_meter_set_scale_range(meter2, scale, 0, 100, 360, 90);
    lv_meter_set_scale_ticks(meter2, scale, 0, 0, 0, lv_color_black());

    static lv_meter_indicator_t * meter2_indic[3];
    meter2_indic[0] = lv_meter_add_arc(meter2, scale, 20, lv_palette_main(LV_PALETTE_RED), -10);
    lv_meter_set_indicator_start_value(meter2, meter2_indic[0], 0);
    lv_meter_set_indicator_end_value(meter2, meter2_indic[0], 39);

    meter2_indic[1] = lv_meter_add_arc(meter2, scale, 30, lv_palette_main(LV_PALETTE_BLUE), 0);
    lv_meter_set_indicator_start_value(meter2, meter2_indic[1], 40);
    lv_meter_set_indicator_end_value(meter2, meter2_indic[1], 69);

    meter2_indic[2] = lv_meter_add_arc(meter2, scale, 10, lv_palette_main(LV_PALETTE_GREEN), -20);
    lv_meter_set_indicator_start_value(meter2, meter2_indic[2], 70);
    lv_meter_set_indicator_end_value(meter2, meter2_indic[2], 99);

    meter2_timer = lv_timer_create(meter2_timer_cb, 100, meter2_indic);

    meter3 = create_meter_box(parent, "Network Speed", "Low speed", "Normal Speed", "High Speed");
    if(disp_size < DISP_LARGE) lv_obj_add_flag(lv_obj_get_parent(meter3), LV_OBJ_FLAG_FLEX_IN_NEW_TRACK);

    /*Add a special circle to the needle's pivot*/
    lv_obj_set_style_pad_hor(meter3, 10, 0);
    lv_obj_set_style_size(meter3, 10, LV_PART_INDICATOR);
    lv_obj_set_style_radius(meter3, LV_RADIUS_CIRCLE, LV_PART_INDICATOR);
    lv_obj_set_style_bg_opa(meter3, LV_OPA_COVER, LV_PART_INDICATOR);
    lv_obj_set_style_bg_color(meter3, lv_palette_darken(LV_PALETTE_GREY, 4), LV_PART_INDICATOR);
    lv_obj_set_style_outline_color(meter3, lv_color_white(), LV_PART_INDICATOR);
    lv_obj_set_style_outline_width(meter3, 3, LV_PART_INDICATOR);
    lv_obj_set_style_text_color(meter3, lv_palette_darken(LV_PALETTE_GREY, 1), LV_PART_TICKS);

    scale = lv_meter_add_scale(meter3);
    lv_meter_set_scale_range(meter3, scale, 10, 60, 220, 360 - 220);
    lv_meter_set_scale_ticks(meter3, scale, 21, 3, 17, lv_color_white());
    lv_meter_set_scale_major_ticks(meter3, scale, 4, 4, 22, lv_color_white(), 15);

    indic = lv_meter_add_arc(meter3, scale, 10, lv_palette_main(LV_PALETTE_RED), 0);
    lv_meter_set_indicator_start_value(meter3, indic, 0);
    lv_meter_set_indicator_end_value(meter3, indic, 20);

    indic = lv_meter_add_scale_lines(meter3, scale, lv_palette_darken(LV_PALETTE_RED, 3), lv_palette_darken(LV_PALETTE_RED,
                                                                                                            3), true, 0);
    lv_meter_set_indicator_start_value(meter3, indic, 0);
    lv_meter_set_indicator_end_value(meter3, indic, 20);

    indic = lv_meter_add_arc(meter3, scale, 12, lv_palette_main(LV_PALETTE_BLUE), 0);
    lv_meter_set_indicator_start_value(meter3, indic, 20);
    lv_meter_set_indicator_end_value(meter3, indic, 40);

    indic = lv_meter_add_scale_lines(meter3, scale, lv_palette_darken(LV_PALETTE_BLUE, 3),
                                     lv_palette_darken(LV_PALETTE_BLUE, 3), true, 0);
    lv_meter_set_indicator_start_value(meter3, indic, 20);
    lv_meter_set_indicator_end_value(meter3, indic, 40);

    indic = lv_meter_add_arc(meter3, scale, 10, lv_palette_main(LV_PALETTE_GREEN), 0);
    lv_meter_set_indicator_start_value(meter3, indic, 40);
    lv_meter_set_indicator_end_value(meter3, indic, 60);

    indic = lv_meter_add_scale_lines(meter3, scale, lv_palette_darken(LV_PALETTE_GREEN, 3),
                                     lv_palette_darken(LV_PALETTE_GREEN, 3), true, 0);
    lv_meter_set_indicator_start_value(meter3, indic, 40);
    lv_meter_set_indicator_end_value(meter3, indic, 60);

    indic = lv_meter_add_needle_line(meter3, scale, 4, lv_palette_darken(LV_PALETTE_GREY, 4), -25);

    lv_obj_t * mbps_label = lv_label_create(meter3);
    lv_label_set_text(mbps_label, "-");
    lv_obj_add_style(mbps_label, &style_title, 0);

    lv_obj_t * mbps_unit_label = lv_label_create(meter3);
    lv_label_set_text(mbps_unit_label, "Mbps");

    lv_anim_init(&a);
    lv_anim_set_values(&a, 10, 60);
    lv_anim_set_repeat_count(&a, LV_ANIM_REPEAT_INFINITE);
    lv_anim_set_exec_cb(&a, meter3_anim_cb);
    lv_anim_set_var(&a, indic);
    lv_anim_set_time(&a, 4100);
    lv_anim_set_playback_time(&a, 800);
    lv_anim_start(&a);

    lv_obj_update_layout(parent);
    if(disp_size == DISP_MEDIUM) {
        lv_obj_set_size(meter1, 200, 200);
        lv_obj_set_size(meter2, 200, 200);
        lv_obj_set_size(meter3, 200, 200);
    }
    else {
        lv_coord_t meter_w = lv_obj_get_width(meter1);
        lv_obj_set_height(meter1, meter_w);
        lv_obj_set_height(meter2, meter_w);
        lv_obj_set_height(meter3, meter_w);
    }

    lv_obj_align(mbps_label, LV_ALIGN_TOP_MID, 10, lv_pct(55));
    lv_obj_align_to(mbps_unit_label, mbps_label, LV_ALIGN_OUT_RIGHT_BOTTOM, 10, 0);
}

void shop_create(lv_obj_t * parent)
{
    lv_obj_set_flex_flow(parent, LV_FLEX_FLOW_ROW_WRAP);

    lv_obj_t * panel1 = lv_obj_create(parent);
    lv_obj_set_size(panel1, lv_pct(100), LV_SIZE_CONTENT);
    lv_obj_set_style_pad_bottom(panel1, 30, 0);

    lv_obj_t * title = lv_label_create(panel1);
    lv_label_set_text(title, "Monthly Summary");
    lv_obj_add_style(title, &style_title, 0);

    lv_obj_t * date = lv_label_create(panel1);
    lv_label_set_text(date, "8-15 July, 2021");
    lv_obj_add_style(date, &style_text_muted, 0);

    lv_obj_t * amount = lv_label_create(panel1);
    lv_label_set_text(amount, "$27,123.25");
    lv_obj_add_style(amount, &style_title, 0);

    lv_obj_t * hint = lv_label_create(panel1);
    lv_label_set_text(hint, LV_SYMBOL_UP" 17% growth this week");
    lv_obj_set_style_text_color(hint, lv_palette_main(LV_PALETTE_GREEN), 0);

    chart3 = lv_chart_create(panel1);
    lv_chart_set_axis_tick(chart3, LV_CHART_AXIS_PRIMARY_Y, 0, 0, 6, 1, true, 80);
    lv_chart_set_axis_tick(chart3, LV_CHART_AXIS_PRIMARY_X, 0, 0, 7, 1, true, 50);
    lv_chart_set_type(chart3, LV_CHART_TYPE_BAR);
    lv_chart_set_div_line_count(chart3, 6, 0);
    lv_chart_set_point_count(chart3, 7);
    lv_obj_add_event_cb(chart3, shop_chart_event_cb, LV_EVENT_ALL, NULL);

    ser4 = lv_chart_add_series(chart3, lv_theme_get_color_primary(chart3), LV_CHART_AXIS_PRIMARY_Y);
    lv_chart_set_next_value(chart3, ser4, lv_rand(60, 90));
    lv_chart_set_next_value(chart3, ser4, lv_rand(60, 90));
    lv_chart_set_next_value(chart3, ser4, lv_rand(60, 90));
    lv_chart_set_next_value(chart3, ser4, lv_rand(60, 90));
    lv_chart_set_next_value(chart3, ser4, lv_rand(60, 90));
    lv_chart_set_next_value(chart3, ser4, lv_rand(60, 90));
    lv_chart_set_next_value(chart3, ser4, lv_rand(60, 90));
    lv_chart_set_next_value(chart3, ser4, lv_rand(60, 90));
    lv_chart_set_next_value(chart3, ser4, lv_rand(60, 90));
    lv_chart_set_next_value(chart3, ser4, lv_rand(60, 90));
    lv_chart_set_next_value(chart3, ser4, lv_rand(60, 90));
    lv_chart_set_next_value(chart3, ser4, lv_rand(60, 90));

    if(disp_size == DISP_LARGE) {
        static lv_coord_t grid1_col_dsc[] = {LV_GRID_FR(1), LV_GRID_FR(1), LV_GRID_TEMPLATE_LAST};
        static lv_coord_t grid1_row_dsc[] = {
            LV_GRID_CONTENT,  /*Title*/
            LV_GRID_CONTENT,  /*Sub title*/
            20,               /*Spacer*/
            LV_GRID_CONTENT,  /*Amount*/
            LV_GRID_CONTENT,  /*Hint*/
            LV_GRID_TEMPLATE_LAST
        };

        lv_obj_set_size(chart3, lv_pct(100), lv_pct(100));
        lv_obj_set_style_pad_column(chart3, LV_DPX(30), 0);


        lv_obj_set_grid_dsc_array(panel1, grid1_col_dsc, grid1_row_dsc);
        lv_obj_set_grid_cell(title, LV_GRID_ALIGN_START, 0, 1, LV_GRID_ALIGN_START, 0, 1);
        lv_obj_set_grid_cell(date, LV_GRID_ALIGN_START, 0, 1, LV_GRID_ALIGN_START, 1, 1);
        lv_obj_set_grid_cell(amount, LV_GRID_ALIGN_START, 0, 1, LV_GRID_ALIGN_START, 3, 1);
        lv_obj_set_grid_cell(hint, LV_GRID_ALIGN_START, 0, 1, LV_GRID_ALIGN_START, 4, 1);
        lv_obj_set_grid_cell(chart3, LV_GRID_ALIGN_STRETCH, 1, 1, LV_GRID_ALIGN_STRETCH, 0, 5);
    }
    else if(disp_size == DISP_MEDIUM) {
        static lv_coord_t grid1_col_dsc[] = {LV_GRID_FR(1), LV_GRID_FR(1), LV_GRID_TEMPLATE_LAST};
        static lv_coord_t grid1_row_dsc[] = {
            LV_GRID_CONTENT,  /*Title + Date*/
            LV_GRID_CONTENT,  /*Amount + Hint*/
            200,              /*Chart*/
            LV_GRID_TEMPLATE_LAST
        };

        lv_obj_update_layout(panel1);
        lv_obj_set_width(chart3, lv_obj_get_content_width(panel1) - 20);
        lv_obj_set_style_pad_column(chart3, LV_DPX(30), 0);

        lv_obj_set_grid_dsc_array(panel1, grid1_col_dsc, grid1_row_dsc);
        lv_obj_set_grid_cell(title, LV_GRID_ALIGN_START, 0, 1, LV_GRID_ALIGN_CENTER, 0, 1);
        lv_obj_set_grid_cell(date, LV_GRID_ALIGN_START, 1, 1, LV_GRID_ALIGN_CENTER, 0, 1);
        lv_obj_set_grid_cell(amount, LV_GRID_ALIGN_START, 0, 1, LV_GRID_ALIGN_CENTER, 1, 1);
        lv_obj_set_grid_cell(hint, LV_GRID_ALIGN_START, 1, 1, LV_GRID_ALIGN_CENTER, 1, 1);
        lv_obj_set_grid_cell(chart3, LV_GRID_ALIGN_END, 0, 2, LV_GRID_ALIGN_STRETCH, 2, 1);
    }
    else if(disp_size == DISP_SMALL) {
        static lv_coord_t grid1_col_dsc[] = {LV_GRID_FR(1), LV_GRID_TEMPLATE_LAST};
        static lv_coord_t grid1_row_dsc[] = {
            LV_GRID_CONTENT,  /*Title*/
            LV_GRID_CONTENT,  /*Date*/
            LV_GRID_CONTENT,  /*Amount*/
            LV_GRID_CONTENT,  /*Hint*/
            LV_GRID_CONTENT,  /*Chart*/
            LV_GRID_TEMPLATE_LAST
        };

        lv_obj_set_width(chart3, LV_PCT(95));
        lv_obj_set_height(chart3, LV_VER_RES - 70);
        lv_obj_set_style_max_height(chart3, 300, 0);
        lv_chart_set_zoom_x(chart3, 512);

        lv_obj_set_grid_dsc_array(panel1, grid1_col_dsc, grid1_row_dsc);
        lv_obj_set_grid_cell(title, LV_GRID_ALIGN_START, 0, 1, LV_GRID_ALIGN_START, 0, 1);
        lv_obj_set_grid_cell(date, LV_GRID_ALIGN_START, 0, 1, LV_GRID_ALIGN_START, 1, 1);
        lv_obj_set_grid_cell(amount, LV_GRID_ALIGN_START, 0, 1, LV_GRID_ALIGN_START, 2, 1);
        lv_obj_set_grid_cell(hint, LV_GRID_ALIGN_START, 0, 1, LV_GRID_ALIGN_START, 3, 1);
        lv_obj_set_grid_cell(chart3, LV_GRID_ALIGN_END, 0, 1, LV_GRID_ALIGN_START, 4, 1);
    }

    lv_obj_t * list = lv_obj_create(parent);
    if(disp_size == DISP_SMALL) {
        lv_obj_add_flag(list, LV_OBJ_FLAG_FLEX_IN_NEW_TRACK);
        lv_obj_set_height(list, LV_PCT(100));
    }
    else {
        lv_obj_set_height(list, LV_PCT(100));
        lv_obj_set_style_max_height(list, 300, 0);
    }

    lv_obj_set_flex_flow(list, LV_FLEX_FLOW_COLUMN);
    lv_obj_set_flex_grow(list, 1);
    lv_obj_add_flag(list, LV_OBJ_FLAG_FLEX_IN_NEW_TRACK);

    title = lv_label_create(list);
    lv_label_set_text(title, "Top products");
    lv_obj_add_style(title, &style_title, 0);

    LV_IMG_DECLARE(img_clothes);
    create_shop_item(list, &img_clothes, "Blue jeans", "Clothes", "$722");
    create_shop_item(list, &img_clothes, "Blue jeans", "Clothes", "$411");
    create_shop_item(list, &img_clothes, "Blue jeans", "Clothes", "$917");
    create_shop_item(list, &img_clothes, "Blue jeans", "Clothes", "$64");
    create_shop_item(list, &img_clothes, "Blue jeans", "Clothes", "$805");

    lv_obj_t * notifications = lv_obj_create(parent);
    if(disp_size == DISP_SMALL) {
        lv_obj_add_flag(notifications, LV_OBJ_FLAG_FLEX_IN_NEW_TRACK);
        lv_obj_set_height(notifications, LV_PCT(100));
    }
    else  {
        lv_obj_set_height(notifications, LV_PCT(100));
        lv_obj_set_style_max_height(notifications, 300, 0);
    }

    lv_obj_set_flex_flow(notifications, LV_FLEX_FLOW_COLUMN);
    lv_obj_set_flex_grow(notifications, 1);

    title = lv_label_create(notifications);
    lv_label_set_text(title, "Notification");
    lv_obj_add_style(title, &style_title, 0);

    lv_obj_t * cb;
    cb = lv_checkbox_create(notifications);
    lv_checkbox_set_text(cb, "Item purchased");

    cb = lv_checkbox_create(notifications);
    lv_checkbox_set_text(cb, "New connection");

    cb = lv_checkbox_create(notifications);
    lv_checkbox_set_text(cb, "New subscriber");
    lv_obj_add_state(cb, LV_STATE_CHECKED);

    cb = lv_checkbox_create(notifications);
    lv_checkbox_set_text(cb, "New message");
    lv_obj_add_state(cb, LV_STATE_DISABLED);

    cb = lv_checkbox_create(notifications);
    lv_checkbox_set_text(cb, "Milestone reached");
    lv_obj_add_state(cb, LV_STATE_CHECKED | LV_STATE_DISABLED);

    cb = lv_checkbox_create(notifications);
    lv_checkbox_set_text(cb, "Out of stock");


}

static void color_changer_create(lv_obj_t * parent)
{
    static lv_palette_t palette[] = {
        LV_PALETTE_BLUE, LV_PALETTE_GREEN, LV_PALETTE_BLUE_GREY,  LV_PALETTE_ORANGE,
        LV_PALETTE_RED, LV_PALETTE_PURPLE, LV_PALETTE_TEAL, _LV_PALETTE_LAST
    };

    lv_obj_t * color_cont = lv_obj_create(parent);
    lv_obj_remove_style_all(color_cont);
    lv_obj_set_flex_flow(color_cont, LV_FLEX_FLOW_ROW);
    lv_obj_set_flex_align(color_cont, LV_FLEX_ALIGN_SPACE_EVENLY, LV_FLEX_ALIGN_CENTER, LV_FLEX_ALIGN_CENTER);
    lv_obj_add_flag(color_cont, LV_OBJ_FLAG_FLOATING);

    lv_obj_set_style_bg_color(color_cont, lv_color_white(), 0);
    lv_obj_set_style_pad_right(color_cont, disp_size == DISP_SMALL ? LV_DPX(47) : LV_DPX(55), 0);
    lv_obj_set_style_bg_opa(color_cont, LV_OPA_COVER, 0);
    lv_obj_set_style_radius(color_cont, LV_RADIUS_CIRCLE, 0);

    if(disp_size == DISP_SMALL) lv_obj_set_size(color_cont, LV_DPX(52), LV_DPX(52));
    else lv_obj_set_size(color_cont, LV_DPX(60), LV_DPX(60));

    lv_obj_align(color_cont, LV_ALIGN_BOTTOM_RIGHT, - LV_DPX(10),  - LV_DPX(10));

    uint32_t i;
    for(i = 0; palette[i] != _LV_PALETTE_LAST; i++) {
        lv_obj_t * c = lv_btn_create(color_cont);
        lv_obj_set_style_bg_color(c, lv_palette_main(palette[i]), 0);
        lv_obj_set_style_radius(c, LV_RADIUS_CIRCLE, 0);
        lv_obj_set_style_opa(c, LV_OPA_TRANSP, 0);
        lv_obj_set_size(c, 20, 20);
        lv_obj_add_event_cb(c, color_event_cb, LV_EVENT_ALL, &palette[i]);
        lv_obj_clear_flag(c, LV_OBJ_FLAG_SCROLL_ON_FOCUS);
    }

    lv_obj_t * btn = lv_btn_create(parent);
    lv_obj_add_flag(btn, LV_OBJ_FLAG_FLOATING | LV_OBJ_FLAG_CLICKABLE);
    lv_obj_set_style_bg_color(btn, lv_color_white(), LV_STATE_CHECKED);
    lv_obj_set_style_pad_all(btn, 10, 0);
    lv_obj_set_style_radius(btn, LV_RADIUS_CIRCLE, 0);
    lv_obj_add_event_cb(btn, color_changer_event_cb, LV_EVENT_ALL, color_cont);
    lv_obj_set_style_shadow_width(btn, 0, 0);
    lv_obj_set_style_bg_img_src(btn, LV_SYMBOL_TINT, 0);

    if(disp_size == DISP_SMALL) {
        lv_obj_set_size(btn, LV_DPX(42), LV_DPX(42));
        lv_obj_align(btn, LV_ALIGN_BOTTOM_RIGHT, -LV_DPX(15), -LV_DPX(15));
    }
    else {
        lv_obj_set_size(btn, LV_DPX(50), LV_DPX(50));
        lv_obj_align(btn, LV_ALIGN_BOTTOM_RIGHT, -LV_DPX(15), -LV_DPX(15));
    }
}

static void color_changer_anim_cb(void * var, int32_t v)
{
    lv_obj_t * obj = var;
    lv_coord_t max_w = lv_obj_get_width(lv_obj_get_parent(obj)) - LV_DPX(20);
    lv_coord_t w;

    if(disp_size == DISP_SMALL) {
        w = lv_map(v, 0, 256, LV_DPX(52), max_w);
        lv_obj_set_width(obj, w);
        lv_obj_align(obj, LV_ALIGN_BOTTOM_RIGHT, - LV_DPX(10),  - LV_DPX(10));
    }
    else {
        w = lv_map(v, 0, 256, LV_DPX(60), max_w);
        lv_obj_set_width(obj, w);
        lv_obj_align(obj, LV_ALIGN_BOTTOM_RIGHT, - LV_DPX(10),  - LV_DPX(10));
    }

    if(v > LV_OPA_COVER) v = LV_OPA_COVER;

    uint32_t i;
    for(i = 0; i < lv_obj_get_child_cnt(obj); i++) {
        lv_obj_set_style_opa(lv_obj_get_child(obj, i), v, 0);
    }

}

static void color_changer_event_cb(lv_event_t * e)
{
    if(lv_event_get_code(e) == LV_EVENT_CLICKED) {
        lv_obj_t * color_cont = lv_event_get_user_data(e);
        if(lv_obj_get_width(color_cont) < LV_HOR_RES / 2) {
            lv_anim_t a;
            lv_anim_init(&a);
            lv_anim_set_var(&a, color_cont);
            lv_anim_set_exec_cb(&a, color_changer_anim_cb);
            lv_anim_set_values(&a, 0, 256);
            lv_anim_set_time(&a, 200);
            lv_anim_start(&a);
        }
        else {
            lv_anim_t a;
            lv_anim_init(&a);
            lv_anim_set_var(&a, color_cont);
            lv_anim_set_exec_cb(&a, color_changer_anim_cb);
            lv_anim_set_values(&a, 256, 0);
            lv_anim_set_time(&a, 200);
            lv_anim_start(&a);
        }
    }
}
static void color_event_cb(lv_event_t * e)
{
    lv_event_code_t code = lv_event_get_code(e);
    lv_obj_t * obj = lv_event_get_target(e);

    if(code == LV_EVENT_FOCUSED) {
        lv_obj_t * color_cont = lv_obj_get_parent(obj);
        if(lv_obj_get_width(color_cont) < LV_HOR_RES / 2) {
            lv_anim_t a;
            lv_anim_init(&a);
            lv_anim_set_var(&a, color_cont);
            lv_anim_set_exec_cb(&a, color_changer_anim_cb);
            lv_anim_set_values(&a, 0, 256);
            lv_anim_set_time(&a, 200);
            lv_anim_start(&a);
        }
    }
    else if(code == LV_EVENT_CLICKED) {
        lv_palette_t * palette_primary = lv_event_get_user_data(e);
        lv_palette_t palette_secondary = (*palette_primary) + 3; /*Use another palette as secondary*/
        if(palette_secondary >= _LV_PALETTE_LAST) palette_secondary = 0;
#if LV_USE_THEME_DEFAULT
        lv_theme_default_init(NULL, lv_palette_main(*palette_primary), lv_palette_main(palette_secondary),
                              LV_THEME_DEFAULT_DARK, font_normal);
#endif
        lv_color_t color = lv_palette_main(*palette_primary);
        lv_style_set_text_color(&style_icon, color);
        lv_chart_set_series_color(chart1, ser1, color);
        lv_chart_set_series_color(chart2, ser3, color);
    }
}

static lv_obj_t * create_meter_box(lv_obj_t * parent, const char * title, const char * text1, const char * text2,
                                   const char * text3)
{
    lv_obj_t * cont = lv_obj_create(parent);
    lv_obj_set_height(cont, LV_SIZE_CONTENT);
    lv_obj_set_flex_grow(cont, 1);

    lv_obj_t * title_label = lv_label_create(cont);
    lv_label_set_text(title_label, title);
    lv_obj_add_style(title_label, &style_title, 0);

    lv_obj_t * meter = lv_meter_create(cont);
    lv_obj_remove_style(meter, NULL, LV_PART_MAIN);
    lv_obj_remove_style(meter, NULL, LV_PART_INDICATOR);
    lv_obj_set_width(meter, LV_PCT(100));

    lv_obj_t * bullet1 = lv_obj_create(cont);
    lv_obj_set_size(bullet1, 13, 13);
    lv_obj_remove_style(bullet1, NULL, LV_PART_SCROLLBAR);
    lv_obj_add_style(bullet1, &style_bullet, 0);
    lv_obj_set_style_bg_color(bullet1, lv_palette_main(LV_PALETTE_RED), 0);
    lv_obj_t * label1 = lv_label_create(cont);
    lv_label_set_text(label1, text1);

    lv_obj_t * bullet2 = lv_obj_create(cont);
    lv_obj_set_size(bullet2, 13, 13);
    lv_obj_remove_style(bullet2, NULL, LV_PART_SCROLLBAR);
    lv_obj_add_style(bullet2, &style_bullet, 0);
    lv_obj_set_style_bg_color(bullet2, lv_palette_main(LV_PALETTE_BLUE), 0);
    lv_obj_t * label2 = lv_label_create(cont);
    lv_label_set_text(label2, text2);

    lv_obj_t * bullet3 = lv_obj_create(cont);
    lv_obj_set_size(bullet3, 13, 13);
    lv_obj_remove_style(bullet3,  NULL, LV_PART_SCROLLBAR);
    lv_obj_add_style(bullet3, &style_bullet, 0);
    lv_obj_set_style_bg_color(bullet3, lv_palette_main(LV_PALETTE_GREEN), 0);
    lv_obj_t * label3 = lv_label_create(cont);
    lv_label_set_text(label3, text3);

    if(disp_size == DISP_MEDIUM) {
        static lv_coord_t grid_col_dsc[] = {LV_GRID_CONTENT, LV_GRID_FR(1), LV_GRID_CONTENT, LV_GRID_FR(8), LV_GRID_TEMPLATE_LAST};
        static lv_coord_t grid_row_dsc[] = {LV_GRID_CONTENT, LV_GRID_FR(1), LV_GRID_CONTENT, LV_GRID_CONTENT, LV_GRID_CONTENT, LV_GRID_FR(1), LV_GRID_TEMPLATE_LAST};

        lv_obj_set_grid_dsc_array(cont, grid_col_dsc, grid_row_dsc);
        lv_obj_set_grid_cell(title_label, LV_GRID_ALIGN_START, 0, 4, LV_GRID_ALIGN_START, 0, 1);
        lv_obj_set_grid_cell(meter, LV_GRID_ALIGN_START, 0, 1, LV_GRID_ALIGN_START, 1, 3);
        lv_obj_set_grid_cell(bullet1, LV_GRID_ALIGN_START, 2, 1, LV_GRID_ALIGN_CENTER, 2, 1);
        lv_obj_set_grid_cell(bullet2, LV_GRID_ALIGN_START, 2, 1, LV_GRID_ALIGN_CENTER, 3, 1);
        lv_obj_set_grid_cell(bullet3, LV_GRID_ALIGN_START, 2, 1, LV_GRID_ALIGN_CENTER, 4, 1);
        lv_obj_set_grid_cell(label1, LV_GRID_ALIGN_STRETCH, 3, 1, LV_GRID_ALIGN_CENTER, 2, 1);
        lv_obj_set_grid_cell(label2, LV_GRID_ALIGN_STRETCH, 3, 1, LV_GRID_ALIGN_CENTER, 3, 1);
        lv_obj_set_grid_cell(label3, LV_GRID_ALIGN_STRETCH, 3, 1, LV_GRID_ALIGN_CENTER, 4, 1);
    }
    else {
        static lv_coord_t grid_col_dsc[] = {LV_GRID_CONTENT, LV_GRID_FR(1), LV_GRID_TEMPLATE_LAST};
        static lv_coord_t grid_row_dsc[] = {LV_GRID_CONTENT, LV_GRID_CONTENT, LV_GRID_CONTENT, LV_GRID_CONTENT, LV_GRID_CONTENT, LV_GRID_TEMPLATE_LAST};
        lv_obj_set_grid_dsc_array(cont, grid_col_dsc, grid_row_dsc);
        lv_obj_set_grid_cell(title_label, LV_GRID_ALIGN_START, 0, 2, LV_GRID_ALIGN_START, 0, 1);
        lv_obj_set_grid_cell(meter, LV_GRID_ALIGN_START, 0, 2, LV_GRID_ALIGN_START, 1, 1);
        lv_obj_set_grid_cell(bullet1, LV_GRID_ALIGN_START, 0, 1, LV_GRID_ALIGN_START, 2, 1);
        lv_obj_set_grid_cell(bullet2, LV_GRID_ALIGN_START, 0, 1, LV_GRID_ALIGN_START, 3, 1);
        lv_obj_set_grid_cell(bullet3, LV_GRID_ALIGN_START, 0, 1, LV_GRID_ALIGN_START, 4, 1);
        lv_obj_set_grid_cell(label1, LV_GRID_ALIGN_STRETCH, 1, 1, LV_GRID_ALIGN_START, 2, 1);
        lv_obj_set_grid_cell(label2, LV_GRID_ALIGN_STRETCH, 1, 1, LV_GRID_ALIGN_START, 3, 1);
        lv_obj_set_grid_cell(label3, LV_GRID_ALIGN_STRETCH, 1, 1, LV_GRID_ALIGN_START, 4, 1);
    }


    return meter;

}

static lv_obj_t * create_shop_item(lv_obj_t * parent, const void * img_src, const char * name, const char * category,
                                   const char * price)
{
    static lv_coord_t grid_col_dsc[] = {LV_GRID_CONTENT, 5, LV_GRID_FR(1), LV_GRID_FR(1), LV_GRID_TEMPLATE_LAST};
    static lv_coord_t grid_row_dsc[] = {LV_GRID_FR(1), LV_GRID_FR(1), LV_GRID_TEMPLATE_LAST};

    lv_obj_t * cont = lv_obj_create(parent);
    lv_obj_remove_style_all(cont);
    lv_obj_set_size(cont, LV_PCT(100), LV_SIZE_CONTENT);
    lv_obj_set_grid_dsc_array(cont, grid_col_dsc, grid_row_dsc);

    lv_obj_t * img = lv_img_create(cont);
    lv_img_set_src(img, img_src);
    lv_obj_set_grid_cell(img, LV_GRID_ALIGN_START, 0, 1, LV_GRID_ALIGN_START, 0, 2);

    lv_obj_t * label;
    label = lv_label_create(cont);
    lv_label_set_text(label, name);
    lv_obj_set_grid_cell(label, LV_GRID_ALIGN_START, 2, 1, LV_GRID_ALIGN_END, 0, 1);

    label = lv_label_create(cont);
    lv_label_set_text(label, category);
    lv_obj_add_style(label, &style_text_muted, 0);
    lv_obj_set_grid_cell(label, LV_GRID_ALIGN_START, 2, 1, LV_GRID_ALIGN_START, 1, 1);

    label = lv_label_create(cont);
    lv_label_set_text(label, price);
    lv_obj_set_grid_cell(label, LV_GRID_ALIGN_END, 3, 1, LV_GRID_ALIGN_END, 0, 1);

    return cont;
}

static void ta_event_cb(lv_event_t * e)
{
    lv_event_code_t code = lv_event_get_code(e);
    lv_obj_t * ta = lv_event_get_target(e);
    lv_obj_t * kb = lv_event_get_user_data(e);
    if(code == LV_EVENT_FOCUSED) {
        if(lv_indev_get_type(lv_indev_get_act()) != LV_INDEV_TYPE_KEYPAD) {
            lv_keyboard_set_textarea(kb, ta);
            lv_obj_set_style_max_height(kb, LV_HOR_RES * 2 / 3, 0);
            lv_obj_update_layout(tv);   /*Be sure the sizes are recalculated*/
            lv_obj_set_height(tv, LV_VER_RES - lv_obj_get_height(kb));
            lv_obj_clear_flag(kb, LV_OBJ_FLAG_HIDDEN);
            lv_obj_scroll_to_view_recursive(ta, LV_ANIM_OFF);
        }
    }
    else if(code == LV_EVENT_DEFOCUSED) {
        lv_keyboard_set_textarea(kb, NULL);
        lv_obj_set_height(tv, LV_VER_RES);
        lv_obj_add_flag(kb, LV_OBJ_FLAG_HIDDEN);
        lv_indev_reset(NULL, ta);

    }
    else if(code == LV_EVENT_READY || code == LV_EVENT_CANCEL) {
        lv_obj_set_height(tv, LV_VER_RES);
        lv_obj_add_flag(kb, LV_OBJ_FLAG_HIDDEN);
        lv_obj_clear_state(ta, LV_STATE_FOCUSED);
        lv_indev_reset(NULL, ta);   /*To forget the last clicked object to make it focusable again*/
    }
}

static void birthday_event_cb(lv_event_t * e)
{
    lv_event_code_t code = lv_event_get_code(e);
    lv_obj_t * ta = lv_event_get_target(e);

    if(code == LV_EVENT_FOCUSED) {
        if(lv_indev_get_type(lv_indev_get_act()) == LV_INDEV_TYPE_POINTER) {
            if(calendar == NULL) {
                lv_obj_add_flag(lv_layer_top(), LV_OBJ_FLAG_CLICKABLE);
                calendar = lv_calendar_create(lv_layer_top());
                lv_obj_set_style_bg_opa(lv_layer_top(), LV_OPA_50, 0);
                lv_obj_set_style_bg_color(lv_layer_top(), lv_palette_main(LV_PALETTE_GREY), 0);
                if(disp_size == DISP_SMALL) lv_obj_set_size(calendar, 180, 200);
                else if(disp_size == DISP_MEDIUM) lv_obj_set_size(calendar, 200, 220);
                else  lv_obj_set_size(calendar, 300, 330);
                lv_calendar_set_showed_date(calendar, 1990, 01);
                lv_obj_align(calendar, LV_ALIGN_CENTER, 0, 30);
                lv_obj_add_event_cb(calendar, calendar_event_cb, LV_EVENT_ALL, ta);

                lv_calendar_header_dropdown_create(calendar);
            }
        }
    }
}

static void calendar_event_cb(lv_event_t * e)
{
    lv_event_code_t code = lv_event_get_code(e);
    lv_obj_t * ta = lv_event_get_user_data(e);
    lv_obj_t * obj = lv_event_get_current_target(e);
    if(code == LV_EVENT_VALUE_CHANGED) {
        lv_calendar_date_t d;
        lv_calendar_get_pressed_date(obj, &d);
        char buf[32];
        lv_snprintf(buf, sizeof(buf), "%02d.%02d.%d", d.day, d.month, d.year);
        lv_textarea_set_text(ta, buf);

        lv_obj_del(calendar);
        calendar = NULL;
        lv_obj_clear_flag(lv_layer_top(), LV_OBJ_FLAG_CLICKABLE);
        lv_obj_set_style_bg_opa(lv_layer_top(), LV_OPA_TRANSP, 0);
    }
}

static void slider_event_cb(lv_event_t * e)
{
    lv_event_code_t code = lv_event_get_code(e);
    lv_obj_t * obj = lv_event_get_target(e);

    if(code == LV_EVENT_REFR_EXT_DRAW_SIZE) {
        lv_coord_t * s = lv_event_get_param(e);
        *s = LV_MAX(*s, 60);
    }
    else if(code == LV_EVENT_DRAW_PART_END) {
        lv_obj_draw_part_dsc_t * dsc = lv_event_get_param(e);
        if(dsc->part == LV_PART_KNOB && lv_obj_has_state(obj, LV_STATE_PRESSED)) {
            char buf[8];
            lv_snprintf(buf, sizeof(buf), "%"LV_PRId32, lv_slider_get_value(obj));

            lv_point_t text_size;
            lv_txt_get_size(&text_size, buf, font_normal, 0, 0, LV_COORD_MAX, LV_TEXT_FLAG_NONE);

            lv_area_t txt_area;
            txt_area.x1 = dsc->draw_area->x1 + lv_area_get_width(dsc->draw_area) / 2 - text_size.x / 2;
            txt_area.x2 = txt_area.x1 + text_size.x;
            txt_area.y2 = dsc->draw_area->y1 - 10;
            txt_area.y1 = txt_area.y2 - text_size.y;

            lv_area_t bg_area;
            bg_area.x1 = txt_area.x1 - LV_DPX(8);
            bg_area.x2 = txt_area.x2 + LV_DPX(8);
            bg_area.y1 = txt_area.y1 - LV_DPX(8);
            bg_area.y2 = txt_area.y2 + LV_DPX(8);

            lv_draw_rect_dsc_t rect_dsc;
            lv_draw_rect_dsc_init(&rect_dsc);
            rect_dsc.bg_color = lv_palette_darken(LV_PALETTE_GREY, 3);
            rect_dsc.radius = LV_DPX(5);
            lv_draw_rect(dsc->draw_ctx, &rect_dsc, &bg_area);

            lv_draw_label_dsc_t label_dsc;
            lv_draw_label_dsc_init(&label_dsc);
            label_dsc.color = lv_color_white();
            label_dsc.font = font_normal;
            lv_draw_label(dsc->draw_ctx, &label_dsc, &txt_area, buf, NULL);
        }
    }
}

static void chart_event_cb(lv_event_t * e)
{
    lv_event_code_t code = lv_event_get_code(e);
    lv_obj_t * obj = lv_event_get_target(e);

    if(code == LV_EVENT_PRESSED || code == LV_EVENT_RELEASED) {
        lv_obj_invalidate(obj); /*To make the value boxes visible*/
    }
    else if(code == LV_EVENT_DRAW_PART_BEGIN) {
        lv_obj_draw_part_dsc_t * dsc = lv_event_get_param(e);
        /*Set the markers' text*/
        if(dsc->part == LV_PART_TICKS && dsc->id == LV_CHART_AXIS_PRIMARY_X) {
            if(lv_chart_get_type(obj) == LV_CHART_TYPE_BAR) {
                const char * month[] = {"I", "II", "III", "IV", "V", "VI", "VII", "VIII", "IX", "X", "XI", "XII"};
                lv_snprintf(dsc->text, dsc->text_length, "%s", month[dsc->value]);
            }
            else {
                const char * month[] = {"Jan", "Febr", "March", "Apr", "May", "Jun", "July", "Aug", "Sept", "Oct", "Nov", "Dec"};
                lv_snprintf(dsc->text, dsc->text_length, "%s", month[dsc->value]);
            }
        }

        /*Add the faded area before the lines are drawn */
        else if(dsc->part == LV_PART_ITEMS) {
#if LV_DRAW_COMPLEX
            /*Add  a line mask that keeps the area below the line*/
            if(dsc->p1 && dsc->p2) {
                lv_draw_mask_line_param_t line_mask_param;
                lv_draw_mask_line_points_init(&line_mask_param, dsc->p1->x, dsc->p1->y, dsc->p2->x, dsc->p2->y,
                                              LV_DRAW_MASK_LINE_SIDE_BOTTOM);
                int16_t line_mask_id = lv_draw_mask_add(&line_mask_param, NULL);

                /*Add a fade effect: transparent bottom covering top*/
                lv_coord_t h = lv_obj_get_height(obj);
                lv_draw_mask_fade_param_t fade_mask_param;
                lv_draw_mask_fade_init(&fade_mask_param, &obj->coords, LV_OPA_COVER, obj->coords.y1 + h / 8, LV_OPA_TRANSP,
                                       obj->coords.y2);
                int16_t fade_mask_id = lv_draw_mask_add(&fade_mask_param, NULL);

                /*Draw a rectangle that will be affected by the mask*/
                lv_draw_rect_dsc_t draw_rect_dsc;
                lv_draw_rect_dsc_init(&draw_rect_dsc);
                draw_rect_dsc.bg_opa = LV_OPA_50;
                draw_rect_dsc.bg_color = dsc->line_dsc->color;

                lv_area_t obj_clip_area;
                _lv_area_intersect(&obj_clip_area, dsc->draw_ctx->clip_area, &obj->coords);
                const lv_area_t * clip_area_ori = dsc->draw_ctx->clip_area;
                dsc->draw_ctx->clip_area = &obj_clip_area;
                lv_area_t a;
                a.x1 = dsc->p1->x;
                a.x2 = dsc->p2->x - 1;
                a.y1 = LV_MIN(dsc->p1->y, dsc->p2->y);
                a.y2 = obj->coords.y2;
                lv_draw_rect(dsc->draw_ctx, &draw_rect_dsc, &a);
                dsc->draw_ctx->clip_area = clip_area_ori;
                /*Remove the masks*/
                lv_draw_mask_remove_id(line_mask_id);
                lv_draw_mask_remove_id(fade_mask_id);
            }
#endif


            const lv_chart_series_t * ser = dsc->sub_part_ptr;

            if(lv_chart_get_pressed_point(obj) == dsc->id) {
                if(lv_chart_get_type(obj) == LV_CHART_TYPE_LINE) {
                    dsc->rect_dsc->outline_color = lv_color_white();
                    dsc->rect_dsc->outline_width = 2;
                }
                else {
                    dsc->rect_dsc->shadow_color = ser->color;
                    dsc->rect_dsc->shadow_width = 15;
                    dsc->rect_dsc->shadow_spread = 0;
                }

                char buf[8];
                lv_snprintf(buf, sizeof(buf), "%"LV_PRIu32, dsc->value);

                lv_point_t text_size;
                lv_txt_get_size(&text_size, buf, font_normal, 0, 0, LV_COORD_MAX, LV_TEXT_FLAG_NONE);

                lv_area_t txt_area;
                if(lv_chart_get_type(obj) == LV_CHART_TYPE_BAR) {
                    txt_area.y2 = dsc->draw_area->y1 - LV_DPX(15);
                    txt_area.y1 = txt_area.y2 - text_size.y;
                    if(ser == lv_chart_get_series_next(obj, NULL)) {
                        txt_area.x1 = dsc->draw_area->x1 + lv_area_get_width(dsc->draw_area) / 2;
                        txt_area.x2 = txt_area.x1 + text_size.x;
                    }
                    else {
                        txt_area.x2 = dsc->draw_area->x1 + lv_area_get_width(dsc->draw_area) / 2;
                        txt_area.x1 = txt_area.x2 - text_size.x;
                    }
                }
                else {
                    txt_area.x1 = dsc->draw_area->x1 + lv_area_get_width(dsc->draw_area) / 2 - text_size.x / 2;
                    txt_area.x2 = txt_area.x1 + text_size.x;
                    txt_area.y2 = dsc->draw_area->y1 - LV_DPX(15);
                    txt_area.y1 = txt_area.y2 - text_size.y;
                }

                lv_area_t bg_area;
                bg_area.x1 = txt_area.x1 - LV_DPX(8);
                bg_area.x2 = txt_area.x2 + LV_DPX(8);
                bg_area.y1 = txt_area.y1 - LV_DPX(8);
                bg_area.y2 = txt_area.y2 + LV_DPX(8);

                lv_draw_rect_dsc_t rect_dsc;
                lv_draw_rect_dsc_init(&rect_dsc);
                rect_dsc.bg_color = ser->color;
                rect_dsc.radius = LV_DPX(5);
                lv_draw_rect(dsc->draw_ctx, &rect_dsc, &bg_area);

                lv_draw_label_dsc_t label_dsc;
                lv_draw_label_dsc_init(&label_dsc);
                label_dsc.color = lv_color_white();
                label_dsc.font = font_normal;
                lv_draw_label(dsc->draw_ctx, &label_dsc, &txt_area,  buf, NULL);
            }
            else {
                dsc->rect_dsc->outline_width = 0;
                dsc->rect_dsc->shadow_width = 0;
            }
        }
    }
}


static void shop_chart_event_cb(lv_event_t * e)
{
    lv_event_code_t code = lv_event_get_code(e);
    if(code == LV_EVENT_DRAW_PART_BEGIN) {
        lv_obj_draw_part_dsc_t * dsc = lv_event_get_param(e);
        /*Set the markers' text*/
        if(dsc->part == LV_PART_TICKS && dsc->id == LV_CHART_AXIS_PRIMARY_X) {
            const char * month[] = {"Jan", "Febr", "March", "Apr", "May", "Jun", "July", "Aug", "Sept", "Oct", "Nov", "Dec"};
            lv_snprintf(dsc->text, dsc->text_length, "%s", month[dsc->value]);
        }
        if(dsc->part == LV_PART_ITEMS) {
            dsc->rect_dsc->bg_opa = LV_OPA_TRANSP; /*We will draw it later*/
        }
    }
    if(code == LV_EVENT_DRAW_PART_END) {
        lv_obj_draw_part_dsc_t * dsc = lv_event_get_param(e);
        /*Add the faded area before the lines are drawn */
        if(dsc->part == LV_PART_ITEMS) {
            static const uint32_t devices[10] = {32, 43, 21, 56, 29, 36, 19, 25, 62, 35};
            static const uint32_t clothes[10] = {12, 19, 23, 31, 27, 32, 32, 11, 21, 32};
            static const uint32_t services[10] = {56, 38, 56, 13, 44, 32, 49, 64, 17, 33};

            lv_draw_rect_dsc_t draw_rect_dsc;
            lv_draw_rect_dsc_init(&draw_rect_dsc);

            lv_coord_t h = lv_area_get_height(dsc->draw_area);

            lv_area_t a;
            a.x1 = dsc->draw_area->x1;
            a.x2 = dsc->draw_area->x2;

            a.y1 = dsc->draw_area->y1;
            a.y2 = a.y1 + 4 + (devices[dsc->id] * h) / 100; /*+4 to overlap the radius*/
            draw_rect_dsc.bg_color = lv_palette_main(LV_PALETTE_RED);
            draw_rect_dsc.radius = 4;
            lv_draw_rect(dsc->draw_ctx, &draw_rect_dsc, &a);

            a.y1 = a.y2 - 4;                                    /*-4 to overlap the radius*/
            a.y2 = a.y1 + (clothes[dsc->id] * h) / 100;
            draw_rect_dsc.bg_color = lv_palette_main(LV_PALETTE_BLUE);
            draw_rect_dsc.radius = 0;
            lv_draw_rect(dsc->draw_ctx, &draw_rect_dsc, &a);

            a.y1 = a.y2;
            a.y2 = a.y1 + (services[dsc->id] * h) / 100;
            draw_rect_dsc.bg_color = lv_palette_main(LV_PALETTE_GREEN);
            lv_draw_rect(dsc->draw_ctx, &draw_rect_dsc, &a);
        }
    }
}


static void meter1_indic1_anim_cb(void * var, int32_t v)
{
    lv_meter_set_indicator_end_value(meter1, var, v);

    lv_obj_t * card = lv_obj_get_parent(meter1);
    lv_obj_t * label = lv_obj_get_child(card, -5);
    lv_label_set_text_fmt(label, "Revenue: %"LV_PRId32" %%", v);
}

static void meter1_indic2_anim_cb(void * var, int32_t v)
{
    lv_meter_set_indicator_end_value(meter1, var, v);

    lv_obj_t * card = lv_obj_get_parent(meter1);
    lv_obj_t * label = lv_obj_get_child(card, -3);
    lv_label_set_text_fmt(label, "Sales: %"LV_PRId32" %%", v);

}

static void meter1_indic3_anim_cb(void * var, int32_t v)
{
    lv_meter_set_indicator_end_value(meter1, var, v);

    lv_obj_t * card = lv_obj_get_parent(meter1);
    lv_obj_t * label = lv_obj_get_child(card, -1);
    lv_label_set_text_fmt(label, "Costs: %"LV_PRId32" %%", v);
}

static void meter2_timer_cb(lv_timer_t * timer)
{
    lv_meter_indicator_t ** indics = timer->user_data;

    static bool down1 = false;
    static bool down2 = false;
    static bool down3 = false;


    if(down1) {
        session_desktop -= 137;
        if(session_desktop < 1400) down1 = false;
    }
    else {
        session_desktop += 116;
        if(session_desktop > 4500) down1 = true;
    }

    if(down2) {
        session_tablet -= 3;
        if(session_tablet < 1400) down2 = false;
    }
    else {
        session_tablet += 9;
        if(session_tablet > 4500) down2 = true;
    }

    if(down3) {
        session_mobile -= 57;
        if(session_mobile < 1400) down3 = false;
    }
    else {
        session_mobile += 76;
        if(session_mobile > 4500) down3 = true;
    }

    uint32_t all = session_desktop + session_tablet + session_mobile;
    uint32_t pct1 = (session_desktop * 97) / all;
    uint32_t pct2 = (session_tablet * 97) / all;

    lv_meter_set_indicator_start_value(meter2, indics[0], 0);
    lv_meter_set_indicator_end_value(meter2, indics[0], pct1);

    lv_meter_set_indicator_start_value(meter2, indics[1], pct1 + 1);
    lv_meter_set_indicator_end_value(meter2, indics[1], pct1 + 1 + pct2);

    lv_meter_set_indicator_start_value(meter2, indics[2], pct1 + 1 + pct2 + 1);
    lv_meter_set_indicator_end_value(meter2, indics[2], 99);

    lv_obj_t * card = lv_obj_get_parent(meter2);
    lv_obj_t * label;

    label = lv_obj_get_child(card, -5);
    lv_label_set_text_fmt(label, "Desktop: %"LV_PRIu32, session_desktop);

    label = lv_obj_get_child(card, -3);
    lv_label_set_text_fmt(label, "Tablet: %"LV_PRIu32, session_tablet);

    label = lv_obj_get_child(card, -1);
    lv_label_set_text_fmt(label, "Mobile: %"LV_PRIu32, session_mobile);
}

static void meter3_anim_cb(void * var, int32_t v)
{
    lv_meter_set_indicator_value(meter3, var, v);

    lv_obj_t * label = lv_obj_get_child(meter3, 0);
    lv_label_set_text_fmt(label, "%"LV_PRId32, v);
}

#endif
